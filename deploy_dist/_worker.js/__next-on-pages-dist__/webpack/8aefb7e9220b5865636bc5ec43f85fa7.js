var we={},nl=(ut,aa,al)=>(we.__chunk_27791=()=>{},we.__chunk_56267=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{default:()=>E,runtime:()=>k});var s=u(73992),x=u(50801);let k="edge";function E(){return(0,s.jsxs)("div",{className:"flex min-h-[60vh] flex-col items-center justify-center gap-4 p-6 text-center",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold",children:"\u9875\u9762\u672A\u627E\u5230"}),(0,s.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"\u60A8\u8BBF\u95EE\u7684\u9875\u9762\u4E0D\u5B58\u5728\u6216\u5DF2\u88AB\u79FB\u52A8\u3002"}),(0,s.jsx)(x.Z,{href:"/",className:"rounded bg-blue-600 px-4 py-2 text-white hover:bg-blue-700 dark:bg-blue-500 dark:hover:bg-blue-600",children:"\u8FD4\u56DE\u9996\u9875"})]})}},we.__chunk_19172=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{default:()=>te,generateMetadata:()=>L,runtime:()=>F,viewport:()=>U});var s=u(73992),x=u(96951),k=u.n(x);u(27791),u(30451);var E=u(93664),S=u(23460);let d=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/ConditionalNav.tsx#default`),o=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/GlobalDownloadManager.tsx#default`),g=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/GlobalErrorIndicator.tsx#GlobalErrorIndicator`);(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/GlobalErrorIndicator.tsx#triggerGlobalError`);let c=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/NavigationLoadingIndicator.tsx#NavigationLoadingIndicator`);(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/NavigationLoadingProvider.tsx#useNavigationLoading`);let f=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/NavigationLoadingProvider.tsx#NavigationLoadingProvider`),m=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/ServiceWorkerRegistration.tsx#default`);(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/SiteProvider.tsx#useSite`);let C=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/SiteProvider.tsx#SiteProvider`),I=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/SubscriptionAutoUpdate.tsx#default`),_=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/ThemeProvider.tsx#ThemeProvider`),R=(0,S.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/src/components/UserOnlineUpdate.tsx#default`),F="edge";async function L(){let Y=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV";return process.env.NEXT_PUBLIC_STORAGE_TYPE!=="localstorage"&&(Y=(await(0,E.iE)()).SiteConfig.SiteName),{title:Y,description:"\u5F71\u89C6\u805A\u5408",manifest:"/manifest.json"}}let U={viewportFit:"cover"};async function te({children:Y}){let q=process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",se=process.env.NEXT_PUBLIC_SITE_NAME||"MoonTV",J=process.env.ANNOUNCEMENT||"\u672C\u7F51\u7AD9\u4EC5\u63D0\u4F9B\u5F71\u89C6\u4FE1\u606F\u641C\u7D22\u670D\u52A1\uFF0C\u6240\u6709\u5185\u5BB9\u5747\u6765\u81EA\u7B2C\u4E09\u65B9\u7F51\u7AD9\u3002\u672C\u7AD9\u4E0D\u5B58\u50A8\u4EFB\u4F55\u89C6\u9891\u8D44\u6E90\uFF0C\u4E0D\u5BF9\u4EFB\u4F55\u5185\u5BB9\u7684\u51C6\u786E\u6027\u3001\u5408\u6CD5\u6027\u3001\u5B8C\u6574\u6027\u8D1F\u8D23\u3002",j=process.env.NEXT_PUBLIC_ENABLE_REGISTER==="true",M=process.env.NEXT_PUBLIC_DOUBAN_PROXY_TYPE||"direct",b=process.env.NEXT_PUBLIC_DOUBAN_PROXY||"",N=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY_TYPE||"direct",$=process.env.NEXT_PUBLIC_DOUBAN_IMAGE_PROXY||"",X=process.env.NEXT_PUBLIC_DISABLE_YELLOW_FILTER==="true",ae=process.env.NEXT_PUBLIC_DANMU_API_BASE_URL||"",K=!1;if(q!=="localstorage"){let ke=await(0,E.iE)();se=ke.SiteConfig.SiteName,J=ke.SiteConfig.Announcement,j=ke.UserConfig.AllowRegister,M=ke.SiteConfig.DoubanProxyType,b=ke.SiteConfig.DoubanProxy,N=ke.SiteConfig.DoubanImageProxyType,$=ke.SiteConfig.DoubanImageProxy,X=ke.SiteConfig.DisableYellowFilter,ae=ke.SiteConfig.DanmakuApiBaseUrl||ae,K=ke.SubscriptionConfig?.autoUpdate===!0}let ve={STORAGE_TYPE:process.env.NEXT_PUBLIC_STORAGE_TYPE||"localstorage",ENABLE_REGISTER:j,DOUBAN_PROXY_TYPE:M,DOUBAN_PROXY:b,DOUBAN_IMAGE_PROXY_TYPE:N,DOUBAN_IMAGE_PROXY:$,DISABLE_YELLOW_FILTER:X,DANMU_API_BASE_URL:ae};return(0,s.jsxs)("html",{lang:"zh-CN",suppressHydrationWarning:!0,children:[(0,s.jsxs)("head",{children:[(0,s.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0, viewport-fit=cover"}),(0,s.jsx)("link",{rel:"apple-touch-icon",href:"/icons/icon-192x192.png"}),(0,s.jsx)("script",{dangerouslySetInnerHTML:{__html:`window.RUNTIME_CONFIG = ${JSON.stringify(ve)};`}})]}),(0,s.jsx)("body",{className:`${k().className} min-h-screen bg-white text-gray-900 dark:bg-black dark:text-gray-200`,children:(0,s.jsxs)(_,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:[(0,s.jsx)(m,{}),(0,s.jsx)(f,{children:(0,s.jsxs)(C,{siteName:se,announcement:J,children:[(0,s.jsx)(c,{}),(0,s.jsx)(R,{}),(0,s.jsx)(d,{}),(0,s.jsx)(o,{}),(0,s.jsx)("div",{className:"relative w-full",children:(0,s.jsx)("main",{className:"flex-1 mb-14 md:mb-0",style:{paddingBottom:"calc(3.5rem + env(safe-area-inset-bottom))"},children:Y})}),(0,s.jsx)(g,{}),K&&(0,s.jsx)(I,{})]})})]})})]})}},we.__chunk_62738=(ce,O,u)=>{"use strict";var s;u.d(O,{Df:()=>k,n4:()=>S,qu:()=>s,we:()=>x});let x="3.8.2";async function k(){try{let d=await E("https://raw.githubusercontent.com/Stardm0/MoonTV/main/VERSION.txt");if(d)return S(d);let o=await E(["https://raw.githubusercontent.com/Stardm0/MoonTV/main/VERSION.txt"][1]);return o?S(o):"fetch_failed"}catch(d){return console.error("\u7248\u672C\u68C0\u67E5\u5931\u8D25:",d),"fetch_failed"}}async function E(d){try{let o=new AbortController,g=setTimeout(()=>o.abort(),5e3),c=Date.now(),f=d.includes("?")?`${d}&_t=${c}`:`${d}?_t=${c}`,m=await fetch(f,{method:"GET",signal:o.signal,headers:{"Content-Type":"text/plain"}});if(clearTimeout(g),!m.ok)throw Error(`HTTP error! status: ${m.status}`);return(await m.text()).trim()}catch(o){return console.warn(`\u4ECE ${d} \u83B7\u53D6\u7248\u672C\u4FE1\u606F\u5931\u8D25:`,o),null}}function S(d){if(d===x)return"no_update";try{let o=x.split(".").map(C=>{let I=parseInt(C,10);if(isNaN(I)||I<0)throw Error(`\u65E0\u6548\u7684\u7248\u672C\u53F7\u683C\u5F0F: ${x}`);return I}),g=d.split(".").map(C=>{let I=parseInt(C,10);if(isNaN(I)||I<0)throw Error(`\u65E0\u6548\u7684\u7248\u672C\u53F7\u683C\u5F0F: ${d}`);return I}),c=C=>{if(C.length>=3)return C.slice(0,3);{let I=[...C];for(;I.length<3;)I.push(0);return I}},f=c(o),m=c(g);for(let C=0;C<3;C++){if(m[C]>f[C])return"has_update";if(m[C]<f[C])break}return"no_update"}catch(o){return console.error("\u7248\u672C\u53F7\u6BD4\u8F83\u5931\u8D25:",o),d!==x?"has_update":"no_update"}}(function(d){d.HAS_UPDATE="has_update",d.NO_UPDATE="no_update",d.FETCH_FAILED="fetch_failed"})(s||(s={}))},we.__chunk_82720=(ce,O,u)=>{"use strict";u.d(O,{Jy:()=>E,a8:()=>x,e9:()=>k}),u(60337);var s=u(11780);function x(S){if(!S||!S.includes("doubanio.com"))return S;let{proxyType:d,proxyUrl:o}={proxyType:localStorage.getItem("doubanImageProxyType")||window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY_TYPE||"direct",proxyUrl:localStorage.getItem("doubanImageProxyUrl")||window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY||""};switch(d){case"server":return`/api/image-proxy?url=${encodeURIComponent(S)}`;case"img3":return S.replace(/img\d+\.doubanio\.com/g,"img3.doubanio.com");case"cmliussss-cdn-tencent":return S.replace(/img\d+\.doubanio\.com/g,"img.doubanio.cmliussss.net");case"cmliussss-cdn-ali":return S.replace(/img\d+\.doubanio\.com/g,"img.doubanio.cmliussss.com");case"custom":return`${o}${encodeURIComponent(S)}`;default:return S}}async function k(S){try{return new Promise((d,o)=>{let g=document.createElement("video");g.muted=!0,g.preload="metadata";let c=performance.now(),f=0;fetch(S,{method:"HEAD",mode:"no-cors"}).then(()=>{f=performance.now()-c}).catch(()=>{f=performance.now()-c});let m=new s.ZP,C=setTimeout(()=>{m.destroy(),g.remove(),o(Error("Timeout loading video metadata"))},4e3);g.onerror=()=>{clearTimeout(C),m.destroy(),g.remove(),o(Error("Failed to load video metadata"))};let I="\u672A\u77E5",_=!1,R=!1,F=0,L=()=>{if(R&&(_||I!=="\u672A\u77E5")){clearTimeout(C);let U=g.videoWidth;U&&U>0?(m.destroy(),g.remove(),d({quality:U>=3840?"4K":U>=2560?"2K":U>=1920?"1080p":U>=1280?"720p":U>=854?"480p":"SD",loadSpeed:I,pingTime:Math.round(f)})):d({quality:"\u672A\u77E5",loadSpeed:I,pingTime:Math.round(f)})}};m.on(s.ZP.Events.FRAG_LOADING,()=>{F=performance.now()}),m.on(s.ZP.Events.FRAG_LOADED,(U,te)=>{if(F>0&&te&&te.payload&&!_){let Y=performance.now()-F,q=te.payload.byteLength||0;if(Y>0&&q>0){let se=q/1024/(Y/1e3);I=se>=1024?`${(se/1024).toFixed(1)} MB/s`:`${se.toFixed(1)} KB/s`,_=!0,L()}}}),m.loadSource(S),m.attachMedia(g),m.on(s.ZP.Events.ERROR,(U,te)=>{console.error("HLS\u9519\u8BEF:",te),te.fatal&&(clearTimeout(C),m.destroy(),g.remove(),o(Error(`HLS\u64AD\u653E\u5931\u8D25: ${te.type}`)))}),g.onloadedmetadata=()=>{R=!0,L()}})}catch(d){throw Error(`Error getting video resolution: ${d instanceof Error?d.message:String(d)}`)}}function E(){return 30}},we.__chunk_12694=(ce,O,u)=>{"use strict";u.d(O,{createWriteStream:()=>g});let s=window.isSecureContext||location.protocol==="https:",x="MozAppearance"in document.documentElement.style,k=s||x?"iframe":"navigate",E=/constructor/i.test(window.HTMLElement.toString())||!!window.safari;try{new Response(new ReadableStream),!s||"serviceWorker"in navigator||(E=!0)}catch{E=!0}let S=!1;try{let{readable:c}=new TransformStream,f=new MessageChannel;f.port1.postMessage(c,[c]),f.port1.close(),f.port2.close(),S=!0}catch{S=!1}let d=null;function o(c){let f=document.createElement("iframe");f.hidden=!0,f.src=c,f.name="iframe",document.body.appendChild(f);let m={frame:f,loaded:!1,isIframe:!0,remove(){window.removeEventListener("message",C),document.body.removeChild(f)},postMessage(I,_,R){f.contentWindow?.postMessage(I,_,R)},addEventListener(I,_,R){f.addEventListener(I,_,R)}},C=I=>{if(I.data==="stream-saver-ready"&&I.source===f.contentWindow){m.loaded=!0,window.removeEventListener("message",C);let _=new Event("load");f.dispatchEvent(_)}};return window.addEventListener("message",C),m}function g(c){let f=0,m=null,C=null,I=null;if(!E){d=d||(s?o("/mitm.html"):function(F){let L=document.createDocumentFragment(),U={frame:window.open(F,"popup","width=200,height=100"),loaded:!1,isPopup:!0,remove(){this.frame&&"close"in this.frame&&this.frame.close()},postMessage(Y,q,se){this.frame&&"postMessage"in this.frame&&this.frame.postMessage(Y,q,se)},addEventListener(Y,q,se){L.addEventListener(Y,q,se)}},te=Y=>{if(Y.source===U.frame){U.loaded=!0,window.removeEventListener("message",te);let q=new Event("load");L.dispatchEvent(q)}};return window.addEventListener("message",te),U}("/mitm.html")),C=new MessageChannel,c=encodeURIComponent(c.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A"),S&&(I=new TransformStream(k==="iframe"?void 0:{transform(F,L){if(!(F instanceof Uint8Array))throw TypeError("Can only write Uint8Arrays");f+=F.length,L.enqueue(F),m&&(location.href=m,m=null)},flush(){m&&(location.href=m)}}),C.port1.postMessage({readableStream:I.readable},[I.readable])),C.port1.onmessage=F=>{if(F.data.download)k==="navigate"?(d?.remove(),d=null,f?location.href=F.data.download:m=F.data.download):(d?.isPopup&&(d?.remove(),d=null,k==="iframe"&&o("/mitm.html")),o(F.data.download));else if(F.data.abort&&(_=[],C)){C.port1.postMessage("abort");let L=C.port1;L.onmessage=null,L.close(),C.port2.close(),C=null}};let R={transferringReadable:S,pathname:Math.random().toString().slice(-6)+"/"+c,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+c}};d.loaded?d.postMessage(R,"*",[C.port2]):d.addEventListener("load",()=>{d&&C&&d.postMessage(R,"*",[C.port2])},{once:!0})}let _=[];return!E&&I&&I.writable?I.writable:new WritableStream({write(R){if(!(R instanceof Uint8Array))throw TypeError("Can only write Uint8Arrays");if(E){_.push(R);return}C?.port1.postMessage(R),f+=R.length,m&&(location.href=m,m=null)},close(){if(E){let R=new Blob(_,{type:"application/octet-stream; charset=utf-8"}),F=document.createElement("a");F.href=URL.createObjectURL(R),F.download=c,F.click()}else C?.port1.postMessage("end")},abort(){if(_=[],C){C.port1.postMessage("abort");let R=C.port1;R.onmessage=null,R.close(),C.port2.close(),C=null}}})}},we.__chunk_90848=(ce,O,u)=>{"use strict";async function s(x,k){return null}u.d(O,{createFileSystemWriteStream:()=>s})},we.__chunk_70040=(ce,O,u)=>{"use strict";u.d(O,{op:()=>S,transmuxTSToMP4:()=>E});var s=u(16536),x=u.n(s);class k{constructor(o){this.mp4Segments=[],this.isInitialized=!1,this.duration=o||0,this.transmuxer=new(x()).mp4.Transmuxer({keepOriginalTimestamps:!0,duration:this.duration}),this.transmuxer.on("data",g=>{let c=new Uint8Array(g.initSegment.byteLength+g.data.byteLength);c.set(g.initSegment,0),c.set(g.data,g.initSegment.byteLength),this.mp4Segments.push(c)}),this.transmuxer.on("done",()=>{this.isInitialized=!0})}push(o){this.transmuxer.push(o)}flush(){this.transmuxer.flush()}getMP4Blob(){if(this.mp4Segments.length===0)throw Error("\u6CA1\u6709\u53EF\u7528\u7684 MP4 \u6570\u636E");let o=new Uint8Array(this.mp4Segments.reduce((c,f)=>c+f.byteLength,0)),g=0;for(let c of this.mp4Segments)o.set(c,g),g+=c.byteLength;return new Blob([o],{type:"video/mp4"})}reset(){this.mp4Segments=[],this.isInitialized=!1,this.transmuxer=new(x()).mp4.Transmuxer({keepOriginalTimestamps:!0,duration:this.duration}),this.transmuxer.on("data",o=>{let g=new Uint8Array(o.initSegment.byteLength+o.data.byteLength);g.set(o.initSegment,0),g.set(o.data,o.initSegment.byteLength),this.mp4Segments.push(g)}),this.transmuxer.on("done",()=>{this.isInitialized=!0})}isReady(){return this.isInitialized}}function E(d,o){let g=new k(o);for(let c of d)g.push(new Uint8Array(c));return g.flush(),g.getMP4Blob()}class S{constructor(o,g){this.writer=null,this.segmentCount=0,this.isFirstSegment=!0,this.writeError=null,this.pendingWrites=[],this.writer=o||null,this.duration=g||0,this.transmuxer=new(x()).mp4.Transmuxer({keepOriginalTimestamps:!0,duration:this.duration}),this.transmuxer.on("data",async c=>{if(!this.writeError)try{this.isFirstSegment&&c.initSegment&&(this.writer&&await this.writer.write(new Uint8Array(c.initSegment)),this.isFirstSegment=!1),c.data&&this.writer&&await this.writer.write(new Uint8Array(c.data)),this.segmentCount++}catch(f){throw console.error("\u5199\u5165 MP4 \u6570\u636E\u5931\u8D25:",f),this.writeError=f instanceof Error?f:Error(String(f)),f}})}setWriter(o){this.writer=o}async pushAndTransmux(o){if(this.writeError||(this.transmuxer.push(o),this.transmuxer.flush(),await new Promise(g=>setTimeout(g,0)),this.writeError))throw this.writeError}async finish(){if(this.transmuxer.flush(),this.writer)try{await this.writer.close()}catch(o){console.error("\u5173\u95ED\u5199\u5165\u6D41\u5931\u8D25:",o)}}getSegmentCount(){return this.segmentCount}reset(){this.segmentCount=0,this.isFirstSegment=!0,this.transmuxer=new(x()).mp4.Transmuxer({keepOriginalTimestamps:!0,duration:this.duration}),this.transmuxer.on("data",async o=>{try{this.isFirstSegment&&o.initSegment&&(this.writer&&await this.writer.write(new Uint8Array(o.initSegment)),this.isFirstSegment=!1),o.data&&this.writer&&await this.writer.write(new Uint8Array(o.data)),this.segmentCount++}catch(g){throw console.error("\u5199\u5165 MP4 \u6570\u636E\u5931\u8D25:",g),g}})}}},we.__chunk_87101=(ce,O,u)=>{"use strict";u.d(O,{BV:()=>d,MP:()=>C,jz:()=>g,mergeSegments:()=>f,qA:()=>c,triggerDownload:()=>m,zc:()=>E});var s=u(13132),x=u.n(s),k=u(70040);class E{pause(){this.isPaused||(this.isPaused=!0,this.pausePromise=new Promise(_=>{this.resumeResolve=_}))}resume(){this.isPaused&&this.resumeResolve&&(this.isPaused=!1,this.resumeResolve(),this.resumeResolve=null,this.pausePromise=null)}async waitIfPaused(){this.isPaused&&this.pausePromise&&await this.pausePromise}getPaused(){return this.isPaused}destroy(){this.isPaused=!1,this.resumeResolve&&(this.resumeResolve(),this.resumeResolve=null),this.pausePromise=null}constructor(){this.isPaused=!1,this.resumeResolve=null,this.pausePromise=null}}function S(I,_){if(/^http/.test(I))return I;let R=new URL(_),F=R.protocol,L=R.host;if(I.startsWith("/"))return`${F}//${L}${I}`;let U=_.split("/");return U.pop(),`${U.join("/")}/${I}`}async function d(I,_=0){if(_>5)throw Error("M3U8 \u89E3\u6790\u5C42\u7EA7\u8FC7\u6DF1\uFF0C\u53EF\u80FD\u5B58\u5728\u5FAA\u73AF\u5F15\u7528");let R=await fetch(I),F=await R.text();if(F.substring(0,7).toUpperCase()!=="#EXTM3U")throw Error("\u65E0\u6548\u7684 m3u8 \u94FE\u63A5");if(F.includes("#EXT-X-STREAM-INF")){let Y=function(q,se){let J=q.split(`
`),j=[];for(let M=0;M<J.length;M++){let b=J[M].trim();if(b.startsWith("#EXT-X-STREAM-INF")){let N=b.match(/BANDWIDTH=(\d+)/),$=b.match(/RESOLUTION=([\dx]+)/);if(M+1<J.length){let X=J[M+1].trim();X&&!X.startsWith("#")&&j.push({url:S(X,se),bandwidth:N?parseInt(N[1]):void 0,resolution:$?$[1]:void 0})}}}return j.length===0?null:(j.sort((M,b)=>(b.bandwidth||0)-(M.bandwidth||0)),j[0].url)}(F,I);if(!Y)throw Error("\u65E0\u6CD5\u4ECE\u4E3B\u64AD\u653E\u5217\u8868\u4E2D\u63D0\u53D6\u5B50\u64AD\u653E\u5217\u8868");return d(Y,_+1)}let L={url:I,title:function(Y){try{let se=new URL(Y).searchParams.get("title");if(se)return se}catch{}let q=new Date;return`video_${q.getFullYear()}${String(q.getMonth()+1).padStart(2,"0")}${String(q.getDate()).padStart(2,"0")}_${String(q.getHours()).padStart(2,"0")}${String(q.getMinutes()).padStart(2,"0")}${String(q.getSeconds()).padStart(2,"0")}`}(I),type:"TS",tsUrlList:[],finishList:[],downloadIndex:0,finishNum:0,errorNum:0,aesConf:{method:"",uri:"",iv:"",key:""},durationSecond:0,segmentDurations:[],rangeDownload:{startSegment:1,endSegment:0,targetSegment:0},totalSize:0},U=F.split(`
`),te=null;for(let Y of U)if(Y.startsWith("#EXTINF:"))te=parseFloat(Y.split("#EXTINF:")[1]),L.durationSecond+=te;else if(/^[^#]/.test(Y)&&Y.trim()){let q=S(Y.trim(),I);L.tsUrlList.push(q),L.finishList.push({title:Y.trim(),status:""}),L.segmentDurations.push(te??0),te=null}if(L.rangeDownload.endSegment=L.tsUrlList.length,L.rangeDownload.targetSegment=L.tsUrlList.length,L.totalSize=Math.round(262144*L.durationSecond),F.includes("#EXT-X-KEY")){let Y=F.match(/METHOD=([^,\s]+)/),q=F.match(/URI="([^"]+)"/),se=F.match(/IV=([^,\s]+)/);if(L.aesConf.method=Y?Y[1]:"",L.aesConf.uri=q?S(q[1],I):"",L.aesConf.iv=se?se[1]:"",L.aesConf.uri){let J=await fetch(L.aesConf.uri),j=await J.arrayBuffer();L.aesConf.key=o(j)}}return L}function o(I){let _=new Uint8Array(I),R=_.length,F=[];for(let L=0;L<R;L+=1)F[L>>>2]|=(255&_[L])<<24-L%4*8;return x().lib.WordArray.create(F,R)}function g(I,_,R){if(!_)return I;let F=o(I),L=R?x().enc.Hex.parse(R.replace("0x","")):x().lib.WordArray.create(),U=x().AES.decrypt({ciphertext:F},_,{iv:L,mode:x().mode.CBC,padding:x().pad.Pkcs7}),te=new Uint8Array(U.sigBytes),Y=U.words;for(let q=0;q<U.sigBytes;q++)te[q]=Y[q>>>2]>>>24-q%4*8&255;return te.buffer}async function c(I,_){let R=await fetch(I,{signal:_});if(!R.ok)throw Error(`\u4E0B\u8F7D\u5931\u8D25: ${R.status}`);return R.arrayBuffer()}function f(I,_){return new Blob(I,{type:_==="MP4"?"video/mp4":"video/MP2T"})}function m(I,_,R){let F=URL.createObjectURL(I),L=document.createElement("a");L.href=F;let U=_.replace(/\.(mp4|ts|m3u8)$/i,"");L.download=`${U}.${R.toLowerCase()}`,L.style.display="none",document.body.appendChild(L),L.click(),setTimeout(()=>{document.body.removeChild(L),URL.revokeObjectURL(F)},100)}async function C(I,_,R,F,L=6,U="disabled",te=3,Y){let q,{startSegment:se,endSegment:J}=I.rangeDownload,j=J-se+1,M=I.segmentDurations.slice(se-1,J).reduce((ne,W)=>ne+W,0),b=null,N=null,$=new Map,X=se-1,ae=Promise.resolve();if(U!=="disabled")try{let ne=I.title.replace(/\.(mp4|ts|m3u8)$/i,""),W=I.type==="MP4"?".mp4":".ts",Q=ne+W;Q.toLowerCase().endsWith(W)||(Q+=W);let de=I.totalSize||void 0,ue=null;if(U==="service-worker"){let{createWriteStream:ye}=await Promise.resolve().then(u.bind(u,12694));ue=ye(Q),console.log("\u2705 \u4F7F\u7528 Service Worker \u6D41\u5F0F\u4E0B\u8F7D")}else if(U==="file-system"){let{createFileSystemWriteStream:ye}=await Promise.resolve().then(u.bind(u,90848));if(ue=await ye(Q,de))console.log("\u2705 \u4F7F\u7528\u6587\u4EF6\u7CFB\u7EDF\u76F4\u5199");else throw Error("\u7528\u6237\u53D6\u6D88\u4E86\u6587\u4EF6\u9009\u62E9")}ue&&(b=ue.getWriter(),I.type==="MP4"&&(N=new k.op(b,M),console.log("\u2705 \u542F\u7528 MP4 \u6D41\u5F0F\u8F6C\u7801")))}catch(ne){console.error("\u521B\u5EFA\u6D41\u5F0F\u5199\u5165\u5668\u5931\u8D25\uFF0C\u964D\u7EA7\u4E3A\u666E\u901A\u4E0B\u8F7D:",ne),b=null}let K=0,ve=async()=>{await ae,b&&(ae=ae.then(async()=>{for(;$.has(X);){if(F&&await F.waitIfPaused(),R?.aborted)throw Error("\u4E0B\u8F7D\u5DF2\u53D6\u6D88");let ne=$.get(X);if(ne==="failed"){console.warn(`\u26A0\uFE0F \u8DF3\u8FC7\u5931\u8D25\u7247\u6BB5 ${X+1}`),$.delete(X),X++;continue}if(!ne)break;try{if(N)await N.pushAndTransmux(new Uint8Array(ne));else if(b)await b.write(new Uint8Array(ne));else throw Error("Writer is not initialized");$.delete(X),X++}catch(W){throw console.error(`\u7247\u6BB5 ${X+1} \u5199\u5165\u6D41\u5931\u8D25:`,W),Error(`\u5199\u5165\u5931\u8D25: ${W instanceof Error?W.message:String(W)}`)}}}),await ae)};Y&&U!=="disabled"&&b&&(Y.current=async()=>{if(b)try{await ve(),N?await N.finish():await b.close(),_?.({current:K,total:j,percentage:100,status:"done",message:"\u4E0B\u8F7D\u5B8C\u6210\uFF01"})}catch(ne){throw console.error("\u63D0\u524D\u5B8C\u6210\u65F6\u5173\u95ED\u6D41\u5931\u8D25:",ne),ne}});let ke=[];for(let ne=se-1;ne<J;ne++)ke.push(ne);let fe=async(ne,W=0)=>{if(R?.aborted)throw Error("\u4E0B\u8F7D\u5DF2\u53D6\u6D88");F&&await F.waitIfPaused(),I.finishList[ne].status="downloading",I.finishList[ne].retryCount=W;try{if(F&&await F.waitIfPaused(),R?.aborted)throw Error("\u4E0B\u8F7D\u5DF2\u53D6\u6D88");let Q=await c(I.tsUrlList[ne],R);if(F&&await F.waitIfPaused(),R?.aborted||(I.aesConf.key&&(Q=g(Q,I.aesConf.key,I.aesConf.iv)),F&&await F.waitIfPaused(),R?.aborted)||(b?($.set(ne,Q),await ve()):(I.downloadedSegments||(I.downloadedSegments=new Map),I.downloadedSegments.set(ne,Q)),F&&await F.waitIfPaused(),R?.aborted))throw Error("\u4E0B\u8F7D\u5DF2\u53D6\u6D88");I.finishList[ne].status="success",K++,I.finishNum++,_?.({current:K,total:j,percentage:Math.floor(K/j*100),status:"downloading",message:`\u6B63\u5728\u4E0B\u8F7D ${K}/${j} \u4E2A\u7247\u6BB5 (${L} \u7EBF\u7A0B)${W>0?" [\u91CD\u8BD5\u6210\u529F]":""}`})}catch(Q){if(Q instanceof Error&&Q.message.includes("\u5199\u5165\u5931\u8D25"))throw console.error("\u5199\u5165\u6D41\u5931\u8D25\uFF0C\u7528\u6237\u53EF\u80FD\u53D6\u6D88\u4E86\u4E0B\u8F7D\uFF0C\u505C\u6B62\u4E0B\u8F7D\u4EFB\u52A1"),Q;if(W<te)return console.warn(`\u7247\u6BB5 ${ne+1} \u4E0B\u8F7D\u5931\u8D25\uFF0C1000ms \u540E\u8FDB\u884C\u7B2C ${W+1} \u6B21\u91CD\u8BD5...`),_?.({current:K,total:j,percentage:Math.floor(K/j*100),status:"downloading",message:`\u7247\u6BB5 ${ne+1} \u91CD\u8BD5\u4E2D (${W+1}/${te})`}),await new Promise(de=>setTimeout(de,1e3)),fe(ne,W+1);I.errorNum++,I.finishList[ne].status="error",I.finishList[ne].retryCount=W,console.error(`\u7247\u6BB5 ${ne+1} \u4E0B\u8F7D\u5931\u8D25\uFF08\u5DF2\u91CD\u8BD5 ${te} \u6B21\uFF09:`,Q),U!=="disabled"&&b?($.set(ne,"failed"),await ve(),console.warn(`\u8FB9\u4E0B\u8FB9\u5B58\u6A21\u5F0F\uFF1A\u5DF2\u8DF3\u8FC7\u5931\u8D25\u7247\u6BB5 ${ne+1}\uFF0C\u7EE7\u7EED\u4E0B\u8F7D...`),_?.({current:K,total:j,percentage:Math.floor(K/j*100),status:"downloading",message:`\u7247\u6BB5 ${ne+1} \u5931\u8D25\u5DF2\u8DF3\u8FC7 (\u5DF2\u5B8C\u6210 ${K}/${j})`})):_?.({current:K,total:j,percentage:Math.floor(K/j*100),status:"downloading",message:`\u7247\u6BB5 ${ne+1} \u4E0B\u8F7D\u5931\u8D25\uFF0C\u7B49\u5F85\u91CD\u8BD5 (\u5DF2\u5B8C\u6210 ${K}/${j})`})}},Ae=[],_e=async()=>{for(;ke.length>0;){if(R?.aborted)throw Error("\u4E0B\u8F7D\u5DF2\u53D6\u6D88");F&&await F.waitIfPaused();let ne=ke.shift();ne!==void 0&&await fe(ne)}};for(let ne=0;ne<Math.min(L,j);ne++)Ae.push(_e());try{if(await Promise.all(Ae),b){try{await ve(),N?await N.finish():await b.close(),_?.({current:K,total:j,percentage:100,status:"done",message:"\u4E0B\u8F7D\u5B8C\u6210\uFF01"})}catch(ne){throw console.error("\u5173\u95ED\u6D41\u5931\u8D25:",ne),ne}return}}catch(ne){if(b)try{await b.abort()}catch(W){console.error("\u4E2D\u6B62\u6D41\u5931\u8D25:",W)}throw ne}if(!I.downloadedSegments||I.downloadedSegments.size===0)throw Error("\u6CA1\u6709\u6210\u529F\u4E0B\u8F7D\u7684\u7247\u6BB5");if(I.finishList.slice(se-1,J).some(ne=>ne.status==="error")){let ne=I.finishList.slice(se-1,J).filter(W=>W.status==="error").length;console.warn(`\u26A0\uFE0F \u6709 ${ne} \u4E2A\u7247\u6BB5\u4E0B\u8F7D\u5931\u8D25\uFF0C\u7B49\u5F85\u624B\u52A8\u91CD\u8BD5...`),_?.({current:K,total:j,percentage:Math.round(K/j*100),status:"downloading",message:`${ne} \u4E2A\u7247\u6BB5\u5931\u8D25\uFF0C\u7B49\u5F85\u91CD\u8BD5...`});return}let Z=[];for(let ne=se-1;ne<J;ne++){let W=I.downloadedSegments.get(ne);W&&Z.push(W)}if(_?.({current:Z.length,total:J-se+1,percentage:100,status:"processing",message:I.type==="MP4"?"\u6B63\u5728\u8F6C\u7801\u4E3A MP4 \u683C\u5F0F...":"\u6B63\u5728\u5408\u5E76\u89C6\u9891\u6587\u4EF6..."}),I.type==="MP4"){let ne=I.segmentDurations.slice(se-1,J).reduce((W,Q)=>W+Q,0);q=(0,k.transmuxTSToMP4)(Z,ne)}else q=f(Z,I.type);m(q,I.title,I.type),_?.({current:Z.length,total:J-se+1,percentage:100,status:"done",message:"\u4E0B\u8F7D\u5B8C\u6210\uFF01"})}},we.__chunk_2587=(ce,O,u)=>{"use strict";function s(x){if(x===0)return"00:00";let k=Math.floor(x/3600),E=Math.floor(x%3600/60),S=Math.round(x%60);return k===0?`${E.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`:`${k.toString().padStart(2,"0")}:${E.toString().padStart(2,"0")}:${S.toString().padStart(2,"0")}`}u.d(O,{m:()=>s})},we.__chunk_17242=(ce,O,u)=>{"use strict";u.d(O,{C2:()=>j,Ev:()=>R,F0:()=>_,Ji:()=>C,Lj:()=>M,Rr:()=>f,Rw:()=>F,at:()=>Y,c1:()=>m,j5:()=>se,jz:()=>q,nO:()=>I,qn:()=>U,r7:()=>te,rq:()=>J,sO:()=>c});var s=u(84217);let x="1.0.0",k=process.env.STORAGE_TYPE||"localstorage";class E{static getInstance(){return E.instance||(E.instance=new E),E.instance}getCurrentUsername(){return(0,s.v)()?.username||null}getUserCacheKey(N){return`moontv_cache_${N}`}getUserCache(N){return{}}saveUserCache(N,$){}cleanOldCache(N){let $=Date.now();N.playRecords&&$-N.playRecords.timestamp>5184e6&&delete N.playRecords,N.favorites&&$-N.favorites.timestamp>5184e6&&delete N.favorites}clearAllCache(){Object.keys(localStorage).forEach(N=>{N.startsWith("moontv_cache_")&&localStorage.removeItem(N)})}isCacheValid(N){let $=Date.now();return N.version===x&&$-N.timestamp<36e5}createCacheData(N){return{data:N,timestamp:Date.now(),version:x}}getCachedPlayRecords(){let N=this.getCurrentUsername();if(!N)return null;let $=this.getUserCache(N).playRecords;return $&&this.isCacheValid($)?$.data:null}cachePlayRecords(N){let $=this.getCurrentUsername();if(!$)return;let X=this.getUserCache($);X.playRecords=this.createCacheData(N),this.saveUserCache($,X)}getCachedFavorites(){let N=this.getCurrentUsername();if(!N)return null;let $=this.getUserCache(N).favorites;return $&&this.isCacheValid($)?$.data:null}cacheFavorites(N){let $=this.getCurrentUsername();if(!$)return;let X=this.getUserCache($);X.favorites=this.createCacheData(N),this.saveUserCache($,X)}getCachedSearchHistory(){let N=this.getCurrentUsername();if(!N)return null;let $=this.getUserCache(N).searchHistory;return $&&this.isCacheValid($)?$.data:null}cacheSearchHistory(N){let $=this.getCurrentUsername();if(!$)return;let X=this.getUserCache($);X.searchHistory=this.createCacheData(N),this.saveUserCache($,X)}getCachedSkipConfigs(){let N=this.getCurrentUsername();if(!N)return null;let $=this.getUserCache(N).skipConfigs;return $&&this.isCacheValid($)?$.data:null}cacheSkipConfigs(N){let $=this.getCurrentUsername();if(!$)return;let X=this.getUserCache($);X.skipConfigs=this.createCacheData(N),this.saveUserCache($,X)}clearUserCache(N){let $=N||this.getCurrentUsername();if($)try{let X=this.getUserCacheKey($);localStorage.removeItem(X)}catch(X){console.warn("\u6E05\u9664\u7528\u6237\u7F13\u5B58\u5931\u8D25:",X)}}clearExpiredCaches(){}}let S=E.getInstance();async function d(b,N){console.error(`\u6570\u636E\u5E93\u64CD\u4F5C\u5931\u8D25 (${b}):`,N);try{let $,X;switch(b){case"playRecords":$=await g("/api/playrecords"),S.cachePlayRecords($),X="playRecordsUpdated";break;case"favorites":$=await g("/api/favorites"),S.cacheFavorites($),X="favoritesUpdated";break;case"searchHistory":$=await g("/api/searchhistory"),S.cacheSearchHistory($),X="searchHistoryUpdated"}window.dispatchEvent(new CustomEvent(X,{detail:$}))}catch($){console.error(`\u5237\u65B0${b}\u7F13\u5B58\u5931\u8D25:`,$)}}async function o(b,N){let $=await fetch(b,N);if(!$.ok){if($.status===401){try{await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(K){console.error("\u6CE8\u9500\u8BF7\u6C42\u5931\u8D25:",K)}let X=window.location.pathname+window.location.search,ae=new URL("/login",window.location.origin);throw ae.searchParams.set("redirect",X),window.location.href=ae.toString(),Error("\u7528\u6237\u672A\u6388\u6743\uFF0C\u5DF2\u8DF3\u8F6C\u5230\u767B\u5F55\u9875\u9762")}throw Error(`\u8BF7\u6C42 ${b} \u5931\u8D25: ${$.status}`)}return $}async function g(b){return await(await o(b)).json()}function c(b,N){return`${b}+${N}`}async function f(){return{}}async function m(b,N,$){let X=c(b,N);if(k!=="localstorage"){let ae=S.getCachedPlayRecords()||{};$.title&&Object.keys(ae).forEach(K=>{K!==X&&ae[K].title===$.title&&delete ae[K]}),ae[X]=$,S.cachePlayRecords(ae),window.dispatchEvent(new CustomEvent("playRecordsUpdated",{detail:ae}));try{await o("/api/playrecords",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:X,record:$})})}catch(K){throw await d("playRecords",K),K}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u4FDD\u5B58\u64AD\u653E\u8BB0\u5F55\u5230 localStorage")}async function C(b,N){let $=c(b,N);if(k!=="localstorage"){let X=S.getCachedPlayRecords()||{};delete X[$],S.cachePlayRecords(X),window.dispatchEvent(new CustomEvent("playRecordsUpdated",{detail:X}));try{await o(`/api/playrecords?key=${encodeURIComponent($)}`,{method:"DELETE"})}catch(ae){throw await d("playRecords",ae),ae}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u5220\u9664\u64AD\u653E\u8BB0\u5F55\u5230 localStorage")}async function I(){return[]}async function _(b){let N=b.trim();if(N&&k!=="localstorage"){let $=[N,...(S.getCachedSearchHistory()||[]).filter(X=>X!==N)];$.length>20&&($.length=20),S.cacheSearchHistory($),window.dispatchEvent(new CustomEvent("searchHistoryUpdated",{detail:$}));try{await o("/api/searchhistory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({keyword:N})})}catch(X){await d("searchHistory",X)}return}}async function R(){if(k!=="localstorage"){S.cacheSearchHistory([]),window.dispatchEvent(new CustomEvent("searchHistoryUpdated",{detail:[]}));try{await o("/api/searchhistory",{method:"DELETE"})}catch(b){await d("searchHistory",b)}return}}async function F(b){let N=b.trim();if(N&&k!=="localstorage"){let $=(S.getCachedSearchHistory()||[]).filter(X=>X!==N);S.cacheSearchHistory($),window.dispatchEvent(new CustomEvent("searchHistoryUpdated",{detail:$}));try{await o(`/api/searchhistory?keyword=${encodeURIComponent(N)}`,{method:"DELETE"})}catch(X){await d("searchHistory",X)}return}}async function L(){return{}}async function U(b,N,$){let X=c(b,N);if(k!=="localstorage"){let ae=S.getCachedFavorites()||{};ae[X]=$,S.cacheFavorites(ae),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:ae}));try{await o("/api/favorites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:X,favorite:$})})}catch(K){throw await d("favorites",K),K}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u4FDD\u5B58\u6536\u85CF\u5230 localStorage")}async function te(b,N){let $=c(b,N);if(k!=="localstorage"){let X=S.getCachedFavorites()||{};delete X[$],S.cacheFavorites(X),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:X}));try{await o(`/api/favorites?key=${encodeURIComponent($)}`,{method:"DELETE"})}catch(ae){throw await d("favorites",ae),ae}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u5220\u9664\u6536\u85CF\u5230 localStorage")}async function Y(b,N){let $=c(b,N);if(k!=="localstorage"){let X=S.getCachedFavorites();if(X)return g("/api/favorites").then(ae=>{JSON.stringify(X)!==JSON.stringify(ae)&&(S.cacheFavorites(ae),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:ae})))}).catch(ae=>{console.warn("\u540E\u53F0\u540C\u6B65\u6536\u85CF\u5931\u8D25:",ae)}),!!X[$];try{let ae=await g("/api/favorites");return S.cacheFavorites(ae),!!ae[$]}catch(ae){return console.error("\u68C0\u67E5\u6536\u85CF\u72B6\u6001\u5931\u8D25:",ae),!1}}return!!(await L())[$]}async function q(){if(k!=="localstorage"){S.cachePlayRecords({}),window.dispatchEvent(new CustomEvent("playRecordsUpdated",{detail:{}}));try{await o("/api/playrecords",{method:"DELETE",headers:{"Content-Type":"application/json"}})}catch(b){throw await d("playRecords",b),b}return}}async function se(){if(k!=="localstorage"){S.cacheFavorites({}),window.dispatchEvent(new CustomEvent("favoritesUpdated",{detail:{}}));try{await o("/api/favorites",{method:"DELETE",headers:{"Content-Type":"application/json"}})}catch(b){throw await d("favorites",b),b}return}}function J(b,N){return()=>{}}async function j(b,N,$){let X=c(b,N);if(k!=="localstorage"){let ae=S.getCachedSkipConfigs()||{};ae[X]=$,S.cacheSkipConfigs(ae),window.dispatchEvent(new CustomEvent("skipConfigsUpdated",{detail:ae}));try{await o("/api/skipconfigs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:X,config:$})})}catch(K){console.error("\u4FDD\u5B58\u8DF3\u8FC7\u7247\u5934\u7247\u5C3E\u914D\u7F6E\u5931\u8D25:",K)}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u4FDD\u5B58\u8DF3\u8FC7\u7247\u5934\u7247\u5C3E\u914D\u7F6E\u5230 localStorage")}async function M(b,N){let $=c(b,N);if(k!=="localstorage"){let X=S.getCachedSkipConfigs()||{};delete X[$],S.cacheSkipConfigs(X),window.dispatchEvent(new CustomEvent("skipConfigsUpdated",{detail:X}));try{await o(`/api/skipconfigs?key=${encodeURIComponent($)}`,{method:"DELETE"})}catch(ae){console.error("\u5220\u9664\u8DF3\u8FC7\u7247\u5934\u7247\u5C3E\u914D\u7F6E\u5931\u8D25:",ae)}return}console.warn("\u65E0\u6CD5\u5728\u670D\u52A1\u7AEF\u5220\u9664\u8DF3\u8FC7\u7247\u5934\u7247\u5C3E\u914D\u7F6E\u5230 localStorage")}},we.__chunk_84217=(ce,O,u)=>{"use strict";function s(){return null}u.d(O,{v:()=>s})},we.__chunk_52533=(ce,O,u)=>{"use strict";function s(){return null}u.d(O,{default:()=>s}),u(24528)},we.__chunk_51354=(ce,O,u)=>{"use strict";u.d(O,{T:()=>o});var s=u(20519),x=u(73069),k=u(51062),E=u(47264),S=u(82755),d=u(24528);function o(){let[g,c]=(0,d.useState)(!1),{setTheme:f,resolvedTheme:m}=(0,S.F)();(0,E.jD)();let C=I=>{let _=document.querySelector('meta[name="theme-color"]');if(_)_.setAttribute("content",I==="dark"?"#0c111c":"#f9fbfe");else{let R=document.createElement("meta");R.name="theme-color",R.content=I==="dark"?"#0c111c":"#f9fbfe",document.head.appendChild(R)}};return g?(0,s.jsx)("button",{onClick:()=>{let I=m==="dark"?"light":"dark";if(C(I),!document.startViewTransition){f(I);return}document.startViewTransition(()=>{f(I)})},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Toggle theme",children:m==="dark"?(0,s.jsx)(x.Z,{className:"w-full h-full"}):(0,s.jsx)(k.Z,{className:"w-full h-full"})}):(0,s.jsx)("div",{className:"w-10 h-10"})}},we.__chunk_56960=(ce,O,u)=>{"use strict";u.d(O,{ThemeProvider:()=>k});var s=u(20519),x=u(82755);function k({children:E,...S}){return(0,s.jsx)(x.f,{attribute:"class",defaultTheme:"system",enableSystem:!0,...S,children:E})}u(24528)},we.__chunk_13147=(ce,O,u)=>{"use strict";function s(){return null}u.d(O,{default:()=>s}),u(24528)},we.__chunk_51385=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>c});var s=u(20519),x=u(32083),k=u(68630),E=u(3482),S=u(73464),d=u(24528),o=u(71172),g=u.n(o);function c({selectedSources:f,onChange:m,openFilter:C,setOpenFilter:I,size:_="default"}){let[R,F]=(0,d.useState)([]),[L,U]=(0,d.useState)(!0),[te,Y]=(0,d.useState)(30),[q,se]=(0,d.useState)(!0),J=C==="sources",[j,M]=(0,d.useState)({}),b=(0,d.useRef)(null),N=(0,d.useRef)(null),$=ae=>{f.includes(ae)?m(f.filter(K=>K!==ae)):m([...f,ae])},X=_==="compact"?"h-10":"h-12";return L?(0,s.jsx)("div",{className:"relative inline-block",children:(0,s.jsx)("div",{className:"flex items-center bg-gray-200 dark:bg-gray-700 rounded-l-lg overflow-hidden",children:(0,s.jsxs)("button",{className:`flex items-center gap-1 px-3 ${X} text-sm font-medium opacity-50`,disabled:!0,children:[(0,s.jsx)(x.Z,{className:"w-4 h-4"}),(0,s.jsx)(k.Z,{className:"w-4 h-4"})]})})}):(0,s.jsxs)("div",{className:"relative inline-block",children:[(0,s.jsx)("div",{className:"flex items-center bg-gray-200 dark:bg-gray-700 rounded-l-lg overflow-hidden",children:(0,s.jsxs)("button",{ref:b,onClick:()=>{I(J?null:"sources")},className:`flex items-center gap-1 px-3 ${X} text-sm font-medium hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors`,children:[(0,s.jsx)(x.Z,{className:"w-4 h-4"}),f.length>0&&(0,s.jsx)("span",{className:"inline-flex items-center justify-center w-5 h-5 text-xs bg-green-500 text-white rounded-full ml-1",children:f.length}),(0,s.jsx)(k.Z,{className:`w-4 h-4 transition-transform ${J?"rotate-180":"rotate-0"}`})]})}),J&&(0,s.jsxs)("div",{ref:N,style:j,className:" fixed z-50 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-4 max-h-[50vh] overflow-auto ",children:[(0,s.jsxs)("div",{className:"mb-3 grid gap-2",style:{gridTemplateColumns:"repeat(auto-fit, minmax(120px, 1fr))"},children:[(0,s.jsxs)("button",{onClick:()=>{localStorage.setItem("savedSources",JSON.stringify(f)),localStorage.setItem("requestTimeout",te.toString()),g().fire({icon:"success",title:"\u4FDD\u5B58\u6210\u529F",text:"\u53EA\u4FDD\u5B58\u5728\u672C\u5730",toast:!0,position:"top-end",showConfirmButton:!1,timer:2e3,timerProgressBar:!0})},className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200 dark:bg-green-900/30 dark:text-green-400 dark:hover:bg-green-800/50 flex items-center justify-center gap-1",title:"\u4FDD\u5B58\u5F53\u524D\u9009\u4E2D\u7684\u641C\u7D22\u6E90\u548C\u8D85\u65F6\u8BBE\u7F6E",children:[(0,s.jsx)(E.Z,{className:"w-3 h-3"}),"\u4FDD\u5B58"]}),(0,s.jsxs)("button",{onClick:()=>{m([])},className:"px-2 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 dark:bg-red-900/30 dark:text-red-400 dark:hover:bg-red-800/50 flex items-center justify-center gap-1",title:"\u6E05\u7A7A\u6240\u6709\u9009\u4E2D\u7684\u641C\u7D22\u6E90",children:[(0,s.jsx)(S.Z,{className:"w-4 h-4"}),"\u6E05\u7A7A"]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 bg-gray-100 dark:bg-gray-700 rounded px-2 py-1",children:[(0,s.jsx)("label",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"\u8D85\u65F6:"}),(0,s.jsx)("input",{type:"number",min:"1",max:"60",value:te,onChange:ae=>Y(Math.max(1,Math.min(60,Number(ae.target.value)||30))),className:"w-12 px-1 py-0.5 text-sm bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded text-gray-700 dark:text-gray-300 focus:outline-none focus:ring-1 focus:ring-green-400",title:"\u8BF7\u6C42\u8D85\u65F6\u65F6\u95F4\uFF08\u79D2\uFF09"}),(0,s.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400 whitespace-nowrap",children:"\u79D2"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 bg-gray-100 dark:bg-gray-700 rounded px-2 py-1",children:[(0,s.jsx)("label",{className:"text-xs text-gray-700 dark:text-gray-300 whitespace-nowrap",children:"\u641C\u7D22\u5EFA\u8BAE"}),(0,s.jsx)("button",{onClick:()=>{let ae=!q;se(ae),localStorage.setItem("enableSearchSuggestions",ae.toString()),window.dispatchEvent(new CustomEvent("searchSettingsChanged",{detail:{enableSearchSuggestions:ae}}))},className:`relative inline-flex h-5 w-9 items-center rounded-full transition-colors ${q?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`,title:q?"\u70B9\u51FB\u5173\u95ED\u641C\u7D22\u5EFA\u8BAE\uFF08\u7ACB\u5373\u751F\u6548\uFF09":"\u70B9\u51FB\u5F00\u542F\u641C\u7D22\u5EFA\u8BAE\uFF08\u7ACB\u5373\u751F\u6548\uFF09",children:(0,s.jsx)("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${q?"translate-x-5":"translate-x-0.5"}`})})]})]}),R.length>0?(0,s.jsx)("div",{className:"grid gap-2",style:{gridTemplateColumns:"repeat(auto-fit, minmax(100px, 1fr))"},children:R.map(ae=>(0,s.jsx)("button",{onClick:()=>$(ae.key),className:`px-3 py-2 text-sm rounded-lg transition-all duration-200 text-center ${f.includes(ae.key)?"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400 border border-green-200 dark:border-green-700":"text-gray-700 dark:text-gray-300 hover:bg-gray-100/80 dark:hover:bg-gray-700/80"}`,title:ae.name,children:ae.name},ae.key))}):(0,s.jsx)("div",{className:"py-4 text-center text-gray-500 dark:text-gray-400",children:"\u8BF7\u914D\u7F6E\u641C\u7D22\u6E90\u6216\u6E05\u9664\u7F13\u5B58"})]})]})}u(82720)},we.__chunk_87602=(ce,O,u)=>{"use strict";u.d(O,{SiteProvider:()=>S,W:()=>E});var s=u(20519),x=u(24528);let k=(0,x.createContext)({siteName:"MoonTV",announcement:"\u672C\u7F51\u7AD9\u4EC5\u63D0\u4F9B\u5F71\u89C6\u4FE1\u606F\u641C\u7D22\u670D\u52A1\uFF0C\u6240\u6709\u5185\u5BB9\u5747\u6765\u81EA\u7B2C\u4E09\u65B9\u7F51\u7AD9\u3002\u672C\u7AD9\u4E0D\u5B58\u50A8\u4EFB\u4F55\u89C6\u9891\u8D44\u6E90\uFF0C\u4E0D\u5BF9\u4EFB\u4F55\u5185\u5BB9\u7684\u51C6\u786E\u6027\u3001\u5408\u6CD5\u6027\u3001\u5B8C\u6574\u6027\u8D1F\u8D23\u3002"}),E=()=>(0,x.useContext)(k);function S({children:d,siteName:o,announcement:g}){return(0,s.jsx)(k.Provider,{value:{siteName:o,announcement:g},children:d})}},we.__chunk_10291=(ce,O,u)=>{"use strict";function s(){return null}u.d(O,{default:()=>s}),u(24528)},we.__chunk_14219=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>k});var s=u(20519),x=u(24528);function k({query:E,isVisible:S,onSelect:d,onClose:o}){let[g,c]=(0,x.useState)([]),[f,m]=(0,x.useState)(-1),[C,I]=(0,x.useState)(!0),_=(0,x.useRef)(null),R=(0,x.useRef)(null),F=(0,x.useRef)(null),L=(0,x.useCallback)(async U=>{R.current&&R.current.abort();let te=new AbortController;R.current=te;try{let Y=await fetch(`/api/search/suggestions?q=${encodeURIComponent(U)}`,{signal:te.signal});if(!Y.body)return;let q=Y.body.getReader(),se=new TextDecoder,J="",j=!1;for(;!j;){let{value:M,done:b}=await q.read();if(j=b)break;let N=(J+=se.decode(M,{stream:!0})).split(`
`);for(let $ of(J=N.pop()||"",N))if($.trim())try{let X=JSON.parse($);X.suggestions&&Array.isArray(X.suggestions)&&c(ae=>[...ae,...X.suggestions.map(K=>({text:K.text}))])}catch(X){console.error("\u89E3\u6790\u6D41\u5F0F\u6570\u636E\u5931\u8D25",X)}}}catch(Y){if(Y instanceof Error&&Y.name==="AbortError")return;c([]),m(-1)}},[]);return(0,x.useCallback)(U=>{F.current&&clearTimeout(F.current),F.current=setTimeout(()=>{U.trim()&&S&&C?(c([]),L(U)):(c([]),m(-1))},300)},[S,C,L]),S&&C&&g.length!==0?(0,s.jsx)("div",{ref:_,className:"absolute top-full left-0 right-0 z-50 mt-1 bg-white dark:bg-gray-800 rounded-lg shadow-lg border border-gray-200 dark:border-gray-700 max-h-80 overflow-y-auto",children:g.map((U,te)=>(0,s.jsx)("button",{onClick:()=>d(U.text),onMouseEnter:()=>m(te),className:`w-full px-4 py-3 text-left hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors duration-150 flex items-center gap-3 ${f===te?"bg-gray-100 dark:bg-gray-700":""}`,children:(0,s.jsx)("span",{className:"flex-1 text-sm text-gray-700 dark:text-gray-300 truncate",children:U.text})},`suggestion-${U.text}-${te}`))}):null}},we.__chunk_53223=(ce,O,u)=>{"use strict";u.d(O,{NavigationLoadingProvider:()=>d,w:()=>S});var s=u(20519),x=u(47264),k=u(24528);let E=(0,k.createContext)({isLoading:!1,startLoading:()=>{},stopLoading:()=>{}}),S=()=>(0,k.useContext)(E);function d({children:o}){let[g,c]=(0,k.useState)(!1);(0,x.jD)(),(0,x.lr)();let f=(0,k.useCallback)(()=>{c(!0)},[]),m=(0,k.useCallback)(()=>{c(!1)},[]);return(0,s.jsx)(E.Provider,{value:{isLoading:g,startLoading:f,stopLoading:m},children:o})}},we.__chunk_19592=(ce,O,u)=>{"use strict";u.d(O,{NavigationLoadingIndicator:()=>E});var s=u(20519),x=u(24528),k=u(53223);function E(){let{isLoading:S}=(0,k.w)(),[d,o]=(0,x.useState)(!1),[g,c]=(0,x.useState)(!1);return d?(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("div",{className:"fixed inset-0 z-[50] bg-white/90 backdrop-blur-xl transition-opacity duration-500 dark:bg-gray-900/90",style:{opacity:g?1:0,pointerEvents:g?"auto":"none"},children:(0,s.jsxs)("div",{className:"flex items-center justify-center h-full",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("div",{className:"relative w-20 h-20",children:[(0,s.jsxs)("div",{className:"absolute inset-0 bg-gradient-to-br from-yellow-300 to-yellow-500 dark:from-yellow-400 dark:to-yellow-600 rounded-full shadow-lg shadow-yellow-500/30 animate-bounce",style:{animationDuration:"2s"},children:[(0,s.jsx)("div",{className:"absolute top-3 left-4 w-2 h-2 bg-yellow-600/40 dark:bg-yellow-700/40 rounded-full"}),(0,s.jsx)("div",{className:"absolute top-6 right-5 w-1.5 h-1.5 bg-yellow-600/40 dark:bg-yellow-700/40 rounded-full"}),(0,s.jsx)("div",{className:"absolute bottom-4 left-6 w-1 h-1 bg-yellow-600/40 dark:bg-yellow-700/40 rounded-full"})]}),(0,s.jsx)("div",{className:"absolute -bottom-1 -left-1 w-2 h-2 bg-yellow-400 dark:bg-yellow-300 rounded-full animate-spin",style:{animationDuration:"4s",animationDirection:"reverse"},children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-0.5 h-0.5 bg-yellow-600 dark:bg-yellow-500 rounded-full"})})})]})}),(0,s.jsxs)("div",{className:"absolute mt-32 text-gray-700 dark:text-gray-300 font-medium text-sm",children:[(0,s.jsx)("span",{className:"animate-pulse",children:"\u{1F319}"}),(0,s.jsx)("span",{className:"animate-pulse",style:{animationDelay:"0.2s"},children:" \u6708\u4EAE\u6B63\u5728\u52AA\u529B\u52A0\u8F7D\u4E2D"}),(0,s.jsx)("span",{className:"animate-pulse",style:{animationDelay:"0.4s"},children:" \u2728"})]})]})})}):null}},we.__chunk_29673=(ce,O,u)=>{"use strict";u.d(O,{GlobalErrorIndicator:()=>k});var s=u(20519),x=u(24528);function k(){let[E,S]=(0,x.useState)(null),[d,o]=(0,x.useState)(!1),[g,c]=(0,x.useState)(!1);return d&&E?(0,s.jsx)("div",{className:"fixed top-4 right-4 z-[2000]",children:(0,s.jsxs)("div",{className:`bg-red-500 text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between min-w-[300px] max-w-[400px] transition-all duration-300 ${g?"scale-105 bg-red-400":"scale-100 bg-red-500"} animate-fade-in`,children:[(0,s.jsx)("span",{className:"text-sm font-medium flex-1 mr-3",children:E.message}),(0,s.jsx)("button",{onClick:()=>{o(!1),S(null),c(!1)},className:"text-white hover:text-red-100 transition-colors flex-shrink-0","aria-label":"\u5173\u95ED\u9519\u8BEF\u63D0\u793A",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}):null}},we.__chunk_85592=(ce,O,u)=>{"use strict";u.d(O,{default:()=>L});var s=u(20519),x=u(24528),k=u(90556),E=u(73464),S=u(97798),d=u(28505),o=u(18392),g=u(89985),c=u(71172),f=u.n(c),m=u(87101),C=u(69817),I=u(14509),_=u(2587);let R=({task:U,isOpen:te,onClose:Y,onSegmentRetry:q,taskExists:se,concurrency:J=6,streamMode:j="disabled"})=>{let[M,b]=(0,x.useState)(new Set),[,N]=(0,x.useState)({}),$=async de=>{if(!M.has(de)){if(se&&!se()){console.log(`\u4EFB\u52A1\u5DF2\u5220\u9664\uFF0C\u53D6\u6D88\u7247\u6BB5 ${de+1} \u7684\u91CD\u8BD5`);return}b(ue=>new Set(ue).add(de));try{let ue=await(0,m.qA)(U.tsUrlList[de]);U.aesConf.key&&(ue=(0,m.jz)(ue,U.aesConf.key,U.aesConf.iv)),U.downloadedSegments||(U.downloadedSegments=new Map),U.downloadedSegments.set(de,ue),U.finishList[de].status="success",U.finishNum++,U.errorNum=Math.max(0,U.errorNum-1),q&&q(de),N({}),console.log(`\u7247\u6BB5 ${de+1} \u91CD\u8BD5\u6210\u529F\uFF0C\u6570\u636E\u5DF2\u4FDD\u5B58`)}catch(ue){console.error(`\u7247\u6BB5 ${de+1} \u91CD\u8BD5\u5931\u8D25:`,ue)}finally{b(ue=>{let ye=new Set(ue);return ye.delete(de),ye})}}},X=async()=>{if(se&&!se()){console.log("\u4EFB\u52A1\u5DF2\u5220\u9664\uFF0C\u53D6\u6D88\u6279\u91CF\u91CD\u8BD5");return}let de=U.finishList.map((Oe,Qe)=>({item:Oe,index:Qe})).filter(({item:Oe})=>Oe.status==="error").map(({index:Oe})=>Oe);if(de.length===0){console.log("\u26A0\uFE0F \u6CA1\u6709\u5931\u8D25\u7684\u7247\u6BB5\u53EF\u91CD\u8BD5");return}console.log(`\u5F00\u59CB\u6279\u91CF\u91CD\u8BD5 ${de.length} \u4E2A\u5931\u8D25\u7247\u6BB5\uFF0C\u5E76\u53D1\u6570: ${J}`);let ue=[...de],ye=async()=>{for(;ue.length>0;){if(se&&!se()){console.log("\u4EFB\u52A1\u5DF2\u5220\u9664\uFF0C\u505C\u6B62\u6279\u91CF\u91CD\u8BD5");return}let Oe=ue.shift();Oe!==void 0&&await $(Oe)}},Ge=[];for(let Oe=0;Oe<Math.min(J,de.length);Oe++)Ge.push(ye());try{await Promise.all(Ge);let Oe=U.finishList.filter(Qe=>Qe.status==="error").length;console.log(`\u6279\u91CF\u91CD\u8BD5\u5B8C\u6210\uFF0C\u5269\u4F59\u5931\u8D25\u7247\u6BB5: ${Oe}`),Oe===0&&console.log(`\u2705 \u6240\u6709\u7247\u6BB5\u5DF2\u6210\u529F\uFF01\u5DF2\u4FDD\u5B58 ${U.downloadedSegments?.size||0} \u4E2A\u7247\u6BB5\u6570\u636E\uFF0C\u5373\u5C06\u81EA\u52A8\u5408\u5E76\u4FDD\u5B58...`)}catch(Oe){console.error("\u6279\u91CF\u91CD\u8BD5\u51FA\u9519:",Oe)}};if((0,x.useEffect)(()=>{let de=ue=>{ue.key==="Escape"&&Y()};return te&&document.addEventListener("keydown",de),()=>{document.removeEventListener("keydown",de)}},[te,Y]),!te)return null;let{startSegment:ae,endSegment:K}=U.rangeDownload,ve=U.finishList.slice(ae-1,K),ke=ae-1,fe=U.segmentDurations||[],Ae=fe.slice(0,ae-1).reduce((de,ue)=>de+ue,0),_e=fe.slice(0,K).reduce((de,ue)=>de+ue,0),Z=ve.filter(de=>de.status==="success").length,ne=ve.filter(de=>de.status==="error").length,W=ve.filter(de=>de.status==="downloading").length,Q=ve.filter(de=>de.status==="").length;return(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[10000] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-2xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"\u7247\u6BB5\u5217\u8868"}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:U.title}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1",children:["\u7247\u6BB5\u8303\u56F4\uFF1A",ae," ~ ",K," \xA0|\xA0 \u65F6\u957F\u8303\u56F4\uFF1A",(0,_.m)(Ae)," ~ ",(0,_.m)(_e)]})]}),(0,s.jsx)("button",{onClick:Y,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,s.jsx)(E.Z,{className:"h-5 w-5"})})]}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 border-b border-gray-200 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-5 gap-3",children:[(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\u603B\u7247\u6BB5"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-900 dark:text-white mt-1",children:ve.length})]}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-xs text-green-600 dark:text-green-400",children:"\u6210\u529F"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-green-700 dark:text-green-300 mt-1",children:Z})]}),(0,s.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 relative",children:[(0,s.jsx)("div",{className:"text-xs text-red-600 dark:text-red-400",children:"\u5931\u8D25"}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-1",children:[(0,s.jsx)("div",{className:"text-lg font-semibold text-red-700 dark:text-red-300",children:ne}),(0,s.jsx)("button",{onClick:X,disabled:M.size>0||ne===0||j!=="disabled",className:"p-1.5 rounded-md hover:bg-red-200 dark:hover:bg-red-800 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",title:j!=="disabled"?"\u8FB9\u4E0B\u8FB9\u5B58\u6A21\u5F0F\u91CD\u8BD5\u7531\u91CD\u8BD5\u6B21\u6570\u63A7\u5236":"\u91CD\u8BD5\u6240\u6709\u5931\u8D25\u7247\u6BB5",children:(0,s.jsx)(I.Z,{className:`h-4 w-4 text-red-600 dark:text-red-400 ${M.size>0?"animate-spin":""}`})})]})]}),(0,s.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-xs text-blue-600 dark:text-blue-400",children:"\u4E0B\u8F7D\u4E2D"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-blue-700 dark:text-blue-300 mt-1",children:W})]}),(0,s.jsxs)("div",{className:"bg-gray-100 dark:bg-gray-700 rounded-lg p-3",children:[(0,s.jsx)("div",{className:"text-xs text-gray-600 dark:text-gray-400",children:"\u5F85\u4E0B\u8F7D"}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-700 dark:text-gray-300 mt-1",children:Q})]})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4",children:(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-2",children:ve.map((de,ue)=>{let ye=ke+ue,Ge=M.has(ye),Oe=de.status==="success"?"bg-green-100 dark:bg-green-900/30 border-green-300 dark:border-green-700":de.status==="error"?"bg-red-100 dark:bg-red-900/30 border-red-300 dark:border-red-700":de.status==="downloading"?"bg-blue-100 dark:bg-blue-900/30 border-blue-300 dark:border-blue-700":"bg-gray-100 dark:bg-gray-700 border-gray-300 dark:border-gray-600",Qe=de.status==="success"?"text-green-700 dark:text-green-300":de.status==="error"?"text-red-700 dark:text-red-300":de.status==="downloading"?"text-blue-700 dark:text-blue-300":"text-gray-700 dark:text-gray-300";return(0,s.jsxs)("div",{className:`relative border rounded-lg p-3 transition-all ${Oe} ${de.status!=="error"||Ge||j!=="disabled"?"":"cursor-pointer hover:shadow-md"}`,onClick:()=>{de.status!=="error"||Ge||j!=="disabled"||$(ye)},title:de.status==="error"?j!=="disabled"?"\u8FB9\u4E0B\u8FB9\u5B58\u6A21\u5F0F\u65E0\u6CD5\u91CD\u8BD5\u5931\u8D25\u7247\u6BB5":"\u70B9\u51FB\u91CD\u8BD5":de.status==="success"?"\u4E0B\u8F7D\u6210\u529F":de.status==="downloading"?"\u4E0B\u8F7D\u4E2D":"\u5F85\u4E0B\u8F7D",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:`text-sm font-medium ${Qe}`,children:["#",ye+1]}),de.status==="error"&&(0,s.jsx)(I.Z,{className:`h-3 w-3 ${Qe} ${Ge?"animate-spin":""}`})]}),(0,s.jsx)("div",{className:`text-xs mt-1 ${Qe} opacity-75`,children:de.status==="success"?"\u2713 \u6210\u529F":de.status==="error"?`\u2717 \u5931\u8D25${de.retryCount?` (\u91CD\u8BD5${de.retryCount}\u6B21)`:""}`:de.status==="downloading"?`\u27F3 ${de.retryCount&&de.retryCount>0?`\u91CD\u8BD5\u4E2D(\u7B2C${de.retryCount}\u6B21)`:"\u4E0B\u8F7D\u4E2D"}`:"\u25CB \u5F85\u4E0B\u8F7D"})]},ye)})})}),(0,s.jsx)("div",{className:"p-4 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"\u70B9\u51FB\u7EA2\u8272\u7247\u6BB5\u53EF\u4EE5\u91CD\u8BD5\u4E0B\u8F7D \u2022 \u7EFF\u8272\u8868\u793A\u6210\u529F \u2022 \u84DD\u8272\u8868\u793A\u4E0B\u8F7D\u4E2D \u2022 \u7070\u8272\u8868\u793A\u5F85\u4E0B\u8F7D"})})]})})},F=({isOpen:U,onClose:te})=>{let[Y,q]=(0,x.useState)([]),[se,J]=(0,x.useState)(!1),[j,M]=(0,x.useState)(null),b=(0,x.useRef)([]),N=(0,x.useRef)(!1),$=(0,x.useRef)(!1),X=(0,x.useRef)(new Set);(0,x.useEffect)(()=>{b.current=Y},[Y]),(0,x.useEffect)(()=>{},[]),(0,x.useEffect)(()=>{if(N.current)return;let W=Y.filter(Q=>Q.autoResume&&Q.status==="paused");W.length>0&&(N.current=!0,setTimeout(()=>{W.forEach(Q=>{Ae(Q.id)}),q(Q=>Q.map(de=>({...de,autoResume:!1})))},500))},[Y]),(0,x.useEffect)(()=>{},[Y]),(0,x.useEffect)(()=>{let W=()=>{$.current=!0,b.current.forEach(Q=>{Q.status==="downloading"&&Q.abortController&&Q.abortController.abort(),Q.pauseResumeController&&Q.pauseResumeController.destroy()})};return window.addEventListener("beforeunload",W),()=>{window.removeEventListener("beforeunload",W)}},[]);let ae=(0,x.useCallback)(async(W,Q,de,ue,ye,Ge,Oe,Qe,be,De="disabled",Xe=3,tt)=>{try{Q.type=ye,Oe&&(Q.rangeDownload={startSegment:Math.max(1,Math.min(Qe,Q.tsUrlList.length)),endSegment:Math.max(1,Math.min(be,Q.tsUrlList.length)),targetSegment:Math.abs(be-Qe)+1}),await(0,m.MP)(Q,Tt=>{q(Dt=>Dt.map(mt=>{if(mt.id!==W||mt.status==="merging"||mt.isEarlyCompleting)return mt;let cr=mt.status==="downloading",kr=mt.parsedTask?{...mt.parsedTask,finishNum:Q.finishNum,errorNum:Q.errorNum,finishList:Q.finishList,downloadedSegments:Q.downloadedSegments}:void 0;return{...mt,progress:Tt.percentage,current:Tt.current,total:Tt.total,status:cr?Tt.status==="done"?"completed":Tt.status==="error"?"error":"downloading":mt.status,parsedTask:kr}}))},de.signal,ue,Ge,De,Xe,tt);let Ct=b.current.find(Tt=>Tt.id===W),ct=Ct?.parsedTask?.finishList.some(Tt=>Tt.status==="error");ct&&De==="disabled"?console.log(`\u26A0\uFE0F \u4EFB\u52A1 ${W} \u6709\u5931\u8D25\u7247\u6BB5\uFF0C\u4FDD\u6301\u4E0B\u8F7D\u72B6\u6001\u7B49\u5F85\u91CD\u8BD5`):(q(Tt=>Tt.map(Dt=>Dt.id===W?{...Dt,abortController:void 0}:Dt)),ct&&De!=="disabled"&&console.log(`\u2705 \u8FB9\u4E0B\u8FB9\u5B58\u6A21\u5F0F\uFF1A\u4EFB\u52A1 ${W} \u5DF2\u5B8C\u6210\uFF0C\u5931\u8D25\u7247\u6BB5\u5DF2\u8DF3\u8FC7`))}catch(Ct){if(Ct instanceof Error&&Ct.message==="\u4E0B\u8F7D\u5DF2\u53D6\u6D88"){let ct=b.current.find(Tt=>Tt.id===W);if(ct?.isEarlyCompleting||ct?.status==="completed")return;$.current||q(Tt=>Tt.map(Dt=>Dt.id===W?{...Dt,status:"paused",abortController:void 0}:Dt))}else console.error("\u4E0B\u8F7D\u5931\u8D25:",Ct),q(ct=>ct.map(Tt=>Tt.id===W?{...Tt,status:"error",abortController:void 0}:Tt))}},[]),K=(0,x.useCallback)(W=>{let Q=Date.now().toString(),de=new AbortController,ue=new m.zc,ye={current:null},Ge={id:Q,url:W.url,title:W.title,status:"downloading",progress:0,current:0,total:W.parsedTask.tsUrlList.length,config:{downloadType:W.downloadType,concurrency:W.concurrency,rangeMode:W.rangeMode,startSegment:W.startSegment,endSegment:W.endSegment,streamMode:W.streamMode,maxRetries:W.maxRetries??3,parsedTask:W.parsedTask},parsedTask:W.parsedTask,abortController:de,pauseResumeController:ue,completeStreamRef:ye};q(Oe=>[...Oe,Ge]),setTimeout(()=>{ae(Q,W.parsedTask,de,ue,W.downloadType,W.concurrency,W.rangeMode,W.startSegment,W.endSegment,W.streamMode,W.maxRetries||3,ye)},0)},[ae]);(0,x.useEffect)(()=>()=>{},[ae]);let ve=(0,x.useCallback)(async(W,Q)=>{let de=b.current.find(ct=>ct.id===W);if(!de?.config)return;let ue=new AbortController,ye=new m.zc,Ge={current:null},{downloadType:Oe,concurrency:Qe,rangeMode:be,startSegment:De,endSegment:Xe,streamMode:tt,maxRetries:Ct}=de.config;q(ct=>ct.map(Tt=>Tt.id===W?{...Tt,status:"downloading",abortController:ue,pauseResumeController:ye,completeStreamRef:Ge}:Tt)),ae(W,Q,ue,ye,Oe,Qe,be,De,Xe,tt||"disabled",Ct??3,Ge)},[ae]),ke=(0,x.useCallback)(W=>{q(Q=>{let de=Q.find(ue=>ue.id===W);return de?.abortController&&de.abortController.abort(),de?.pauseResumeController&&de.pauseResumeController.destroy(),Q.filter(ue=>ue.id!==W)})},[]),fe=(0,x.useCallback)(W=>{q(Q=>{let de=Q.find(ue=>ue.id===W);return de?.pauseResumeController&&de.pauseResumeController.pause(),Q.map(ue=>ue.id===W?{...ue,status:"paused"}:ue)})},[]),Ae=(0,x.useCallback)(async W=>{console.log(`\u{1F504} resumeTask \u88AB\u8C03\u7528: taskId=${W}`);let Q=b.current.find(ye=>ye.id===W);if(!Q){console.log(`\u26A0\uFE0F \u627E\u4E0D\u5230\u4EFB\u52A1: ${W}`);return}console.log(`\u{1F4CB} \u4EFB\u52A1\u72B6\u6001: ${Q.status}, abortController: ${!!Q.abortController}`);let de=Q.parsedTask?.finishList.some(ye=>ye.status==="error");if(Q.status==="downloading"&&Q.abortController&&de){console.log("\u26A0\uFE0F \u4EFB\u52A1\u6B63\u5728\u4E0B\u8F7D\u4E2D\u4E14\u6709\u5931\u8D25\u7247\u6BB5\uFF0C\u8DF3\u8FC7");return}if(Q.pauseResumeController&&Q.pauseResumeController.getPaused()){console.log("\u25B6\uFE0F \u4EFB\u52A1\u5904\u4E8E\u6682\u505C\u72B6\u6001\uFF0C\u6062\u590D\u4E0B\u8F7D..."),Q.pauseResumeController.resume(),q(ye=>ye.map(Ge=>Ge.id===W?{...Ge,status:"downloading"}:Ge));return}let ue=Q.parsedTask||Q.config?.parsedTask;if(ue){let ye=ue.downloadedSegments?.size||0,Ge=Q.config?.streamMode!=="disabled",{startSegment:Oe,endSegment:Qe}=ue.rangeDownload,be=0,De=0,Xe=0;for(let Ct=Oe-1;Ct<Qe;Ct++){let ct=ue.finishList[Ct].status;ct===""||ct==="downloading"?be++:ct==="success"?De++:ct==="error"&&Xe++}let tt=Qe-Oe+1;if(console.log(`\u2705 \u4F7F\u7528\u5DF2\u4FDD\u5B58\u7684 parsedTask\uFF0C\u8303\u56F4\u5185\u7247\u6BB5: ${tt}\u4E2A\uFF0C\u6210\u529F: ${De}\uFF0C\u5931\u8D25: ${Xe}\uFF0C\u5F85\u4E0B\u8F7D: ${be}\uFF0C\u5DF2\u4FDD\u5B58\u6570\u636E: ${ye} \u4E2A, \u8FB9\u4E0B\u8FB9\u5B58: ${Ge}`),be===0){if(Xe===0){if(console.log(`\u{1F389} \u8303\u56F4\u5185\u6240\u6709 ${tt} \u4E2A\u7247\u6BB5\u90FD\u5DF2\u6210\u529F\u4E0B\u8F7D`),Ge){console.log("\u2705 \u8FB9\u4E0B\u8FB9\u5B58\u6A21\u5F0F\uFF0C\u6570\u636E\u5DF2\u5199\u5165\u6587\u4EF6\uFF0C\u76F4\u63A5\u6807\u8BB0\u4E3A\u5B8C\u6210"),q(Ct=>Ct.map(ct=>ct.id===W?{...ct,status:"completed",progress:100}:ct));return}console.log(`\u{1F4E6} \u666E\u901A\u6A21\u5F0F\uFF0C\u5F00\u59CB\u5408\u5E76 ${ye} \u4E2A\u7247\u6BB5\u6570\u636E...`),q(Ct=>Ct.map(ct=>ct.id===W?{...ct,status:"merging",progress:99}:ct)),setTimeout(async()=>{try{let Ct,ct=[];for(let kr=Oe-1;kr<Qe;kr++){let Ht=ue.downloadedSegments?.get(kr);Ht&&ct.push(Ht)}if(ct.length===0)throw Error("\u6CA1\u6709\u53EF\u5408\u5E76\u7684\u7247\u6BB5\u6570\u636E");console.log(`\u{1F4E6} \u5408\u5E76 ${ct.length} \u4E2A\u7247\u6BB5...`);let{mergeSegments:Tt,triggerDownload:Dt}=await Promise.resolve().then(u.bind(u,87101)),{transmuxTSToMP4:mt}=await Promise.resolve().then(u.bind(u,70040)),cr=Q.config?.downloadType||"TS";if(cr==="MP4"){let kr=ue.durationSecond||0,Ht=ue.finishList.length;console.log("\u{1F3AC} \u8F6C\u7801\u4E3A MP4 \u683C\u5F0F..."),Ct=mt(ct,tt/Ht*kr)}else Ct=Tt(ct,cr);Dt(Ct,ue.title,cr),q(kr=>kr.map(Ht=>Ht.id===W?{...Ht,status:"completed",progress:100}:Ht)),console.log("\u2705 \u5408\u5E76\u4E0B\u8F7D\u5B8C\u6210\uFF01")}catch(Ct){console.error("\u5408\u5E76\u4E0B\u8F7D\u5931\u8D25:",Ct),q(ct=>ct.map(Tt=>Tt.id===W?{...Tt,status:"error"}:Tt))}},100);return}console.log(`\u26A0\uFE0F \u8303\u56F4\u5185\u6709 ${Xe} \u4E2A\u7247\u6BB5\u5931\u8D25\uFF0C\u7B49\u5F85\u624B\u52A8\u91CD\u8BD5`);return}console.log(`\u25B6\uFE0F \u8FD8\u6709 ${be} \u4E2A\u7247\u6BB5\u5F85\u4E0B\u8F7D\uFF0C\u7EE7\u7EED\u4E0B\u8F7D...`),ve(W,ue);return}try{let ye=await(0,m.BV)(Q.url);ye.title=Q.title,q(Ge=>Ge.map(Oe=>Oe.id===W?{...Oe,config:{downloadType:Oe.config?.downloadType||"TS",concurrency:Oe.config?.concurrency||6,rangeMode:Oe.config?.rangeMode||!1,startSegment:Oe.config?.startSegment||1,endSegment:Oe.config?.endSegment||ye.tsUrlList.length,streamMode:Oe.config?.streamMode||"disabled",parsedTask:ye}}:Oe)),ve(W,ye)}catch(ye){console.error("\u91CD\u65B0\u89E3\u6790\u5931\u8D25:",ye),q(Ge=>Ge.map(Oe=>Oe.id===W?{...Oe,status:"error"}:Oe))}},[ve]),_e=(0,x.useCallback)(()=>{q(W=>(W.forEach(Q=>{Q.status==="downloading"&&Q.pauseResumeController&&Q.pauseResumeController.pause()}),W.map(Q=>Q.status==="downloading"?{...Q,status:"paused"}:Q)))},[]),Z=(0,x.useCallback)(()=>{b.current.forEach(W=>{(W.status==="waiting"||W.status==="paused"||W.status==="error")&&Ae(W.id)})},[Ae]),ne=(0,x.useCallback)(()=>{q(W=>(W.forEach(Q=>{Q.abortController&&Q.abortController.abort(),Q.pauseResumeController&&Q.pauseResumeController.destroy()}),[]))},[]);return U?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[9999] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-4xl max-h-[80vh] flex flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("h2",{className:"text-lg font-bold text-gray-900 dark:text-white flex items-center gap-2",children:[(0,s.jsx)(k.Z,{className:"h-5 w-5"}),"\u4E0B\u8F7D\u7BA1\u7406\u5668"]}),(0,s.jsx)("button",{onClick:te,className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors",children:(0,s.jsx)(E.Z,{className:"h-5 w-5"})})]}),(0,s.jsxs)("div",{className:"p-4 border-b border-gray-200 dark:border-gray-700 flex gap-2",children:[(0,s.jsxs)("button",{onClick:()=>J(!0),className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,s.jsx)(k.Z,{className:"h-4 w-4"}),"\u6DFB\u52A0\u4E0B\u8F7D"]}),(0,s.jsxs)("button",{onClick:Z,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,s.jsx)(S.Z,{className:"h-4 w-4"}),"\u5168\u90E8\u5F00\u59CB"]}),(0,s.jsxs)("button",{onClick:_e,className:"px-4 py-2 bg-yellow-600 hover:bg-yellow-700 text-white rounded-lg transition-colors flex items-center gap-2",children:[(0,s.jsx)(d.Z,{className:"h-4 w-4"}),"\u5168\u90E8\u6682\u505C"]}),(0,s.jsx)("button",{onClick:ne,className:"px-4 py-2 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors",children:"\u6E05\u7A7A\u5168\u90E8"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:Y.length===0?(0,s.jsx)("div",{className:"text-center py-12 text-gray-500 dark:text-gray-400",children:"\u6682\u65E0\u4E0B\u8F7D\u4EFB\u52A1"}):Y.map(W=>(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4 space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white truncate",children:W.title}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 truncate mt-1",children:W.url}),W.config&&(0,s.jsxs)("div",{className:"flex flex-wrap gap-2 mt-2",children:[(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-400",children:[W.config.downloadType," \u683C\u5F0F"]}),(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-400",children:[W.config.concurrency," \u7EBF\u7A0B"]}),W.config.rangeMode&&(()=>{let Q=0,de=0;if(W.parsedTask&&Array.isArray(W.parsedTask.segmentDurations)){let{startSegment:ue,endSegment:ye}=W.parsedTask.rangeDownload,Ge=W.parsedTask.segmentDurations;Q=Ge.slice(0,ue-1).reduce((Oe,Qe)=>Oe+Qe,0),de=Ge.slice(0,ye).reduce((Oe,Qe)=>Oe+Qe,0)}return(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-400",children:["\u8303\u56F4: ",W.config.startSegment,"-",W.config.endSegment,W.parsedTask&&W.parsedTask.segmentDurations&&W.parsedTask.segmentDurations.length>0&&(0,s.jsxs)(s.Fragment,{children:["\xA0|\xA0\u65F6\u957F: ",(0,_.m)(Q)," ~ ",(0,_.m)(de)]})]})})(),W.parsedTask&&(()=>{let{startSegment:Q,endSegment:de}=W.parsedTask.rangeDownload,ue=W.parsedTask.finishList.slice(Q-1,de).filter(ye=>ye.status==="error").length;return ue>0?(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400",children:["\u5931\u8D25: ",ue," \u4E2A\u7247\u6BB5"]}):null})()]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[W.parsedTask&&(0,s.jsx)("button",{onClick:async()=>{if(!X.current.has(W.id)&&W.parsedTask){if((W.config?.streamMode||"disabled")!=="disabled"){if(!(await f().fire({title:"\u7ACB\u5373\u4FDD\u5B58",text:`\u7ACB\u5373\u4FDD\u5B58\u5C06\u8DF3\u8FC7\u540E\u7EED\u7247\u6BB5\u4E0B\u8F7D\uFF0C\u76F4\u63A5\u5B8C\u6210\u4E0B\u8F7D\u3002\u6587\u4EF6\u5C06\u5305\u542B\u76EE\u524D\u5DF2\u4E0B\u8F7D\u7684\u7247\u6BB5\u3002

\u662F\u5426\u7EE7\u7EED\uFF1F`,icon:"warning",showCancelButton:!0,confirmButtonText:"\u786E\u5B9A",cancelButtonText:"\u53D6\u6D88",customClass:{container:"z-[11000]"}})).isConfirmed)return;if(W.completeStreamRef?.current)try{q(Q=>Q.map(de=>de.id===W.id?{...de,isEarlyCompleting:!0}:de)),W.abortController&&W.abortController.abort(),await new Promise(Q=>setTimeout(Q,100)),await W.completeStreamRef.current(),q(Q=>Q.map(de=>de.id===W.id?{...de,status:"completed",progress:100,current:de.total,abortController:void 0}:de)),setTimeout(()=>{q(Q=>Q.map(de=>de.id===W.id&&de.status==="completed"?{...de,isEarlyCompleting:!1}:de))},1e3)}catch(Q){console.error("\u5B8C\u6210\u4E0B\u8F7D\u5931\u8D25:",Q),f().fire({icon:"error",title:"\u5B8C\u6210\u4E0B\u8F7D\u5931\u8D25",text:Q instanceof Error?Q.message:String(Q)}),q(de=>de.map(ue=>ue.id===W.id?{...ue,isEarlyCompleting:!1}:ue))}else f().fire({icon:"error",title:"\u65E0\u6CD5\u5B8C\u6210\u4E0B\u8F7D",text:"\u6D41\u672A\u521D\u59CB\u5316"});return}X.current.add(W.id);try{let Q,{mergeSegments:de,triggerDownload:ue}=await Promise.resolve().then(u.bind(u,87101)),{transmuxTSToMP4:ye}=await Promise.resolve().then(u.bind(u,70040)),{startSegment:Ge,endSegment:Oe}=W.parsedTask.rangeDownload,Qe=W.config?.downloadType||"TS",be=[];for(let De=Ge-1;De<Oe;De++){let Xe=W.parsedTask.downloadedSegments?.get(De);Xe&&be.push(Xe)}if(be.length===0){alert("\u6CA1\u6709\u53EF\u5408\u5E76\u7684\u7247\u6BB5\u6570\u636E\uFF01");return}if(Qe==="MP4"){let De=(W.parsedTask.durationSecond||0)/(Oe-Ge+1)*be.length;Q=ye(be,De)}else Q=de(be,Qe);ue(Q,W.parsedTask.title,Qe)}catch(Q){alert("\u5408\u5E76\u4E0B\u8F7D\u5931\u8D25\uFF1A"+(Q instanceof Error?Q.message:Q))}finally{setTimeout(()=>X.current.delete(W.id),2e3)}}},className:"p-2 hover:bg-green-100 dark:hover:bg-green-900/30 text-green-600 dark:text-green-400 rounded-lg transition-colors",title:W.config?.streamMode==="disabled"?"\u7ACB\u5373\u5408\u5E76\u5DF2\u4E0B\u8F7D\u7247\u6BB5\u5E76\u5BFC\u51FA\u6587\u4EF6":"\u7ACB\u5373\u4FDD\u5B58\uFF08\u5C06\u8DF3\u8FC7\u540E\u7EED\u7247\u6BB5\u4E0B\u8F7D\uFF0C\u76F4\u63A5\u5B8C\u6210\u4E0B\u8F7D\uFF09",children:(0,s.jsx)(k.Z,{className:"h-4 w-4"})}),W.parsedTask&&(0,s.jsx)("button",{onClick:()=>M(W.id),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"\u67E5\u770B\u7247\u6BB5",children:(0,s.jsx)(o.Z,{className:"h-4 w-4"})}),W.status==="downloading"?(0,s.jsx)("button",{onClick:()=>fe(W.id),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"\u6682\u505C",children:(0,s.jsx)(d.Z,{className:"h-4 w-4"})}):W.status==="waiting"||W.status==="paused"||W.status==="error"?(0,s.jsx)("button",{onClick:()=>Ae(W.id),className:"p-2 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors",title:"\u5F00\u59CB/\u7EE7\u7EED",children:(0,s.jsx)(S.Z,{className:"h-4 w-4"})}):null,(0,s.jsx)("button",{onClick:()=>ke(W.id),className:"p-2 hover:bg-red-100 dark:hover:bg-red-900/30 text-red-600 dark:text-red-400 rounded-lg transition-colors",title:"\u5220\u9664",children:(0,s.jsx)(g.Z,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:W.status==="completed"?"\u5DF2\u5B8C\u6210":W.status==="merging"?"\u5408\u5E76\u4E2D":W.status==="downloading"?"\u4E0B\u8F7D\u4E2D":W.status==="error"?"\u4E0B\u8F7D\u5931\u8D25":W.status==="paused"?"\u5DF2\u6682\u505C":"\u7B49\u5F85\u4E2D"}),(0,s.jsxs)("span",{className:"text-gray-600 dark:text-gray-400",children:[Math.floor(W.progress),"%"]})]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 dark:bg-gray-600 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-green-600 h-2 rounded-full transition-all duration-300",style:{width:`${W.progress}%`}})}),(0,s.jsx)("div",{className:"flex items-center justify-between text-xs text-gray-500 dark:text-gray-400",children:(0,s.jsxs)("span",{children:[W.current," / ",W.total," \u7247\u6BB5"]})})]})]},W.id))})]})}),(0,s.jsx)(C.Z,{isOpen:se,onClose:()=>J(!1),onAddTask:W=>{K(W),J(!1)},initialUrl:"",initialTitle:""}),j&&(()=>{let W=Y.find(Q=>Q.id===j);return W?.parsedTask?(0,s.jsx)(R,{task:W.parsedTask,isOpen:!0,onClose:()=>M(null),taskExists:()=>Y.some(Q=>Q.id===j),concurrency:W.config?.concurrency||6,streamMode:W.config?.streamMode||"disabled",onSegmentRetry:Q=>{q(de=>de.map(ue=>{if(ue.id===j&&ue.parsedTask){let{startSegment:ye,endSegment:Ge}=ue.parsedTask.rangeDownload,Oe=0,Qe=0;for(let Xe=ye-1;Xe<Ge;Xe++)ue.parsedTask.finishList[Xe].status==="success"?Oe++:ue.parsedTask.finishList[Xe].status==="error"&&Qe++;let be=Ge-ye+1,De=Oe/be*100;if(Qe===0&&Oe===be){if(X.current.has(j))return console.log(`\u26A0\uFE0F \u4EFB\u52A1 ${j} \u5DF2\u7ECF\u5728\u5408\u5E76\u4E2D\uFF0C\u8DF3\u8FC7`),ue;X.current.add(j),console.log(`\u2705 \u8303\u56F4\u5185\u6240\u6709 ${be} \u4E2A\u7247\u6BB5\u91CD\u8BD5\u6210\u529F\uFF01downloadedSegments \u6709 ${ue.parsedTask.downloadedSegments?.size||0} \u4E2A\u7247\u6BB5\uFF0C\u81EA\u52A8\u89E6\u53D1\u5408\u5E76\u4FDD\u5B58...`),M(null),q(Xe=>Xe.map(tt=>tt.id===j?{...tt,abortController:void 0}:tt)),setTimeout(()=>{Ae(j),setTimeout(()=>{X.current.delete(j)},3e3)},500)}return{...ue,current:Oe,progress:De}}return ue}))}}):null})()]}):null},L=(0,x.memo)(()=>{let[U,te]=(0,x.useState)(!1);return(0,x.useEffect)(()=>()=>{},[]),(0,s.jsx)(F,{isOpen:U,onClose:()=>te(!1)})})},we.__chunk_68236=(ce,O,u)=>{"use strict";u.d(O,{default:()=>Qe});var s=u(20519),x=u(47264),k=u(24528),E=u(34422),S=u(68163),d=u(68054),o=u(92845),g=u(27715),c=u(43903),f=u(2826),m=u(277);async function C(){return(await(await fetch("/api/config/custom_category")).json()).filter(De=>!De.disabled).map(De=>({name:De.name||"",type:De.type,query:De.query}))}var I=u(53223);let _=(0,k.memo)(({activePath:be})=>{let De=(0,x.jD)(),{startLoading:Xe}=(0,I.w)(),tt=be??De,[Ct,ct]=(0,k.useState)([{icon:E.Z,label:"\u9996\u9875",href:"/"},{icon:S.Z,label:"\u641C\u7D22",href:"/search"},{icon:d.Z,label:"\u7535\u5F71",href:"/douban?type=movie"},{icon:o.Z,label:"\u5267\u96C6",href:"/douban?type=tv"},{icon:g.Z,label:"\u52A8\u6F2B",href:"/douban?type=anime"},{icon:c.Z,label:"\u7EFC\u827A",href:"/douban?type=show"}]),[Tt,Dt]=(0,k.useState)(!1),[mt,cr]=(0,k.useState)(!1);(0,k.useEffect)(()=>{cr(!0)},[]),(0,k.useEffect)(()=>{C().then(Ht=>{Ht.length>0&&ct(Or=>[...Or,{icon:f.Z,label:"\u81EA\u5B9A\u4E49",href:"/douban?type=custom"}])})},[]);let kr=Ht=>{let Or=Ht.match(/type=([^&]+)/)?.[1],fr=decodeURIComponent(tt);return fr===decodeURIComponent(Ht)||fr.startsWith("/douban")&&fr.includes(`type=${Or}`)};return(0,s.jsx)("nav",{className:"md:hidden fixed left-0 right-0 z-[600] bg-white/90 backdrop-blur-xl border-t border-gray-200/50 overflow-hidden dark:bg-gray-900/80 dark:border-gray-700/50",style:{bottom:0,paddingBottom:"env(safe-area-inset-bottom)",minHeight:"calc(3.5rem + env(safe-area-inset-bottom))"},children:(0,s.jsx)("ul",{className:"flex items-center overflow-x-auto scrollbar-hide",children:Ct.map(Ht=>{let Or=kr(Ht.href);return mt&&(!Tt||["/","/search"].includes(Ht.href))?(0,s.jsx)("li",{className:"flex-shrink-0",style:{width:Tt?"50vw":"20vw",minWidth:Tt?"50vw":"20vw"},children:(0,s.jsxs)(m.Z,{href:Ht.href,className:"flex flex-col items-center justify-center w-full h-14 gap-1 text-xs",onClick:fr=>{Or||Xe()},children:[(0,s.jsx)(Ht.icon,{className:`h-6 w-6 ${Or?"text-green-600 dark:text-green-400":"text-gray-500 dark:text-gray-400"}`}),(0,s.jsx)("span",{className:Or?"text-green-600 dark:text-green-400":"text-gray-600 dark:text-gray-300",children:Ht.label})]})},Ht.href):null})})})});var R=u(90556),F=u(35068);function L(){return(0,s.jsx)("button",{onClick:()=>window.history.back(),className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"Back",children:(0,s.jsx)(F.Z,{className:"w-full h-full"})})}var U=u(87602),te=u(51354),Y=u(32083),q=u(38834),se=u(31611),J=u(80185),j=u(73464),M=u(68630),b=u(55297),N=u(94570),$=u(4676),X=u(85192),ae=u(62738),K=u(9075),ve=u(14509),ke=u(17145),fe=u(60609),Ae=u(42860);let _e=[{version:"3.8.2",date:"2026-01-04",added:["\u5BFC\u822A\u680F\u52A0\u5165\u4E0B\u8F7D\u7BA1\u7406\u9875\u9762","\u89C6\u9891\u4E0B\u8F7D\u4E2D\u53EF\u67E5\u770B\u7247\u6BB5\u4E0B\u8F7D\u72B6\u51B5: \u53EF\u624B\u52A8\u8FDB\u884C\u9519\u8BEF\u91CD\u8BD5","\u53EF\u8BBE\u7F6E\u81EA\u52A8\u5F39\u5E55\u83B7\u53D6\u5C1D\u8BD5\u6B21\u6570","\u666E\u901A\u6A21\u5F0F\u4E0B\u8F7D\u53EF\u5728\u4E0B\u8F7D\u8FC7\u7A0B\u4E2D\u7ACB\u5373\u5B58\u50A8: \u5B58\u50A8\u5DF2\u7ECF\u4E0B\u8F7D\u7684\u7247\u6BB5\uFF0C\u4E0D\u5F71\u54CD\u6B63\u5E38\u4E0B\u8F7D\u8FC7\u7A0B"],changed:["\u5BFC\u822A\u680F\u6846\u67B6\u5206\u79BB: \u5207\u6362\u5BFC\u822A\u9875\u9762\u65F6\u4E0D\u518D\u5237\u65B0","\u5B8C\u5584\u8FB9\u4E0B\u8FB9\u5B58\u529F\u80FD: \u53EF\u624B\u52A8\u9009\u62E9\u4E09\u79CD\u4E0B\u8F7D\u6A21\u5F0F","\u5B8C\u5584mp4\u8F6C\u7801\u529F\u80FD"],fixed:["\u4FEE\u590D\u79FB\u52A8\u7AEF\u8FB9\u4E0B\u8FB9\u5B58\u6587\u4EF6\u540E\u7F00\u9519\u8BEF","\u4FEE\u590D\u767B\u5F55\u9875\u9762\u5BFC\u822A\u680F\u9519\u8BEF\u52A0\u8F7D"]},{version:"3.7.0",date:"2026-01-01",added:["\u52A0\u5165M3U8\u89C6\u9891\u5728\u7EBF\u4E0B\u8F7D\u529F\u80FD","\u652F\u6301\u591A\u7EBF\u7A0B\u5E76\u53D1\u4E0B\u8F7D\uFF081-16\u7EBF\u7A0B\u53EF\u8C03\uFF09","\u652F\u6301TS\u548CMP4\u683C\u5F0F\u8F6C\u6362","\u652F\u6301\u8303\u56F4\u4E0B\u8F7D\uFF08\u6307\u5B9A\u8D77\u59CB\u548C\u7ED3\u675F\u7247\u6BB5\uFF09","\u652F\u6301AES-128\u52A0\u5BC6\u89C6\u9891\u89E3\u5BC6","\u652F\u6301\u8FB9\u4E0B\u8FB9\u5B58\u529F\u80FD\uFF08\u89E3\u51B3\u5927\u6587\u4EF6\u5185\u5B58\u5360\u7528\u95EE\u9898\uFF09","\u4E0B\u8F7D\u4EFB\u52A1\u7BA1\u7406\uFF08\u6682\u505C/\u7EE7\u7EED/\u5220\u9664\uFF09","\u6279\u91CF\u64CD\u4F5C\uFF08\u5168\u90E8\u5F00\u59CB/\u5168\u90E8\u6682\u505C/\u6E05\u7A7A\u5168\u90E8\uFF09","\u672C\u5730\u5B58\u50A8\u4EFB\u52A1\u6301\u4E45\u5316","\u81EA\u52A8\u4FDD\u7559\u7528\u6237\u914D\u7F6E\u504F\u597D\uFF08\u683C\u5F0F\u3001\u7EBF\u7A0B\u6570\u3001\u8FB9\u4E0B\u8FB9\u5B58\uFF09"],changed:["\u64AD\u653E\u9875\u9762\u6DFB\u52A0\u4E0B\u8F7D\u89C6\u9891\u6309\u94AE","\u663E\u793A\u7528\u6237\u6700\u540E\u5728\u7EBF\u65F6\u95F4"],fixed:["\u4FEE\u590D\u5386\u53F2\u5F71\u7247\u91CD\u590D\u4FDD\u5B58\u95EE\u9898","\u4FEE\u590D\u8BBE\u7F6E\u91CD\u7F6E\u4E0D\u5B8C\u5168\u7684\u95EE\u9898"]},{version:"3.6.2",date:"2025-12-09",added:["\u6DFB\u52A0\u9ED8\u8BA4\u4F18\u9009\u6362\u6E90\u5F00\u5173"],changed:["\u4F18\u5316\u5F39\u5E55\u81EA\u52A8\u52A0\u8F7D","\u9ED8\u8BA4\u4E3A\u7A7A\u58F3\u9879\u76EE(\u65E0\u5185\u7F6E\u6E90\u548C\u5F39\u5E55)","\u4F18\u5316\u4F18\u9009\u6362\u6E90\u52A0\u8F7D\u5F62\u5F0F"],fixed:["OrionTV\u672C\u5730\u5B58\u50A8\u64AD\u653E\u65E0\u6E90"]},{version:"3.5.7",date:"2025-12-06",added:["\u81EA\u52A8\u5F39\u5E55\u52A0\u8F7D\u529F\u80FD","\u8BA2\u9605\u914D\u7F6E\u529F\u80FD"],changed:["\u4F18\u5316\u5F39\u5E55\u52A0\u8F7D","\u4F7F\u7528artplayer\u5F39\u5E55\u5E93","\u5F39\u5E55\u52A0\u8F7D\u72B6\u6001\u63D0\u793A"],fixed:[]},{version:"3.5.0",date:"2025-11-30",added:["\u52A0\u5165\u89C6\u9891\u64AD\u653E\u5F39\u5E55\u529F\u80FD"],changed:["\u53EF\u624B\u52A8\u641C\u7D22\u5F39\u5E55\u6E90","\u53EF\u63A7\u5236\u5F39\u5E55\u7684\u663E\u793A\u884C\u6570","\u53EF\u63A7\u5236\u5F39\u5E55\u7684\u663E\u793A\u5BC6\u5EA6","\u5206\u9875\u6E32\u67D3\u641C\u7D22\u7ED3\u679C"],fixed:["\u4FEE\u590DCF\u6570\u636E\u5BFC\u51FA\u7684\u4E0D\u5B8C\u6574","\u4FEE\u590Ddocker\u975E\u672C\u5730\u5B58\u50A8\u7BA1\u7406\u5458\u914D\u7F6E\u7684\u8BFB\u53D6\u4FEE\u6539"]},{version:"3.4.2",date:"2025-10-21",added:["\u6DFB\u52A0\u6570\u636E\u8FC1\u79FB\u529F\u80FD","\u52A0\u5165\u5361\u7247\u53F3\u952E\u957F\u6309\u9009\u9879\u5361"],changed:["\u8C03\u6574\u9009\u9879\u5361\u6536\u85CF\u6309\u94AE\u663E\u793A\u903B\u8F91","\u5FAE\u8C03UI\u53CA\u6536\u85CF\u6309\u94AE\u663E\u793A\u903B\u8F91","\u4F18\u5316\u79FB\u52A8\u7AEF\u5361\u7247\u957F\u6309\u590D\u5236\u95EE\u9898","\u5FAE\u8C03\u64AD\u653E\u9875\u9762UI","\u7B80\u5316\u8C03\u6574\u64AD\u653E\u9875\u9762","\u8C03\u6574\u5206\u7EC4\u914D\u7F6E\u5F39\u7A97UI","\u5FAE\u8C03\u89C6\u9891\u6E90\u914D\u7F6EUI"],fixed:["\u4FEE\u590DCF\u6570\u636E\u8FC1\u5165\u95EE\u9898","\u4FEE\u590D\u672C\u5730\u5B58\u50A8\u641C\u7D22","\u4FEE\u590D\u672C\u5730\u5B58\u50A8TVBox\u63A5\u53E3"]},{version:"3.3.0",date:"2025-10-16",added:["\u7528\u6237\u7EC4\u5206\u914D\u89C6\u9891\u6E90\u529F\u80FD","\u89C6\u9891\u6E90\u914D\u7F6E\u652F\u6301\u6279\u91CF\u64CD\u4F5C","\u6DFB\u52A0\u52A0\u8F7D\u52A8\u753B"],changed:["\u975E\u672C\u5730\u5B58\u50A8\u9ED8\u8BA4\u5173\u95EDTVBox","\u7B80\u5316\u660E\u6697\u6A21\u5F0F\u53D8\u5316","\u4F18\u5316 docker \u6784\u5EFA\u6D41\u7A0B"],fixed:["\u975E\u672C\u5730\u6A21\u5F0F\u89C6\u9891\u6E90\u914D\u7F6E\u521D\u59CB\u5316"]},{version:"3.2.0",date:"2025-10-04",added:["\u6DFB\u52A0Docker\u955C\u50CF\u81EA\u52A8\u6784\u5EFA\u5DE5\u4F5C\u6D41","\u641C\u7D22\u5EFA\u8BAE\u6DFB\u52A0\u5F00\u5173\u63A7\u5236"],changed:["\u4F18\u5316\u641C\u7D22\u8BBE\u7F6EUI\u5E03\u5C40","\u8C03\u6574\u641C\u7D22\u5EFA\u8BAE\u6392\u5E8F\u903B\u8F91","\u4F18\u5316\u641C\u7D22\u53C2\u6570\u8BBE\u7F6E\u903B\u8F91","\u8C03\u6574\u5E76\u7B80\u5316\u64AD\u653E\u9875\u9762UI","\u8C03\u6574\u79FB\u52A8\u7AEF\u64AD\u653E\u9875\u9762UI","\u5FAE\u8C03\u7AD9\u70B9\u914D\u7F6EUI","\u5FAE\u8C03TVBox\u914D\u7F6EUI"],fixed:[]},{version:"3.1.0",date:"2025-10-02",added:[],changed:["TVBox\u7684\u8BBE\u7F6E\u6539\u4E3A\u5728\u7BA1\u7406\u9762\u677F\u4E2D\uFF0C\u539F\u4F4D\u7F6E\u663E\u793A\u72B6\u6001\u53CA\u5176\u94FE\u63A5","\u4FEE\u6539\u684C\u9762\u7AEF\u5BFC\u822A\u680F\u5E03\u5C40\u4E3A\u9876\u680F","\u684C\u9762\u641C\u7D22\u9875\u6539\u4E3A\u9876\u680F\u641C\u7D22\u6846"],fixed:["\u5361\u7247\u663E\u793A\u8BE6\u60C5\u94FE\u63A5\u8DF3\u8F6C"]},{version:"3.0.0",date:"2025-09-30",added:["\u6DFB\u52A0TVBox\u914D\u7F6E\u63A5\u53E3","\u6DFB\u52A0\u5BF9Selene\u7684\u517C\u5BB9"],changed:[],fixed:["\u4FEE\u590D\u9996\u9875\u52A8\u6F2B\u63A5\u53E3\u5F15\u8D77\u7684\u5D29\u6E83","\u4FEE\u590Ddocker\u64AD\u653E\u5237\u65B0\u5D29\u6E83\u95EE\u9898"]},{version:"2.9.1",date:"2025-09-19",added:[],changed:["\u641C\u7D22\u680F\u5DE6\u4FA7\u6E90\u914D\u7F6E\u83B7\u53D6\u91C7\u7528\u7F13\u5B58","\u4F18\u5316\u641C\u7D22\u7ED3\u679C\u7684\u7B5B\u9009\u7EC4\u4EF6UI","\u641C\u7D22\u7ED3\u679C\u533A\u5206\u4E3A\u5305\u542B\u4E0E\u4E0D\u5305\u542B\u641C\u7D22\u8BCD\u7684\u7ED3\u679C","\u5220\u9664\u64AD\u653E\u5B58\u50A8\u65E0\u7528\u7F13\u5B58\u7684\u903B\u8F91","\u5F00\u653E\u5206\u7C7B\u914D\u7F6E\u4E2D\u7684\u6DFB\u52A0\u5206\u7C7B"],fixed:["\u7F13\u5B58\u5931\u6548\u65F6\u64AD\u653E\u52A0\u8F7D\u6E90\u4E0D\u4E00\u81F4","\u4FEE\u590Dd1\u6570\u636E\u5E93\u7BA1\u7406\u914D\u7F6E\u4FDD\u5B58\u62A5\u9519"]},{version:"2.8.4",date:"2025-09-14",added:["\u6DFB\u52A0\u641C\u7D22\u7ED3\u679C\u7684\u6392\u5E8F\u9009\u62E9"],changed:["\u4F18\u5316\u641C\u7D22\u903B\u8F91"],fixed:["\u4FEE\u590D\u5BF9OrionTV\u7684\u517C\u5BB9","\u4FEE\u590Dd1\u6570\u636E\u5E93\u7EE7\u7EED\u89C2\u770B\u65E0\u6CD5\u6536\u85CF"]},{version:"2.8.0",date:"2025-09-09",added:["\u6DFB\u52A0cf\u90E8\u7F72","\u6DFB\u52A0d1\u652F\u6301"],changed:[],fixed:[]},{version:"2.7.6",date:"2025-09-04",added:[],changed:["\u8C03\u6574\u641C\u7D22\u8D85\u65F6\u65F6\u95F4\u53EF\u9009\u8303\u56F4\uFF0C\u53CA\u9ED8\u8BA4\u503C","\u6DFB\u52A0docker\u90E8\u7F72\u652F\u6301"],fixed:["\u4FEE\u590D\u64AD\u653E\u4E2D\u641C\u7D22\u8D85\u65F6\u65F6\u95F4\u4E0D\u751F\u6548"]},{version:"2.7.4",date:"2025-08-31",added:[],changed:["\u53EF\u81EA\u5B9A\u4E49\u641C\u7D22\u8D85\u65F6\u65F6\u95F4","\u64AD\u653E\u65F6\u7684\u641C\u7D22\u64AD\u653E\u6E90\u8D85\u65F6\u65F6\u95F4\u540C\u4E0A","\u7EC6\u5316\u5931\u8D25\u6E90\u539F\u56E0\u7684\u5C55\u793A"],fixed:["\u4FEE\u590D\u64AD\u653E\u641C\u7D22\u65E0\u7ED3\u679C\u4E5F\u7F13\u5B58\u5728localstorage"]},{version:"2.7.0",date:"2025-08-30",added:["\u641C\u7D22\u6DFB\u52A0\u5BF9\u6E90\u7684\u9009\u62E9\u529F\u80FD"],changed:["\u4F18\u5316\u7B5B\u9009","\u7B80\u6D01\u6A21\u5F0F\u8DF3\u8FC7\u8C46\u74E3\u6570\u636E\u52A0\u8F7D"],fixed:[]},{version:"2.6.4",date:"2025-08-30",added:[],changed:["\u4F18\u5316\u641C\u7D22:\u8C03\u6574\u8D85\u65F6\u65F6\u95F4(\u83B7\u53D6\u9996\u9875\u8D85\u65F6\u65F6\u95F4\u8FC7\u957F)"],fixed:["\u4FEE\u590D\u64AD\u653E\u7F13\u5B58key\u4E0D\u552F\u4E00","\u4FEE\u590D\u805A\u5408\u7ED3\u679C\u4E0D\u51C6\u786E"]},{version:"2.6.1",date:"2025-08-29",added:["\u6DFB\u52A0\u7B80\u6D01\u6A21\u5F0F"],changed:[],fixed:[]},{version:"2.5.1",date:"2025-08-28",added:[],changed:["\u4F18\u5316\u6536\u85CF\u72B6\u6001\u68C0\u6D4B,\u51CF\u5C11\u6570\u636E\u5E93\u8BF7\u6C42","\u4F18\u5316\u641C\u7D22\u7B5B\u9009\u5C55\u793A\u903B\u8F91","\u8FB9\u7F18\u70B9\u51FB\u4E0D\u89E6\u53D1\u64AD\u653E"],fixed:["\u4FEE\u590D\u52A8\u6F2B\u756A\u5267\u8BE6\u60C5\u9875\u9762\u8DF3\u8F6C"]},{version:"2.4.7",date:"2025-08-26",added:["\u641C\u7D22\u7ED3\u679C\u6DFB\u52A0\u7B5B\u9009\u529F\u80FD"],changed:[],fixed:["\u4E3B\u9875\u5C55\u793A\u8BC4\u5206","\u641C\u7D22\u7ED3\u679C\u5C55\u793A\u5E74\u4EFD"]},{version:"2.4.0",date:"2025-08-25",added:[],changed:["\u7AD9\u70B9\u914D\u7F6E\u53EF\u76F4\u63A5\u4FEE\u6539","\u8FDB\u4E00\u6B65\u4F18\u5316\u641C\u7D22\u901F\u5EA6"],fixed:["\u4FEE\u590D\u641C\u7D22\u7ED3\u679C\u53EA\u80FD\u6253\u5F00\u540C\u4E00\u4E2A"]},{version:"2.3.6",date:"2025-08-24",added:[],changed:["\u4F18\u5316\u64AD\u653E\u4F18\u9009\u6362\u6E90"],fixed:["\u4FEE\u590D\u64AD\u653E\u89C6\u9891\u6E90\u7F13\u5B58"]},{version:"2.3.4",date:"2025-08-24",added:[],changed:[],fixed:["\u4FEE\u590D\u7BA1\u7406\u529F\u80FD\u4E0D\u751F\u6548","\u4FEE\u590Dnetlify\u65E0\u6CD5\u90E8\u7F72","\u4FEE\u590D\u975E\u672C\u5730\u6570\u636E\u5E93\u521D\u59CB\u5316"]},{version:"2.3.1",date:"2025-08-23",added:[],changed:[],fixed:["\u4FEE\u590D\u914D\u7F6E\u6587\u4EF6\u4E0D\u751F\u6548","\u4FEE\u590D\u65E0config.json\u6587\u4EF6\u62A5\u9519","\u4FEE\u590D\u5931\u8D25\u6E90\u4E0D\u51C6\u786E"]},{version:"2.2.8",date:"2025-08-22",added:[],changed:["\u8F6C\u79FB\u89C6\u9891\u6E90\u4F18\u9009\u6309\u94AE\u81F3\u64AD\u653E\u9875\u9762"],fixed:["\u4F18\u5316\u64AD\u653E\u6362\u6E90","\u4F18\u5316\u5931\u8D25\u6E90\u663E\u793A\u903B\u8F91","\u4FEE\u590D\u641C\u7D22\u8DEF\u7531\u95EE\u9898"]},{version:"2.2.1",date:"2025-08-22",added:["\u641C\u7D22\u7ED3\u679C\u5C55\u793A\u5931\u8D25\u6E90"],changed:["\u79FB\u9664\u65E0\u6548\u4EE3\u7406Cors Anywhere"],fixed:["\u4FEE\u590D\u4E00\u6B21\u641C\u7D22\u4E24\u4E2A\u8BF7\u6C42\u7684\u95EE\u9898"]},{version:"2.1.0",date:"2025-08-21",added:["\u652F\u6301\u6D41\u5F0F\u641C\u7D22\u641C\u7D22\u6A21\u5F0F","\u641C\u7D22\u7ED3\u679C\u5C55\u793A\u89C6\u9891\u6E90"],changed:["\u91CD\u65B0\u652F\u6301localstorage","\u72EC\u7ACB\u7F13\u5B58\u64AD\u653E\u6E90"],fixed:["\u4FEE\u590D\u89C6\u9891\u64AD\u653E\u7F13\u5B58\u903B\u8F91\u95EE\u9898"]},{version:"2.0.1",date:"2025-08-13",added:[],changed:["\u7248\u672C\u68C0\u67E5\u548C\u53D8\u66F4\u65E5\u5FD7\u8BF7\u6C42 Github"],fixed:["\u5FAE\u8C03\u7BA1\u7406\u9762\u677F\u6837\u5F0F"]},{version:"2.0.0",date:"2025-08-13",added:["\u652F\u6301\u914D\u7F6E\u6587\u4EF6\u5728\u7EBF\u914D\u7F6E\u548C\u7F16\u8F91","\u641C\u7D22\u9875\u641C\u7D22\u6846\u5B9E\u65F6\u8054\u60F3","\u53BB\u9664\u5BF9 localstorage \u6A21\u5F0F\u7684\u652F\u6301"],changed:["\u64AD\u653E\u8BB0\u5F55\u5220\u9664\u6309\u94AE\u6539\u4E3A\u5783\u573E\u6876\u56FE\u6807\u4EE5\u6D88\u9664\u6B67\u4E49"],fixed:["\u9650\u5236\u8BBE\u7F6E\u9762\u677F\u7684\u6700\u5927\u957F\u5EA6\uFF0C\u9632\u6B62\u8D85\u51FA\u89C6\u53E3"]},{version:"1.1.1",date:"2025-08-12",added:[],changed:["\u4FEE\u6B63 zwei \u63D0\u4F9B\u7684 cors proxy \u5730\u5740","\u79FB\u9664\u5E9F\u5F03\u4EE3\u7801"],fixed:["[\u8FD0\u7EF4] docker workflow release \u65E5\u671F\u4F7F\u7528\u4E1C\u516B\u533A\u65E5\u671F"]},{version:"1.1.0",date:"2025-08-12",added:["\u6BCF\u65E5\u65B0\u756A\u653E\u9001\u529F\u80FD\uFF0C\u5C55\u793A\u6BCF\u65E5\u65B0\u756A\u653E\u9001\u7684\u756A\u5267"],changed:[],fixed:["\u4FEE\u590D\u8FDC\u7A0B CHANGELOG \u65E0\u6CD5\u63D0\u53D6\u53D8\u66F4\u5185\u5BB9\u7684\u95EE\u9898"]},{version:"1.0.5",date:"2025-08-12",added:[],changed:["\u5B9E\u73B0\u57FA\u4E8E Git \u6807\u7B7E\u7684\u81EA\u52A8 Release \u5DE5\u4F5C\u6D41"],fixed:[]},{version:"1.0.4",date:"2025-08-11",added:["\u4F18\u5316\u7248\u672C\u7BA1\u7406\u5DE5\u4F5C\u6D41\uFF0C\u5B9E\u73B0\u5355\u70B9\u4FEE\u6539"],changed:["\u7248\u672C\u53F7\u73B0\u5728\u4ECE CHANGELOG \u81EA\u52A8\u63D0\u53D6\uFF0C\u65E0\u9700\u624B\u52A8\u7EF4\u62A4 VERSION.txt"],fixed:[]},{version:"1.0.3",date:"2025-08-11",added:[],changed:["\u5347\u7EA7\u64AD\u653E\u5668 Artplayer \u81F3\u7248\u672C 5.2.5"],fixed:[]},{version:"1.0.2",date:"2025-08-11",added:[],changed:["\u7248\u672C\u53F7\u6BD4\u8F83\u673A\u5236\u6062\u590D\u4E3A\u6570\u5B57\u6BD4\u8F83\uFF0C\u4EC5\u5F53\u6700\u65B0\u7248\u672C\u5927\u4E8E\u672C\u5730\u7248\u672C\u65F6\u624D\u8BA4\u4E3A\u6709\u66F4\u65B0","[\u8FD0\u7EF4] \u81EA\u52A8\u66FF\u6362 version.ts \u4E2D\u7684\u7248\u672C\u53F7\u4E3A VERSION.txt \u4E2D\u7684\u7248\u672C\u53F7"],fixed:[]},{version:"1.0.1",date:"2025-08-11",added:[],changed:[],fixed:["\u4FEE\u590D\u7248\u672C\u68C0\u67E5\u529F\u80FD\uFF0C\u53EA\u8981\u4E0E\u6700\u65B0\u7248\u672C\u53F7\u4E0D\u4E00\u81F4\u5373\u8BA4\u4E3A\u6709\u66F4\u65B0"]},{version:"1.0.0",date:"2025-08-10",added:["\u57FA\u4E8E Semantic Versioning \u7684\u7248\u672C\u53F7\u673A\u5236","\u7248\u672C\u4FE1\u606F\u9762\u677F\uFF0C\u5C55\u793A\u672C\u5730\u53D8\u66F4\u65E5\u5FD7\u548C\u8FDC\u7A0B\u66F4\u65B0\u65E5\u5FD7"],changed:[],fixed:[]}],Z=({isOpen:be,onClose:De})=>{let[Xe,tt]=(0,k.useState)(!1),[Ct,ct]=(0,k.useState)([]),[Tt,Dt]=(0,k.useState)(!1),[mt,cr]=(0,k.useState)(""),[kr,Ht]=(0,k.useState)(!1);(0,k.useEffect)(()=>(tt(!0),()=>tt(!1)),[]),(0,k.useEffect)(()=>{be&&Or()},[be]);let Or=async()=>{try{let At=await fetch("https://raw.githubusercontent.com/Stardm0/MoonTV/main/CHANGELOG");if(At.ok){let Pr=await At.text(),hr=fr(Pr);if(ct(hr),hr.length>0){let gr=hr[0];cr(gr.version),Dt((0,ae.n4)(gr.version)===ae.qu.HAS_UPDATE)}}else console.error("\u83B7\u53D6\u8FDC\u7A0B\u53D8\u66F4\u65E5\u5FD7\u5931\u8D25:",At.status,At.statusText)}catch(At){console.error("\u83B7\u53D6\u8FDC\u7A0B\u53D8\u66F4\u65E5\u5FD7\u5931\u8D25:",At)}},fr=At=>{let Pr=At.split(`
`),hr=[],gr=null,Jt=null,Ir=!1;for(let ea of Pr){let ki=ea.trim(),na=ki.match(/^## \[([\d.]+)\] - (\d{4}-\d{2}-\d{2})$/);if(na){gr&&hr.push(gr),gr={version:na[1],date:na[2],added:[],changed:[],fixed:[]},Jt=null,Ir=!0;continue}if(Ir&&gr){if(ki==="### Added"){Jt="added";continue}if(ki==="### Changed"){Jt="changed";continue}if(ki==="### Fixed"){Jt="fixed";continue}if(ki.startsWith("- ")&&Jt){let Kr=ki.substring(2);Jt==="added"?gr.added.push(Kr):Jt==="changed"?gr.changed.push(Kr):Jt==="fixed"&&gr.fixed.push(Kr)}}}return gr&&hr.push(gr),hr},Oi=(At,Pr=!1,hr=!1)=>{let gr=hr&&Tt&&At.version===mt;return(0,s.jsxs)("div",{className:`p-4 rounded-lg border ${Pr?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":gr?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-gray-50 dark:bg-gray-800/60 border-gray-200 dark:border-gray-700"}`,children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["v",At.version]}),Pr&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300 rounded-full",children:"\u5F53\u524D\u7248\u672C"}),gr&&(0,s.jsxs)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:[(0,s.jsx)(R.Z,{className:"w-3 h-3"}),"\u53EF\u66F4\u65B0"]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:At.date})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[At.added.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-green-700 dark:text-green-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(K.Z,{className:"w-4 h-4"}),"\u65B0\u589E\u529F\u80FD"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.added.map((Jt,Ir)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-green-500 rounded-full mt-2 flex-shrink-0"}),Jt]},Ir))})]}),At.changed.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-blue-700 dark:text-blue-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(ve.Z,{className:"w-4 h-4"}),"\u529F\u80FD\u6539\u8FDB"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.changed.map((Jt,Ir)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),Jt]},Ir))})]}),At.fixed.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(ke.Z,{className:"w-4 h-4"}),"\u95EE\u9898\u4FEE\u590D"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.fixed.map((Jt,Ir)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),Jt]},Ir))})]})]})]},At.version)},li=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:De}),(0,s.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-xl max-h-[90vh] bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-6 border-b border-gray-200 dark:border-gray-700",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,s.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-gray-800 dark:text-gray-200",children:"\u7248\u672C\u4FE1\u606F"}),(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-1 sm:gap-2",children:[(0,s.jsxs)("span",{className:"px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300 rounded-full",children:["v",ae.we]}),Tt&&(0,s.jsxs)("span",{className:"px-2 sm:px-3 py-1 text-xs sm:text-sm font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:[(0,s.jsx)(R.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:"\u6709\u65B0\u7248\u672C\u53EF\u7528"}),(0,s.jsx)("span",{className:"sm:hidden",children:"\u53EF\u66F4\u65B0"})]})]})]}),(0,s.jsx)("button",{onClick:De,className:"w-6 h-6 sm:w-8 sm:h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"\u5173\u95ED",children:(0,s.jsx)(j.Z,{className:"w-full h-full"})})]}),(0,s.jsx)("div",{className:"p-3 sm:p-6 overflow-y-auto max-h-[calc(95vh-140px)] sm:max-h-[calc(90vh-120px)]",children:(0,s.jsxs)("div",{className:"space-y-3 sm:space-y-6",children:[Tt&&(0,s.jsx)("div",{className:"bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-3 sm:p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-yellow-100 dark:bg-yellow-800/40 rounded-full flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(R.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-yellow-600 dark:text-yellow-400"})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-yellow-800 dark:text-yellow-200",children:"\u53D1\u73B0\u65B0\u7248\u672C"}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-yellow-700 dark:text-yellow-300 break-all",children:["v",ae.we," \u2192 v",mt]})]})]}),(0,s.jsxs)("a",{href:"https://github.com/Stardm0/MoonTV",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-3 py-2 bg-yellow-600 hover:bg-yellow-700 text-white text-xs sm:text-sm rounded-lg transition-colors shadow-sm w-full",children:[(0,s.jsx)(R.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"\u524D\u5F80\u4ED3\u5E93"]})]})}),!Tt&&(0,s.jsx)("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3 sm:p-4",children:(0,s.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 sm:w-10 sm:h-10 bg-green-100 dark:bg-green-800/40 rounded-full flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(fe.Z,{className:"w-4 h-4 sm:w-5 sm:h-5 text-green-600 dark:text-green-400"})}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-green-800 dark:text-green-200",children:"\u5F53\u524D\u4E3A\u6700\u65B0\u7248\u672C"}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-green-700 dark:text-green-300 break-all",children:["\u5DF2\u662F\u6700\u65B0\u7248\u672C v",ae.we]})]})]}),(0,s.jsxs)("a",{href:"https://github.com/Stardm0/MoonTV",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center justify-center gap-2 px-3 py-2 bg-green-600 hover:bg-green-700 text-white text-xs sm:text-sm rounded-lg transition-colors shadow-sm w-full",children:[(0,s.jsx)(fe.Z,{className:"w-3 h-3 sm:w-4 sm:h-4"}),"\u524D\u5F80\u4ED3\u5E93"]})]})}),Tt&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 flex items-center gap-2",children:[(0,s.jsx)(R.Z,{className:"w-5 h-5 text-yellow-500"}),"\u8FDC\u7A0B\u66F4\u65B0\u5185\u5BB9"]}),(0,s.jsx)("button",{onClick:()=>Ht(!kr),className:"inline-flex items-center justify-center gap-2 px-3 py-1.5 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 dark:bg-yellow-800/30 dark:hover:bg-yellow-800/50 dark:text-yellow-200 rounded-lg transition-colors text-sm w-full sm:w-auto",children:kr?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ae.Z,{className:"w-4 h-4"}),"\u6536\u8D77"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.Z,{className:"w-4 h-4"}),"\u67E5\u770B\u66F4\u65B0\u5185\u5BB9"]})})]}),kr&&Ct.length>0&&(0,s.jsx)("div",{className:"space-y-4",children:Ct.filter(At=>!_e.map(Pr=>Pr.version).includes(At.version)).map((At,Pr)=>(0,s.jsxs)("div",{className:`p-4 rounded-lg border ${At.version===mt?"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800":"bg-gray-50 dark:bg-gray-800/60 border-gray-200 dark:border-gray-700"}`,children:[(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 mb-3",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,s.jsxs)("h4",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:["v",At.version]}),At.version===mt&&(0,s.jsx)("span",{className:"px-2 py-1 text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300 rounded-full flex items-center gap-1",children:"\u8FDC\u7A0B\u6700\u65B0"})]}),(0,s.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400",children:At.date})]}),At.added&&At.added.length>0&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-green-600 dark:text-green-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(K.Z,{className:"w-4 h-4"}),"\u65B0\u589E\u529F\u80FD"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.added.map((hr,gr)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mt-2 flex-shrink-0"}),hr]},gr))})]}),At.changed&&At.changed.length>0&&(0,s.jsxs)("div",{className:"mb-3",children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(ve.Z,{className:"w-4 h-4"}),"\u529F\u80FD\u6539\u8FDB"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.changed.map((hr,gr)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),hr]},gr))})]}),At.fixed&&At.fixed.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("h5",{className:"text-sm font-medium text-purple-700 dark:text-purple-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(ke.Z,{className:"w-4 h-4"}),"\u95EE\u9898\u4FEE\u590D"]}),(0,s.jsx)("ul",{className:"space-y-1",children:At.fixed.map((hr,gr)=>(0,s.jsxs)("li",{className:"text-sm text-gray-700 dark:text-gray-300 flex items-start gap-2",children:[(0,s.jsx)("span",{className:"w-1.5 h-1.5 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),hr]},gr))})]})]},Pr))})]}),(0,s.jsxs)("div",{className:"border-b border-gray-200 dark:border-gray-700 pb-4",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 pb-3 sm:pb-4",children:"\u53D8\u66F4\u65E5\u5FD7"}),(0,s.jsx)("div",{className:"space-y-4",children:_e.map(At=>Oi(At,At.version===ae.we,!1))})]})]})})]})]});return Xe&&be?(0,X.createPortal)(li,document.body):null},ne=()=>{let be=(0,x.tv)(),De=(0,x.jD)(),{startLoading:Xe}=(0,I.w)(),[tt,Ct]=(0,k.useState)(!1),[ct,Tt]=(0,k.useState)(!1),[Dt,mt]=(0,k.useState)(!1),[cr,kr]=(0,k.useState)(!1),[Ht,Or]=(0,k.useState)(null),[fr,Oi]=(0,k.useState)("localstorage"),[li,At]=(0,k.useState)(!1),[Pr,hr]=(0,k.useState)(!0),[gr,Jt]=(0,k.useState)(!0),[Ir,ea]=(0,k.useState)(!1),[ki,na]=(0,k.useState)(""),[Kr,Ni]=(0,k.useState)("direct"),[mr,Er]=(0,k.useState)("direct"),[Dr,Ar]=(0,k.useState)(""),[Br,ba]=(0,k.useState)(!1),[Wr,pi]=(0,k.useState)(!1),[Ba,Xt]=(0,k.useState)(!1),[ti,Pa]=(0,k.useState)(()=>3),[$t,Qt]=(0,k.useState)(!1),[Mi,Fi]=(0,k.useState)("bilibili1"),[ji,_i]=(0,k.useState)(!1),ai=[{value:"qiyi",label:"qiyi\uFF08\u7231\u5947\u827A\uFF09"},{value:"bilibili1",label:"bilibili1\uFF08\u54D4\u54E9\u54D4\u54E9\uFF09"},{value:"imgo",label:"imgo\uFF08\u8292\u679C\uFF09"},{value:"youku",label:"youku\uFF08\u4F18\u9177\uFF09"},{value:"qq",label:"qq\uFF08\u817E\u8BAF\uFF09"},{value:"renren",label:"renren\uFF08\u4EBA\u4EBA\uFF09"},{value:"hanjutv",label:"hanjutv\uFF08\u97E9\u5267TV\uFF09"},{value:"bahamut",label:"bahamut\uFF08\u5DF4\u54C8\u59C6\u7279\uFF09"},{value:"dandan",label:"dandan\uFF08\u5F39\u5F39\uFF09"}],di=[{value:"direct",label:"\u76F4\u8FDE\uFF08\u670D\u52A1\u5668\u76F4\u63A5\u8BF7\u6C42\u8C46\u74E3\uFF09"},{value:"cors-proxy-zwei",label:"Cors Proxy By Zwei"},{value:"cmliussss-cdn-tencent",label:"\u8C46\u74E3 CDN By CMLiussss\uFF08\u817E\u8BAF\u4E91\uFF09"},{value:"cmliussss-cdn-ali",label:"\u8C46\u74E3 CDN By CMLiussss\uFF08\u963F\u91CC\u4E91\uFF09"},{value:"custom",label:"\u81EA\u5B9A\u4E49\u4EE3\u7406"}],gi=[{value:"direct",label:"\u76F4\u8FDE\uFF08\u6D4F\u89C8\u5668\u76F4\u63A5\u8BF7\u6C42\u8C46\u74E3\uFF09"},{value:"server",label:"\u670D\u52A1\u5668\u4EE3\u7406\uFF08\u7531\u670D\u52A1\u5668\u4EE3\u7406\u8BF7\u6C42\u8C46\u74E3\uFF09"},{value:"img3",label:"\u8C46\u74E3\u7CBE\u54C1 CDN\uFF08\u963F\u91CC\u4E91\uFF09"},{value:"cmliussss-cdn-tencent",label:"\u8C46\u74E3 CDN By CMLiussss\uFF08\u817E\u8BAF\u4E91\uFF09"},{value:"cmliussss-cdn-ali",label:"\u8C46\u74E3 CDN By CMLiussss\uFF08\u963F\u91CC\u4E91\uFF09"},{value:"custom",label:"\u81EA\u5B9A\u4E49\u4EE3\u7406"}],[hi,Ri]=(0,k.useState)(""),[fi,Ai]=(0,k.useState)(""),[Bi,mi]=(0,k.useState)(!1),[zr,Gi]=(0,k.useState)(""),[Yr,yi]=(0,k.useState)(null),[Na,Fa]=(0,k.useState)(!0),[Xr,Hi]=(0,k.useState)(!1),[ln,dn]=(0,k.useState)(""),[un,tn]=(0,k.useState)(""),ss=Ht?.role==="owner"||Ht?.role==="admin",Wn=async()=>{try{let Ze=await fetch("/api/admin/tvbox",{cache:"no-store"});if(!Ze.ok)return;let Kt=await Ze.json();Hi(!!Kt.enabled),dn(Kt.password||""),tn(Kt.url||"")}catch(Ze){console.warn("Failed to load TVBox admin config:",Ze)}};(0,k.useEffect)(()=>{ct&&Wn()},[ct]),(0,k.useEffect)(()=>{At(!0)},[]),(0,k.useEffect)(()=>{},[]),(0,k.useEffect)(()=>{},[]),(0,k.useEffect)(()=>{(async()=>{try{let Ze=await(0,ae.Df)();yi(Ze)}catch(Ze){console.warn("\u7248\u672C\u68C0\u67E5\u5931\u8D25:",Ze)}finally{Fa(!1)}})()},[]),(0,k.useEffect)(()=>{let Ze=Kt=>{Br&&!Kt.target.closest('[data-dropdown="douban-datasource"]')&&ba(!1)};if(Br)return document.addEventListener("mousedown",Ze),()=>document.removeEventListener("mousedown",Ze)},[Br]),(0,k.useEffect)(()=>{let Ze=Kt=>{Wr&&!Kt.target.closest('[data-dropdown="douban-image-proxy"]')&&pi(!1)};if(Wr)return document.addEventListener("mousedown",Ze),()=>document.removeEventListener("mousedown",Ze)},[Wr]);let zn=()=>{Ct(!1)},vn=async()=>{try{await fetch("/api/logout",{method:"POST",headers:{"Content-Type":"application/json"}})}catch(Ze){console.error("\u6CE8\u9500\u8BF7\u6C42\u5931\u8D25:",Ze)}window.location.href="/"},In=()=>{mt(!1),Ri(""),Ai(""),Gi("")},$n=async()=>{if(Gi(""),!hi){Gi("\u65B0\u5BC6\u7801\u4E0D\u5F97\u4E3A\u7A7A");return}if(hi!==fi){Gi("\u4E24\u6B21\u8F93\u5165\u7684\u5BC6\u7801\u4E0D\u4E00\u81F4");return}mi(!0);try{let Ze=await fetch("/api/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newPassword:hi})}),Kt=await Ze.json();if(!Ze.ok){Gi(Kt.error||"\u4FEE\u6539\u5BC6\u7801\u5931\u8D25");return}mt(!1),await vn()}catch{Gi("\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u7A0D\u540E\u91CD\u8BD5")}finally{mi(!1)}},Ln=()=>{Tt(!1)},Aa=Ze=>{Xt(Ze),localStorage.setItem("autoDanmakuEnabled",JSON.stringify(Ze))},Yn=Ze=>{Ze<-1||(Pa(Ze),localStorage.setItem("danmakuRetryCount",Ze.toString()))},jn=Ze=>{Qt(Ze),localStorage.setItem("enablePreferBestSource",JSON.stringify(Ze))},lt=Ze=>{Fi(Ze),localStorage.setItem("preferredDanmakuPlatform",Ze)},B=Ze=>{hr(Ze)},le=Ze=>{Jt(Ze)},pe=Ze=>{ea(Ze),Tt(!1),setTimeout(()=>{window.location.reload()},100)},Re=Ze=>{na(Ze)},Pe=Ze=>{Ni(Ze)},it=Ze=>{Er(Ze)},yt=Ze=>{Ar(Ze)},St=Ze=>{switch(Ze){case"cors-proxy-zwei":return{text:"Thanks to @Zwei",url:"https://github.com/bestzwei"};case"cmliussss-cdn-tencent":case"cmliussss-cdn-ali":return{text:"Thanks to @CMLiussss",url:"https://github.com/cmliu"};default:return null}},It=Ht?.role==="owner"||Ht?.role==="admin",er=Ht?.role!=="owner"&&fr!=="localstorage",qr=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-transparent z-[1000]",onClick:zn}),(0,s.jsxs)("div",{className:"fixed top-14 right-4 w-56 bg-white dark:bg-gray-900 rounded-lg shadow-xl z-[1001] border border-gray-200/50 dark:border-gray-700/50 overflow-hidden select-none",children:[(0,s.jsx)("div",{className:"px-3 py-2.5 border-b border-gray-200 dark:border-gray-700 bg-gradient-to-r from-gray-50 to-gray-100/50 dark:from-gray-800 dark:to-gray-800/50",children:(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",children:"\u5F53\u524D\u7528\u6237"}),(0,s.jsx)("span",{className:`inline-flex items-center px-1.5 py-0.5 rounded-full text-xs font-medium ${(Ht?.role||"user")==="owner"?"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300":(Ht?.role||"user")==="admin"?"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300":"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300"}`,children:(Ze=>{switch(Ze){case"owner":return"\u7AD9\u957F";case"admin":return"\u7BA1\u7406\u5458";case"user":return"\u7528\u6237";default:return""}})(Ht?.role||"user")})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"font-semibold text-gray-900 dark:text-gray-100 text-sm truncate",children:Ht?.username||"default"}),(0,s.jsxs)("div",{className:"text-[10px] text-gray-400 dark:text-gray-500",children:["\u6570\u636E\u5B58\u50A8\uFF1A",fr==="localstorage"?"\u672C\u5730":fr]})]})]})}),(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsxs)("button",{onClick:()=>{Ct(!1),Tt(!0)},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,s.jsx)(Y.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,s.jsx)("span",{className:"font-medium",children:"\u8BBE\u7F6E"})]}),It&&(0,s.jsxs)("button",{onClick:()=>{if(De==="/admin"){Ct(!1);return}Xe(),be.push("/admin")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,s.jsx)(q.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,s.jsx)("span",{className:"font-medium",children:"\u7BA1\u7406\u9762\u677F"})]}),er&&(0,s.jsxs)("button",{onClick:()=>{Ct(!1),mt(!0),Ri(""),Ai(""),Gi("")},className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-sm",children:[(0,s.jsx)(se.Z,{className:"w-4 h-4 text-gray-500 dark:text-gray-400"}),(0,s.jsx)("span",{className:"font-medium",children:"\u4FEE\u6539\u5BC6\u7801"})]}),(0,s.jsx)("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),(0,s.jsxs)("button",{onClick:vn,className:"w-full px-3 py-2 text-left flex items-center gap-2.5 text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors text-sm",children:[(0,s.jsx)(J.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"font-medium",children:"\u767B\u51FA"})]}),(0,s.jsx)("div",{className:"my-1 border-t border-gray-200 dark:border-gray-700"}),(0,s.jsx)("button",{onClick:()=>{kr(!0),zn()},className:"w-full px-3 py-2 text-center flex items-center justify-center text-gray-500 dark:text-gray-400 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors text-xs",children:(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)("span",{className:"font-mono",children:["v",ae.we]}),!Na&&Yr&&Yr!==ae.qu.FETCH_FAILED&&(0,s.jsx)("div",{className:`w-2 h-2 rounded-full -translate-y-2 ${Yr===ae.qu.HAS_UPDATE?"bg-yellow-500":Yr===ae.qu.NO_UPDATE?"bg-green-400":""}`})]})})]})]})]}),Zr=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:Ln}),(0,s.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-xl max-h-[90vh] bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6 overflow-y-auto",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"\u672C\u5730\u8BBE\u7F6E"}),(0,s.jsx)("button",{onClick:()=>{let Ze=window.RUNTIME_CONFIG?.DOUBAN_PROXY_TYPE||"direct",Kt=window.RUNTIME_CONFIG?.DOUBAN_PROXY||"",Gr=window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY_TYPE||"direct",bi=window.RUNTIME_CONFIG?.DOUBAN_IMAGE_PROXY||"";hr(!0),Jt(!0),ea(!1),na(Kt),Ni(Ze),Er(Gr),Ar(bi),Qt(!1),Xt(!1),Fi("bilibili1"),Pa(3)},className:"px-2 py-1 text-xs text-red-500 hover:text-red-700 dark:text-red-400 dark:hover:text-red-300 border border-red-200 hover:border-red-300 dark:border-red-800 dark:hover:border-red-700 hover:bg-red-50 dark:hover:bg-red-900/20 rounded transition-colors",title:"\u91CD\u7F6E\u4E3A\u9ED8\u8BA4\u8BBE\u7F6E",children:"\u91CD\u7F6E"})]}),(0,s.jsx)("button",{onClick:Ln,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:(0,s.jsx)(j.Z,{className:"w-full h-full"})})]}),(0,s.jsxs)("div",{className:"space-y-6",children:[!Ir&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u8C46\u74E3\u6570\u636E\u4EE3\u7406"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u9009\u62E9\u83B7\u53D6\u8C46\u74E3\u6570\u636E\u7684\u65B9\u5F0F"})]}),(0,s.jsxs)("div",{className:"relative","data-dropdown":"douban-datasource",children:[(0,s.jsx)("button",{type:"button",onClick:()=>ba(!Br),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:border-gray-400 dark:hover:border-gray-500 text-left",children:di.find(Ze=>Ze.value===Kr)?.label}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,s.jsx)(M.Z,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform duration-200 ${Br?"rotate-180":""}`})}),Br&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:di.map(Ze=>(0,s.jsxs)("button",{type:"button",onClick:()=>{Pe(Ze.value),ba(!1)},className:`w-full px-3 py-2.5 text-left text-sm transition-colors duration-150 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 ${Kr===Ze.value?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"}`,children:[(0,s.jsx)("span",{className:"truncate",children:Ze.label}),Kr===Ze.value&&(0,s.jsx)(b.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 ml-2"})]},Ze.value))})]}),St(Kr)&&(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsxs)("button",{type:"button",onClick:()=>window.open(St(Kr).url,"_blank"),className:"flex items-center justify-center gap-1.5 w-full px-3 text-xs text-gray-500 dark:text-gray-400 cursor-pointer",children:[(0,s.jsx)("span",{className:"font-medium",children:St(Kr).text}),(0,s.jsx)(N.Z,{className:"w-3.5 opacity-70"})]})})]}),Kr==="custom"&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u8C46\u74E3\u4EE3\u7406\u5730\u5740"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u81EA\u5B9A\u4E49\u4EE3\u7406\u670D\u52A1\u5668\u5730\u5740"})]}),(0,s.jsx)("input",{type:"text",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 shadow-sm hover:border-gray-400 dark:hover:border-gray-500",placeholder:"\u4F8B\u5982: https://proxy.example.com/fetch?url=",value:ki,onChange:Ze=>Re(Ze.target.value)})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u8C46\u74E3\u56FE\u7247\u4EE3\u7406"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u9009\u62E9\u83B7\u53D6\u8C46\u74E3\u56FE\u7247\u7684\u65B9\u5F0F"})]}),(0,s.jsxs)("div",{className:"relative","data-dropdown":"douban-image-proxy",children:[(0,s.jsx)("button",{type:"button",onClick:()=>pi(!Wr),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:border-gray-400 dark:hover:border-gray-500 text-left",children:gi.find(Ze=>Ze.value===mr)?.label}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none",children:(0,s.jsx)(M.Z,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform duration-200 ${Br?"rotate-180":""}`})}),Wr&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:gi.map(Ze=>(0,s.jsxs)("button",{type:"button",onClick:()=>{it(Ze.value),pi(!1)},className:`w-full px-3 py-2.5 text-left text-sm transition-colors duration-150 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 ${mr===Ze.value?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"}`,children:[(0,s.jsx)("span",{className:"truncate",children:Ze.label}),mr===Ze.value&&(0,s.jsx)(b.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 ml-2"})]},Ze.value))})]}),St(mr)&&(0,s.jsx)("div",{className:"mt-3",children:(0,s.jsxs)("button",{type:"button",onClick:()=>window.open(St(mr).url,"_blank"),className:"flex items-center justify-center gap-1.5 w-full px-3 text-xs text-gray-500 dark:text-gray-400 cursor-pointer",children:[(0,s.jsx)("span",{className:"font-medium",children:St(mr).text}),(0,s.jsx)(N.Z,{className:"w-3.5 opacity-70"})]})})]}),mr==="custom"&&(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u8C46\u74E3\u56FE\u7247\u4EE3\u7406\u5730\u5740"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u81EA\u5B9A\u4E49\u56FE\u7247\u4EE3\u7406\u670D\u52A1\u5668\u5730\u5740"})]}),(0,s.jsx)("input",{type:"text",className:"w-full px-3 py-2.5 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 shadow-sm hover:border-gray-400 dark:hover:border-gray-500",placeholder:"\u4F8B\u5982: https://proxy.example.com/fetch?url=",value:Dr,onChange:Ze=>yt(Ze.target.value)})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u9ED8\u8BA4\u805A\u5408\u641C\u7D22\u7ED3\u679C"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u641C\u7D22\u65F6\u9ED8\u8BA4\u6309\u6807\u9898\u548C\u5E74\u4EFD\u805A\u5408\u663E\u793A\u7ED3\u679C"})]}),(0,s.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:Pr,onChange:Ze=>B(Ze.target.checked)}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,s.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u9ED8\u8BA4\u6D41\u5F0F\u641C\u7D22\u6A21\u5F0F"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u5173\u95ED\u540E\u9ED8\u8BA4\u4F7F\u7528\u4E00\u6B21\u6027\u8FD4\u56DE\uFF0C\u7A7A\u7ED3\u679C\u5C06\u4E0D\u7F13\u5B58"})]}),(0,s.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:gr,onChange:Ze=>le(Ze.target.checked)}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,s.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u4F18\u9009\u64AD\u653E\u6E90"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u5F00\u542F\u540E\uFF0C\u52A0\u8F7D\u89C6\u9891\u65F6\u6267\u884C\u4F18\u9009\uFF0C\u5173\u95ED\u5219\u8DF3\u8FC7"})]}),(0,s.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:$t,onChange:Ze=>jn(Ze.target.checked)}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,s.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u81EA\u52A8\u5339\u914D\u5F39\u5E55"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u5728\u8FDB\u5165\u64AD\u653E\u9875\u9762\u65F6\u81EA\u52A8\u5339\u914D\u5E76\u52A0\u8F7D\u5F39\u5E55\uFF08\u63A8\u8350\uFF09"})]}),(0,s.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:Ba,onChange:Ze=>Aa(Ze.target.checked)}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,s.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u5F39\u5E55\u81EA\u52A8\u5C1D\u8BD5\u6B21\u6570"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u81EA\u52A8\u5F39\u5E55\u83B7\u53D6\u7684\u5C1D\u8BD5\u6B21\u6570\uFF0C-1\u4E3A\u4E00\u76F4\u83B7\u53D6\u76F4\u5230\u6210\u529F"})]}),(0,s.jsx)("input",{type:"number",min:"-1",className:"w-11 px-2 py-1 rounded text-sm bg-[#f5f5f5] dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none border-none focus:outline-none focus:border-none focus:ring-0",value:ti,onChange:Ze=>Yn(Number(Ze.target.value))})]}),(0,s.jsxs)("div",{className:"mt-3 relative",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u4F18\u5148\u5F39\u5E55\u5E73\u53F0"}),(0,s.jsx)("button",{type:"button",onClick:()=>_i(!ji),className:"w-full px-3 py-2.5 pr-10 border border-gray-300 dark:border-gray-600 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-all duration-200 bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 shadow-sm hover:border-gray-400 dark:hover:border-gray-500 text-left mt-2",children:ai.find(Ze=>Ze.value===Mi)?.label}),(0,s.jsx)("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none mt-2",children:(0,s.jsx)(M.Z,{className:`w-4 h-4 text-gray-400 dark:text-gray-500 transition-transform duration-200 ${ji?"rotate-180":""}`})}),ji&&(0,s.jsx)("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-300 dark:border-gray-600 rounded-lg shadow-lg max-h-60 overflow-auto",children:ai.map(Ze=>(0,s.jsxs)("button",{type:"button",onClick:()=>{lt(Ze.value),_i(!1)},className:`w-full px-3 py-2.5 text-left text-sm transition-colors duration-150 flex items-center justify-between hover:bg-gray-100 dark:hover:bg-gray-700 ${Mi===Ze.value?"bg-green-50 dark:bg-green-900/20 text-green-600 dark:text-green-400":"text-gray-900 dark:text-gray-100"}`,children:[(0,s.jsx)("span",{className:"truncate",children:Ze.label}),Mi===Ze.value&&(0,s.jsx)(b.Z,{className:"w-4 h-4 text-green-600 dark:text-green-400 flex-shrink-0 ml-2"})]},Ze.value))}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u81EA\u52A8\u5339\u914D\u5F39\u5E55\u65F6\u4F18\u5148\u4F7F\u7528\u6B64\u5E73\u53F0"})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"TVBox \u63A5\u53E3"}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:`flex items-center gap-1.5 px-3 py-2 rounded-full text-xs font-medium shrink-0 ${Xr?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400":"bg-gray-100 dark:bg-gray-800 text-gray-600 dark:text-gray-400"}`,children:[(0,s.jsx)("div",{className:`w-2 h-2 rounded-full ${Xr?"bg-green-500 animate-pulse":"bg-gray-400"}`}),(0,s.jsx)("span",{children:Xr?"\u5DF2\u5F00\u542F":"\u672A\u5F00\u542F"})]}),Xr&&un?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{ref:Ze=>{if(Ze){let Kt=new URL(un);Kt.searchParams.set("pwd",ln||""),Ze.value=Kt.toString()}},type:"text",className:"flex-1 min-w-0 px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm bg-gray-50 dark:bg-gray-800 text-gray-900 dark:text-gray-100",readOnly:!0}),(0,s.jsx)("button",{type:"button",className:"shrink-0 px-3 py-2 text-sm bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",onClick:Ze=>{let Kt=Ze.currentTarget.previousElementSibling;navigator.clipboard.writeText(Kt.value)},children:"\u590D\u5236"})]}):!Xr&&(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:fr==="localstorage"?"\u8BF7\u4FEE\u6539\u73AF\u5883\u53D8\u91CF TVBOX_ENABLED \u4EE5\u5F00\u542F":ss?"\u8BF7\u524D\u5F80\u7BA1\u7406\u9762\u677F\u7684\u7AD9\u70B9\u914D\u7F6E\u4E2D\u5F00\u542F":"\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\u5F00\u542F"})]}),Xr&&un&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"\u5C06\u8BE5\u5730\u5740\u586B\u5165 TVBox \u7684\u8BA2\u9605/\u914D\u7F6E\u63A5\u53E3\u5373\u53EF\u4F7F\u7528\u3002"}),fr==="localstorage"&&(0,s.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-lg",children:"\u{1F4A1} \u672C\u5730\u6A21\u5F0F\uFF0C\u5F00\u5173\u7531\u73AF\u5883\u53D8\u91CF TVBOX_ENABLED \u63A7\u5236\uFF0C\u53E3\u4EE4\u4E3A PASSWORD"}),ss&&fr!=="localstorage"&&(0,s.jsx)("p",{className:"text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 px-3 py-2 rounded-lg",children:"\u{1F4A1} \u5982\u9700\u4FEE\u6539 TVBox \u914D\u7F6E\uFF08\u5F00\u5173/\u5BC6\u7801\uFF09\uFF0C\u8BF7\u524D\u5F80\u7BA1\u7406\u9762\u677F\u7684\u7AD9\u70B9\u914D\u7F6E"})]})]}),(0,s.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u7B80\u6D01\u6A21\u5F0F"}),(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:"\u5F00\u542F\u540E\u5BFC\u822A\u680F\u53EA\u4FDD\u7559\u9996\u9875\u548C\u641C\u7D22\uFF0C\u9996\u9875\u53EA\u4FDD\u7559\u7EE7\u7EED\u89C2\u770B\u548C\u6536\u85CF\u5939"})]}),(0,s.jsx)("label",{className:"flex items-center cursor-pointer",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:Ir,onChange:Ze=>pe(Ze.target.checked)}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-300 rounded-full peer-checked:bg-green-500 transition-colors dark:bg-gray-600"}),(0,s.jsx)("div",{className:"absolute top-0.5 left-0.5 w-5 h-5 bg-white rounded-full transition-transform peer-checked:translate-x-5"})]})})]})]}),(0,s.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"\u8FD9\u4E9B\u8BBE\u7F6E\u4FDD\u5B58\u5728\u672C\u5730\u6D4F\u89C8\u5668\u4E2D"})})]})]}),vi=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[1000]",onClick:In}),(0,s.jsxs)("div",{className:"fixed top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md bg-white dark:bg-gray-900 rounded-xl shadow-xl z-[1001] p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"\u4FEE\u6539\u5BC6\u7801"}),(0,s.jsx)("button",{onClick:In,className:"w-8 h-8 p-1 rounded-full flex items-center justify-center text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors","aria-label":"Close",children:(0,s.jsx)(j.Z,{className:"w-full h-full"})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"\u65B0\u5BC6\u7801"}),(0,s.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"\u8BF7\u8F93\u5165\u65B0\u5BC6\u7801",value:hi,onChange:Ze=>Ri(Ze.target.value),disabled:Bi})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"\u786E\u8BA4\u5BC6\u7801"}),(0,s.jsx)("input",{type:"password",className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent transition-colors bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400",placeholder:"\u8BF7\u518D\u6B21\u8F93\u5165\u65B0\u5BC6\u7801",value:fi,onChange:Ze=>Ai(Ze.target.value),disabled:Bi})]}),zr&&(0,s.jsx)("div",{className:"text-red-500 text-sm bg-red-50 dark:bg-red-900/20 p-3 rounded-md border border-red-200 dark:border-red-800",children:zr})]}),(0,s.jsxs)("div",{className:"flex gap-3 mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,s.jsx)("button",{onClick:In,className:"flex-1 px-4 py-2 text-sm font-medium text-gray-700 dark:text-gray-300 bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-md transition-colors",disabled:Bi,children:"\u53D6\u6D88"}),(0,s.jsx)("button",{onClick:$n,className:"flex-1 px-4 py-2 text-sm font-medium text-white bg-green-600 hover:bg-green-700 dark:bg-green-700 dark:hover:bg-green-600 rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:Bi||!hi||!fi,children:Bi?"\u4FEE\u6539\u4E2D...":"\u786E\u8BA4\u4FEE\u6539"})]}),(0,s.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center",children:"\u4FEE\u6539\u5BC6\u7801\u540E\u9700\u8981\u91CD\u65B0\u767B\u5F55"})})]})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{onClick:()=>{Ct(!tt)},className:"w-10 h-10 p-2 rounded-full flex items-center justify-center text-gray-600 hover:bg-gray-200/50 dark:text-gray-300 dark:hover:bg-gray-700/50 transition-colors","aria-label":"User Menu",children:(0,s.jsx)($.Z,{className:"w-full h-full"})}),Yr===ae.qu.HAS_UPDATE&&(0,s.jsx)("div",{className:"absolute top-[2px] right-[2px] w-2 h-2 bg-yellow-500 rounded-full"})]}),tt&&li&&(0,X.createPortal)(qr,document.body),ct&&li&&(0,X.createPortal)(Zr,document.body),Dt&&li&&(0,X.createPortal)(vi,document.body),(0,s.jsx)(Z,{isOpen:cr,onClose:()=>kr(!1)})]})},W=(0,k.memo)(({showBackButton:be=!1})=>{let{siteName:De}=(0,U.W)(),[Xe,tt]=(0,k.useState)(0);return(0,k.useEffect)(()=>()=>{},[]),(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("header",{className:"md:hidden relative w-full bg-white/70 backdrop-blur-xl border-b border-gray-200/50 shadow-sm dark:bg-gray-900/70 dark:border-gray-700/50",children:(0,s.jsxs)("div",{className:"h-12 flex items-center justify-between px-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[be&&(0,s.jsx)(L,{}),(0,s.jsx)(m.Z,{href:"/",className:"text-xl font-bold text-green-600 tracking-tight hover:opacity-80 transition-opacity",children:De})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("button",{onClick:()=>{},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors relative",title:"\u4E0B\u8F7D\u7BA1\u7406\u5668",children:[(0,s.jsx)(R.Z,{className:"h-5 w-5"}),Xe>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-4 w-4 flex items-center justify-center",children:Xe>9?"9+":Xe})]}),(0,s.jsx)(te.T,{}),(0,s.jsx)(ne,{})]})]})})})});var Q=u(62239),de=u(89985),ue=u(17242),ye=u(14219),Ge=u(51385);let Oe=(0,k.memo)(({activePath:be})=>{let De=(0,x.tv)(),Xe=(0,x.jD)(),tt=(0,x.lr)(),{siteName:Ct}=(0,U.W)(),{startLoading:ct}=(0,I.w)(),[Tt,Dt]=(0,k.useState)(be||"/"),[mt,cr]=(0,k.useState)(""),[kr,Ht]=(0,k.useState)(!1),Or=(0,k.useRef)(null),[fr,Oi]=(0,k.useState)([]),[li,At]=(0,k.useState)(null),[Pr,hr]=(0,k.useState)([]),[gr,Jt]=(0,k.useState)(!1),Ir=(0,k.useRef)(null),ea=(0,k.useRef)(null),[ki,na]=(0,k.useState)(!1),Kr=(0,k.useRef)(null),[Ni,mr]=(0,k.useState)(0);(0,k.useEffect)(()=>()=>{},[]);let[Er,Dr]=(0,k.useState)(!1),[Ar,Br]=(0,k.useState)(!1);(0,k.useEffect)(()=>{Br(!0),(0,ue.nO)().then(hr);let $t=(0,ue.rq)("searchHistoryUpdated",hr);return()=>{$t()}},[]),(0,k.useEffect)(()=>{if(be)Dt(be);else{let $t=tt.toString();Dt($t?`${Xe}?${$t}`:Xe)}},[be,Xe,tt]),(0,k.useEffect)(()=>{if(Xe==="/search"){let $t=tt.get("q");cr($t?decodeURIComponent($t):"");let Qt=tt.get("sources");Qt&&Oi(Qt.split(","))}},[Xe,tt]);let[ba,Wr]=(0,k.useState)([{icon:d.Z,label:"\u7535\u5F71",href:"/douban?type=movie"},{icon:o.Z,label:"\u5267\u96C6",href:"/douban?type=tv"},{icon:g.Z,label:"\u52A8\u6F2B",href:"/douban?type=anime"},{icon:c.Z,label:"\u7EFC\u827A",href:"/douban?type=show"}]);(0,k.useEffect)(()=>{C().then($t=>{$t.length>0&&Wr(Qt=>[...Qt,{icon:f.Z,label:"\u81EA\u5B9A\u4E49",href:"/douban?type=custom"}])})},[]);let pi=$t=>{cr($t),Jt(!1),(0,ue.F0)($t),Xe!=="/search"&&ct();let Qt=new URLSearchParams;Qt.set("q",$t),fr.length>0&&Qt.set("sources",fr.join(",")),De.push(`/search?${Qt.toString()}`)},Ba=async($t,Qt)=>{Qt.stopPropagation(),await(0,ue.Rw)($t)},Xt=async()=>{await(0,ue.Ev)(),Jt(!1)};(0,k.useEffect)(()=>{let $t=Qt=>{ki&&Kr.current&&!Kr.current.contains(Qt.target)&&(na(!1),li&&At(null),gr&&Jt(!1))};return document.addEventListener("mousedown",$t),()=>{document.removeEventListener("mousedown",$t)}},[ki,li,gr]),(0,k.useEffect)(()=>{let $t=Qt=>{gr&&ea.current&&Ir.current&&!ea.current.contains(Qt.target)&&!Ir.current.contains(Qt.target)&&Jt(!1)};return document.addEventListener("mousedown",$t),()=>{document.removeEventListener("mousedown",$t)}},[gr]);let ti=(0,s.jsxs)("div",{className:"flex-1 max-w-md flex items-center",ref:Kr,children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:(0,s.jsx)(Ge.Z,{selectedSources:fr,onChange:Oi,openFilter:li,setOpenFilter:At,size:"compact"})}),(0,s.jsxs)("div",{className:"relative flex-1",children:[(0,s.jsxs)("form",{onSubmit:$t=>{$t.preventDefault();let Qt=mt.trim();if(Qt){(0,ue.F0)(Qt),Xe!=="/search"&&ct();let Mi=new URLSearchParams;Mi.set("q",Qt),fr.length>0&&Mi.set("sources",fr.join(",")),De.push(`/search?${Mi.toString()}`),Ht(!1),Jt(!1)}},className:"relative",children:[(0,s.jsx)(S.Z,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400 dark:text-gray-500"}),(0,s.jsx)("input",{ref:Or,type:"text",value:mt,onChange:$t=>{let Qt=$t.target.value;cr(Qt),Ht(Qt.trim().length>0),Jt(!1)},onFocus:()=>{mt.trim().length>0&&Ht(!0),Jt(!1)},placeholder:"\u641C\u7D22\u7535\u5F71\u3001\u7535\u89C6\u5267...",className:"w-full h-10 rounded-r-lg rounded-l-none bg-gray-100/80 py-2 pl-10 pr-20 text-sm text-gray-700 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-green-400 focus:bg-white transition-all duration-200 border border-gray-200/50 border-l-0 dark:bg-gray-800 dark:text-gray-300 dark:placeholder-gray-500 dark:focus:bg-gray-700 dark:border-gray-700"}),(0,s.jsxs)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[mt&&(0,s.jsx)("button",{type:"button",onClick:()=>{cr(""),Ht(!1),Or.current?.focus()},className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",children:(0,s.jsx)(j.Z,{className:"h-4 w-4"})}),(0,s.jsxs)("button",{ref:Ir,type:"button",onClick:()=>Jt(!gr),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300 transition-colors relative",title:"\u641C\u7D22\u5386\u53F2",children:[(0,s.jsx)(Q.Z,{className:"h-4 w-4"}),Pr.length>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 w-2 h-2 bg-green-500 rounded-full"})]})]}),(0,s.jsx)(ye.Z,{query:mt,isVisible:kr,onSelect:$t=>{cr($t),Ht(!1),Jt(!1),(0,ue.F0)($t),Xe!=="/search"&&ct();let Qt=new URLSearchParams;Qt.set("q",$t),fr.length>0&&Qt.set("sources",fr.join(",")),De.push(`/search?${Qt.toString()}`)},onClose:()=>Ht(!1)})]}),gr&&Pr.length>0&&(0,s.jsxs)("div",{ref:ea,className:"absolute top-full right-0 mt-2 w-80 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-96 overflow-y-auto z-50",children:[(0,s.jsxs)("div",{className:"p-3 border-b border-gray-200 dark:border-gray-700 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-gray-700 dark:text-gray-300",children:"\u641C\u7D22\u5386\u53F2"}),(0,s.jsx)("button",{onClick:Xt,className:"text-xs text-gray-500 hover:text-red-500 dark:text-gray-400 dark:hover:text-red-500 transition-colors",children:"\u6E05\u7A7A\u5168\u90E8"})]}),(0,s.jsx)("div",{className:"p-2",children:Pr.map(($t,Qt)=>(0,s.jsxs)("div",{className:"group flex items-center justify-between px-3 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:()=>pi($t),children:[(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300 truncate flex-1",children:$t}),(0,s.jsx)("button",{onClick:Mi=>Ba($t,Mi),className:"ml-2 text-gray-400 hover:text-red-500 dark:text-gray-500 dark:hover:text-red-500 transition-colors",title:"\u5220\u9664",children:(0,s.jsx)(de.Z,{className:"h-3 w-3"})})]},`history-${$t}-${Qt}`))})]})]})]}),Pa=(0,s.jsx)("button",{onClick:()=>{na(!0),setTimeout(()=>Or.current?.focus(),300)},className:"p-2 text-gray-700 hover:bg-gray-100/50 hover:text-green-600 rounded-lg transition-colors duration-200 dark:text-gray-300 dark:hover:text-green-400 dark:hover:bg-gray-700/50 flex-shrink-0",title:"\u641C\u7D22",children:(0,s.jsx)(S.Z,{className:"h-5 w-5"})});return(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("header",{className:"hidden md:block sticky top-0 z-50 w-full bg-white/80 backdrop-blur-xl border-b border-gray-200/50 shadow-sm dark:bg-gray-900/80 dark:border-gray-700/50",children:(0,s.jsxs)("div",{className:"mx-auto px-6 h-16 flex items-center justify-between gap-6",children:[Er?(0,s.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2",children:(0,s.jsx)(m.Z,{href:"/",className:"flex items-center justify-center select-none hover:opacity-80 transition-opacity duration-200",onClick:()=>{Tt!=="/"&&ct()},children:(0,s.jsx)("span",{className:"text-2xl font-bold text-green-600 tracking-tight",children:Ct})})}):(0,s.jsx)(m.Z,{href:"/",className:"flex items-center justify-center select-none hover:opacity-80 transition-opacity duration-200 flex-shrink-0",onClick:()=>{Tt!=="/"&&ct()},children:(0,s.jsx)("span",{className:"text-2xl font-bold text-green-600 tracking-tight",children:Ct})}),(0,s.jsxs)("nav",{className:"flex items-center gap-1 flex-shrink-0",children:[Ar&&!Er&&(0,s.jsxs)(m.Z,{href:"/",onClick:()=>{Tt!=="/"&&ct(),Dt("/")},"data-active":Tt==="/",className:"group flex items-center gap-2 px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100/50 hover:text-green-600 data-[active=true]:bg-green-500/10 data-[active=true]:text-green-600 font-medium transition-colors duration-200 dark:text-gray-300 dark:hover:text-green-400 dark:hover:bg-gray-700/50 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400",children:[(0,s.jsx)(E.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"\u9996\u9875"})]}),Ar&&!Er&&ba.map($t=>{let Qt=$t.href.match(/type=([^&]+)/)?.[1],Mi=decodeURIComponent(Tt),Fi=Mi===decodeURIComponent($t.href)||Mi.startsWith("/douban")&&Mi.includes(`type=${Qt}`),ji=$t.icon;return(0,s.jsxs)(m.Z,{href:$t.href,onClick:()=>{Fi||ct(),Dt($t.href)},"data-active":Fi,className:"group flex items-center gap-2 px-4 py-2 rounded-lg text-gray-700 hover:bg-gray-100/50 hover:text-green-600 data-[active=true]:bg-green-500/10 data-[active=true]:text-green-600 font-medium transition-colors duration-200 dark:text-gray-300 dark:hover:text-green-400 dark:hover:bg-gray-700/50 dark:data-[active=true]:bg-green-500/10 dark:data-[active=true]:text-green-400",children:[(0,s.jsx)(ji,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:$t.label})]},$t.label)})]}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsxs)("div",{className:"flex items-center justify-end",children:[ki&&ti,!ki&&Pa]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0 mr-9",children:[(0,s.jsxs)("button",{onClick:()=>{},className:"p-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors relative",title:"\u4E0B\u8F7D\u7BA1\u7406\u5668",children:[(0,s.jsx)(R.Z,{className:"h-5 w-5"}),Ni>0&&(0,s.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs font-bold rounded-full h-5 w-5 flex items-center justify-center",children:Ni>99?"99+":Ni})]}),(0,s.jsx)(te.T,{}),(0,s.jsx)(ne,{})]})]})})})}),Qe=(0,k.memo)(()=>{let be=(0,x.jD)();return["/login","/warning"].some(De=>be.startsWith(De))?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{showBackButton:!1}),(0,s.jsx)(Oe,{}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)(_,{})})]})})},we.__chunk_69817=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>o});var s=u(20519),x=u(73464),k=u(22319),E=u(24528),S=u(87101),d=u(2587);let o=({isOpen:g,onClose:c,onAddTask:f,initialUrl:m="",initialTitle:C="",skipConfig:I})=>{let[_,R]=(0,E.useState)(!1),[F,L]=(0,E.useState)(null),[U,te]=(0,E.useState)("TS"),[Y,q]=(0,E.useState)(!1),[se,J]=(0,E.useState)(1),[j,M]=(0,E.useState)(0),[b,N]=(0,E.useState)(6),[$,X]=(0,E.useState)(3),[ae,K]=(0,E.useState)("disabled"),[ve,ke]=(0,E.useState)(""),[fe,Ae]=(0,E.useState)(""),[_e,Z]=(0,E.useState)(!1),[ne,W]=(0,E.useState)({serviceWorker:!1,fileSystem:!1,blob:!0});(0,E.useEffect)(()=>{},[]),(0,E.useEffect)(()=>{},[]),(0,E.useEffect)(()=>{},[U,b,$,ae]),(0,E.useEffect)(()=>{g&&(ke(m||""),Ae(C||""),L(null),J(1),M(0))},[g,m,C]),(0,E.useEffect)(()=>{g&&C&&(Ae(C),F&&L({...F,title:C}))},[g,C]),(0,E.useEffect)(()=>{g&&ve&&!F&&!_&&Q()},[g,ve]),(0,E.useEffect)(()=>{if(F&&_e&&I){let de=F.segmentDurations||[],ue=1;if(I.intro_time>0&&de.length>0){let Ge=0,Oe=0;for(let Qe=0;Qe<de.length&&Ge+de[Qe]<=I.intro_time;Qe++)Ge+=de[Qe],Oe=Qe;ue=Math.min(F.tsUrlList.length,Oe+2)}let ye=F.tsUrlList.length;if(I.outro_time!==0&&de.length>0){let Ge=0,Oe=(F.durationSecond||0)+I.outro_time;ye=F.tsUrlList.length;for(let Qe=0;Qe<de.length;Qe++)if((Ge+=de[Qe])>=Oe){ye=Qe+1;break}ye=Math.max(1,Math.min(F.tsUrlList.length,ye))}J(ue),M(ye)}},[F,_e,I]);let Q=async()=>{if(ve){R(!0);try{let de=await(0,S.BV)(ve);de.title=fe||de.title,de.type=U,L(de),M(de.tsUrlList.length)}catch{}finally{R(!1)}}};return g?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[10000] flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"relative w-full max-w-2xl rounded-lg bg-white p-6 shadow-xl dark:bg-gray-800 max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("button",{onClick:()=>{c(),L(null),ke(""),Ae("")},className:"absolute right-4 top-4 text-gray-400 transition-colors hover:text-gray-600 dark:hover:text-gray-200",children:(0,s.jsx)(x.Z,{className:"h-6 w-6"})}),(0,s.jsx)("h2",{className:"mb-6 text-2xl font-bold text-gray-900 dark:text-white",children:"\u4E0B\u8F7D M3U8 \u89C6\u9891"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"M3U8 \u5730\u5740"}),(0,s.jsx)("input",{type:"text",value:ve,onChange:de=>ke(de.target.value),className:"w-full rounded-lg border border-gray-300 px-4 py-2 text-sm dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"\u8BF7\u8F93\u5165 M3U8 \u94FE\u63A5\u5730\u5740"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u4FDD\u5B58\u6807\u9898"}),(0,s.jsx)("input",{type:"text",value:F?F.title:fe,onChange:de=>{let ue=de.target.value;Ae(ue),F&&L({...F,title:ue})},className:"w-full rounded-lg border border-gray-300 px-4 py-2 dark:border-gray-600 dark:bg-gray-700 dark:text-white",placeholder:"\u8BF7\u8F93\u5165\u6587\u4EF6\u540D"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u4FDD\u5B58\u683C\u5F0F"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"format",value:"TS",checked:U==="TS",onChange:()=>te("TS"),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"TS \u683C\u5F0F"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"format",value:"MP4",checked:U==="MP4",onChange:()=>te("MP4"),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm text-gray-700 dark:text-gray-300",children:"MP4 \u683C\u5F0F"})]})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:["\u4E0B\u8F7D\u7EBF\u7A0B\u6570: ",b]}),(0,s.jsx)("input",{type:"range",min:"1",max:"16",value:b,onChange:de=>N(parseInt(de.target.value,10)),className:"w-full"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(0,s.jsx)("span",{children:"1 \u7EBF\u7A0B"}),(0,s.jsx)("span",{children:"16 \u7EBF\u7A0B"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:["\u5931\u8D25\u91CD\u8BD5\u6B21\u6570: ",$]}),(0,s.jsx)("input",{type:"range",min:"0",max:"10",value:$,onChange:de=>X(parseInt(de.target.value,10)),className:"w-full"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 dark:text-gray-400 mt-1",children:[(0,s.jsx)("span",{children:"\u4E0D\u91CD\u8BD5"}),(0,s.jsx)("span",{children:"10 \u6B21"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"mb-2 block text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u4E0B\u8F7D\u6A21\u5F0F"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"radio",name:"streamMode",value:"disabled",checked:ae==="disabled",onChange:()=>K("disabled"),className:"w-4 h-4"}),(0,s.jsxs)("div",{className:"text-sm flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsx)("span",{className:"text-green-500",children:"\u2713"}),(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:"\u666E\u901A\u6A21\u5F0F"})]}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 ml-4",children:"\u5185\u5B58\u4E0B\u8F7D\uFF0C\u9002\u5408\u5C0F\u6587\u4EF6\uFF08<500MB\uFF09"})]})]}),(0,s.jsxs)("label",{className:`flex items-center gap-2 ${ne.serviceWorker?"cursor-pointer":"opacity-60"}`,children:[(0,s.jsx)("input",{type:"radio",name:"streamMode",value:"service-worker",checked:ae==="service-worker",onChange:()=>K("service-worker"),disabled:!ne.serviceWorker,className:"w-4 h-4 disabled:cursor-not-allowed"}),(0,s.jsxs)("div",{className:"text-sm flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[ne.serviceWorker?(0,s.jsx)("span",{className:"text-green-500",children:"\u2713"}):(0,s.jsx)("span",{className:"text-red-500",children:"\u2717"}),(0,s.jsx)("span",{className:`font-medium ${ne.serviceWorker?"text-gray-700 dark:text-gray-300":"text-gray-400 dark:text-gray-500"}`,children:"Service Worker \u6D41\u5F0F\u4E0B\u8F7D"})]}),(0,s.jsx)("div",{className:`text-xs ml-4 ${ne.serviceWorker?"text-gray-500 dark:text-gray-400":"text-gray-400 dark:text-gray-500"}`,children:ne.serviceWorker?"\u8FB9\u4E0B\u8FB9\u5B58\uFF0C\u65E0\u5927\u5C0F\u9650\u5236\uFF0C\u9002\u5408\u8D85\u5927\u6587\u4EF6":"\u4E0D\u652F\u6301\uFF1A\u9700\u8981HTTPS\u6216\u672C\u5730\u73AF\u5883"})]})]}),(0,s.jsxs)("label",{className:`flex items-center gap-2 ${ne.fileSystem?"cursor-pointer":"opacity-60"}`,children:[(0,s.jsx)("input",{type:"radio",name:"streamMode",value:"file-system",checked:ae==="file-system",onChange:()=>K("file-system"),disabled:!ne.fileSystem,className:"w-4 h-4 disabled:cursor-not-allowed"}),(0,s.jsxs)("div",{className:"text-sm flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[ne.fileSystem?(0,s.jsx)("span",{className:"text-green-500",children:"\u2713"}):(0,s.jsx)("span",{className:"text-red-500",children:"\u2717"}),(0,s.jsx)("span",{className:`font-medium ${ne.fileSystem?"text-gray-700 dark:text-gray-300":"text-gray-400 dark:text-gray-500"}`,children:"\u6587\u4EF6\u7CFB\u7EDF\u76F4\u5199"})]}),(0,s.jsx)("div",{className:`text-xs ml-4 ${ne.fileSystem?"text-gray-500 dark:text-gray-400":"text-gray-400 dark:text-gray-500"}`,children:ne.fileSystem?"\u76F4\u63A5\u5199\u5165\u78C1\u76D8\uFF0C\u65E0\u5927\u5C0F\u9650\u5236\uFF08\u63A8\u8350\uFF09":"\u4E0D\u652F\u6301\uFF1A\u9700\u8981Chrome/Edge\u6D4F\u89C8\u5668"})]})]})]})]}),_&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-blue-600 dark:text-blue-400",children:[(0,s.jsx)(k.Z,{className:"h-5 w-5 animate-spin"}),(0,s.jsx)("span",{children:"\u6B63\u5728\u89E3\u6790 M3U8..."})]}),F&&(0,s.jsxs)("div",{className:"rounded-lg bg-gray-50 p-4 dark:bg-gray-700/50",children:[(0,s.jsx)("h3",{className:"mb-2 font-medium text-gray-900 dark:text-white",children:"\u89E3\u6790\u7ED3\u679C"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-300",children:[(0,s.jsxs)("p",{children:["\u603B\u65F6\u957F: ",(0,d.m)(F.durationSecond||0)]}),(0,s.jsxs)("p",{children:["\u7247\u6BB5\u6570: ",F.tsUrlList.length]}),F.aesConf?.key&&(0,s.jsx)("p",{className:"text-yellow-600 dark:text-yellow-400",children:"\u{1F512} \u5DF2\u52A0\u5BC6 (AES-128)"})]}),(0,s.jsxs)("div",{className:"mt-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:Y,onChange:de=>q(de.target.checked),className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"\u8303\u56F4\u4E0B\u8F7D"})]}),Y&&(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:_e,onChange:de=>{let ue=de.target.checked;if(Z(ue),ue&&F){let ye=F.tsUrlList.length,Ge=(F.durationSecond||0)/ye;if(Ge>0){let Oe=1;I&&I.intro_time>0&&(Oe=Math.min(ye,Math.ceil(I.intro_time/Ge)+1));let Qe=ye;I&&I.outro_time!==0&&(Qe=Math.max(1,Math.min(ye,Math.floor((F.durationSecond+I.outro_time)/Ge)))),J(Oe),M(Qe)}}},className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-xs text-gray-600 dark:text-gray-400",children:"\u540C\u6B65\u8DF3\u8FC7\u914D\u7F6E"})]})]}),Y&&(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"block text-xs text-gray-600 dark:text-gray-400",children:"\u8D77\u59CB\u7247\u6BB5:"}),(0,s.jsx)("input",{type:"number",min:1,max:F.tsUrlList.length,value:se,onChange:de=>{let ue=parseInt(de.target.value,10);isNaN(ue)&&(ue=1),J(ue=Math.max(1,Math.min(F.tsUrlList.length,ue)))},className:"w-20 px-2 py-1 rounded text-sm bg-[#f5f5f5] dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none border-none focus:outline-none focus:border-none focus:ring-0 ml-1"})]}),(0,s.jsx)("input",{type:"range",min:"1",max:F.tsUrlList.length,value:se,onChange:de=>J(parseInt(de.target.value,10)),className:"w-full"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:(0,d.m)(F.segmentDurations?F.segmentDurations.slice(0,se-1).reduce((de,ue)=>de+ue,0):0)})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("span",{className:"block text-xs text-gray-600 dark:text-gray-400",children:"\u7ED3\u675F\u7247\u6BB5:"}),(0,s.jsx)("input",{type:"number",min:1,max:F.tsUrlList.length,value:j,onChange:de=>{let ue=parseInt(de.target.value,10);isNaN(ue)&&(ue=1),M(ue=Math.max(1,Math.min(F.tsUrlList.length,ue)))},className:"w-20 px-2 py-1 rounded text-sm bg-[#f5f5f5] dark:bg-gray-800 text-gray-900 dark:text-gray-100 outline-none border-none focus:outline-none focus:border-none focus:ring-0 ml-1"})]}),(0,s.jsx)("input",{type:"range",min:"1",max:F.tsUrlList.length,value:j,onChange:de=>M(parseInt(de.target.value,10)),className:"w-full"}),(0,s.jsx)("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:(0,d.m)(F.segmentDurations?F.segmentDurations.slice(0,j).reduce((de,ue)=>de+ue,0):0)})]})]})]})]}),(0,s.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,s.jsx)("button",{onClick:Q,disabled:!ve||_,className:"flex-1 px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:_?"\u89E3\u6790\u4E2D...":"\u89E3\u6790"}),(0,s.jsx)("button",{onClick:()=>{F&&(f({url:ve,title:F.title,downloadType:U,concurrency:b,rangeMode:Y,startSegment:se,endSegment:j,streamMode:ae,maxRetries:$,parsedTask:F}),c(),L(null),ke(""),Ae(""))},disabled:!F,className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 disabled:bg-gray-400 text-white rounded-lg transition-colors",children:"\u6DFB\u52A0\u4E0B\u8F7D"})]})]})]})}):null}},we.__chunk_52998=(ce,O,u)=>{Promise.resolve().then(u.bind(u,68236)),Promise.resolve().then(u.bind(u,85592)),Promise.resolve().then(u.bind(u,29673)),Promise.resolve().then(u.bind(u,19592)),Promise.resolve().then(u.bind(u,53223)),Promise.resolve().then(u.bind(u,10291)),Promise.resolve().then(u.bind(u,87602)),Promise.resolve().then(u.bind(u,13147)),Promise.resolve().then(u.bind(u,56960)),Promise.resolve().then(u.bind(u,52533))},we.__chunk_25200=(ce,O,u)=>{Promise.resolve().then(u.bind(u,84074))},we.__chunk_46437=(ce,O,u)=>{Promise.resolve().then(u.bind(u,34744)),Promise.resolve().then(u.bind(u,68549)),Promise.resolve().then(u.bind(u,70373)),Promise.resolve().then(u.bind(u,39927)),Promise.resolve().then(u.bind(u,96825)),Promise.resolve().then(u.bind(u,23068)),Promise.resolve().then(u.bind(u,24351)),Promise.resolve().then(u.bind(u,86270)),Promise.resolve().then(u.bind(u,33262)),Promise.resolve().then(u.bind(u,74917))},we.__chunk_82755=(ce,O,u)=>{"use strict";u.d(O,{F:()=>o,f:()=>g});var s=u(24528),x=(R,F,L,U,te,Y,q,se)=>{let J=document.documentElement,j=["light","dark"];function M(b){(Array.isArray(R)?R:[R]).forEach(N=>{let $=N==="class",X=$&&Y?te.map(ae=>Y[ae]||ae):te;$?(J.classList.remove(...X),J.classList.add(Y&&Y[b]?Y[b]:b)):J.setAttribute(N,b)}),se&&j.includes(b)&&(J.style.colorScheme=b)}if(U)M(U);else try{let b=localStorage.getItem(F)||L,N=q&&b==="system"?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":b;M(N)}catch{}},k=["light","dark"],E="(prefers-color-scheme: dark)",S=s.createContext(void 0),d={setTheme:R=>{},themes:[]},o=()=>{var R;return(R=s.useContext(S))!=null?R:d},g=R=>s.useContext(S)?s.createElement(s.Fragment,null,R.children):s.createElement(f,{...R}),c=["light","dark"],f=({forcedTheme:R,disableTransitionOnChange:F=!1,enableSystem:L=!0,enableColorScheme:U=!0,storageKey:te="theme",themes:Y=c,defaultTheme:q=L?"system":"light",attribute:se="data-theme",value:J,children:j,nonce:M,scriptProps:b})=>{let[N,$]=s.useState(()=>C(te,q)),[X,ae]=s.useState(()=>N==="system"?_():N),K=J?Object.values(J):Y,ve=s.useCallback(_e=>{let Z=_e;if(!Z)return;_e==="system"&&L&&(Z=_());let ne=J?J[Z]:Z,W=F?I(M):null,Q=document.documentElement,de=ue=>{ue==="class"?(Q.classList.remove(...K),ne&&Q.classList.add(ne)):ue.startsWith("data-")&&(ne?Q.setAttribute(ue,ne):Q.removeAttribute(ue))};if(Array.isArray(se)?se.forEach(de):de(se),U){let ue=k.includes(q)?q:null,ye=k.includes(Z)?Z:ue;Q.style.colorScheme=ye}W?.()},[M]),ke=s.useCallback(_e=>{let Z=typeof _e=="function"?_e(N):_e;$(Z);try{localStorage.setItem(te,Z)}catch{}},[N]),fe=s.useCallback(_e=>{ae(_(_e)),N==="system"&&L&&!R&&ve("system")},[N,R]);s.useEffect(()=>{let _e=window.matchMedia(E);return _e.addListener(fe),fe(_e),()=>_e.removeListener(fe)},[fe]),s.useEffect(()=>{let _e=Z=>{Z.key===te&&(Z.newValue?$(Z.newValue):ke(q))};return window.addEventListener("storage",_e),()=>window.removeEventListener("storage",_e)},[ke]),s.useEffect(()=>{ve(R??N)},[R,N]);let Ae=s.useMemo(()=>({theme:N,setTheme:ke,forcedTheme:R,resolvedTheme:N==="system"?X:N,themes:L?[...Y,"system"]:Y,systemTheme:L?X:void 0}),[N,ke,R,X,L,Y]);return s.createElement(S.Provider,{value:Ae},s.createElement(m,{forcedTheme:R,storageKey:te,attribute:se,enableSystem:L,enableColorScheme:U,defaultTheme:q,value:J,themes:Y,nonce:M,scriptProps:b}),j)},m=s.memo(({forcedTheme:R,storageKey:F,attribute:L,enableSystem:U,enableColorScheme:te,defaultTheme:Y,value:q,themes:se,nonce:J,scriptProps:j})=>{let M=JSON.stringify([L,F,Y,R,se,q,U,te]).slice(1,-1);return s.createElement("script",{...j,suppressHydrationWarning:!0,nonce:J,dangerouslySetInnerHTML:{__html:`(${x.toString()})(${M})`}})}),C=(R,F)=>{},I=R=>{let F=document.createElement("style");return R&&F.setAttribute("nonce",R),F.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(F),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(F)},1)}},_=R=>(R||(R=window.matchMedia(E)),R.matches?"dark":"light")},we.__chunk_11780=(ce,O,u)=>{"use strict";let s;u.d(O,{ZP:()=>en});let x=Number.isFinite||function(y){return typeof y=="number"&&isFinite(y)},k=Number.isSafeInteger||function(y){return typeof y=="number"&&Math.abs(y)<=E},E=Number.MAX_SAFE_INTEGER||9007199254740991,S=function(y){return y.NETWORK_ERROR="networkError",y.MEDIA_ERROR="mediaError",y.KEY_SYSTEM_ERROR="keySystemError",y.MUX_ERROR="muxError",y.OTHER_ERROR="otherError",y}({}),d=function(y){return y.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",y.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",y.KEY_SYSTEM_NO_SESSION="keySystemNoSession",y.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",y.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",y.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",y.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",y.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",y.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",y.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",y.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR="keySystemDestroyMediaKeysError",y.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR="keySystemDestroyCloseSessionError",y.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR="keySystemDestroyRemoveSessionError",y.MANIFEST_LOAD_ERROR="manifestLoadError",y.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",y.MANIFEST_PARSING_ERROR="manifestParsingError",y.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",y.LEVEL_EMPTY_ERROR="levelEmptyError",y.LEVEL_LOAD_ERROR="levelLoadError",y.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",y.LEVEL_PARSING_ERROR="levelParsingError",y.LEVEL_SWITCH_ERROR="levelSwitchError",y.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",y.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",y.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",y.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",y.FRAG_LOAD_ERROR="fragLoadError",y.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",y.FRAG_DECRYPT_ERROR="fragDecryptError",y.FRAG_PARSING_ERROR="fragParsingError",y.FRAG_GAP="fragGap",y.REMUX_ALLOC_ERROR="remuxAllocError",y.KEY_LOAD_ERROR="keyLoadError",y.KEY_LOAD_TIMEOUT="keyLoadTimeOut",y.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",y.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",y.BUFFER_APPEND_ERROR="bufferAppendError",y.BUFFER_APPENDING_ERROR="bufferAppendingError",y.BUFFER_STALLED_ERROR="bufferStalledError",y.BUFFER_FULL_ERROR="bufferFullError",y.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",y.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",y.ASSET_LIST_LOAD_ERROR="assetListLoadError",y.ASSET_LIST_LOAD_TIMEOUT="assetListLoadTimeout",y.ASSET_LIST_PARSING_ERROR="assetListParsingError",y.INTERSTITIAL_ASSET_ITEM_ERROR="interstitialAssetItemError",y.INTERNAL_EXCEPTION="internalException",y.INTERNAL_ABORTED="aborted",y.ATTACH_MEDIA_ERROR="attachMediaError",y.UNKNOWN="unknown",y}({}),o=function(y){return y.MEDIA_ATTACHING="hlsMediaAttaching",y.MEDIA_ATTACHED="hlsMediaAttached",y.MEDIA_DETACHING="hlsMediaDetaching",y.MEDIA_DETACHED="hlsMediaDetached",y.MEDIA_ENDED="hlsMediaEnded",y.STALL_RESOLVED="hlsStallResolved",y.BUFFER_RESET="hlsBufferReset",y.BUFFER_CODECS="hlsBufferCodecs",y.BUFFER_CREATED="hlsBufferCreated",y.BUFFER_APPENDING="hlsBufferAppending",y.BUFFER_APPENDED="hlsBufferAppended",y.BUFFER_EOS="hlsBufferEos",y.BUFFERED_TO_END="hlsBufferedToEnd",y.BUFFER_FLUSHING="hlsBufferFlushing",y.BUFFER_FLUSHED="hlsBufferFlushed",y.MANIFEST_LOADING="hlsManifestLoading",y.MANIFEST_LOADED="hlsManifestLoaded",y.MANIFEST_PARSED="hlsManifestParsed",y.LEVEL_SWITCHING="hlsLevelSwitching",y.LEVEL_SWITCHED="hlsLevelSwitched",y.LEVEL_LOADING="hlsLevelLoading",y.LEVEL_LOADED="hlsLevelLoaded",y.LEVEL_UPDATED="hlsLevelUpdated",y.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",y.LEVELS_UPDATED="hlsLevelsUpdated",y.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",y.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",y.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",y.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",y.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",y.AUDIO_TRACK_UPDATED="hlsAudioTrackUpdated",y.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",y.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",y.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",y.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",y.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",y.SUBTITLE_TRACK_UPDATED="hlsSubtitleTrackUpdated",y.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",y.CUES_PARSED="hlsCuesParsed",y.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",y.INIT_PTS_FOUND="hlsInitPtsFound",y.FRAG_LOADING="hlsFragLoading",y.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",y.FRAG_LOADED="hlsFragLoaded",y.FRAG_DECRYPTED="hlsFragDecrypted",y.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",y.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",y.FRAG_PARSING_METADATA="hlsFragParsingMetadata",y.FRAG_PARSED="hlsFragParsed",y.FRAG_BUFFERED="hlsFragBuffered",y.FRAG_CHANGED="hlsFragChanged",y.FPS_DROP="hlsFpsDrop",y.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",y.MAX_AUTO_LEVEL_UPDATED="hlsMaxAutoLevelUpdated",y.ERROR="hlsError",y.DESTROYING="hlsDestroying",y.KEY_LOADING="hlsKeyLoading",y.KEY_LOADED="hlsKeyLoaded",y.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",y.BACK_BUFFER_REACHED="hlsBackBufferReached",y.STEERING_MANIFEST_LOADED="hlsSteeringManifestLoaded",y.ASSET_LIST_LOADING="hlsAssetListLoading",y.ASSET_LIST_LOADED="hlsAssetListLoaded",y.INTERSTITIALS_UPDATED="hlsInterstitialsUpdated",y.INTERSTITIALS_BUFFERED_TO_BOUNDARY="hlsInterstitialsBufferedToBoundary",y.INTERSTITIAL_ASSET_PLAYER_CREATED="hlsInterstitialAssetPlayerCreated",y.INTERSTITIAL_STARTED="hlsInterstitialStarted",y.INTERSTITIAL_ASSET_STARTED="hlsInterstitialAssetStarted",y.INTERSTITIAL_ASSET_ENDED="hlsInterstitialAssetEnded",y.INTERSTITIAL_ASSET_ERROR="hlsInterstitialAssetError",y.INTERSTITIAL_ENDED="hlsInterstitialEnded",y.INTERSTITIALS_PRIMARY_RESUMED="hlsInterstitialsPrimaryResumed",y.PLAYOUT_LIMIT_REACHED="hlsPlayoutLimitReached",y.EVENT_CUE_ENTER="hlsEventCueEnter",y}({});var g,c,f={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},m={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};class C{constructor(e,t=0,r=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=r}sample(e,t){let r=Math.pow(this.alpha_,e);this.estimate_=t*(1-r)+r*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class I{constructor(e,t,r,i=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=r,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new C(e),this.fast_=new C(t),this.defaultTTFB_=i,this.ttfb_=new C(e)}update(e,t){let{slow_:r,fast_:i,ttfb_:a}=this;r.halfLife!==e&&(this.slow_=new C(e,r.getEstimate(),r.getTotalWeight())),i.halfLife!==t&&(this.fast_=new C(t,i.getEstimate(),i.getTotalWeight())),a.halfLife!==e&&(this.ttfb_=new C(e,a.getEstimate(),a.getTotalWeight()))}sample(e,t){let r=(e=Math.max(e,this.minDelayMs_))/1e3,i=8*t/r;this.fast_.sample(r,i),this.slow_.sample(r,i)}sampleTTFB(e){this.ttfb_.sample(Math.sqrt(2)*Math.exp(-Math.pow(e/1e3,2)/2),Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}get defaultEstimate(){return this.defaultEstimate_}destroy(){}}function _(){return(_=Object.assign?Object.assign.bind():function(y){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(y[r]=t[r])}return y}).apply(null,arguments)}function R(y,e){var t=Object.keys(y);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(y);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(y,i).enumerable})),t.push.apply(t,r)}return t}function F(y){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?R(Object(t),!0).forEach(function(r){var i,a;i=r,a=t[r],(i=function(n){var l=function(h,p){if(typeof h!="object"||!h)return h;var v=h[Symbol.toPrimitive];if(v!==void 0){var w=v.call(h,p);if(typeof w!="object")return w;throw TypeError("@@toPrimitive must return a primitive value.")}return(p==="string"?String:Number)(h)}(n,"string");return typeof l=="symbol"?l:l+""}(i))in y?Object.defineProperty(y,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):y[i]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(y,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach(function(r){Object.defineProperty(y,r,Object.getOwnPropertyDescriptor(t,r))})}return y}class L{constructor(e,t){this.trace=void 0,this.debug=void 0,this.log=void 0,this.warn=void 0,this.info=void 0,this.error=void 0;let r=`[${e}]:`;this.trace=U,this.debug=t.debug.bind(null,r),this.log=t.log.bind(null,r),this.warn=t.warn.bind(null,r),this.info=t.info.bind(null,r),this.error=t.error.bind(null,r)}}let U=function(){},te={trace:U,debug:U,log:U,warn:U,info:U,error:U};function Y(){return _({},te)}function q(y,e,t){return e[y]?e[y].bind(e):function(r,i){let a=ut.console[r];return a?a.bind(ut.console,`${i?"["+i+"] ":""}[${r}] >`):U}(y,t)}let se=Y();function J(y=!0){if(typeof ut<"u")return(y||!ut.MediaSource)&&ut.ManagedMediaSource||ut.MediaSource||ut.WebKitMediaSource}function j(y,e){let t=Object.keys(y),r=Object.keys(e),i=t.length,a=r.length;return!i||!a||i===a&&!t.some(n=>r.indexOf(n)===-1)}function M(y,e=!1){let t,r;if(typeof TextDecoder<"u"){let l=new TextDecoder("utf-8").decode(y);if(e){let h=l.indexOf("\0");return h!==-1?l.substring(0,h):l}return l.replace(/\0/g,"")}let i=y.length,a="",n=0;for(;n<i&&((t=y[n++])!==0||!e);)if(t!==0&&t!==3)switch(t>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:a+=String.fromCharCode(t);break;case 12:case 13:a+=String.fromCharCode((31&t)<<6|63&y[n++]);break;case 14:a+=String.fromCharCode((15&t)<<12|(63&y[n++])<<6|(63&y[n++])<<0)}return a}function b(y){let e="";for(let t=0;t<y.length;t++){let r=y[t].toString(16);r.length<2&&(r="0"+r),e+=r}return e}function N(y){return Uint8Array.from(y.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var $={exports:{}},X=function(){var y,e,t,r,i;return g||(g=1,y=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,e=/^(?=([^\/?#]*))\1([^]*)$/,t=/(?:\/|^)\.(?=\/)/g,r=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,i={buildAbsoluteURL:function(a,n,l){if(l=l||{},a=a.trim(),!(n=n.trim())){if(!l.alwaysNormalize)return a;var h=i.parseURL(a);if(!h)throw Error("Error trying to parse base URL.");return h.path=i.normalizePath(h.path),i.buildURLFromParts(h)}var p=i.parseURL(n);if(!p)throw Error("Error trying to parse relative URL.");if(p.scheme)return l.alwaysNormalize?(p.path=i.normalizePath(p.path),i.buildURLFromParts(p)):n;var v=i.parseURL(a);if(!v)throw Error("Error trying to parse base URL.");if(!v.netLoc&&v.path&&v.path[0]!=="/"){var w=e.exec(v.path);v.netLoc=w[1],v.path=w[2]}v.netLoc&&!v.path&&(v.path="/");var P={scheme:v.scheme,netLoc:p.netLoc,path:null,params:p.params,query:p.query,fragment:p.fragment};if(!p.netLoc&&(P.netLoc=v.netLoc,p.path[0]!=="/"))if(p.path){var D=v.path,G=D.substring(0,D.lastIndexOf("/")+1)+p.path;P.path=i.normalizePath(G)}else P.path=v.path,p.params||(P.params=v.params,p.query||(P.query=v.query));return P.path===null&&(P.path=l.alwaysNormalize?i.normalizePath(p.path):p.path),i.buildURLFromParts(P)},parseURL:function(a){var n=y.exec(a);return n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(a){for(a=a.split("").reverse().join("").replace(t,"");a.length!==(a=a.replace(r,"")).length;);return a.split("").reverse().join("")},buildURLFromParts:function(a){return a.scheme+a.netLoc+a.path+a.params+a.query+a.fragment}},$.exports=i),$.exports}();class ae{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var K={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class ve{constructor(e){this._byteRange=null,this._url=null,this._stats=null,this._streams=null,this.base=void 0,this.relurl=void 0,typeof e=="string"&&(e={url:e}),this.base=e,function(t,r){let i=function a(n,l){let h=Object.getPrototypeOf(n);if(h)return Object.getOwnPropertyDescriptor(h,l)||a(h,l)}(t,r);i&&(i.enumerable=!0,Object.defineProperty(t,r,i))}(this,"stats")}setByteRange(e,t){let r,i=e.split("@",2);r=i.length===1?t?.byteRangeEndOffset||0:parseInt(i[1]),this._byteRange=[r,parseInt(i[0])+r]}get baseurl(){return this.base.url}get byteRange(){return this._byteRange===null?[]:this._byteRange}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get elementaryStreams(){return this._streams===null&&(this._streams={[K.AUDIO]:null,[K.VIDEO]:null,[K.AUDIOVIDEO]:null}),this._streams}set elementaryStreams(e){this._streams=e}get hasStats(){return this._stats!==null}get hasStreams(){return this._streams!==null}get stats(){return this._stats===null&&(this._stats=new ae),this._stats}set stats(e){this._stats=e}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=X.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}clearElementaryStreamInfo(){let{elementaryStreams:e}=this;e[K.AUDIO]=null,e[K.VIDEO]=null,e[K.AUDIOVIDEO]=null}}function ke(y){return y.sn!=="initSegment"}class fe extends ve{constructor(e,t){super(t),this._decryptdata=null,this._programDateTime=null,this._ref=null,this._bitrate=void 0,this.rawProgramDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.playlistOffset=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.urlId=0,this.type=e}get byteLength(){if(this.hasStats){let e=this.stats.total;if(e)return e}if(this.byteRange.length){let e=this.byteRange[0],t=this.byteRange[1];if(x(e)&&x(t))return t-e}return null}get bitrate(){return this.byteLength?8*this.byteLength/this.duration:this._bitrate?this._bitrate:null}set bitrate(e){this._bitrate=e}get decryptdata(){let{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){let t=this.levelkeys.identity;if(t)this._decryptdata=t.getDecryptData(this.sn);else{let r=Object.keys(this.levelkeys);if(r.length===1){let i=this._decryptdata=this.levelkeys[r[0]]||null;if(i)return i.getDecryptData(this.sn)}}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(this.programDateTime===null)return null;let e=x(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e,t;if((e=this._decryptdata)!=null&&e.encrypted)return!0;if(this.levelkeys){let r=Object.keys(this.levelkeys),i=r.length;if(i>1||i===1&&(t=this.levelkeys[r[0]])!=null&&t.encrypted)return!0}return!1}get programDateTime(){return this._programDateTime===null&&this.rawProgramDateTime&&(this.programDateTime=Date.parse(this.rawProgramDateTime)),this._programDateTime}set programDateTime(e){if(!x(e)){this._programDateTime=this.rawProgramDateTime=null;return}this._programDateTime=e}get ref(){return ke(this)?(this._ref||(this._ref={base:this.base,start:this.start,duration:this.duration,sn:this.sn,programDateTime:this.programDateTime}),this._ref):null}addStart(e){this.setStart(this.start+e)}setStart(e){this.start=e,this._ref&&(this._ref.start=e)}setDuration(e){this.duration=e,this._ref&&(this._ref.duration=e)}setKeyFormat(e){if(this.levelkeys){let t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;(e=this.loader)==null||e.abort(),(t=this.keyLoader)==null||t.abort()}setElementaryStreamInfo(e,t,r,i,a,n=!1){let{elementaryStreams:l}=this,h=l[e];if(!h){l[e]={startPTS:t,endPTS:r,startDTS:i,endDTS:a,partial:n};return}h.startPTS=Math.min(h.startPTS,t),h.endPTS=Math.max(h.endPTS,r),h.startDTS=Math.min(h.startDTS,i),h.endDTS=Math.max(h.endDTS,a)}}class Ae extends ve{constructor(e,t,r,i,a){super(r),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=i;let n=e.enumeratedString("BYTERANGE");n&&this.setByteRange(n,a),a&&(this.fragOffset=a.fragOffset+a.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}let _e=[].push,Z={video:1,audio:2,id3:3,text:4};function ne(y){return String.fromCharCode.apply(null,y)}function W(y,e){let t=y[e]<<8|y[e+1];return t<0?65536+t:t}function Q(y,e){let t=ue(y,e);return t<0?4294967296+t:t}function de(y,e){let t=Q(y,e);return t*=4294967296,t+=Q(y,e+4)}function ue(y,e){return y[e]<<24|y[e+1]<<16|y[e+2]<<8|y[e+3]}function ye(y,e){let t=[];if(!e.length)return t;let r=y.byteLength;for(let i=0;i<r;){let a=Q(y,i),n=ne(y.subarray(i+4,i+8)),l=a>1?i+a:r;if(n===e[0])if(e.length===1)t.push(y.subarray(i+8,l));else{let h=ye(y.subarray(i+8,l),e.slice(1));h.length&&_e.apply(t,h)}i=l}return t}function Ge(y){let e=[],t=ye(y,["moov","trak"]);for(let r=0;r<t.length;r++){let i=t[r],a=ye(i,["tkhd"])[0];if(a){let n=a[0],l=Q(a,n===0?12:20),h=ye(i,["mdia","mdhd"])[0];if(h){n=h[0];let p=Q(h,n===0?12:20),v=ye(i,["mdia","hdlr"])[0];if(v){let w=ne(v.subarray(8,12)),P={soun:K.AUDIO,vide:K.VIDEO}[w],D=function(G){let z,H=G.subarray(8),oe=H.subarray(86),Se=ne(H.subarray(4,8)),me=Se,Te=Se==="enca"||Se==="encv";if(Te){let je=ye(H,[Se])[0].subarray(Se==="enca"?28:78);ye(je,["sinf"]).forEach(ge=>{let ze=ye(ge,["schm"])[0];if(ze){let Fe=ne(ze.subarray(4,8));if(Fe==="cbcs"||Fe==="cenc"){let rt=ye(ge,["frma"])[0];rt&&(me=ne(rt))}}})}let Be=me;switch(me){case"avc1":case"avc2":case"avc3":case"avc4":{let je=ye(oe,["avcC"])[0];je&&je.length>3&&(me+="."+be(je[1])+be(je[2])+be(je[3]),z=Oe(Be==="avc1"?"dva1":"dvav",oe));break}case"mp4a":{let je=ye(H,[Se])[0],ge=ye(je.subarray(28),["esds"])[0];if(ge&&ge.length>7){let ze=4;if(ge[ze++]!==3)break;ze=Qe(ge,ze)+2;let Fe=ge[ze++];if(128&Fe&&(ze+=2),64&Fe&&(ze+=ge[ze++]),ge[ze++]!==4)break;ze=Qe(ge,ze);let rt=ge[ze++];if(rt===64)me+="."+be(rt);else break;if(ze+=12,ge[ze++]!==5)break;ze=Qe(ge,ze);let st=ge[ze++],kt=(248&st)>>3;kt===31&&(kt+=1+((7&st)<<3)+((224&ge[ze])>>5)),me+="."+kt}break}case"hvc1":case"hev1":{let je=ye(oe,["hvcC"])[0];if(je&&je.length>12){let ge=je[1],ze=["","A","B","C"][ge>>6],Fe=Q(je,2),rt=je[12],st=je.subarray(6,12);me+="."+ze+(31&ge)+"."+function(Ye){let et=0;for(let dt=0;dt<32;dt++)et|=(Ye>>dt&1)<<31-dt;return et>>>0}(Fe).toString(16).toUpperCase()+"."+((32&ge)>>5?"H":"L")+rt;let kt="";for(let Ye=st.length;Ye--;){let et=st[Ye];(et||kt)&&(kt="."+et.toString(16).toUpperCase()+kt)}me+=kt}z=Oe(Be=="hev1"?"dvhe":"dvh1",oe);break}case"dvh1":case"dvhe":case"dvav":case"dva1":case"dav1":me=Oe(me,oe)||me;break;case"vp09":{let je=ye(oe,["vpcC"])[0];if(je&&je.length>6){let ge=je[4],ze=je[5],Fe=je[6]>>4&15;me+="."+De(ge)+"."+De(ze)+"."+De(Fe)}break}case"av01":{let je=ye(oe,["av1C"])[0];if(je&&je.length>2){let ge=je[1]>>>5,ze=31&je[1],Fe=je[2]>>>7?"H":"M",rt=(64&je[2])>>6,st=(32&je[2])>>5,kt=(16&je[2])>>4,Ye=(8&je[2])>>3,et=(4&je[2])>>2,dt=3&je[2];me+="."+ge+"."+De(ze)+Fe+"."+De(ge===2&&rt?st?12:10:rt?10:8)+"."+kt+"."+Ye+et+dt+"."+De(1)+"."+De(1)+"."+De(1)+".0",z=Oe("dav1",oe)}}}return{codec:me,encrypted:Te,supplemental:z}}(ye(i,["mdia","minf","stbl","stsd"])[0]);P?(e[l]={timescale:p,type:P,stsd:D},e[P]=F({timescale:p,id:l},D)):e[l]={timescale:p,type:w,stsd:D}}}}}return ye(y,["moov","mvex","trex"]).forEach(r=>{let i=e[Q(r,4)];i&&(i.default={duration:Q(r,12),flags:Q(r,20)})}),e}function Oe(y,e){let t=ye(e,["dvvC"]),r=t.length?t[0]:ye(e,["dvcC"])[0];if(r){let i=r[2]>>1&127,a=r[2]<<5&32|r[3]>>3&31;return y+"."+De(i)+"."+De(a)}}function Qe(y,e){let t=e+5;for(;128&y[e++]&&e<t;);return e}function be(y){return("0"+y.toString(16).toUpperCase()).slice(-2)}function De(y){return(y<10?"0":"")+y}function Xe(y){let e=ye(y,["schm"])[0];if(e){let t=ne(e.subarray(4,8));if(t==="cbcs"||t==="cenc")return ye(y,["schi","tenc"])[0]}return null}function tt(y,e){let t=new Uint8Array(y.length+e.length);return t.set(y),t.set(e,y.length),t}function Ct(y,e){let t=[],r=e.samples,i=e.timescale,a=e.id,n=!1;return ye(r,["moof"]).map(l=>{let h=l.byteOffset-8;ye(l,["traf"]).map(p=>{let v=ye(p,["tfdt"]).map(w=>{let P=w[0],D=Q(w,4);return P===1&&(D*=4294967296,D+=Q(w,8)),D/i})[0];return v!==void 0&&(y=v),ye(p,["tfhd"]).map(w=>{let P=Q(w,4),D=16777215&Q(w,0),G=0,z=0,H=8;P===a&&((1&D)!=0&&(H+=8),(2&D)!=0&&(H+=4),(8&D)!=0&&(G=Q(w,H),H+=4),(16&D)!=0&&(z=Q(w,H),H+=4),(32&D)!=0&&(H+=4),e.type==="video"&&(n=ct(e.codec)),ye(p,["trun"]).map(oe=>{let Se=oe[0],me=16777215&Q(oe,0),Te=0,Be=(256&me)!=0,je=0,ge=(512&me)!=0,ze=0,Fe=(1024&me)!=0,rt=(2048&me)!=0,st=0,kt=Q(oe,4),Ye=8;(1&me)!=0&&(Te=Q(oe,Ye),Ye+=4),(4&me)!=0&&(Ye+=4);let et=Te+h;for(let dt=0;dt<kt;dt++){if(Be?(je=Q(oe,Ye),Ye+=4):je=G,ge?(ze=Q(oe,Ye),Ye+=4):ze=z,Fe&&(Ye+=4),rt&&(st=Se===0?Q(oe,Ye):ue(oe,Ye),Ye+=4),e.type===K.VIDEO){let bt=0;for(;bt<ze;){let _t=Q(r,et);et+=4,function(xt,at){if(!xt)return(31&at)==6;{let nt=at>>1&63;return nt===39||nt===40}}(n,r[et])&&Tt(r.subarray(et,et+_t),n?2:1,y+st/i,t),et+=_t,bt+=_t+4}}y+=je/i}}))})})}),t}function ct(y){if(!y)return!1;let e=y.substring(0,4);return e==="hvc1"||e==="hev1"||e==="dvh1"||e==="dvhe"}function Tt(y,e,t,r){let i,a=Dt(y);i=0+e;let n=0,l=0,h=0;for(;i<a.length;){n=0;do{if(i>=a.length)break;n+=h=a[i++]}while(h===255);l=0;do{if(i>=a.length)break;l+=h=a[i++]}while(h===255);let p=a.length-i,v=i;if(l<p)i+=l;else if(l>p){se.error(`Malformed SEI payload. ${l} is too small, only ${p} bytes left to parse.`);break}if(n===4){if(a[v++]===181){let w=W(a,v);if(v+=2,w===49){let P=Q(a,v);if(v+=4,P===1195456820){let D=a[v++];if(D===3){let G=a[v++],z=31&G,H=64&G,oe=H?2+3*z:0,Se=new Uint8Array(oe);if(H){Se[0]=G;for(let me=1;me<oe;me++)Se[me]=a[v++]}r.push({type:D,payloadType:n,pts:t,bytes:Se})}}}}}else if(n===5&&l>16){let w=[];for(let G=0;G<16;G++){let z=a[v++].toString(16);w.push(z.length==1?"0"+z:z),(G===3||G===5||G===7||G===9)&&w.push("-")}let P=l-16,D=new Uint8Array(P);for(let G=0;G<P;G++)D[G]=a[v++];r.push({payloadType:n,pts:t,uuid:w.join(""),userData:M(D),userDataBytes:D})}}}function Dt(y){let e=y.byteLength,t=[],r=1;for(;r<e-2;)y[r]===0&&y[r+1]===0&&y[r+2]===3?(t.push(r+2),r+=2):r++;if(t.length===0)return y;let i=e-t.length,a=new Uint8Array(i),n=0;for(r=0;r<i;n++,r++)n===t[0]&&(n++,t.shift()),a[r]=y[n];return a}let mt=()=>/\(Windows.+Firefox\//i.test(navigator.userAgent),cr={audio:{a3ds:1,"ac-3":.95,"ac-4":1,alac:.9,alaw:1,dra1:1,"dts+":1,"dts-":1,dtsc:1,dtse:1,dtsh:1,"ec-3":.9,enca:1,fLaC:.9,flac:.9,FLAC:.9,g719:1,g726:1,m4ae:1,mha1:1,mha2:1,mhm1:1,mhm2:1,mlpa:1,mp4a:1,"raw ":1,Opus:1,opus:1,samr:1,sawb:1,sawp:1,sevc:1,sqcp:1,ssmv:1,twos:1,ulaw:1},video:{avc1:1,avc2:1,avc3:1,avc4:1,avcp:1,av01:.8,dav1:.8,drac:1,dva1:1,dvav:1,dvh1:.7,dvhe:.7,encv:1,hev1:.75,hvc1:.75,mjp2:1,mp4v:1,mvc1:1,mvc2:1,mvc3:1,mvc4:1,resv:1,rv60:1,s263:1,svc1:1,svc2:1,"vc-1":1,vp08:1,vp09:.9},text:{stpp:1,wvtt:1}};function kr(y,e){let t=cr[e];return!!t&&!!t[y.slice(0,4)]}function Ht(y,e,t=!0){return!y.split(",").some(r=>!Or(r,e,t))}function Or(y,e,t=!0){var r;let i=J(t);return(r=i?.isTypeSupported(fr(y,e)))!=null&&r}function fr(y,e){return`${e}/mp4;codecs=${y}`}function Oi(y){if(y){let e=y.substring(0,4);return cr.video[e]}return 2}function li(y){let e=mt();return y.split(",").reduce((t,r)=>{let i=e&&ct(r)?9:cr.video[r];return i?(2*i+t)/(t?3:2):(cr.audio[r]+t)/(t?2:1)},0)}let At={},Pr=/flac|opus|mp4a\.40\.34/i;function hr(y,e=!0){return y.replace(Pr,t=>function(r,i=!0){if(At[r])return At[r];let a={flac:["flac","fLaC","FLAC"],opus:["opus","Opus"],"mp4a.40.34":["mp3"]}[r];for(let l=0;l<a.length;l++){var n;if(Or(a[l],"audio",i))return At[r]=a[l],a[l];if(a[l]==="mp3"&&(n=J(i))!=null&&n.isTypeSupported("audio/mpeg"))return""}return r}(t.toLowerCase(),e))}function gr(y,e){if(y&&(y.length>4||["ac-3","ec-3","alac","fLaC","Opus"].indexOf(y)!==-1)&&(Jt(y,"audio")||Jt(y,"video")))return y;if(e){let t=e.split(",");if(t.length>1){if(y){for(let r=t.length;r--;)if(t[r].substring(0,4)===y.substring(0,4))return t[r]}return t[0]}}return e||y}function Jt(y,e){return kr(y,e)&&Or(y,e)}function Ir(y){let e=J(y)||{isTypeSupported:()=>!1};return{mpeg:e.isTypeSupported("audio/mpeg"),mp3:e.isTypeSupported('audio/mp4; codecs="mp3"'),ac3:e.isTypeSupported('audio/mp4; codecs="ac-3"')}}function ea(y){return y.replace(/^.+codecs=["']?([^"']+).*$/,"$1")}let ki={supported:!1,smooth:!1,powerEfficient:!1},na={supported:!0,configurations:[],decodingInfoResults:[{supported:!0,powerEfficient:!0,smooth:!0}]};function Kr(y,e){return{supported:!1,configurations:e,decodingInfoResults:[ki],error:y}}function Ni(y,e,t,r={}){let i=y.videoCodec;if(!i&&!y.audioCodec||!t)return Promise.resolve(na);let a=[],n=function(v){var w;let P=(w=v.videoCodec)==null?void 0:w.split(","),D=mr(v),G=v.width||640,z=v.height||480,H=v.frameRate||30,oe=v.videoRange.toLowerCase();return P?P.map(Se=>{let me={contentType:fr(function(Te){if(Te.startsWith("av01.")){let Be=Te.split("."),je=["0","111","01","01","01","0"];for(let ge=Be.length;ge>4&&ge<10;ge++)Be[ge]=je[ge-4];return Be.join(".")}return Te}(Se),"video"),width:G,height:z,bitrate:D,framerate:H};return oe!=="sdr"&&(me.transferFunction=oe),me}):[]}(y),l=n.length,h=function(v,w,P){var D;let G=(D=v.audioCodec)==null?void 0:D.split(","),z=mr(v);return G&&v.audioGroups?v.audioGroups.reduce((H,oe)=>{var Se;let me=oe?(Se=w.groups[oe])==null?void 0:Se.tracks:null;return me?me.reduce((Te,Be)=>{if(Be.groupId===oe){let je=parseFloat(Be.channels||"");G.forEach(ge=>{let ze={contentType:fr(ge,"audio"),bitrate:P?function(Fe,rt){if(rt<=1)return 1;let st=128e3;return Fe==="ec-3"?st=768e3:Fe==="ac-3"&&(st=64e4),Math.min(rt/2,st)}(ge,z):z};je&&(ze.channels=""+je),Te.push(ze)})}return Te},H):H},[]):[]}(y,e,l>0),p=h.length;for(let v=l||1*p||1;v--;){let w={type:"media-source"};if(l&&(w.video=n[v%l]),p){w.audio=h[v%p];let P=w.audio.bitrate;w.video&&P&&(w.video.bitrate-=P)}a.push(w)}if(i){let v=navigator.userAgent;if(i.split(",").some(w=>ct(w))&&mt())return Promise.resolve(Kr(Error(`Overriding Windows Firefox HEVC MediaCapabilities result based on user-agent string: (${v})`),a))}return Promise.all(a.map(v=>{let w=function(P){let D="",{audio:G,video:z}=P;if(z){let H=ea(z.contentType);D+=`${H}_r${z.height}x${z.width}f${Math.ceil(z.framerate)}${z.transferFunction||"sd"}_${Math.ceil(z.bitrate/1e5)}`}if(G){let H=ea(G.contentType);D+=`${z?"_":""}${H}_c${G.channels}`}return D}(v);return r[w]||(r[w]=t.decodingInfo(v))})).then(v=>({supported:!v.some(w=>!w.supported),configurations:a,decodingInfoResults:v})).catch(v=>({supported:!1,configurations:a,decodingInfoResults:[],error:v}))}function mr(y){return 1e3*Math.ceil(Math.max(.9*y.bitrate,y.averageBitrate)/1e3)||1}let Er=["NONE","TYPE-0","TYPE-1",null],Dr=["SDR","PQ","HLG"];var Ar={No:"",Yes:"YES",v2:"v2"};function Br(y){let{canSkipUntil:e,canSkipDateRanges:t,age:r}=y;return e&&r<e/2?t?Ar.v2:Ar.Yes:Ar.No}class ba{constructor(e,t,r){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=r}addDirectives(e){let t=new ut.URL(e);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class Wr{constructor(e){if(this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.url=void 0,this.frameRate=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.supplemental=void 0,this.videoCodec=void 0,this.width=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.supportedPromise=void 0,this.supportedResult=void 0,this._avgBitrate=0,this._audioGroups=void 0,this._subtitleGroups=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.frameRate=e.attrs.optionalFloat("FRAME-RATE",0),this._avgBitrate=e.attrs.decimalInteger("AVERAGE-BANDWIDTH"),this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.codecSet=[e.videoCodec,e.audioCodec].filter(r=>!!r).map(r=>r.substring(0,4)).join(","),"supplemental"in e){var t;this.supplemental=e.supplemental;let r=(t=e.supplemental)==null?void 0:t.videoCodec;r&&r!==e.videoCodec&&(this.codecSet+=`,${r.substring(0,4)}`)}this.addGroupId("audio",e.attrs.AUDIO),this.addGroupId("text",e.attrs.SUBTITLES)}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get averageBitrate(){return this._avgBitrate||this.realBitrate||this.bitrate}get attrs(){return this._attrs[0]}get codecs(){return this.attrs.CODECS||""}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get videoRange(){return this.attrs["VIDEO-RANGE"]||"SDR"}get score(){return this.attrs.optionalFloat("SCORE",0)}get uri(){return this.url[0]||""}hasAudioGroup(e){return pi(this._audioGroups,e)}hasSubtitleGroup(e){return pi(this._subtitleGroups,e)}get audioGroups(){return this._audioGroups}get subtitleGroups(){return this._subtitleGroups}addGroupId(e,t){if(t){if(e==="audio"){let r=this._audioGroups;r||(r=this._audioGroups=[]),r.indexOf(t)===-1&&r.push(t)}else if(e==="text"){let r=this._subtitleGroups;r||(r=this._subtitleGroups=[]),r.indexOf(t)===-1&&r.push(t)}}}get urlId(){return 0}set urlId(e){}get audioGroupIds(){return this.audioGroups?[this.audioGroupId]:void 0}get textGroupIds(){return this.subtitleGroups?[this.textGroupId]:void 0}get audioGroupId(){var e;return(e=this.audioGroups)==null?void 0:e[0]}get textGroupId(){var e;return(e=this.subtitleGroups)==null?void 0:e[0]}addFallback(){}}function pi(y,e){return!!e&&!!y&&y.indexOf(e)!==-1}let Ba=y=>{let e=new WeakSet;return(t,r)=>{if(y&&(r=y(t,r)),typeof r=="object"&&r!==null){if(e.has(r))return;e.add(r)}return r}},Xt=(y,e)=>JSON.stringify(y,Ba(e));function ti(y,e){se.log(`[abr] start candidates with "${y}" ignored because ${e}`)}function Pa(y){return y.reduce((e,t)=>{let r=e.groups[t.groupId];r||(r=e.groups[t.groupId]={tracks:[],channels:{2:0},hasDefault:!1,hasAutoSelect:!1}),r.tracks.push(t);let i=t.channels||"2";return r.channels[i]=(r.channels[i]||0)+1,r.hasDefault=r.hasDefault||t.default,r.hasAutoSelect=r.hasAutoSelect||t.autoselect,r.hasDefault&&(e.hasDefaultAudio=!0),r.hasAutoSelect&&(e.hasAutoSelectAudio=!0),e},{hasDefaultAudio:!1,hasAutoSelectAudio:!1,groups:{}})}function $t(y){if(!y)return y;let{lang:e,assocLang:t,characteristics:r,channels:i,audioCodec:a}=y;return{lang:e,assocLang:t,characteristics:r,channels:i,audioCodec:a}}function Qt(y,e,t){if("attrs"in y){let r=e.indexOf(y);if(r!==-1)return r}for(let r=0;r<e.length;r++)if(Mi(y,e[r],t))return r;return-1}function Mi(y,e,t){let{groupId:r,name:i,lang:a,assocLang:n,default:l}=y,h=y.forced;return(r===void 0||e.groupId===r)&&(i===void 0||e.name===i)&&(a===void 0||function(p,v="--"){return p.length===v.length?p===v:p.startsWith(v)||v.startsWith(p)}(a,e.lang))&&(a===void 0||e.assocLang===n)&&(l===void 0||e.default===l)&&(h===void 0||e.forced===h)&&(!("characteristics"in y)||function(p,v=""){let w=p.split(","),P=v.split(",");return w.length===P.length&&!w.some(D=>P.indexOf(D)===-1)}(y.characteristics||"",e.characteristics))&&(t===void 0||t(y,e))}function Fi(y,e){let{audioCodec:t,channels:r}=y;return(t===void 0||(e.audioCodec||"").substring(0,4)===t.substring(0,4))&&(r===void 0||r===(e.channels||"2"))}function ji(y,e,t){for(let r=e;r>-1;r--)if(t(y[r]))return r;for(let r=e+1;r<y.length;r++)if(t(y[r]))return r;return-1}function _i(y,e){var t;return!!y&&y!==((t=e.loadLevelObj)==null?void 0:t.uri)}class ai extends L{constructor(e){super("abr",e.logger),this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=-1,this.firstSelection=-1,this._nextAutoLevel=-1,this.nextAutoLevelKey="",this.audioTracksByGroup=null,this.codecTiers=null,this.timer=-1,this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.rebufferNotice=-1,this.supportedCache={},this.bwEstimator=void 0,this._abandonRulesCheck=t=>{var r;let i,{fragCurrent:a,partCurrent:n,hls:l}=this,{autoLevelEnabled:h,media:p}=l;if(!a||!p)return;let v=performance.now(),w=n?n.stats:a.stats,P=n?n.duration:a.duration,D=v-w.loading.start,G=l.minAutoLevel,z=a.level,H=this._nextAutoLevel;if(w.aborted||w.loaded&&w.loaded===w.total||z<=G){this.clearTimer(),this._nextAutoLevel=-1;return}if(!h)return;let oe=H>-1&&H!==z,Se=!!t||oe;if(!Se&&(p.paused||!p.playbackRate||!p.readyState))return;let me=l.mainForwardBufferInfo;if(!Se&&me===null)return;let Te=this.bwEstimator.getEstimateTTFB(),Be=Math.abs(p.playbackRate);if(D<=Math.max(Te,P/(2*Be)*1e3))return;let je=me?me.len/Be:0,ge=w.loading.first?w.loading.first-w.loading.start:-1,ze=w.loaded&&ge>-1,Fe=this.getBwEstimate(),rt=l.levels,st=rt[z],kt=Math.max(w.loaded,Math.round(P*(a.bitrate||st.averageBitrate)/8)),Ye=ze?D-ge:D;Ye<1&&ze&&(Ye=Math.min(D,8*w.loaded/Fe));let et=ze?1e3*w.loaded/Ye:0,dt=Te/1e3,bt=et?(kt-w.loaded)/et:8*kt/Fe+dt;if(bt<=je)return;let _t=et?8*et:Fe,xt=((r=t?.details||this.hls.latestLevelDetails)==null?void 0:r.live)===!0,at=this.hls.config.abrBandWidthUpFactor,nt=Number.POSITIVE_INFINITY;for(i=z-1;i>G;i--){let Mt=rt[i].maxBitrate,Pt=!rt[i].details||xt;if((nt=this.getTimeToLoadFrag(dt,_t,P*Mt,Pt))<Math.min(je,P+dt))break}if(nt>=bt||nt>10*P)return;ze?this.bwEstimator.sample(D-Math.min(Te,ge),w.loaded):this.bwEstimator.sampleTTFB(D);let Zt=rt[i].maxBitrate;this.getBwEstimate()*at>Zt&&this.resetEstimator(Zt);let lr=this.findBestLevel(Zt,G,i,0,je,1,1);lr>-1&&(i=lr),this.warn(`Fragment ${a.sn}${n?" part "+n.index:""} of level ${z} is loading too slowly;
      Fragment duration: ${a.duration.toFixed(3)}
      Time to underbuffer: ${je.toFixed(3)} s
      Estimated load time for current fragment: ${bt.toFixed(3)} s
      Estimated load time for down switch fragment: ${nt.toFixed(3)} s
      TTFB estimate: ${0|ge} ms
      Current BW estimate: ${x(Fe)?0|Fe:"Unknown"} bps
      New BW estimate: ${0|this.getBwEstimate()} bps
      Switching to level ${i} @ ${0|Zt} bps`),l.nextLoadLevel=l.nextAutoLevel=i,this.clearTimer();let ar=()=>{if(this.clearTimer(),this.fragCurrent===a&&this.hls.loadLevel===i&&i>0){let Mt=this.getStarvationDelay();if(this.warn(`Aborting inflight request ${i>0?"and switching down":""}
      Fragment duration: ${a.duration.toFixed(3)} s
      Time to underbuffer: ${Mt.toFixed(3)} s`),a.abortRequests(),this.fragCurrent=this.partCurrent=null,i>G){let Pt=this.findBestLevel(this.hls.levels[G].bitrate,G,i,0,Mt,1,1);Pt===-1&&(Pt=G),this.hls.nextLoadLevel=this.hls.nextAutoLevel=Pt,this.resetEstimator(this.hls.levels[Pt].bitrate)}}};oe||bt>2*nt?ar():this.timer=ut.setInterval(ar,1e3*nt),l.trigger(o.FRAG_LOAD_EMERGENCY_ABORTED,{frag:a,part:n,stats:w})},this.hls=e,this.bwEstimator=this.initEstimator(),this.registerListeners()}resetEstimator(e){e&&(this.log(`setting initial bwe to ${e}`),this.hls.config.abrEwmaDefaultEstimate=e),this.firstSelection=-1,this.bwEstimator=this.initEstimator()}initEstimator(){let e=this.hls.config;return new I(e.abrEwmaSlowVoD,e.abrEwmaFastVoD,e.abrEwmaDefaultEstimate)}registerListeners(){let{hls:e}=this;e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.FRAG_LOADING,this.onFragLoading,this),e.on(o.FRAG_LOADED,this.onFragLoaded,this),e.on(o.FRAG_BUFFERED,this.onFragBuffered,this),e.on(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(o.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e&&(e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.FRAG_LOADING,this.onFragLoading,this),e.off(o.FRAG_LOADED,this.onFragLoaded,this),e.off(o.FRAG_BUFFERED,this.onFragBuffered,this),e.off(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(o.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.MAX_AUTO_LEVEL_UPDATED,this.onMaxAutoLevelUpdated,this),e.off(o.ERROR,this.onError,this))}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this._abandonRulesCheck=this.supportedCache=null,this.fragCurrent=this.partCurrent=null}onManifestLoading(e,t){this.lastLoadedFragLevel=-1,this.firstSelection=-1,this.lastLevelLoadSec=0,this.supportedCache={},this.fragCurrent=this.partCurrent=null,this.onLevelsUpdated(),this.clearTimer()}onLevelsUpdated(){this.lastLoadedFragLevel>-1&&this.fragCurrent&&(this.lastLoadedFragLevel=this.fragCurrent.level),this._nextAutoLevel=-1,this.onMaxAutoLevelUpdated(),this.codecTiers=null,this.audioTracksByGroup=null}onMaxAutoLevelUpdated(){this.firstSelection=-1,this.nextAutoLevelKey=""}onFragLoading(e,t){let r=t.frag;if(!this.ignoreFragment(r)){if(!r.bitrateTest){var i;this.fragCurrent=r,this.partCurrent=(i=t.part)!=null?i:null}this.clearTimer(),this.timer=ut.setInterval(this._abandonRulesCheck,100)}}onLevelSwitching(e,t){this.clearTimer()}onError(e,t){if(!t.fatal)switch(t.details){case d.BUFFER_ADD_CODEC_ERROR:case d.BUFFER_APPEND_ERROR:this.lastLoadedFragLevel=-1,this.firstSelection=-1;break;case d.FRAG_LOAD_TIMEOUT:{let r=t.frag,{fragCurrent:i,partCurrent:a}=this;if(r&&i&&r.sn===i.sn&&r.level===i.level){let n=performance.now(),l=a?a.stats:r.stats,h=n-l.loading.start,p=l.loading.first?l.loading.first-l.loading.start:-1;if(l.loaded&&p>-1){let v=this.bwEstimator.getEstimateTTFB();this.bwEstimator.sample(h-Math.min(v,p),l.loaded)}else this.bwEstimator.sampleTTFB(h)}}}}getTimeToLoadFrag(e,t,r,i){let a=i?e+this.lastLevelLoadSec:0;return e+r/t+a}onLevelLoaded(e,t){let r=this.hls.config,{loading:i}=t.stats,a=i.end-i.first;x(a)&&(this.lastLevelLoadSec=a/1e3),t.details.live?this.bwEstimator.update(r.abrEwmaSlowLive,r.abrEwmaFastLive):this.bwEstimator.update(r.abrEwmaSlowVoD,r.abrEwmaFastVoD),this.timer>-1&&this._abandonRulesCheck(t.levelInfo)}onFragLoaded(e,{frag:t,part:r}){let i=r?r.stats:t.stats;if(t.type===m.MAIN&&this.bwEstimator.sampleTTFB(i.loading.first-i.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),t.level===this._nextAutoLevel&&(this._nextAutoLevel=-1),this.firstSelection=-1,this.hls.config.abrMaxWithRealBitrate){let a=r?r.duration:t.duration,n=this.hls.levels[t.level],l=(n.loaded?n.loaded.bytes:0)+i.loaded,h=(n.loaded?n.loaded.duration:0)+a;n.loaded={bytes:l,duration:h},n.realBitrate=Math.round(8*l/h)}if(t.bitrateTest){let a={stats:i,frag:t,part:r,id:t.type};this.onFragBuffered(o.FRAG_BUFFERED,a),t.bitrateTest=!1}else this.lastLoadedFragLevel=t.level}}onFragBuffered(e,t){let{frag:r,part:i}=t,a=i!=null&&i.stats.loaded?i.stats:r.stats;if(a.aborted||this.ignoreFragment(r))return;let n=a.parsing.end-a.loading.start-Math.min(a.loading.first-a.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(n,a.loaded),a.bwEstimate=this.getBwEstimate(),r.bitrateTest?this.bitrateTestDelay=n/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==m.MAIN||e.sn==="initSegment"}clearTimer(){this.timer>-1&&(ut.clearInterval(this.timer),this.timer=-1)}get firstAutoLevel(){let{maxAutoLevel:e,minAutoLevel:t}=this.hls,r=this.getBwEstimate(),i=this.hls.config.maxStarvationDelay,a=this.findBestLevel(r,t,e,0,i,1,1);if(a>-1)return a;let n=this.hls.firstLevel,l=Math.min(Math.max(n,t),e);return this.warn(`Could not find best starting auto level. Defaulting to first in playlist ${n} clamped to ${l}`),l}get forcedAutoLevel(){return this.nextAutoLevelKey?-1:this._nextAutoLevel}get nextAutoLevel(){let e=this.forcedAutoLevel,t=this.bwEstimator.canEstimate(),r=this.lastLoadedFragLevel>-1;if(e!==-1&&(!t||!r||this.nextAutoLevelKey===this.getAutoLevelKey()))return e;let i=t&&r?this.getNextABRAutoLevel():this.firstAutoLevel;if(e!==-1){let a=this.hls.levels;if(a.length>Math.max(e,i)&&a[e].loadError<=a[i].loadError)return e}return this._nextAutoLevel=i,this.nextAutoLevelKey=this.getAutoLevelKey(),i}getAutoLevelKey(){return`${this.getBwEstimate()}_${this.getStarvationDelay().toFixed(2)}`}getNextABRAutoLevel(){let{fragCurrent:e,partCurrent:t,hls:r}=this;if(r.levels.length<=1)return r.loadLevel;let{maxAutoLevel:i,config:a,minAutoLevel:n}=r,l=t?t.duration:e?e.duration:0,h=this.getBwEstimate(),p=this.getStarvationDelay(),v=a.abrBandWidthFactor,w=a.abrBandWidthUpFactor;if(p){let H=this.findBestLevel(h,n,i,p,0,v,w);if(H>=0)return this.rebufferNotice=-1,H}let P=l?Math.min(l,a.maxStarvationDelay):a.maxStarvationDelay;if(!p){let H=this.bitrateTestDelay;H&&(P=(l?Math.min(l,a.maxLoadingDelay):a.maxLoadingDelay)-H,this.info(`bitrate test took ${Math.round(1e3*H)}ms, set first fragment max fetchDuration to ${Math.round(1e3*P)} ms`),v=w=1)}let D=this.findBestLevel(h,n,i,p,P,v,w);if(this.rebufferNotice!==D&&(this.rebufferNotice=D,this.info(`${p?"rebuffering expected":"buffer is empty"}, optimal quality level ${D}`)),D>-1)return D;let G=r.levels[n],z=r.loadLevelObj;return z&&G?.bitrate<z.bitrate?n:r.loadLevel}getStarvationDelay(){let e=this.hls,t=e.media;if(!t)return 1/0;let r=t&&t.playbackRate!==0?Math.abs(t.playbackRate):1,i=e.mainForwardBufferInfo;return(i?i.len:0)/r}getBwEstimate(){return this.bwEstimator.canEstimate()?this.bwEstimator.getEstimate():this.hls.config.abrEwmaDefaultEstimate}findBestLevel(e,t,r,i,a,n,l){var h,p;let v,w=i+a,P=this.lastLoadedFragLevel,D=P===-1?this.hls.firstLevel:P,{fragCurrent:G,partCurrent:z}=this,{levels:H,allAudioTracks:oe,loadLevel:Se,config:me}=this.hls;if(H.length===1)return 0;let Te=H[D],Be=!!((h=this.hls.latestLevelDetails)!=null&&h.live),je=Se===-1||P===-1,ge="SDR",ze=Te?.frameRate||0,{audioPreference:Fe,videoPreference:rt}=me,st=this.audioTracksByGroup||(this.audioTracksByGroup=Pa(oe)),kt=-1;if(je){if(this.firstSelection!==-1)return this.firstSelection;let bt=function(ar,Mt,Pt,nr,qt){let si=Object.keys(ar),$i=nr?.channels,Ut=nr?.audioCodec,oi=qt?.videoCodec,xi=$i&&parseInt($i)===2,fa=!1,Qi=!1,Ji=1/0,Ta=1/0,Lr=1/0,yn=1/0,An=0,Cn=[],{preferHDR:el,allowedVideoRanges:Oo}=function(ii,Ti){let Ea=!1,Rs=[];if(ii&&(Ea=ii!=="SDR",Rs=[ii]),Ti){let rl=(Rs=Ti.allowedVideoRanges||Dr.slice(0)).join("")!=="SDR"&&!Ti.videoCodec;(Ea=Ti.preferHDR!==void 0?Ti.preferHDR:rl&&function(){if(typeof matchMedia=="function"){let tl=matchMedia("(dynamic-range: high)"),il=matchMedia("bad query");if(tl.media!==il.media)return tl.matches===!0}return!1}())||(Rs=["SDR"])}return{preferHDR:Ea,allowedVideoRanges:Rs}}(Mt,qt);for(let ii=si.length;ii--;){let Ti=ar[si[ii]];fa||(fa=Ti.channels[2]>0),Ji=Math.min(Ji,Ti.minHeight),Ta=Math.min(Ta,Ti.minFramerate),Lr=Math.min(Lr,Ti.minBitrate),Oo.filter(Ea=>Ti.videoRanges[Ea]>0).length>0&&(Qi=!0)}Ji=x(Ji)?Ji:0,Ta=x(Ta)?Ta:0;let Mo=Math.max(1080,Ji),Xo=Math.max(30,Ta);Pt=Math.max(Lr=x(Lr)?Lr:Pt,Pt),Qi||(Mt=void 0);let Zo=si.length>1;return{codecSet:si.reduce((ii,Ti)=>{let Ea=ar[Ti];if(Ti===ii)return ii;if(Cn=Qi?Oo.filter(Rs=>Ea.videoRanges[Rs]>0):[],Zo){if(Ea.minBitrate>Pt)return ti(Ti,`min bitrate of ${Ea.minBitrate} > current estimate of ${Pt}`),ii;if(!Ea.hasDefaultAudio)return ti(Ti,"no renditions with default or auto-select sound found"),ii;if(Ut&&Ti.indexOf(Ut.substring(0,4))%5!=0)return ti(Ti,`audio codec preference "${Ut}" not found`),ii;if($i&&!xi){if(!Ea.channels[$i])return ti(Ti,`no renditions with ${$i} channel sound found (channels options: ${Object.keys(Ea.channels)})`),ii}else if((!Ut||xi)&&fa&&Ea.channels[2]===0)return ti(Ti,"no renditions with stereo sound found"),ii;if(Ea.minHeight>Mo)return ti(Ti,`min resolution of ${Ea.minHeight} > maximum of ${Mo}`),ii;if(Ea.minFramerate>Xo)return ti(Ti,`min framerate of ${Ea.minFramerate} > maximum of ${Xo}`),ii;if(!Cn.some(Rs=>Ea.videoRanges[Rs]>0))return ti(Ti,`no variants with VIDEO-RANGE of ${Xt(Cn)} found`),ii;if(oi&&Ti.indexOf(oi.substring(0,4))%5!=0)return ti(Ti,`video codec preference "${oi}" not found`),ii;if(Ea.maxScore<An)return ti(Ti,`max score of ${Ea.maxScore} < selected max of ${An}`),ii}return ii&&(li(Ti)>=li(ii)||Ea.fragmentError>ar[ii].fragmentError)?ii:(yn=Ea.minIndex,An=Ea.maxScore,Ti)},void 0),videoRanges:Cn,preferHDR:el,minFramerate:Ta,minBitrate:Lr,minIndex:yn}}(this.codecTiers||(this.codecTiers=H.slice(t,r+1).reduce((ar,Mt,Pt)=>{if(!Mt.codecSet)return ar;let nr=Mt.audioGroups,qt=ar[Mt.codecSet];qt||(ar[Mt.codecSet]=qt={minBitrate:1/0,minHeight:1/0,minFramerate:1/0,minIndex:Pt,maxScore:0,videoRanges:{SDR:0},channels:{2:0},hasDefaultAudio:!nr,fragmentError:0}),qt.minBitrate=Math.min(qt.minBitrate,Mt.bitrate);let si=Math.min(Mt.height,Mt.width);return qt.minHeight=Math.min(qt.minHeight,si),qt.minFramerate=Math.min(qt.minFramerate,Mt.frameRate),qt.minIndex=Math.min(qt.minIndex,Pt),qt.maxScore=Math.max(qt.maxScore,Mt.score),qt.fragmentError+=Mt.fragmentError,qt.videoRanges[Mt.videoRange]=(qt.videoRanges[Mt.videoRange]||0)+1,nr&&nr.forEach($i=>{if(!$i)return;let Ut=st.groups[$i];Ut&&(qt.hasDefaultAudio=qt.hasDefaultAudio||st.hasDefaultAudio?Ut.hasDefault:Ut.hasAutoSelect||!st.hasDefaultAudio&&!st.hasAutoSelectAudio,Object.keys(Ut.channels).forEach(oi=>{qt.channels[oi]=(qt.channels[oi]||0)+Ut.channels[oi]}))}),ar},{})),ge,e,Fe,rt),{codecSet:_t,videoRanges:xt,minFramerate:at,minBitrate:nt,minIndex:Zt,preferHDR:lr}=bt;kt=Zt,v=_t,ge=lr?xt[xt.length-1]:xt[0],ze=at,e=Math.max(e,nt),this.log(`picked start tier ${Xt(bt)}`)}else v=Te?.codecSet,ge=Te?.videoRange;let Ye=z?z.duration:G?G.duration:0,et=this.bwEstimator.getEstimateTTFB()/1e3,dt=[];for(let bt=r;bt>=t;bt--){let _t,xt=H[bt],at=bt>D;if(!xt)continue;if(me.useMediaCapabilities&&!xt.supportedResult&&!xt.supportedPromise){let Mt=navigator.mediaCapabilities;typeof Mt?.decodingInfo=="function"&&function(Pt,nr,qt,si,$i,Ut){let oi=Pt.videoCodec,xi=Pt.audioCodec?Pt.audioGroups:null,fa=Ut?.audioCodec,Qi=Ut?.channels,Ji=Qi?parseInt(Qi):fa?1/0:2,Ta=null;if(xi!=null&&xi.length)try{Ta=xi.length===1&&xi[0]?nr.groups[xi[0]].channels:xi.reduce((Lr,yn)=>{if(yn){let An=nr.groups[yn];if(!An)throw Error(`Audio track group ${yn} not found`);Object.keys(An.channels).forEach(Cn=>{Lr[Cn]=(Lr[Cn]||0)+An.channels[Cn]})}return Lr},{2:0})}catch{return!0}return oi!==void 0&&(oi.split(",").some(Lr=>ct(Lr))||Pt.width>1920&&Pt.height>1088||Pt.height>1920&&Pt.width>1088||Pt.frameRate>Math.max(si,30)||Pt.videoRange!=="SDR"&&Pt.videoRange!==qt||Pt.bitrate>Math.max($i,8e6))||!!Ta&&x(Ji)&&Object.keys(Ta).some(Lr=>parseInt(Lr)>Ji)}(xt,st,ge,ze,e,Fe)?(xt.supportedPromise=Ni(xt,st,Mt,this.supportedCache),xt.supportedPromise.then(Pt=>{if(!this.hls)return;xt.supportedResult=Pt;let nr=this.hls.levels,qt=nr.indexOf(xt);Pt.error?this.warn(`MediaCapabilities decodingInfo error: "${Pt.error}" for level ${qt} ${Xt(Pt)}`):Pt.supported?Pt.decodingInfoResults.some(si=>si.smooth===!1||si.powerEfficient===!1)&&this.log(`MediaCapabilities decodingInfo for level ${qt} not smooth or powerEfficient: ${Xt(Pt)}`):(this.warn(`Unsupported MediaCapabilities decodingInfo result for level ${qt} ${Xt(Pt)}`),qt>-1&&nr.length>1&&(this.log(`Removing unsupported level ${qt}`),this.hls.removeLevel(qt),this.hls.loadLevel===-1&&(this.hls.nextLoadLevel=0)))}).catch(Pt=>{this.warn(`Error handling MediaCapabilities decodingInfo: ${Pt}`)})):xt.supportedResult=na}if((v&&xt.codecSet!==v||ge&&xt.videoRange!==ge||at&&ze>xt.frameRate||!at&&ze>0&&ze<xt.frameRate||(p=xt.supportedResult)!=null&&(p=p.decodingInfoResults)!=null&&p.some(Mt=>Mt.smooth===!1))&&(!je||bt!==kt)){dt.push(bt);continue}let nt=xt.details,Zt=(z?nt?.partTarget:nt?.averagetargetduration)||Ye;_t=at?l*e:n*e;let lr=Ye&&i>=2*Ye&&a===0?xt.averageBitrate:xt.maxBitrate,ar=this.getTimeToLoadFrag(et,_t,lr*Zt,nt===void 0);if(_t>=lr&&(bt===P||xt.loadError===0&&xt.fragmentError===0)&&(ar<=et||!x(ar)||Be&&!this.bitrateTestDelay||ar<w)){let Mt=this.forcedAutoLevel;return bt!==Se&&(Mt===-1||Mt!==Se)&&(dt.length&&this.trace(`Skipped level(s) ${dt.join(",")} of ${r} max with CODECS and VIDEO-RANGE:"${H[dt[0]].codecs}" ${H[dt[0]].videoRange}; not compatible with "${v}" ${ge}`),this.info(`switch candidate:${D}->${bt} adjustedbw(${Math.round(_t)})-bitrate=${Math.round(_t-lr)} ttfb:${et.toFixed(1)} avgDuration:${Zt.toFixed(1)} maxFetchDuration:${w.toFixed(1)} fetchDuration:${ar.toFixed(1)} firstSelection:${je} codecSet:${xt.codecSet} videoRange:${xt.videoRange} hls.loadLevel:${Se}`)),je&&(this.firstSelection=bt),bt}}return-1}set nextAutoLevel(e){let t=this.deriveNextAutoLevel(e);this._nextAutoLevel!==t&&(this.nextAutoLevelKey="",this._nextAutoLevel=t)}deriveNextAutoLevel(e){let{maxAutoLevel:t,minAutoLevel:r}=this.hls;return Math.min(Math.max(e,r),t)}}let di={search:function(y,e){let t=0,r=y.length-1,i=null,a=null;for(;t<=r;){let n=e(a=y[i=(t+r)/2|0]);if(n>0)t=i+1;else{if(!(n<0))return a;r=i-1}}return null}};function gi(y,e,t=0,r=0,i=.005){let a=null;if(y){a=e[1+y.sn-e[0].sn]||null;let l=y.endDTS-t;l>0&&l<15e-7&&(t+=15e-7),a&&y.level!==a.level&&a.end<=y.end&&(a=e[2+y.sn-e[0].sn]||null)}else t===0&&e[0].start===0&&(a=e[0]);if(a&&((!y||y.level===a.level)&&hi(t,r,a)===0||function(l,h,p){if(h&&h.start===0&&h.level<l.level&&(h.endPTS||0)>0){let v=h.tagList.reduce((w,P)=>(P[0]==="INF"&&(w+=parseFloat(P[1])),w),p);return l.start<=v}return!1}(a,y,Math.min(i,r))))return a;let n=di.search(e,hi.bind(null,t,r));return n&&(n!==y||!a)?n:a}function hi(y=0,e=0,t){if(t.start<=y&&t.start+t.duration>y)return 0;let r=Math.min(e,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-r<=y?1:t.start-r>y&&t.start?-1:0}function Ri(y,e,t){if(y&&y.startCC<=e&&y.endCC>=e){let r,i=y.fragments,{fragmentHint:a}=y;return a&&(i=i.concat(a)),di.search(i,n=>n.cc<e?1:n.cc>e?-1:(r=n,n.end<=t?1:n.start>t?-1:0)),r||null}return null}function fi(y){switch(y.details){case d.FRAG_LOAD_TIMEOUT:case d.KEY_LOAD_TIMEOUT:case d.LEVEL_LOAD_TIMEOUT:case d.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function Ai(y,e){let t=fi(e);return y.default[`${t?"timeout":"error"}Retry`]}function Bi(y,e){return Math.min((y.backoff==="linear"?1:Math.pow(2,e))*y.retryDelayMs,y.maxRetryDelayMs)}function mi(y){return F(F({},y),{errorRetry:null,timeoutRetry:null})}function zr(y,e,t,r){if(!y)return!1;let i=r?.code,a=e<y.maxNumRetry&&(Gi(i)||!!i&&(i<400||i>499)||!!t);return y.shouldRetry?y.shouldRetry(y,e,t,r,a):a}function Gi(y){return y===0&&navigator.onLine===!1}var Yr={DoNothing:0,SendAlternateToPenaltyBox:2,RemoveAlternatePermanently:3,RetryRequest:5},yi={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2,MoveAllAlternatesMatchingKey:4};class Na extends L{constructor(e){super("error-controller",e.logger),this.hls=void 0,this.playlistError=0,this.hls=e,this.registerListeners()}registerListeners(){let e=this.hls;e.on(o.ERROR,this.onError,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let e=this.hls;e&&(e.off(o.ERROR,this.onError,this),e.off(o.ERROR,this.onErrorOut,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null}startLoad(e){}stopLoad(){this.playlistError=0}getVariantLevelIndex(e){return e?.type===m.MAIN?e.level:this.getVariantIndex()}getVariantIndex(){var e;let t=this.hls,r=t.currentLevel;return(e=t.loadLevelObj)!=null&&e.details||r===-1?t.loadLevel:r}variantHasKey(e,t){if(e){var r;if((r=e.details)!=null&&r.hasKey(t))return!0;let i=e.audioGroups;if(i)return this.hls.allAudioTracks.filter(a=>i.indexOf(a.groupId)>=0).some(a=>{var n;return(n=a.details)==null?void 0:n.hasKey(t)})}return!1}onManifestLoading(){this.playlistError=0}onLevelUpdated(){this.playlistError=0}onError(e,t){var r,i,a;if(t.fatal)return;let n=this.hls,l=t.context;switch(t.details){case d.FRAG_LOAD_ERROR:case d.FRAG_LOAD_TIMEOUT:case d.KEY_LOAD_ERROR:case d.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case d.FRAG_PARSING_ERROR:if((r=t.frag)!=null&&r.gap){t.errorAction=Fa();return}case d.FRAG_GAP:case d.FRAG_DECRYPT_ERROR:t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=Yr.SendAlternateToPenaltyBox;return;case d.LEVEL_EMPTY_ERROR:case d.LEVEL_PARSING_ERROR:{let h=t.parent===m.MAIN?t.level:n.loadLevel;t.details===d.LEVEL_EMPTY_ERROR&&(i=t.context)!=null&&(i=i.levelDetails)!=null&&i.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,h):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,h))}return;case d.LEVEL_LOAD_ERROR:case d.LEVEL_LOAD_TIMEOUT:typeof l?.level=="number"&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,l.level));return;case d.AUDIO_TRACK_LOAD_ERROR:case d.AUDIO_TRACK_LOAD_TIMEOUT:case d.SUBTITLE_LOAD_ERROR:case d.SUBTITLE_TRACK_LOAD_TIMEOUT:if(l){let h=n.loadLevelObj;h&&(l.type===f.AUDIO_TRACK&&h.hasAudioGroup(l.groupId)||l.type===f.SUBTITLE_TRACK&&h.hasSubtitleGroup(l.groupId))&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,n.loadLevel),t.errorAction.action=Yr.SendAlternateToPenaltyBox,t.errorAction.flags=yi.MoveAllAlternatesMatchingHost)}return;case d.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:t.errorAction={action:Yr.SendAlternateToPenaltyBox,flags:yi.MoveAllAlternatesMatchingHDCP};return;case d.KEY_SYSTEM_SESSION_UPDATE_FAILED:case d.KEY_SYSTEM_STATUS_INTERNAL_ERROR:case d.KEY_SYSTEM_NO_SESSION:t.errorAction={action:Yr.SendAlternateToPenaltyBox,flags:yi.MoveAllAlternatesMatchingKey};return;case d.BUFFER_ADD_CODEC_ERROR:case d.REMUX_ALLOC_ERROR:case d.BUFFER_APPEND_ERROR:t.errorAction||(t.errorAction=this.getLevelSwitchAction(t,(a=t.level)!=null?a:n.loadLevel));return;case d.INTERNAL_EXCEPTION:case d.BUFFER_APPENDING_ERROR:case d.BUFFER_FULL_ERROR:case d.LEVEL_SWITCH_ERROR:case d.BUFFER_STALLED_ERROR:case d.BUFFER_SEEK_OVER_HOLE:case d.BUFFER_NUDGE_ON_STALL:t.errorAction=Fa();return}t.type===S.KEY_SYSTEM_ERROR&&(t.levelRetry=!1,t.errorAction=Fa())}getPlaylistRetryOrSwitchAction(e,t){let r=Ai(this.hls.config.playlistLoadPolicy,e),i=this.playlistError++;if(zr(r,i,fi(e),e.response))return{action:Yr.RetryRequest,flags:yi.None,retryConfig:r,retryCount:i};let a=this.getLevelSwitchAction(e,t);return r&&(a.retryConfig=r,a.retryCount=i),a}getFragRetryOrSwitchAction(e){let t=this.hls,r=this.getVariantLevelIndex(e.frag),i=t.levels[r],{fragLoadPolicy:a,keyLoadPolicy:n}=t.config,l=Ai(e.details.startsWith("key")?n:a,e),h=t.levels.reduce((v,w)=>v+w.fragmentError,0);if(i&&(e.details!==d.FRAG_GAP&&i.fragmentError++,zr(l,h,fi(e),e.response)))return{action:Yr.RetryRequest,flags:yi.None,retryConfig:l,retryCount:h};let p=this.getLevelSwitchAction(e,r);return l&&(p.retryConfig=l,p.retryCount=h),p}getLevelSwitchAction(e,t){let r=this.hls;t==null&&(t=r.loadLevel);let i=this.hls.levels[t];if(i){var a,n,l,h;let p=e.details;i.loadError++,p===d.BUFFER_APPEND_ERROR&&i.fragmentError++;let v=-1,{levels:w,loadLevel:P,minAutoLevel:D,maxAutoLevel:G}=r;r.autoLevelEnabled||r.config.preserveManualLevelOnError||(r.loadLevel=-1);let z=(a=e.frag)==null?void 0:a.type,H=(z===m.AUDIO&&p===d.FRAG_PARSING_ERROR||e.sourceBufferName==="audio"&&(p===d.BUFFER_ADD_CODEC_ERROR||p===d.BUFFER_APPEND_ERROR))&&w.some(({audioCodec:Te})=>i.audioCodec!==Te),oe=e.sourceBufferName==="video"&&(p===d.BUFFER_ADD_CODEC_ERROR||p===d.BUFFER_APPEND_ERROR)&&w.some(({codecSet:Te,audioCodec:Be})=>i.codecSet!==Te&&i.audioCodec===Be),{type:Se,groupId:me}=(n=e.context)!=null?n:{};for(let Te=w.length;Te--;){let Be=(Te+P)%w.length;if(Be!==P&&Be>=D&&Be<=G&&w[Be].loadError===0){let je=w[Be];if(p===d.FRAG_GAP&&z===m.MAIN&&e.frag){let ge=w[Be].details;if(ge){let ze=gi(e.frag,ge.fragments,e.frag.start);if(ze!=null&&ze.gap)continue}}else{if(Se===f.AUDIO_TRACK&&je.hasAudioGroup(me)||Se===f.SUBTITLE_TRACK&&je.hasSubtitleGroup(me))continue;if(z===m.AUDIO&&(l=i.audioGroups)!=null&&l.some(ge=>je.hasAudioGroup(ge))||z===m.SUBTITLE&&(h=i.subtitleGroups)!=null&&h.some(ge=>je.hasSubtitleGroup(ge))||H&&i.audioCodec===je.audioCodec||oe&&i.codecSet===je.codecSet||!H&&i.codecSet!==je.codecSet)continue}v=Be;break}}if(v>-1&&r.loadLevel!==v)return e.levelRetry=!0,this.playlistError=0,{action:Yr.SendAlternateToPenaltyBox,flags:yi.None,nextAutoLevel:v}}return{action:Yr.SendAlternateToPenaltyBox,flags:yi.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var r;switch((r=t.errorAction)==null?void 0:r.action){case Yr.DoNothing:break;case Yr.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===d.FRAG_GAP?/MediaSource readyState: ended/.test(t.error.message)&&(this.warn(`MediaSource ended after "${t.sourceBufferName}" sourceBuffer append error. Attempting to recover from media error.`),this.hls.recoverMediaError()):t.fatal=!0;case Yr.RetryRequest:}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){let t=this.hls,r=e.errorAction;if(!r)return;let{flags:i}=r,a=r.nextAutoLevel;switch(i){case yi.None:this.switchLevel(e,a);break;case yi.MoveAllAlternatesMatchingHDCP:{let h=this.getVariantLevelIndex(e.frag),p=t.levels[h],v=p?.attrs["HDCP-LEVEL"];if(r.hdcpLevel=v,v){t.maxHdcpLevel=Er[Er.indexOf(v)-1],r.resolved=!0,this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`);break}}case yi.MoveAllAlternatesMatchingKey:{let h=e.decryptdata;if(h){let p=this.hls.levels;for(let v=p.length;v--;)if(this.variantHasKey(p[v],h)){var n,l;this.log(`Banned key found in level ${v} (${p[v].bitrate}bps) or audio group "${(n=p[v].audioGroups)==null?void 0:n.join(",")}" (${(l=e.frag)==null?void 0:l.type} fragment) ${b(h.keyId||[])}`),p[v].fragmentError++,p[v].loadError++,this.log(`Removing level ${v} with key error (${e.error})`),this.hls.removeLevel(v)}p.length&&(r.resolved=!0)}}}r.resolved||this.switchLevel(e,a)}switchLevel(e,t){if(t!==void 0&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel,e.details===d.BUFFER_ADD_CODEC_ERROR&&e.mimeType&&e.sourceBufferName!=="audiovideo")){let r=ea(e.mimeType),i=this.hls.levels;for(let a=i.length;a--;)i[a][`${e.sourceBufferName}Codec`]===r&&(this.log(`Removing level ${a} for ${e.details} ("${r}" not supported)`),this.hls.removeLevel(a))}}}function Fa(y){let e={action:Yr.DoNothing,flags:yi.None};return y&&(e.resolved=!0),e}var Xr={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class Hi{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){let{hls:e}=this;e&&(e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.BUFFER_APPENDED,this.onBufferAppended,this),e.on(o.FRAG_BUFFERED,this.onFragBuffered,this),e.on(o.FRAG_LOADED,this.onFragLoaded,this))}_unregisterListeners(){let{hls:e}=this;e&&(e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.BUFFER_APPENDED,this.onBufferAppended,this),e.off(o.FRAG_BUFFERED,this.onFragBuffered,this),e.off(o.FRAG_LOADED,this.onFragLoaded,this))}destroy(){this._unregisterListeners(),this.hls=this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){let r=this.activePartLists[t];if(r)for(let i=r.length;i--;){let a=r[i];if(!a)break;if(a.start<=e&&e<=a.end&&a.loaded)return a}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){return this.getFragAtPos(e,t,!0)}getFragAtPos(e,t,r){let{fragments:i}=this,a=Object.keys(i);for(let n=a.length;n--;){let l=i[a[n]];if(l?.body.type===t&&(!r||l.buffered)){let h=l.body;if(h.start<=e&&e<=h.end)return h}}return null}detectEvictedFragments(e,t,r,i,a){this.timeRanges&&(this.timeRanges[e]=t);let n=i?.fragment.sn||-1;Object.keys(this.fragments).forEach(l=>{let h=this.fragments[l];if(!h||n>=h.body.sn)return;if(!h.buffered&&(!h.loaded||a)){h.body.type===r&&this.removeFragment(h.body);return}let p=h.range[e];if(p){if(p.time.length===0){this.removeFragment(h.body);return}p.time.some(v=>{let w=!this.isTimeBuffered(v.startPTS,v.endPTS,t);return w&&this.removeFragment(h.body),w})}})}detectPartialFragments(e){let t=this.timeRanges;if(!t||e.frag.sn==="initSegment")return;let r=e.frag,i=dn(r),a=this.fragments[i];if(!a||a.buffered&&r.gap)return;let n=!r.relurl;Object.keys(t).forEach(l=>{let h=r.elementaryStreams[l];if(!h)return;let p=t[l],v=n||h.partial===!0;a.range[l]=this.getBufferedTimes(r,e.part,v,p)}),a.loaded=null,Object.keys(a.range).length?(a.buffered=!0,(a.body.endList=r.endList||a.body.endList)&&(this.endListFragments[a.body.type]=a),ln(a)||this.removeParts(r.sn-1,r.type)):this.removeFragment(a.body)}removeParts(e,t){let r=this.activePartLists[t];r&&(this.activePartLists[t]=un(r,i=>i.fragment.sn>=e))}fragBuffered(e,t){let r=dn(e),i=this.fragments[r];!i&&t&&(i=this.fragments[r]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),i&&(i.loaded=null,i.buffered=!0)}getBufferedTimes(e,t,r,i){let a={time:[],partial:r},n=e.start,l=e.end,h=e.minEndPTS||l,p=e.maxStartPTS||n;for(let v=0;v<i.length;v++){let w=i.start(v)-this.bufferPadding,P=i.end(v)+this.bufferPadding;if(p>=w&&h<=P){a.time.push({startPTS:Math.max(n,i.start(v)),endPTS:Math.min(l,i.end(v))});break}if(n<P&&l>w){let D=Math.max(n,i.start(v)),G=Math.min(l,i.end(v));G>D&&(a.partial=!0,a.time.push({startPTS:D,endPTS:G}))}else if(l<=w)break}return a}getPartialFragment(e){let t,r,i,a=null,n=0,{bufferPadding:l,fragments:h}=this;return Object.keys(h).forEach(p=>{let v=h[p];v&&ln(v)&&(r=v.body.start-l,i=v.body.end+l,e>=r&&e<=i&&n<=(t=Math.min(e-r,i-e))&&(a=v.body,n=t))}),a}isEndListAppended(e){let t=this.endListFragments[e];return t!==void 0&&(t.buffered||ln(t))}getState(e){let t=dn(e),r=this.fragments[t];return r?r.buffered?ln(r)?Xr.PARTIAL:Xr.OK:Xr.APPENDING:Xr.NOT_LOADED}isTimeBuffered(e,t,r){let i,a;for(let n=0;n<r.length;n++){if(i=r.start(n)-this.bufferPadding,a=r.end(n)+this.bufferPadding,e>=i&&t<=a)return!0;if(t<=i)break}return!1}onManifestLoading(){this.removeAllFragments()}onFragLoaded(e,t){if(t.frag.sn==="initSegment"||t.frag.bitrateTest)return;let r=t.frag,i=t.part?null:t,a=dn(r);this.fragments[a]={body:r,appendedPTS:null,loaded:i,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){let{frag:r,part:i,timeRanges:a,type:n}=t;if(r.sn==="initSegment")return;let l=r.type;if(i){let p=this.activePartLists[l];p||(this.activePartLists[l]=p=[]),p.push(i)}this.timeRanges=a;let h=a[n];this.detectEvictedFragments(n,h,l,i)}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){let t=dn(e);return!!this.fragments[t]}hasFragments(e){let{fragments:t}=this,r=Object.keys(t);if(!e)return r.length>0;for(let i=r.length;i--;){let a=t[r[i]];if(a?.body.type===e)return!0}return!1}hasParts(e){var t;return!!((t=this.activePartLists[e])!=null&&t.length)}removeFragmentsInRange(e,t,r,i,a){(!i||this.hasGaps)&&Object.keys(this.fragments).forEach(n=>{let l=this.fragments[n];if(!l)return;let h=l.body;h.type===r&&(!i||h.gap)&&h.start<t&&h.end>e&&(l.buffered||a)&&this.removeFragment(h)})}removeFragment(e){let t=dn(e);e.clearElementaryStreamInfo();let r=this.activePartLists[e.type];if(r){let i=e.sn;this.activePartLists[e.type]=un(r,a=>a.fragment.sn!==i)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){var e;this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1;let t=(e=this.hls)==null||(e=e.latestLevelDetails)==null?void 0:e.partList;t&&t.forEach(r=>r.clearElementaryStreamInfo())}}function ln(y){var e,t,r;return y.buffered&&!!(y.body.gap||(e=y.range.video)!=null&&e.partial||(t=y.range.audio)!=null&&t.partial||(r=y.range.audiovideo)!=null&&r.partial)}function dn(y){return`${y.type}_${y.level}_${y.sn}`}function un(y,e){return y.filter(t=>{let r=e(t);return r||t.clearElementaryStreamInfo(),r})}var tn={cbc:0,ctr:1};class ss{constructor(e,t,r){this.subtle=void 0,this.aesIV=void 0,this.aesMode=void 0,this.subtle=e,this.aesIV=t,this.aesMode=r}decrypt(e,t){switch(this.aesMode){case tn.cbc:return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e);case tn.ctr:return this.subtle.decrypt({name:"AES-CTR",counter:this.aesIV,length:64},t,e);default:throw Error(`[AESCrypto] invalid aes mode ${this.aesMode}`)}}}class Wn{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){let t=new DataView(e),r=new Uint32Array(4);for(let i=0;i<4;i++)r[i]=t.getUint32(4*i);return r}initTable(){let e=this.sBox,t=this.invSBox,r=this.subMix,i=r[0],a=r[1],n=r[2],l=r[3],h=this.invSubMix,p=h[0],v=h[1],w=h[2],P=h[3],D=new Uint32Array(256),G=0,z=0,H=0;for(H=0;H<256;H++)H<128?D[H]=H<<1:D[H]=H<<1^283;for(H=0;H<256;H++){let oe=z^z<<1^z<<2^z<<3^z<<4;oe=oe>>>8^255&oe^99,e[G]=oe,t[oe]=G;let Se=D[G],me=D[Se],Te=D[me],Be=257*D[oe]^16843008*oe;i[G]=Be<<24|Be>>>8,a[G]=Be<<16|Be>>>16,n[G]=Be<<8|Be>>>24,l[G]=Be,Be=16843009*Te^65537*me^257*Se^16843008*G,p[oe]=Be<<24|Be>>>8,v[oe]=Be<<16|Be>>>16,w[oe]=Be<<8|Be>>>24,P[oe]=Be,G?(G=Se^D[D[D[Te^Se]]],z^=D[D[z]]):G=z=1}}expandKey(e){let t,r,i,a,n=this.uint8ArrayToUint32Array_(e),l=!0,h=0;for(;h<n.length&&l;)l=n[h]===this.key[h],h++;if(l)return;this.key=n;let p=this.keySize=n.length;if(p!==4&&p!==6&&p!==8)throw Error("Invalid aes key size="+p);let v=this.ksRows=(p+6+1)*4,w=this.keySchedule=new Uint32Array(v),P=this.invKeySchedule=new Uint32Array(v),D=this.sBox,G=this.rcon,z=this.invSubMix,H=z[0],oe=z[1],Se=z[2],me=z[3];for(t=0;t<v;t++){if(t<p){i=w[t]=n[t];continue}a=i,t%p==0?a=(D[(a=a<<8|a>>>24)>>>24]<<24|D[a>>>16&255]<<16|D[a>>>8&255]<<8|D[255&a])^G[t/p|0]<<24:p>6&&t%p==4&&(a=D[a>>>24]<<24|D[a>>>16&255]<<16|D[a>>>8&255]<<8|D[255&a]),w[t]=i=(w[t-p]^a)>>>0}for(r=0;r<v;r++)t=v-r,a=3&r?w[t]:w[t-4],r<4||t<=4?P[r]=a:P[r]=H[D[a>>>24]]^oe[D[a>>>16&255]]^Se[D[a>>>8&255]]^me[D[255&a]],P[r]=P[r]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,r){let i,a,n,l,h,p,v,w,P,D,G,z,H,oe,Se=this.keySize+6,me=this.invKeySchedule,Te=this.invSBox,Be=this.invSubMix,je=Be[0],ge=Be[1],ze=Be[2],Fe=Be[3],rt=this.uint8ArrayToUint32Array_(r),st=rt[0],kt=rt[1],Ye=rt[2],et=rt[3],dt=new Int32Array(e),bt=new Int32Array(dt.length),_t=this.networkToHostOrderSwap;for(;t<dt.length;){for(oe=1,P=_t(dt[t]),D=_t(dt[t+1]),G=_t(dt[t+2]),z=_t(dt[t+3]),h=P^me[0],p=z^me[1],v=G^me[2],w=D^me[3],H=4;oe<Se;oe++)i=je[h>>>24]^ge[p>>16&255]^ze[v>>8&255]^Fe[255&w]^me[H],a=je[p>>>24]^ge[v>>16&255]^ze[w>>8&255]^Fe[255&h]^me[H+1],n=je[v>>>24]^ge[w>>16&255]^ze[h>>8&255]^Fe[255&p]^me[H+2],l=je[w>>>24]^ge[h>>16&255]^ze[p>>8&255]^Fe[255&v]^me[H+3],h=i,p=a,v=n,w=l,H+=4;i=Te[h>>>24]<<24^Te[p>>16&255]<<16^Te[v>>8&255]<<8^Te[255&w]^me[H],a=Te[p>>>24]<<24^Te[v>>16&255]<<16^Te[w>>8&255]<<8^Te[255&h]^me[H+1],n=Te[v>>>24]<<24^Te[w>>16&255]<<16^Te[h>>8&255]<<8^Te[255&p]^me[H+2],l=Te[w>>>24]<<24^Te[h>>16&255]<<16^Te[p>>8&255]<<8^Te[255&v]^me[H+3],bt[t]=_t(i^st),bt[t+1]=_t(l^kt),bt[t+2]=_t(n^Ye),bt[t+3]=_t(a^et),st=P,kt=D,Ye=G,et=z,t+=4}return bt.buffer}}class zn{constructor(e,t,r){this.subtle=void 0,this.key=void 0,this.aesMode=void 0,this.subtle=e,this.key=t,this.aesMode=r}expandKey(){let e=function(t){switch(t){case tn.cbc:return"AES-CBC";case tn.ctr:return"AES-CTR";default:throw Error(`[FastAESKey] invalid aes mode ${t}`)}}(this.aesMode);return this.subtle.importKey("raw",this.key,{name:e},!1,["encrypt","decrypt"])}}class vn{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.enableSoftwareAES=void 0,this.enableSoftwareAES=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{let r=ut.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch{}this.useSoftware=!this.subtle}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;let r=new Uint8Array(e);return this.reset(),this.removePKCS7Padding?function(i){let a=i.byteLength,n=a&&new DataView(i.buffer).getUint8(a-1);return n?i.slice(0,a-n):i}(r):r}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,r,i){return this.useSoftware?new Promise((a,n)=>{let l=ArrayBuffer.isView(e)?e:new Uint8Array(e);this.softwareDecrypt(l,t,r,i);let h=this.flush();h?a(h.buffer):n(Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,r,i)}softwareDecrypt(e,t,r,i){let{currentIV:a,currentResult:n,remainderData:l}=this;if(i!==tn.cbc||t.byteLength!==16)return se.warn("SoftwareDecrypt: can only handle AES-128-CBC"),null;this.logOnce("JS AES decrypt"),l&&(e=tt(l,e),this.remainderData=null);let h=this.getValidChunk(e);if(!h.length)return null;a&&(r=a);let p=this.softwareDecrypter;return p||(p=this.softwareDecrypter=new Wn),p.expandKey(t),this.currentResult=p.decrypt(h.buffer,0,r),this.currentIV=h.slice(-16).buffer,n||null}webCryptoDecrypt(e,t,r,i){if(this.key!==t||!this.fastAesKey){if(!this.subtle)return Promise.resolve(this.onWebCryptoError(e,t,r,i));this.key=t,this.fastAesKey=new zn(this.subtle,t,i)}return this.fastAesKey.expandKey().then(a=>this.subtle?(this.logOnce("WebCrypto AES decrypt"),new ss(this.subtle,new Uint8Array(r),i).decrypt(e.buffer,a)):Promise.reject(Error("web crypto not initialized"))).catch(a=>(se.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${a.name}: ${a.message}`),this.onWebCryptoError(e,t,r,i)))}onWebCryptoError(e,t,r,i){let a=this.enableSoftwareAES;if(a){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,r,i);let n=this.flush();if(n)return n.buffer}throw Error("WebCrypto"+(a?" and softwareDecrypt":"")+": failed to decrypt data")}getValidChunk(e){let t=e,r=e.length-e.length%16;return r!==e.length&&(t=e.slice(0,r),this.remainderData=e.slice(r)),t}logOnce(e){this.logEnabled&&(se.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}class In{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){let r=e.url;if(!r)return Promise.reject(new Aa({type:S.NETWORK_ERROR,details:d.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:Error(`Fragment does not have a ${r?"part list":"url"}`),networkDetails:null}));this.abort();let i=this.config,a=i.fLoader,n=i.loader;return new Promise((l,h)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(G=>G[0]==="GAP")){h(Ln(e));return}e.gap=!1}let p=this.loader=a?new a(i):new n(i),v=$n(e);e.loader=p;let w=mi(i.fragLoadPolicy.default),P={loadPolicy:w,timeout:w.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:e.sn==="initSegment"?1/0:131072};e.stats=p.stats;let D={onSuccess:(G,z,H,oe)=>{this.resetLoader(e,p);let Se=G.data;H.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(Se.slice(0,16)),Se=Se.slice(16)),l({frag:e,part:null,payload:Se,networkDetails:oe})},onError:(G,z,H,oe)=>{this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:F({url:r,data:void 0},G),error:Error(`HTTP Error ${G.code} ${G.text}`),networkDetails:H,stats:oe}))},onAbort:(G,z,H)=>{this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.INTERNAL_ABORTED,fatal:!1,frag:e,error:Error("Aborted"),networkDetails:H,stats:G}))},onTimeout:(G,z,H)=>{this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:Error(`Timeout after ${P.timeout}ms`),networkDetails:H,stats:G}))}};t&&(D.onProgress=(G,z,H,oe)=>t({frag:e,part:null,payload:H,networkDetails:oe})),p.load(v,P,D)})}loadPart(e,t,r){this.abort();let i=this.config,a=i.fLoader,n=i.loader;return new Promise((l,h)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){h(Ln(e,t));return}let p=this.loader=a?new a(i):new n(i),v=$n(e,t);e.loader=p;let w=mi(i.fragLoadPolicy.default),P={loadPolicy:w,timeout:w.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:131072};t.stats=p.stats,p.load(v,P,{onSuccess:(D,G,z,H)=>{this.resetLoader(e,p),this.updateStatsFromPart(e,t);let oe={frag:e,part:t,payload:D.data,networkDetails:H};r(oe),l(oe)},onError:(D,G,z,H)=>{this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:F({url:v.url,data:void 0},D),error:Error(`HTTP Error ${D.code} ${D.text}`),networkDetails:z,stats:H}))},onAbort:(D,G,z)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:Error("Aborted"),networkDetails:z,stats:D}))},onTimeout:(D,G,z)=>{this.resetLoader(e,p),h(new Aa({type:S.NETWORK_ERROR,details:d.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:Error(`Timeout after ${P.timeout}ms`),networkDetails:z,stats:D}))}})})}updateStatsFromPart(e,t){let r=e.stats,i=t.stats,a=i.total;if(r.loaded+=i.loaded,a){let h=Math.round(e.duration/t.duration),p=Math.min(Math.round(r.loaded/a),h),v=(h-p)*Math.round(r.loaded/p);r.total=r.loaded+v}else r.total=Math.max(r.loaded,r.total);let n=r.loading,l=i.loading;n.start?n.first+=l.first-l.start:(n.start=l.start,n.first=l.first),n.end=l.end}resetLoader(e,t){e.loader=null,this.loader===t&&(ut.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function $n(y,e=null){let t=e||y,r={frag:y,part:e,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},i=t.byteRangeStartOffset,a=t.byteRangeEndOffset;if(x(i)&&x(a)){var n,l;let h=i,p=a;if(y.sn==="initSegment"&&((l=(n=y.decryptdata)==null?void 0:n.method)==="AES-128"||l==="AES-256")){let v=a-i;v%16&&(p=a+(16-v%16)),i!==0&&(r.resetIV=!0,h=i-16)}r.rangeStart=h,r.rangeEnd=p}return r}function Ln(y,e){let t=Error(`GAP ${y.gap?"tag":"attribute"} found`),r={type:S.MEDIA_ERROR,details:d.FRAG_GAP,fatal:!1,frag:y,error:t,networkDetails:null};return e&&(r.part=e),(e||y).stats.aborted=!0,new Aa(r)}class Aa extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class Yn extends L{constructor(e,t){super(e,t),this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=ut.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(ut.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(ut.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=ut.setTimeout(this._boundTick,0)}doTick(){}}class jn{constructor(e,t,r,i=0,a=-1,n=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=lt(),this.buffering={audio:lt(),video:lt(),audiovideo:lt()},this.level=e,this.sn=t,this.id=r,this.size=i,this.part=a,this.partial=n}}function lt(){return{start:0,executeStart:0,executeEnd:0,end:0}}let B={length:0,start:()=>0,end:()=>0};class le{static isBuffered(e,t){if(e){let r=le.getBuffered(e);for(let i=r.length;i--;)if(t>=r.start(i)&&t<=r.end(i))return!0}return!1}static bufferedRanges(e){if(e){let t=le.getBuffered(e);return le.timeRangesToArray(t)}return[]}static timeRangesToArray(e){let t=[];for(let r=0;r<e.length;r++)t.push({start:e.start(r),end:e.end(r)});return t}static bufferInfo(e,t,r){if(e){let i=le.bufferedRanges(e);if(i.length)return le.bufferedInfo(i,t,r)}return{len:0,start:t,end:t,bufferedIndex:-1}}static bufferedInfo(e,t,r){let i;t=Math.max(0,t),e.length>1&&e.sort((v,w)=>v.start-w.start||w.end-v.end);let a=-1,n=[];if(r)for(let v=0;v<e.length;v++){t>=e[v].start&&t<=e[v].end&&(a=v);let w=n.length;if(w){let P=n[w-1].end;e[v].start-P<r?e[v].end>P&&(n[w-1].end=e[v].end):n.push(e[v])}else n.push(e[v])}else n=e;let l=0,h=t,p=t;for(let v=0;v<n.length;v++){let w=n[v].start,P=n[v].end;if(a===-1&&t>=w&&t<=P&&(a=v),t+r>=w&&t<P)h=w,l=(p=P)-t;else if(t+r<w){i=w;break}}return{len:l,start:h||0,end:p||0,nextStart:i,buffered:e,bufferedIndex:a}}static getBuffered(e){try{return e.buffered||B}catch(t){return se.log("failed to get media.buffered",t),B}}}let pe=/\{\$([a-zA-Z0-9-_]+)\}/g;function Re(y,e){if(y.variableList!==null||y.hasVariableRefs){let t=y.variableList;return e.replace(pe,r=>{let i=r.substring(2,r.length-1),a=t?.[i];return a===void 0?(y.playlistParsingError||(y.playlistParsingError=Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${i}"`)),r):a})}return e}function Pe(y,e,t){let r,i,a=y.variableList;if(a||(y.variableList=a={}),"QUERYPARAM"in e){r=e.QUERYPARAM;try{let n=new ut.URL(t).searchParams;if(n.has(r))i=n.get(r);else throw Error(`"${r}" does not match any query parameter in URI: "${t}"`)}catch(n){y.playlistParsingError||(y.playlistParsingError=Error(`EXT-X-DEFINE QUERYPARAM: ${n.message}`))}}else r=e.NAME,i=e.VALUE;r in a?y.playlistParsingError||(y.playlistParsingError=Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):a[r]=i||""}let it=/^(\d+)x(\d+)$/,yt=/(.+?)=(".*?"|.*?)(?:,|$)/g;class St{constructor(e,t){typeof e=="string"&&(e=St.parseAttrList(e,t)),_(this,e)}get clientAttrs(){return Object.keys(this).filter(e=>e.substring(0,2)==="X-")}decimalInteger(e){let t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(this[e]){let t=(this[e]||"0x").slice(2),r=new Uint8Array((t=(1&t.length?"0":"")+t).length/2);for(let i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null}hexadecimalIntegerAsNumber(e){let t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){let r=this[e];return r?parseFloat(r):t}enumeratedString(e){return this[e]}enumeratedStringList(e,t){let r=this[e];return(r?r.split(/[ ,]+/):[]).reduce((i,a)=>(i[a.toLowerCase()]=!0,i),t)}bool(e){return this[e]==="YES"}decimalResolution(e){let t=it.exec(this[e]);if(t!==null)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e,t){let r,i={};for(yt.lastIndex=0;(r=yt.exec(e))!==null;){let a=r[1].trim(),n=r[2],l=n.indexOf('"')===0&&n.lastIndexOf('"')===n.length-1,h=!1;if(l)n=n.slice(1,-1);else switch(a){case"IV":case"SCTE35-CMD":case"SCTE35-IN":case"SCTE35-OUT":h=!0}if(t&&(l||h))n=Re(t,n);else if(!h&&!l)switch(a){case"CLOSED-CAPTIONS":if(n==="NONE")break;case"ALLOWED-CPC":case"CLASS":case"ASSOC-LANGUAGE":case"AUDIO":case"BYTERANGE":case"CHANNELS":case"CHARACTERISTICS":case"CODECS":case"DATA-ID":case"END-DATE":case"GROUP-ID":case"ID":case"IMPORT":case"INSTREAM-ID":case"KEYFORMAT":case"KEYFORMATVERSIONS":case"LANGUAGE":case"NAME":case"PATHWAY-ID":case"QUERYPARAM":case"RECENTLY-REMOVED-DATERANGES":case"SERVER-URI":case"STABLE-RENDITION-ID":case"STABLE-VARIANT-ID":case"START-DATE":case"SUBTITLES":case"SUPPLEMENTAL-CODECS":case"URI":case"VALUE":case"VIDEO":case"X-ASSET-LIST":case"X-ASSET-URI":se.warn(`${e}: attribute ${a} is missing quotes`)}i[a]=n}return i}}class It{constructor(e,t,r=0){var i;if(this.attr=void 0,this.tagAnchor=void 0,this.tagOrder=void 0,this._startDate=void 0,this._endDate=void 0,this._dateAtEnd=void 0,this._cue=void 0,this._badValueForSameId=void 0,this.tagAnchor=t?.tagAnchor||null,this.tagOrder=(i=t?.tagOrder)!=null?i:r,t){let a=t.attr;for(let n in a)if(Object.prototype.hasOwnProperty.call(e,n)&&e[n]!==a[n]){se.warn(`DATERANGE tag attribute: "${n}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=n;break}e=_(new St({}),a,e)}if(this.attr=e,t?(this._startDate=t._startDate,this._cue=t._cue,this._endDate=t._endDate,this._dateAtEnd=t._dateAtEnd):this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){let a=t?.endDate||new Date(this.attr["END-DATE"]);x(a.getTime())&&(this._endDate=a)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get cue(){let e=this._cue;return e===void 0?this._cue=this.attr.enumeratedStringList(this.attr.CUE?"CUE":"X-CUE",{pre:!1,post:!1,once:!1}):e}get startTime(){let{tagAnchor:e}=this;return e===null||e.programDateTime===null?(se.warn(`Expected tagAnchor Fragment with PDT set for DateRange "${this.id}": ${e}`),NaN):e.start+(this.startDate.getTime()-e.programDateTime)/1e3}get startDate(){return this._startDate}get endDate(){let e=this._endDate||this._dateAtEnd;if(e)return e;let t=this.duration;return t!==null?this._dateAtEnd=new Date(this._startDate.getTime()+1e3*t):null}get duration(){if("DURATION"in this.attr){let e=this.attr.decimalFloatingPoint("DURATION");if(x(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isInterstitial(){return this.class==="com.apple.hls.interstitial"}get isValid(){return!!this.id&&!this._badValueForSameId&&x(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)&&(!this.attr.CUE||!this.cue.pre&&!this.cue.post||this.cue.pre!==this.cue.post)&&(!this.isInterstitial||"X-ASSET-URI"in this.attr||"X-ASSET-LIST"in this.attr)}}class er{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.dateRangeTagCount=0,this.live=!0,this.requestScheduled=-1,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.appliedTimelineOffset=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}let t=this.lastPartSn-e.lastPartSn,r=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!r||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||t===0&&r>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1}hasKey(e){return this.encryptedFragments.some(t=>{let r=t.decryptdata;return r||(t.setKeyFormat(e.keyFormat),r=t.decryptdata),!!r&&e.matches(r)})}get hasProgramDateTime(){return!!this.fragments.length&&x(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){let e=this.driftEndTime-this.driftStartTime;return e>0?1e3*(this.driftEnd-this.driftStart)/e:1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){return this.fragments.length?this.fragments[this.fragments.length-1].end:0}get fragmentStart(){return this.fragments.length?this.fragments[0].start:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].index:-1}get maxPartIndex(){let e=this.partList;if(e){let t=this.lastPartIndex;if(t!==-1){for(let r=e.length;r--;)if(e[r].index>t)return e[r].index;return t}}return 0}get lastPartSn(){var e;return(e=this.partList)!=null&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}get expired(){if(this.live&&this.age&&this.misses<3){let e=this.partEnd-this.fragmentStart;return this.age>Math.max(e,this.totalduration)+this.levelTargetDuration}return!1}}function qr(y,e){return y.length===e.length&&!y.some((t,r)=>t!==e[r])}function Zr(y,e){return!y&&!e||!!y&&!!e&&qr(y,e)}function vi(y){return y==="AES-128"||y==="AES-256"||y==="AES-256-CTR"}function Ze(y){switch(y){case"AES-128":case"AES-256":return tn.cbc;case"AES-256-CTR":return tn.ctr;default:throw Error(`invalid full segment method ${y}`)}}function Kt(y){return Uint8Array.from(atob(y),e=>e.charCodeAt(0))}function Gr(y){return Uint8Array.from(unescape(encodeURIComponent(y)),e=>e.charCodeAt(0))}let bi=typeof ut<"u"?ut:void 0;var Wt={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},Fr={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function Tr(y){switch(y){case Fr.FAIRPLAY:return Wt.FAIRPLAY;case Fr.PLAYREADY:return Wt.PLAYREADY;case Fr.WIDEVINE:return Wt.WIDEVINE;case Fr.CLEARKEY:return Wt.CLEARKEY}}function Ei(y){switch(y){case Wt.FAIRPLAY:return Fr.FAIRPLAY;case Wt.PLAYREADY:return Fr.PLAYREADY;case Wt.WIDEVINE:return Fr.WIDEVINE;case Wt.CLEARKEY:return Fr.CLEARKEY}}function wi(y){let{drmSystems:e,widevineLicenseUrl:t}=y,r=e?[Wt.FAIRPLAY,Wt.WIDEVINE,Wt.PLAYREADY,Wt.CLEARKEY].filter(i=>!!e[i]):[];return!r[Wt.WIDEVINE]&&t&&r.push(Wt.WIDEVINE),r}let ci=function(y){return bi!=null&&(y=bi.navigator)!=null&&y.requestMediaKeySystemAccess?ut.navigator.requestMediaKeySystemAccess.bind(ut.navigator):null}(),Ci={};class sr{static clearKeyUriToKeyIdMap(){Ci={}}constructor(e,t,r,i=[1],a=null,n){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=r,this.keyFormatVersions=i,this.iv=a,this.encrypted=!!e&&e!=="NONE",this.isCommonEncryption=this.encrypted&&!vi(e),n!=null&&n.startsWith("0x")&&(this.keyId=new Uint8Array(N(n)))}matches(e){return e.uri===this.uri&&e.method===this.method&&e.encrypted===this.encrypted&&e.keyFormat===this.keyFormat&&qr(e.keyFormatVersions,this.keyFormatVersions)&&Zr(e.iv,this.iv)&&Zr(e.keyId,this.keyId)}isSupported(){if(this.method){if(vi(this.method)||this.method==="NONE")return!0;if(this.keyFormat==="identity")return this.method==="SAMPLE-AES";switch(this.keyFormat){case Fr.FAIRPLAY:case Fr.WIDEVINE:case Fr.PLAYREADY:case Fr.CLEARKEY:return["SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if(vi(this.method)&&this.uri&&!this.iv){typeof e!="number"&&(se.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);let r=function(i){let a=new Uint8Array(16);for(let n=12;n<16;n++)a[n]=i>>8*(15-n)&255;return a}(e);return new sr(this.method,this.uri,"identity",this.keyFormatVersions,r)}if(this.pssh&&this.keyId)return this;let t=function(r){let i=r.split(":"),a=null;if(i[0]==="data"&&i.length===2){let n=i[1].split(";"),l=n[n.length-1].split(",");if(l.length===2){let h=l[0]==="base64",p=l[1];h?(n.splice(-1,1),a=Kt(p)):a=function(v){let w=Gr(v).subarray(0,16),P=new Uint8Array(16);return P.set(w,16-w.length),P}(p)}}return a}(this.uri);if(t)switch(this.keyFormat){case Fr.WIDEVINE:if(this.pssh=t,!this.keyId&&t.length>=22){let r=t.length-22;this.keyId=t.subarray(r,r+16)}break;case Fr.PLAYREADY:{let r=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(i,a,n){let l,h;if(i.byteLength!==16)throw RangeError("Invalid system id");l=new Uint8Array,h=new Uint8Array;let p=new Uint8Array(4);return n.byteLength>0&&new DataView(p.buffer).setUint32(0,n.byteLength,!1),function(v,...w){let P=w.length,D=8,G=P;for(;G--;)D+=w[G].byteLength;let z=new Uint8Array(D);for(z[0]=D>>24&255,z[1]=D>>16&255,z[2]=D>>8&255,z[3]=255&D,z.set(v,4),G=0,D=8;G<P;G++)z.set(w[G],D),D+=w[G].byteLength;return z}([112,115,115,104],new Uint8Array([0,0,0,0]),i,h,l,p,n)}(r,0,t),this.keyId=function(i){let a=new Uint16Array(i.buffer,i.byteOffset,i.byteLength/2),n=String.fromCharCode.apply(null,Array.from(a)),l=n.substring(n.indexOf("<"),n.length),h=new DOMParser().parseFromString(l,"text/xml").getElementsByTagName("KID")[0];if(h){let p=h.childNodes[0]?h.childNodes[0].nodeValue:h.getAttribute("VALUE");if(p){let v=Kt(p).subarray(0,16);return function(w){let P=function(D,G,z){let H=D[G];D[G]=D[z],D[z]=H};P(w,0,3),P(w,1,2),P(w,4,5),P(w,6,7)}(v),v}}return null}(t);break}default:{let r=t.subarray(0,16);if(r.length!==16){let i=new Uint8Array(16);i.set(r,16-r.length),r=i}this.keyId=r}}if(!this.keyId||this.keyId.byteLength!==16){let r=Ci[this.uri];if(!r){let i=Object.keys(Ci).length%Number.MAX_SAFE_INTEGER;new DataView((r=new Uint8Array(16)).buffer,12,4).setUint32(0,i),Ci[this.uri]=r}this.keyId=r}return this}}let vr=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,Hr=/#EXT-X-MEDIA:(.*)/g,sa=/^#EXT(?:INF|-X-TARGETDURATION):/m,pa=RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[^\r\n]*)/.source,/#.*/.source].join("|"),"g"),Da=new RegExp([/#EXT-X-(PROGRAM-DATE-TIME|BYTERANGE|DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP|INDEPENDENT-SEGMENTS)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class jr{static findGroup(e,t){for(let r=0;r<e.length;r++){let i=e[r];if(i.id===t)return i}}static resolve(e,t){return X.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return sa.test(e)}static parseMasterPlaylist(e,t){var r;let i,a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:pe.test(e)},n=[];for(vr.lastIndex=0;(i=vr.exec(e))!=null;)if(i[1]){let h=new St(i[1],a),p=Re(a,i[2]),v={attrs:h,bitrate:h.decimalInteger("BANDWIDTH")||h.decimalInteger("AVERAGE-BANDWIDTH"),name:h.NAME,url:jr.resolve(p,t)},w=h.decimalResolution("RESOLUTION");w&&(v.width=w.width,v.height=w.height),Ua(h.CODECS,v);let P=h["SUPPLEMENTAL-CODECS"];P&&(v.supplemental={},Ua(P,v.supplemental)),(r=v.unknownCodecs)!=null&&r.length||n.push(v),a.levels.push(v)}else if(i[3]){let h=i[3],p=i[4];switch(h){case"SESSION-DATA":{let v=new St(p,a),w=v["DATA-ID"];w&&(a.sessionData===null&&(a.sessionData={}),a.sessionData[w]=v);break}case"SESSION-KEY":{let v=Ga(p,t,a);v.encrypted&&v.isSupported()?(a.sessionKeys===null&&(a.sessionKeys=[]),a.sessionKeys.push(v)):se.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${p}"`);break}case"DEFINE":{let v=new St(p,a);Pe(a,v,t)}break;case"CONTENT-STEERING":{let v=new St(p,a);a.contentSteering={uri:jr.resolve(v["SERVER-URI"],t),pathwayId:v["PATHWAY-ID"]||"."};break}case"START":a.startTimeOffset=rn(p)}}let l=n.length>0&&n.length<a.levels.length;return a.levels=l?n:a.levels,a.levels.length===0&&(a.playlistParsingError=Error("no levels found in manifest")),a}static parseMasterPlaylistMedia(e,t,r){let i,a={},n=r.levels,l={AUDIO:n.map(p=>({id:p.attrs.AUDIO,audioCodec:p.audioCodec})),SUBTITLES:n.map(p=>({id:p.attrs.SUBTITLES,textCodec:p.textCodec})),"CLOSED-CAPTIONS":[]},h=0;for(Hr.lastIndex=0;(i=Hr.exec(e))!==null;){let p=new St(i[1],r),v=p.TYPE;if(v){let w=l[v],P=a[v]||[];a[v]=P;let D=p.LANGUAGE,G=p["ASSOC-LANGUAGE"],z=p.CHANNELS,H=p.CHARACTERISTICS,oe=p["INSTREAM-ID"],Se={attrs:p,bitrate:0,id:h++,groupId:p["GROUP-ID"]||"",name:p.NAME||D||"",type:v,default:p.bool("DEFAULT"),autoselect:p.bool("AUTOSELECT"),forced:p.bool("FORCED"),lang:D,url:p.URI?jr.resolve(p.URI,t):""};if(G&&(Se.assocLang=G),z&&(Se.channels=z),H&&(Se.characteristics=H),oe&&(Se.instreamId=oe),w!=null&&w.length){let me=jr.findGroup(w,Se.groupId)||w[0];bn(Se,me,"audioCodec"),bn(Se,me,"textCodec")}P.push(Se)}}return a}static parseLevelPlaylist(e,t,r,i,a,n){var l;let h,p,v,w,P={url:t},D=new er(t),G=D.fragments,z=[],H=null,oe=0,Se=0,me=0,Te=0,Be=0,je=null,ge=new fe(i,P),ze=-1,Fe=!1,rt=null;if(pa.lastIndex=0,D.m3u8=e,D.hasVariableRefs=pe.test(e),((l=pa.exec(e))==null?void 0:l[0])!=="#EXTM3U")return D.playlistParsingError=Error("Missing format identifier #EXTM3U"),D;for(;(h=pa.exec(e))!==null;){Fe&&(Fe=!1,(ge=new fe(i,P)).playlistOffset=me,ge.setStart(me),ge.sn=oe,ge.cc=Te,Be&&(ge.bitrate=Be),ge.level=r,H&&(ge.initSegment=H,H.rawProgramDateTime&&(ge.rawProgramDateTime=H.rawProgramDateTime,H.rawProgramDateTime=null),rt&&(ge.setByteRange(rt),rt=null)));let et=h[1];if(et){ge.duration=parseFloat(et);let dt=(" "+h[2]).slice(1);ge.title=dt||null,ge.tagList.push(dt?["INF",et,dt]:["INF",et])}else if(h[3]){if(x(ge.duration)){ge.playlistOffset=me,ge.setStart(me),v&&Si(ge,v,D),ge.sn=oe,ge.level=r,ge.cc=Te,G.push(ge);let dt=(" "+h[3]).slice(1);ge.relurl=Re(D,dt),Mr(ge,je,z),je=ge,me+=ge.duration,oe++,Se=0,Fe=!0}}else{if(!(h=h[0].match(Da))){se.warn("No matches on slow regex match for level playlist!");continue}for(p=1;p<h.length&&h[p]===void 0;p++);let dt=(" "+h[p]).slice(1),bt=(" "+h[p+1]).slice(1),_t=h[p+2]?(" "+h[p+2]).slice(1):null;switch(dt){case"BYTERANGE":je?ge.setByteRange(bt,je):ge.setByteRange(bt);break;case"PROGRAM-DATE-TIME":ge.rawProgramDateTime=bt,ge.tagList.push(["PROGRAM-DATE-TIME",bt]),ze===-1&&(ze=G.length);break;case"PLAYLIST-TYPE":D.type&&oa(D,dt,h),D.type=bt.toUpperCase();break;case"MEDIA-SEQUENCE":D.startSN!==0?oa(D,dt,h):G.length>0&&_a(D,dt,h),oe=D.startSN=parseInt(bt);break;case"SKIP":{D.skippedSegments&&oa(D,dt,h);let xt=new St(bt,D),at=xt.decimalInteger("SKIPPED-SEGMENTS");if(x(at)){D.skippedSegments+=at;for(let Zt=at;Zt--;)G.push(null);oe+=at}let nt=xt.enumeratedString("RECENTLY-REMOVED-DATERANGES");nt&&(D.recentlyRemovedDateranges=(D.recentlyRemovedDateranges||[]).concat(nt.split("	")));break}case"TARGETDURATION":D.targetduration!==0&&oa(D,dt,h),D.targetduration=Math.max(parseInt(bt),1);break;case"VERSION":D.version!==null&&oa(D,dt,h),D.version=parseInt(bt);break;case"INDEPENDENT-SEGMENTS":break;case"ENDLIST":D.live||oa(D,dt,h),D.live=!1;break;case"#":(bt||_t)&&ge.tagList.push(_t?[bt,_t]:[bt]);break;case"DISCONTINUITY":Te++,ge.tagList.push(["DIS"]);break;case"GAP":ge.gap=!0,ge.tagList.push([dt]);break;case"BITRATE":ge.tagList.push([dt,bt]),x(Be=1e3*parseInt(bt))?ge.bitrate=Be:Be=0;break;case"DATERANGE":{let xt=new St(bt,D),at=new It(xt,D.dateRanges[xt.ID],D.dateRangeTagCount);D.dateRangeTagCount++,at.isValid||D.skippedSegments?D.dateRanges[at.id]=at:se.warn(`Ignoring invalid DATERANGE tag: "${bt}"`),ge.tagList.push(["EXT-X-DATERANGE",bt]);break}case"DEFINE":{let xt=new St(bt,D);"IMPORT"in xt?function(at,nt,Zt){let lr=nt.IMPORT;if(Zt&&lr in Zt){let ar=at.variableList;ar||(at.variableList=ar={}),ar[lr]=Zt[lr]}else at.playlistParsingError||(at.playlistParsingError=Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${lr}"`))}(D,xt,n):Pe(D,xt,t)}break;case"DISCONTINUITY-SEQUENCE":D.startCC!==0?oa(D,dt,h):G.length>0&&_a(D,dt,h),D.startCC=Te=parseInt(bt);break;case"KEY":{let xt=Ga(bt,t,D);if(xt.isSupported()){if(xt.method==="NONE"){v=void 0;break}v||(v={});let at=v[xt.keyFormat];at!=null&&at.matches(xt)||(at&&(v=_({},v)),v[xt.keyFormat]=xt)}else se.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${bt}"`);break}case"START":D.startTimeOffset=rn(bt);break;case"MAP":{let xt=new St(bt,D);if(ge.duration){let at=new fe(i,P);Ui(at,xt,r,v),H=at,ge.initSegment=H,H.rawProgramDateTime&&!ge.rawProgramDateTime&&(ge.rawProgramDateTime=H.rawProgramDateTime)}else{let at=ge.byteRangeEndOffset;if(at){let nt=ge.byteRangeStartOffset;rt=`${at-nt}@${nt}`}else rt=null;Ui(ge,xt,r,v),H=ge,Fe=!0}H.cc=Te;break}case"SERVER-CONTROL":w&&oa(D,dt,h),w=new St(bt),D.canBlockReload=w.bool("CAN-BLOCK-RELOAD"),D.canSkipUntil=w.optionalFloat("CAN-SKIP-UNTIL",0),D.canSkipDateRanges=D.canSkipUntil>0&&w.bool("CAN-SKIP-DATERANGES"),D.partHoldBack=w.optionalFloat("PART-HOLD-BACK",0),D.holdBack=w.optionalFloat("HOLD-BACK",0);break;case"PART-INF":{D.partTarget&&oa(D,dt,h);let xt=new St(bt);D.partTarget=xt.decimalFloatingPoint("PART-TARGET");break}case"PART":{let xt=D.partList;xt||(xt=D.partList=[]);let at=Se>0?xt[xt.length-1]:void 0,nt=Se++,Zt=new Ae(new St(bt,D),ge,P,nt,at);xt.push(Zt),ge.duration+=Zt.duration;break}case"PRELOAD-HINT":{let xt=new St(bt,D);D.preloadHint=xt;break}case"RENDITION-REPORT":{let xt=new St(bt,D);D.renditionReports=D.renditionReports||[],D.renditionReports.push(xt);break}default:se.warn(`line parsed but not handled: ${h}`)}}}je&&!je.relurl?(G.pop(),me-=je.duration,D.partList&&(D.fragmentHint=je)):D.partList&&(Mr(ge,je,z),ge.cc=Te,D.fragmentHint=ge,v&&Si(ge,v,D)),D.targetduration||(D.playlistParsingError=Error("#EXT-X-TARGETDURATION is required"));let st=G.length,kt=G[0],Ye=G[st-1];if((me+=D.skippedSegments*D.targetduration)>0&&st&&Ye){D.averagetargetduration=me/st;let et=Ye.sn;D.endSN=et!=="initSegment"?et:0,D.live||(Ye.endList=!0),ze>0&&(function(dt,bt){let _t=dt[bt];for(let xt=bt;xt--;){let at=dt[xt];if(!at)return;at.programDateTime=_t.programDateTime-1e3*at.duration,_t=at}}(G,ze),kt&&z.unshift(kt))}return D.fragmentHint&&(me+=D.fragmentHint.duration),D.totalduration=me,z.length&&D.dateRangeTagCount&&kt&&Pn(z,D),D.endCC=Te,D}}function Pn(y,e){let t=y.length;if(!t){if(!e.hasProgramDateTime)return;{let l=e.fragments[e.fragments.length-1];y.push(l),t++}}let r=y[t-1],i=e.live?1/0:e.totalduration,a=Object.keys(e.dateRanges);for(let l=a.length;l--;){let h=e.dateRanges[a[l]],p=h.startDate.getTime();h.tagAnchor=r.ref;for(let v=t;v--;){var n;if(((n=y[v])==null?void 0:n.sn)<e.startSN)break;let w=function(P,D,G,z,H){let oe=G[z];if(oe){let me=oe.programDateTime;if(D>=me||z===0){var Se;if(D<=me+1e3*((((Se=G[z+1])==null?void 0:Se.start)||H)-oe.start)){let Te=G[z].sn-P.startSN;if(Te<0)return-1;let Be=P.fragments;if(Be.length>G.length){let je=(G[z+1]||Be[Be.length-1]).sn-P.startSN;for(let ge=je;ge>Te;ge--){let ze=Be[ge].programDateTime;if(D>=ze&&D<ze+1e3*Be[ge].duration)return ge}}return Te}}}return-1}(e,p,y,v,i);if(w!==-1){h.tagAnchor=e.fragments[w].ref;break}}}}function Ga(y,e,t){var r,i;let a=new St(y,t),n=(r=a.METHOD)!=null?r:"",l=a.URI,h=a.hexadecimalInteger("IV"),p=a.KEYFORMATVERSIONS,v=(i=a.KEYFORMAT)!=null?i:"identity";return l&&a.IV&&!h&&se.error(`Invalid IV: ${a.IV}`),new sr(n,l?jr.resolve(l,e):"",v,(p||"1").split("/").map(Number).filter(Number.isFinite),h,a.KEYID)}function rn(y){let e=new St(y).decimalFloatingPoint("TIME-OFFSET");return x(e)?e:null}function Ua(y,e){let t=(y||"").split(/[ ,]+/).filter(r=>r);["video","audio","text"].forEach(r=>{let i=t.filter(a=>kr(a,r));i.length&&(e[`${r}Codec`]=i.map(a=>a.split("/")[0]).join(","),t=t.filter(a=>i.indexOf(a)===-1))}),e.unknownCodecs=t}function bn(y,e,t){let r=e[t];r&&(y[t]=r)}function Mr(y,e,t){y.rawProgramDateTime?t.push(y):e!=null&&e.programDateTime&&(y.programDateTime=e.endProgramDateTime)}function Ui(y,e,t,r){y.relurl=e.URI,e.BYTERANGE&&y.setByteRange(e.BYTERANGE),y.level=t,y.sn="initSegment",r&&(y.levelkeys=r),y.initSegment=null}function Si(y,e,t){y.levelkeys=e;let{encryptedFragments:r}=t;(!r.length||r[r.length-1].levelkeys!==e)&&Object.keys(e).some(i=>e[i].isCommonEncryption)&&r.push(y)}function oa(y,e,t){y.playlistParsingError=Error(`#EXT-X-${e} must not appear more than once (${t[0]})`)}function _a(y,e,t){y.playlistParsingError=Error(`#EXT-X-${e} must appear before the first Media Segment (${t[0]})`)}function Sn(y,e){let t=e.startPTS;if(x(t)){let r,i=0;e.sn>y.sn?(i=t-y.start,r=y):(i=y.start-t,r=e),r.duration!==i&&r.setDuration(i)}else e.sn>y.sn?y.cc===e.cc&&y.minEndPTS?e.setStart(y.start+(y.minEndPTS-y.start)):e.setStart(y.start+y.duration):e.setStart(Math.max(y.start-e.duration,0))}function re(y,e,t,r,i,a,n){let l;r-t<=0&&(n.warn("Fragment should have a positive duration",e),r=t+e.duration,a=i+e.duration);let h=t,p=r,v=e.startPTS,w=e.endPTS;if(x(v)){let H=Math.abs(v-t);y&&H>y.totalduration?n.warn(`media timestamps and playlist times differ by ${H}s for level ${e.level} ${y.url}`):x(e.deltaPTS)?e.deltaPTS=Math.max(H,e.deltaPTS):e.deltaPTS=H,h=Math.max(t,v),t=Math.min(t,v),i=e.startDTS!==void 0?Math.min(i,e.startDTS):i,p=Math.min(r,w),r=Math.max(r,w),a=e.endDTS!==void 0?Math.max(a,e.endDTS):a}let P=t-e.start;e.start!==0&&e.setStart(t),e.setDuration(r-e.start),e.startPTS=t,e.maxStartPTS=h,e.startDTS=i,e.endPTS=r,e.minEndPTS=p,e.endDTS=a;let D=e.sn;if(!y||D<y.startSN||D>y.endSN)return 0;let G=D-y.startSN,z=y.fragments;for(z[G]=e,l=G;l>0;l--)Sn(z[l],z[l-1]);for(l=G;l<z.length-1;l++)Sn(z[l],z[l+1]);return y.fragmentHint&&Sn(z[z.length-1],y.fragmentHint),y.PTSKnown=y.alignedSliding=!0,P}function he(y,e,t,r,i){return Error(`${y} ${i.url}
Playlist starting @${e.startSN}
${e.m3u8}

Playlist starting @${t.startSN}
${t.m3u8}`)}function xe(y,e,t=!0){let r=e.startSN+e.skippedSegments-y.startSN,i=y.fragments,a=r>=0,n=0;if(a&&r<i.length)n=i[r].start;else if(a&&e.startSN===y.endSN+1)n=y.fragmentEnd;else if(a&&t)n=y.fragmentStart+r*e.levelTargetDuration;else{if(e.skippedSegments||e.fragmentStart!==0)return;n=y.fragmentStart}Le(e,n)}function Le(y,e){if(e){let t=y.fragments;for(let r=y.skippedSegments;r<t.length;r++)t[r].addStart(e);y.fragmentHint&&y.fragmentHint.addStart(e)}}function Ce(y,e=1/0){let t=1e3*y.targetduration;if(y.updated){let r=y.fragments;if(r.length&&4*t>e){let i=1e3*r[r.length-1].duration;i<t&&(t=i)}}else t/=2;return Math.round(t)}function Ve(y,e,t){if(!y)return null;let r=y.fragments[e-y.startSN];return r||(r=y.fragmentHint)&&r.sn===e?r:e<y.startSN&&t&&t.sn===e?t:null}function Ue(y,e,t){return y?qe(y.partList,e,t):null}function qe(y,e,t){if(y)for(let r=y.length;r--;){let i=y[r];if(i.index===t&&i.fragment.sn===e)return i}return null}function We(y){y.forEach((e,t)=>{var r;(r=e.details)==null||r.fragments.forEach(i=>{i.level=t,i.initSegment&&(i.initSegment.level=t)})})}function Ke(y){return y.replace(/\?[^?]*$/,"")}function Je(y,e){for(let r=0,i=y.length;r<i;r++){var t;if(((t=y[r])==null?void 0:t.cc)===e)return y[r]}return null}function vt(y,e){let t=y.start+e;y.startPTS=t,y.setStart(t),y.endPTS=t+y.duration}function ft(y,e){let t=e.fragments;for(let r=0,i=t.length;r<i;r++)vt(t[r],y);e.fragmentHint&&vt(e.fragmentHint,y),e.alignedSliding=!0}function Lt(y,e){if(!e||!(y.startCC<e.endCC)||!(y.endCC>e.startCC))return;let t=Math.min(e.endCC,y.endCC),r=Je(e.fragments,t),i=Je(y.fragments,t);r&&i&&(se.log(`Aligning playlist at start of dicontinuity sequence ${t}`),ft(r.start-i.start,y))}function Rt(y,e){let t,r;if(!y.hasProgramDateTime||!e.hasProgramDateTime)return;let i=y.fragments,a=e.fragments;if(!i.length||!a.length)return;let n=Math.min(e.endCC,y.endCC);e.startCC<n&&y.startCC<n&&(t=Je(a,n),r=Je(i,n)),t&&r||(r=Je(i,(t=a[Math.floor(a.length/2)]).cc)||i[Math.floor(i.length/2)]);let l=t.programDateTime,h=r.programDateTime;l&&h&&ft((h-l)/1e3-(r.start-t.start),y)}function ot(y,e,t){Ot(y,e,t),y.addEventListener(e,t)}function Ot(y,e,t){y.removeEventListener(e,t)}let yr={},Ie={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class Bt extends Yn{constructor(e,t,r,i,a){super(i,e.logger),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=Ie.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.buffering=!0,this.loadingParts=!1,this.loopSn=void 0,this.onMediaSeeking=()=>{let{config:n,fragCurrent:l,media:h,mediaBuffer:p,state:v}=this,w=h?h.currentTime:0,P=le.bufferInfo(p||h,w,n.maxBufferHole),D=!P.len;if(this.log(`Media seeking to ${x(w)?w.toFixed(3):w}, state: ${v}, ${D?"out of":"in"} buffer`),this.state===Ie.ENDED)this.resetLoadingState();else if(l){let G=n.maxFragLookUpTolerance,z=l.start-G,H=l.start+l.duration+G;if(D||H<P.start||z>P.end){let oe=w>H;(w<z||oe)&&(oe&&l.loader&&(this.log(`Cancelling fragment load for seek (sn: ${l.sn})`),l.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}if(h&&(this.fragmentTracker.removeFragmentsInRange(w,1/0,this.playlistType,!0),w>this.lastCurrentTime&&(this.lastCurrentTime=w),!this.loadingParts)){let G=Math.max(P.end,w),z=this.shouldLoadParts(this.getLevelDetails(),G);z&&(this.log(`LL-Part loading ON after seeking to ${w.toFixed(2)} with buffer @${G.toFixed(2)}`),this.loadingParts=z)}!this.hls.hasEnoughToStart&&(this.log(`Setting ${D?"startPosition":"nextLoadPosition"} to ${w} for seek without enough to start`),this.nextLoadPosition=w,D&&(this.startPosition=w)),D&&this.state===Ie.IDLE&&this.tickImmediate()},this.onMediaEnded=()=>{this.log("setting startPosition to 0 because media ended"),this.startPosition=this.lastCurrentTime=0},this.playlistType=a,this.hls=e,this.fragmentLoader=new In(e.config),this.keyLoader=r,this.fragmentTracker=t,this.config=e.config,this.decrypter=new vn(e.config)}registerListeners(){let{hls:e}=this;e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.ERROR,this.onError,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){if(this.state===Ie.STOPPED)return;this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);let e=this.fragCurrent;e!=null&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=Ie.STOPPED}get startPositionValue(){let{nextLoadPosition:e,startPosition:t}=this;return t===-1&&e?e:t}get bufferingEnabled(){return this.buffering}pauseBuffering(){this.buffering=!1}resumeBuffering(){this.buffering=!0}get inFlightFrag(){return{frag:this.fragCurrent,state:this.state}}_streamEnded(e,t){if(t.live||!this.media)return!1;let r=e.end||0,i=this.config.timelineOffset||0;if(r<=i)return!1;let a=e.buffered;this.config.maxBufferHole&&a&&a.length>1&&(e=le.bufferedInfo(a,e.start,0));let n=e.nextStart;if(n&&n>i&&n<t.edge||this.media.currentTime<e.start)return!1;let l=t.partList;if(l!=null&&l.length){let p=l[l.length-1];return le.isBuffered(this.media,p.start+p.duration/2)}let h=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(h)}getLevelDetails(){if(this.levels&&this.levelLastLoaded!==null)return this.levelLastLoaded.details}get timelineOffset(){let e=this.config.timelineOffset;if(e){var t;return((t=this.getLevelDetails())==null?void 0:t.appliedTimelineOffset)||e}return 0}onMediaAttached(e,t){let r=this.media=this.mediaBuffer=t.media;ot(r,"seeking",this.onMediaSeeking),ot(r,"ended",this.onMediaEnded);let i=this.config;this.levels&&i.autoStartLoad&&this.state===Ie.STOPPED&&this.startLoad(i.startPosition)}onMediaDetaching(e,t){let r=!!t.transferMedia,i=this.media;if(i!==null){if(i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),Ot(i,"seeking",this.onMediaSeeking),Ot(i,"ended",this.onMediaEnded),this.keyLoader&&!r&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loopSn=void 0,r){this.resetLoadingState(),this.resetTransmuxer();return}this.loadingParts=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}}onManifestLoading(){this.initPTS=[],this.levels=this.levelLastLoaded=this.fragCurrent=null,this.lastCurrentTime=this.startPosition=0,this.startFragRequested=!1}onError(e,t){}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset}onHandlerDestroying(){this.stopLoad(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),super.onHandlerDestroying(),this.hls=this.onMediaSeeking=this.onMediaEnded=null}onHandlerDestroyed(){this.state=Ie.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,r){this.startFragRequested=!0,this._loadFragForPlayback(e,t,r)}_loadFragForPlayback(e,t,r){this._doFragLoad(e,t,r,i=>{let a=i.frag;if(this.fragContextChanged(a)){this.warn(`${a.type} sn: ${a.sn}${i.part?" part: "+i.part.index:""} of ${this.fragInfo(a,!1,i.part)}) was dropped during download.`),this.fragmentTracker.removeFragment(a);return}a.stats.chunkCount++,this._handleFragmentLoadProgress(i)}).then(i=>{if(!i)return;let a=this.state,n=i.frag;if(this.fragContextChanged(n)){a!==Ie.FRAG_LOADING&&(this.fragCurrent||a!==Ie.PARSING)||(this.fragmentTracker.removeFragment(n),this.state=Ie.IDLE);return}"payload"in i&&(this.log(`Loaded ${n.type} sn: ${n.sn} of ${this.playlistLabel()} ${n.level}`),this.hls.trigger(o.FRAG_LOADED,i)),this._handleFragmentLoadComplete(i)}).catch(i=>{this.state!==Ie.STOPPED&&this.state!==Ie.ERROR&&(this.warn(`Frag error: ${i?.message||i}`),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;let{fragmentTracker:r}=this;if(r.getState(e)===Xr.APPENDING){let i=e.type,a=this.getFwdBufferInfo(this.mediaBuffer,i),n=Math.max(e.duration,a?a.len:this.config.maxBufferLength),l=this.backtrackFragment;((l?e.sn-l.sn:0)==1||this.reduceMaxBufferLength(n,e.duration))&&r.removeFragment(e)}else((t=this.mediaBuffer)==null?void 0:t.buffered.length)===0?r.removeAllFragments():r.hasParts(e.type)&&(r.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),r.getState(e)===Xr.PARTIAL&&r.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){let t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}waitForLive(e){let t=e.details;return t?.live&&t.type!=="EVENT"&&(this.levelLastLoaded!==e||t.expired)}flushMainBuffer(e,t,r=null){e-t&&this.hls.trigger(o.BUFFER_FLUSHING,{startOffset:e,endOffset:t,type:r})}_loadInitSegment(e,t){this._doFragLoad(e,t).then(r=>{let i=r?.frag;if(!i||this.fragContextChanged(i)||!this.levels)throw Error("init load aborted");return r}).then(r=>{let{hls:i}=this,{frag:a,payload:n}=r,l=a.decryptdata;if(n&&n.byteLength>0&&l!=null&&l.key&&l.iv&&vi(l.method)){let h=ut.performance.now();return this.decrypter.decrypt(new Uint8Array(n),l.key.buffer,l.iv.buffer,Ze(l.method)).catch(p=>{throw i.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_DECRYPT_ERROR,fatal:!1,error:p,reason:p.message,frag:a}),p}).then(p=>{let v=ut.performance.now();return i.trigger(o.FRAG_DECRYPTED,{frag:a,payload:p,stats:{tstart:h,tdecrypt:v}}),r.payload=p,this.completeInitSegmentLoad(r)})}return this.completeInitSegmentLoad(r)}).catch(r=>{this.state!==Ie.STOPPED&&this.state!==Ie.ERROR&&(this.warn(r),this.resetFragmentLoading(e))})}completeInitSegmentLoad(e){let{levels:t}=this;if(!t)throw Error("init load aborted, missing levels");let r=e.frag.stats;this.state!==Ie.STOPPED&&(this.state=Ie.IDLE),e.frag.data=new Uint8Array(e.payload),r.parsing.start=r.buffering.start=ut.performance.now(),r.parsing.end=r.buffering.end=ut.performance.now(),this.tick()}unhandledEncryptionError(e,t){var r,i;let a=e.tracks;if(a&&!t.encrypted&&((r=a.audio)!=null&&r.encrypted||(i=a.video)!=null&&i.encrypted)&&(!this.config.emeEnabled||!this.keyLoader.emeController)){let n=this.media,l=Error(`Encrypted track with no key in ${this.fragInfo(t)} (media ${n?"attached mediaKeys: "+n.mediaKeys:"detached"})`);return this.warn(l.message),!!n&&!n.mediaKeys&&(this.hls.trigger(o.ERROR,{type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_NO_KEYS,fatal:!1,error:l,frag:t}),this.resetTransmuxer(),!0)}return!1}fragContextChanged(e){let{fragCurrent:t}=this;return!e||!t||e.sn!==t.sn||e.level!==t.level}fragBufferedComplete(e,t){let r=this.mediaBuffer?this.mediaBuffer:this.media;if(this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)} > buffer:${r?yr.toString(le.getBuffered(r)):"(detached)"})`),ke(e)){var i;if(e.type!==m.SUBTITLE){let n=e.elementaryStreams;if(!Object.keys(n).some(l=>!!n[l])){this.state=Ie.IDLE;return}}let a=(i=this.levels)==null?void 0:i[e.level];a!=null&&a.fragmentError&&(this.log(`Resetting level fragment error count of ${a.fragmentError} on frag buffered`),a.fragmentError=0)}this.state=Ie.IDLE}_handleFragmentLoadComplete(e){let{transmuxer:t}=this;if(!t)return;let{frag:r,part:i,partsLoaded:a}=e,n=!a||a.length===0||a.some(h=>!h),l=new jn(r.level,r.sn,r.stats.chunkCount+1,0,i?i.index:-1,!n);t.flush(l)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,r=null,i){var a,n;let l;this.fragCurrent=e;let h=t.details;if(!this.levels||!h)throw Error(`frag load aborted, missing level${h?"":" detail"}s`);let p=null;if(e.encrypted&&!((a=e.decryptdata)!=null&&a.key)){if(this.log(`Loading key for ${e.sn} of [${h.startSN}-${h.endSN}], ${this.playlistLabel()} ${e.level}`),this.state=Ie.KEY_LOADING,this.fragCurrent=e,p=this.keyLoader.load(e).then(P=>{if(!this.fragContextChanged(P.frag))return this.hls.trigger(o.KEY_LOADED,P),this.state===Ie.KEY_LOADING&&(this.state=Ie.IDLE),P}),this.hls.trigger(o.KEY_LOADING,{frag:e}),this.fragCurrent===null)return this.log("context changed in KEY_LOADING"),Promise.resolve(null)}else!e.encrypted&&(p=this.keyLoader.loadClear(e,h.encryptedFragments,this.startFragRequested))&&this.log("[eme] blocking frag load until media-keys acquired");let v=this.fragPrevious;if(ke(e)&&(!v||e.sn!==v.sn)){let P=this.shouldLoadParts(t.details,e.end);P!==this.loadingParts&&(this.log(`LL-Part loading ${P?"ON":"OFF"} loading sn ${v?.sn}->${e.sn}`),this.loadingParts=P)}if(r=Math.max(e.start,r||0),this.loadingParts&&ke(e)){let P=h.partList;if(P&&i){r>h.fragmentEnd&&h.fragmentHint&&(e=h.fragmentHint);let D=this.getNextPart(P,e,r);if(D>-1){let G,z=P[D];return e=this.fragCurrent=z.fragment,this.log(`Loading ${e.type} sn: ${e.sn} part: ${z.index} (${D}/${P.length-1}) of ${this.fragInfo(e,!1,z)}) cc: ${e.cc} [${h.startSN}-${h.endSN}], target: ${parseFloat(r.toFixed(3))}`),this.nextLoadPosition=z.start+z.duration,this.state=Ie.FRAG_LOADING,G=p?p.then(H=>!H||this.fragContextChanged(H.frag)?null:this.doFragPartsLoad(e,z,t,i)).catch(H=>this.handleFragLoadError(H)):this.doFragPartsLoad(e,z,t,i).catch(H=>this.handleFragLoadError(H)),this.hls.trigger(o.FRAG_LOADING,{frag:e,part:z,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING parts")):G}if(!e.url||this.loadedEndOfParts(P,r))return Promise.resolve(null)}}if(ke(e)&&this.loadingParts)this.log(`LL-Part loading OFF after next part miss @${r.toFixed(2)} Check buffer at sn: ${e.sn} loaded parts: ${(n=h.partList)==null?void 0:n.filter(P=>P.loaded).map(P=>`[${P.start}-${P.end}]`)}`),this.loadingParts=!1;else if(!e.url)return Promise.resolve(null);this.log(`Loading ${e.type} sn: ${e.sn} of ${this.fragInfo(e,!1)}) cc: ${e.cc} ${"["+h.startSN+"-"+h.endSN+"]"}, target: ${parseFloat(r.toFixed(3))}`),x(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=Ie.FRAG_LOADING;let w=this.config.progressive;return l=w&&p?p.then(P=>!P||this.fragContextChanged(P.frag)?null:this.fragmentLoader.load(e,i)).catch(P=>this.handleFragLoadError(P)):Promise.all([this.fragmentLoader.load(e,w?i:void 0),p]).then(([P])=>(!w&&i&&i(P),P)).catch(P=>this.handleFragLoadError(P)),this.hls.trigger(o.FRAG_LOADING,{frag:e,targetBufferTime:r}),this.fragCurrent===null?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING")):l}doFragPartsLoad(e,t,r,i){return new Promise((a,n)=>{var l;let h=[],p=(l=r.details)==null?void 0:l.partList,v=w=>{this.fragmentLoader.loadPart(e,w,i).then(P=>{h[w.index]=P;let D=P.part;this.hls.trigger(o.FRAG_LOADED,P);let G=Ue(r.details,e.sn,w.index+1)||qe(p,e.sn,w.index+1);if(!G)return a({frag:e,part:D,partsLoaded:h});v(G)}).catch(n)};v(t)})}handleFragLoadError(e){if("data"in e){let t=e.data;t.frag&&t.details===d.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):t.frag&&t.type===S.KEY_SYSTEM_ERROR?(t.frag.abortRequests(),this.resetFragmentLoading(t.frag)):this.hls.trigger(o.ERROR,t)}else this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){let t=this.getCurrentContext(e);if(!t||this.state!==Ie.PARSING){this.fragCurrent||this.state===Ie.STOPPED||this.state===Ie.ERROR||(this.state=Ie.IDLE);return}let{frag:r,part:i,level:a}=t,n=ut.performance.now();r.stats.parsing.end=n,i&&(i.stats.parsing.end=n);let l=this.getLevelDetails(),h=l&&r.sn>l.endSN||this.shouldLoadParts(l,r.end);h!==this.loadingParts&&(this.log(`LL-Part loading ${h?"ON":"OFF"} after parsing segment ending @${r.end.toFixed(2)}`),this.loadingParts=h),this.updateLevelTiming(r,i,a,e.partial)}shouldLoadParts(e,t){if(this.config.lowLatencyMode){if(!e)return this.loadingParts;if(e.partList){var r,i;let a=e.partList[0];if(a.fragment.type===m.SUBTITLE)return!1;if(t>=a.end+(((r=e.fragmentHint)==null?void 0:r.duration)||0)&&(this.hls.hasEnoughToStart?((i=this.media)==null?void 0:i.currentTime)||this.lastCurrentTime:this.getLoadPosition())>a.start-a.fragment.duration)return!0}}return!1}getCurrentContext(e){let{levels:t,fragCurrent:r}=this,{level:i,sn:a,part:n}=e;if(!(t!=null&&t[i]))return this.warn(`Levels object was unset while buffering fragment ${a} of ${this.playlistLabel()} ${i}. The current chunk will not be buffered.`),null;let l=t[i],h=l.details,p=n>-1?Ue(h,a,n):null,v=p?p.fragment:Ve(h,a,r);return v?(r&&r!==v&&(v.stats=r.stats),{frag:v,part:p,level:l}):null}bufferFragmentData(e,t,r,i,a){if(this.state!==Ie.PARSING)return;let{data1:n,data2:l}=e,h=n;if(l&&(h=tt(n,l)),!h.length)return;let p=this.initPTS[t.cc],v=p?-p.baseTime/p.timescale:void 0,w={type:e.type,frag:t,part:r,chunkMeta:i,offset:v,parent:t.type,data:h};if(this.hls.trigger(o.BUFFER_APPENDING,w),e.dropped&&e.independent&&!r){if(a)return;this.flushBufferGap(t)}}flushBufferGap(e){let t=this.media;if(!t)return;if(!le.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}let r=t.currentTime,i=le.bufferInfo(t,r,0),a=e.duration,n=Math.min(2*this.config.maxFragLookUpTolerance,.25*a),l=Math.max(Math.min(e.start-n,i.end-n),r+n);e.start-l>n&&this.flushMainBuffer(l,e.start)}getFwdBufferInfo(e,t){var r;let i=this.getLoadPosition();if(!x(i))return null;let a=this.lastCurrentTime>i||(r=this.media)!=null&&r.paused?0:this.config.maxBufferHole;return this.getFwdBufferInfoAtPos(e,i,t,a)}getFwdBufferInfoAtPos(e,t,r,i){let a=le.bufferInfo(e,t,i);if(a.len===0&&a.nextStart!==void 0){let n=this.fragmentTracker.getBufferedFrag(t,r);if(n&&(a.nextStart<=n.end||n.gap)){let l=Math.max(Math.min(a.nextStart,n.end)-t,i);return le.bufferInfo(e,t,l)}}return a}getMaxBufferLength(e){let{config:t}=this;return Math.min(e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,t.maxMaxBufferLength)}reduceMaxBufferLength(e,t){let r=this.config,i=Math.max(Math.min(e-t,r.maxBufferLength),t),a=Math.max(e-3*t,r.maxMaxBufferLength/2,i);return a>=i&&(r.maxMaxBufferLength=a,this.warn(`Reduce max buffer length to ${a}s`),!0)}getAppendedFrag(e,t=m.MAIN){let r=this.fragmentTracker?this.fragmentTracker.getAppendedFrag(e,t):null;return r&&"fragment"in r?r.fragment:r}getNextFragment(e,t){let r=t.fragments,i=r.length;if(!i)return null;let{config:a}=this,n=r[0].start,l=a.lowLatencyMode&&!!t.partList,h=null;if(t.live){let w=a.initialLiveManifestSize;if(i<w)return this.warn(`Not enough fragments to start playback (have: ${i}, need: ${w})`),null;if(!t.PTSKnown&&!this.startFragRequested&&this.startPosition===-1||e<n){var p;l&&!this.loadingParts&&(this.log("LL-Part loading ON for initial live fragment"),this.loadingParts=!0),h=this.getInitialLiveFragment(t);let P=this.hls.startPosition,D=this.hls.liveSyncPosition,G=h?(P!==-1&&P>=n?P:D)||h.start:e;this.log(`Setting startPosition to ${G} to match start frag at live edge. mainStart: ${P} liveSyncPosition: ${D} frag.start: ${(p=h)==null?void 0:p.start}`),this.startPosition=this.nextLoadPosition=G}}else e<=n&&(h=r[0]);if(!h){let w=this.loadingParts?t.partEnd:t.fragmentEnd;h=this.getFragmentAtPosition(e,w,t)}let v=this.filterReplacedPrimary(h,t);if(!v&&h){let w=h.sn-t.startSN;v=this.filterReplacedPrimary(r[w+1]||null,t)}return this.mapToInitFragWhenRequired(v)}isLoopLoading(e,t){let r=this.fragmentTracker.getState(e);return(r===Xr.OK||r===Xr.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,r,i,a){let n=null;if(e.gap&&(n=this.getNextFragment(this.nextLoadPosition,t))&&!n.gap&&r.nextStart){let l=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,r.nextStart,i,0);if(l!==null&&r.len+l.len>=a){let h=n.sn;return this.loopSn!==h&&(this.log(`buffer full after gaps in "${i}" playlist starting at sn: ${h}`),this.loopSn=h),null}}return this.loopSn=void 0,n}get primaryPrefetch(){if($e(this.config)){var e;if(!((e=this.hls.interstitialsManager)==null||(e=e.playingItem)==null)&&e.event)return!0}return!1}filterReplacedPrimary(e,t){if(!e)return e;if($e(this.config)&&e.type!==m.SUBTITLE){let r=this.hls.interstitialsManager,i=r?.bufferingItem;if(i){let n=i.event;if(n){if(n.appendInPlace||Math.abs(e.start-i.start)>1||i.start===0)return null}else if(e.end<=i.start&&t?.live===!1||e.start>i.end&&i.nextEvent&&(i.nextEvent.appendInPlace||e.start-i.end>1))return null}let a=r?.playerQueue;if(a)for(let n=a.length;n--;){let l=a[n].interstitial;if(l.appendInPlace&&e.start>=l.startTime&&e.end<=l.resumeTime)return null}}return e}mapToInitFragWhenRequired(e){return e==null||!e.initSegment||e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,r){let i=-1,a=!1,n=!0;for(let l=0,h=e.length;l<h;l++){let p=e[l];if(n=n&&!p.independent,i>-1&&r<p.start)break;let v=p.loaded;v?i=-1:(a||(p.independent||n)&&p.fragment===t)&&(p.fragment!==t&&this.warn(`Need buffer at ${r} but next unloaded part starts at ${p.start}`),i=l),a=v}return i}loadedEndOfParts(e,t){let r;for(let i=e.length;i--&&(r=e[i]).loaded;)if(t>r.start)return!0;return!1}getInitialLiveFragment(e){let t=e.fragments,r=this.fragPrevious,i=null;if(r){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${r.programDateTime}`),i=function(a,n,l){if(n===null||!Array.isArray(a)||!a.length||!x(n)||n<(a[0].programDateTime||0)||n>=(a[a.length-1].endProgramDateTime||0))return null;for(let h=0;h<a.length;++h){let p=a[h];if(function(v,w,P){let D=1e3*Math.min(w,P.duration+(P.deltaPTS?P.deltaPTS:0));return(P.endProgramDateTime||0)-D>v}(n,l,p))return p}return null}(t,r.endProgramDateTime,this.config.maxFragLookUpTolerance)),!i){let a=r.sn+1;if(a>=e.startSN&&a<=e.endSN){let n=t[a-e.startSN];r.cc===n.cc&&(i=n,this.log(`Live playlist, switching playlist, load frag with next SN: ${i.sn}`))}!i&&(i=Ri(e,r.cc,r.end))&&this.log(`Live playlist, switching playlist, load frag with same CC: ${i.sn}`)}}else{let a=this.hls.liveSyncPosition;a!==null&&(i=this.getFragmentAtPosition(a,this.bitrateTest?e.fragmentEnd:e.edge,e))}return i}getFragmentAtPosition(e,t,r){let i,{config:a}=this,{fragPrevious:n}=this,{fragments:l,endSN:h}=r,{fragmentHint:p}=r,{maxFragLookUpTolerance:v}=a,w=r.partList,P=!!(this.loadingParts&&w!=null&&w.length&&p);if(P&&!this.bitrateTest&&w[w.length-1].fragment.sn===p.sn&&(l=l.concat(p),h=p.sn),e<t){var D;let G=e<this.lastCurrentTime||e>t-v||(D=this.media)!=null&&D.paused||!this.startFragRequested?0:v;i=gi(n,l,e,G)}else i=l[l.length-1];if(i){let G=i.sn-r.startSN,z=this.fragmentTracker.getState(i);if((z===Xr.OK||z===Xr.PARTIAL&&i.gap)&&(n=i),n&&i.sn===n.sn&&(!P||w[0].fragment.sn>i.sn||!r.live)&&i.level===n.level){let H=l[G+1];i=i.sn<h&&this.fragmentTracker.getState(H)!==Xr.OK?H:null}}return i}alignPlaylists(e,t,r){let i=e.fragments.length;if(!i)return this.warn("No fragments in live playlist"),0;let a=e.fragmentStart,n=e.alignedSliding&&x(a);if(!t||!n&&!a){r&&(Lt(e,r),e.alignedSliding||Rt(e,r),e.alignedSliding||e.skippedSegments||xe(r,e,!1));let l=e.fragmentStart;return this.log(`Live playlist sliding: ${l.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} fragments: ${i}`),l}return a}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let r=this.startPosition;r<t&&(r=-1);let i=this.timelineOffset;if(r===-1){let a=this.startTimeOffset!==null,n=a?this.startTimeOffset:e.startTimeOffset;n!==null&&x(n)?(r=t+n,n<0&&(r+=e.edge),r=Math.min(Math.max(t,r),t+e.totalduration),this.log(`Setting startPosition to ${r} for start time offset ${n} found in ${a?"multivariant":"media"} playlist`),this.startPosition=r):e.live?(r=this.hls.liveSyncPosition||t,this.log(`Setting startPosition to -1 to start at live edge ${r}`),this.startPosition=-1):(this.log("setting startPosition to 0 by default"),this.startPosition=r=0),this.lastCurrentTime=r+i}this.nextLoadPosition=r+i}getLoadPosition(){var e;let{media:t}=this,r=0;return(e=this.hls)!=null&&e.hasEnoughToStart&&t?r=t.currentTime:this.nextLoadPosition>=0&&(r=this.nextLoadPosition),r}handleFragLoadAborted(e,t){this.transmuxer&&e.type===this.playlistType&&ke(e)&&e.stats.aborted&&(this.log(`Fragment ${e.sn}${t?" part "+t.index:""} of ${this.playlistLabel()} ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===Ie.FRAG_LOADING_WAITING_RETRY)||(this.state=Ie.IDLE)}onFragmentOrKeyLoadError(e,t){var r,i,a;if(t.chunkMeta&&!t.frag){let oe=this.getCurrentContext(t.chunkMeta);oe&&(t.frag=oe.frag)}let n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){this.warn(`Frag load error must match current frag to retry ${n.url} > ${(i=this.fragCurrent)==null?void 0:i.url}`);return}let l=t.details===d.FRAG_GAP;l&&this.fragmentTracker.fragBuffered(n,!0);let h=t.errorAction;if(!h){this.state=Ie.ERROR;return}let{action:p,flags:v,retryCount:w=0,retryConfig:P}=h,D=!!P,G=D&&p===Yr.RetryRequest,z=D&&!h.resolved&&v===yi.MoveAllAlternatesMatchingHost,H=(r=this.hls.latestLevelDetails)==null?void 0:r.live;if(!G&&z&&ke(n)&&!n.endList&&H)this.resetFragmentErrors(e),this.treatAsGap(n),h.resolved=!0;else if((G||z)&&w<P.maxNumRetry){let oe=Gi((a=t.response)==null?void 0:a.code),Se=Bi(P,w);if(this.resetStartWhenNotLoaded(),this.retryDate=ut.performance.now()+Se,this.state=Ie.FRAG_LOADING_WAITING_RETRY,h.resolved=!0,oe){this.log("Waiting for connection (offline)"),this.retryDate=1/0,t.reason="offline";return}this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${w+1}/${P.maxNumRetry} in ${Se}ms`)}else if(P)if(this.resetFragmentErrors(e),w<P.maxNumRetry)l||p===Yr.RemoveAlternatePermanently||(h.resolved=!0);else{this.warn(`${t.details} reached or exceeded max retry (${w})`);return}else p===Yr.SendAlternateToPenaltyBox?this.state=Ie.WAITING_LEVEL:this.state=Ie.ERROR;this.tickImmediate()}checkRetryDate(){let e=ut.performance.now(),t=this.retryDate,r=t===1/0;(!t||e>=t||r&&!Gi(0))&&(r&&this.log("Connection restored (online)"),this.resetStartWhenNotLoaded(),this.state=Ie.IDLE)}reduceLengthAndFlushBuffer(e){if(this.state===Ie.PARSING||this.state===Ie.PARSED){let t=e.frag,r=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,r),a=i&&i.len>.5;a&&this.reduceMaxBufferLength(i.len,t?.duration||10);let n=!a;return n&&this.warn(`Buffer full error while media.currentTime (${this.getLoadPosition()}) is not buffered, flush ${r} buffer`),t&&(this.fragmentTracker.removeFragment(t),this.nextLoadPosition=t.start),this.resetLoadingState(),n}return!1}resetFragmentErrors(e){e===m.AUDIO&&(this.fragCurrent=null),this.hls.hasEnoughToStart||(this.startFragRequested=!1),this.state!==Ie.STOPPED&&(this.state=Ie.IDLE)}afterBufferFlushed(e,t,r){if(!e)return;let i=le.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,i,r),this.state===Ie.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state!==Ie.STOPPED&&(this.state=Ie.IDLE)}resetStartWhenNotLoaded(){if(!this.hls.hasEnoughToStart){this.startFragRequested=!1;let e=this.levelLastLoaded,t=e?e.details:null;t!=null&&t.live?(this.log("resetting startPosition for live start"),this.startPosition=-1,this.setStartPosition(t,t.fragmentStart),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){this.log(`Loading context changed while buffering sn ${e.sn} of ${this.playlistLabel()} ${e.level===-1?"<removed>":e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,r,i){let a=r.details;if(!a){this.warn("level.details undefined");return}if(!Object.keys(e.elementaryStreams).reduce((l,h)=>{let p=e.elementaryStreams[h];if(p){let v=p.endPTS-p.startPTS;if(v<=0)return this.warn(`Could not parse fragment ${e.sn} ${h} duration reliably (${v})`),l||!1;let w=i?0:re(a,e,p.startPTS,p.endPTS,p.startDTS,p.endDTS,this);return this.hls.trigger(o.LEVEL_PTS_UPDATED,{details:a,level:r,drift:w,type:h,frag:e,start:p.startPTS,end:p.endPTS}),!0}return l},!1)){var n;if(r.fragmentError===0&&this.treatAsGap(e,r),((n=this.transmuxer)==null?void 0:n.error)===null){let l=Error(`Found no media in fragment ${e.sn} of ${this.playlistLabel()} ${e.level} resetting transmuxer to fallback to playlist timing`);if(this.warn(l.message),this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_PARSING_ERROR,fatal:!1,error:l,frag:e,reason:`Found no media in msn ${e.sn} of ${this.playlistLabel()} "${r.url}"`}),!this.hls)return;this.resetTransmuxer()}}this.state=Ie.PARSED,this.log(`Parsed ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.fragInfo(e,!1,t)})`),this.hls.trigger(o.FRAG_PARSED,{frag:e,part:t})}playlistLabel(){return this.playlistType===m.MAIN?"level":"track"}fragInfo(e,t=!0,r){var i,a;return`${this.playlistLabel()} ${e.level} (${r?"part":"frag"}:[${((i=t&&!r?e.startPTS:(r||e).start)!=null?i:NaN).toFixed(3)}-${((a=t&&!r?e.endPTS:(r||e).end)!=null?a:NaN).toFixed(3)}]${r&&e.type==="main"?"INDEPENDENT="+(r.independent?"YES":"NO"):""}`}treatAsGap(e,t){t&&t.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)}resetTransmuxer(){var e;(e=this.transmuxer)==null||e.reset()}recoverWorkerError(e){e.event==="demuxerWorker"&&(this.fragmentTracker.removeAllFragments(),this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null),this.resetStartWhenNotLoaded(),this.resetLoadingState())}set state(e){let t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function $e(y){return!!y.interstitialsController&&y.enableInterstitialPlayback!==!1}class Nt{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){let e,{chunks:t,dataLength:r}=this;return t.length?(e=t.length===1?t[0]:function(i,a){let n=new Uint8Array(a),l=0;for(let h=0;h<i.length;h++){let p=i[h];n.set(p,l),l+=p.length}return n}(t,r),this.reset(),e):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}var Ft={exports:{}},or=function(y){return y&&y.__esModule&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y}((c||(c=1,function(y){var e=Object.prototype.hasOwnProperty,t="~";function r(){}function i(h,p,v){this.fn=h,this.context=p,this.once=v||!1}function a(h,p,v,w,P){if(typeof v!="function")throw TypeError("The listener must be a function");var D=new i(v,w||h,P),G=t?t+p:p;return h._events[G]?h._events[G].fn?h._events[G]=[h._events[G],D]:h._events[G].push(D):(h._events[G]=D,h._eventsCount++),h}function n(h,p){--h._eventsCount==0?h._events=new r:delete h._events[p]}function l(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1)),l.prototype.eventNames=function(){var h,p,v=[];if(this._eventsCount===0)return v;for(p in h=this._events)e.call(h,p)&&v.push(t?p.slice(1):p);return Object.getOwnPropertySymbols?v.concat(Object.getOwnPropertySymbols(h)):v},l.prototype.listeners=function(h){var p=t?t+h:h,v=this._events[p];if(!v)return[];if(v.fn)return[v.fn];for(var w=0,P=v.length,D=Array(P);w<P;w++)D[w]=v[w].fn;return D},l.prototype.listenerCount=function(h){var p=t?t+h:h,v=this._events[p];return v?v.fn?1:v.length:0},l.prototype.emit=function(h,p,v,w,P,D){var G=t?t+h:h;if(!this._events[G])return!1;var z,H,oe=this._events[G],Se=arguments.length;if(oe.fn){switch(oe.once&&this.removeListener(h,oe.fn,void 0,!0),Se){case 1:return oe.fn.call(oe.context),!0;case 2:return oe.fn.call(oe.context,p),!0;case 3:return oe.fn.call(oe.context,p,v),!0;case 4:return oe.fn.call(oe.context,p,v,w),!0;case 5:return oe.fn.call(oe.context,p,v,w,P),!0;case 6:return oe.fn.call(oe.context,p,v,w,P,D),!0}for(H=1,z=Array(Se-1);H<Se;H++)z[H-1]=arguments[H];oe.fn.apply(oe.context,z)}else{var me,Te=oe.length;for(H=0;H<Te;H++)switch(oe[H].once&&this.removeListener(h,oe[H].fn,void 0,!0),Se){case 1:oe[H].fn.call(oe[H].context);break;case 2:oe[H].fn.call(oe[H].context,p);break;case 3:oe[H].fn.call(oe[H].context,p,v);break;case 4:oe[H].fn.call(oe[H].context,p,v,w);break;default:if(!z)for(me=1,z=Array(Se-1);me<Se;me++)z[me-1]=arguments[me];oe[H].fn.apply(oe[H].context,z)}}return!0},l.prototype.on=function(h,p,v){return a(this,h,p,v,!1)},l.prototype.once=function(h,p,v){return a(this,h,p,v,!0)},l.prototype.removeListener=function(h,p,v,w){var P=t?t+h:h;if(!this._events[P])return this;if(!p)return n(this,P),this;var D=this._events[P];if(D.fn)D.fn!==p||w&&!D.once||v&&D.context!==v||n(this,P);else{for(var G=0,z=[],H=D.length;G<H;G++)(D[G].fn!==p||w&&!D[G].once||v&&D[G].context!==v)&&z.push(D[G]);z.length?this._events[P]=z.length===1?z[0]:z:n(this,P)}return this},l.prototype.removeAllListeners=function(h){var p;return h?(p=t?t+h:h,this._events[p]&&n(this,p)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=t,l.EventEmitter=l,y.exports=l}(Ft)),Ft.exports));let tr="1.6.11",rr={};function zt(y,e){return e+10<=y.length&&y[e]===51&&y[e+1]===68&&y[e+2]===73&&y[e+3]<255&&y[e+4]<255&&y[e+6]<128&&y[e+7]<128&&y[e+8]<128&&y[e+9]<128}function ir(y,e){return e+10<=y.length&&y[e]===73&&y[e+1]===68&&y[e+2]===51&&y[e+3]<255&&y[e+4]<255&&y[e+6]<128&&y[e+7]<128&&y[e+8]<128&&y[e+9]<128}function wr(y,e){return(127&y[e])<<21|(127&y[e+1])<<14|(127&y[e+2])<<7|127&y[e+3]}function _r(y,e){let t=e,r=0;for(;ir(y,e);)r+=10+wr(y,e+6),zt(y,e+10)&&(r+=10),e+=r;if(r>0)return y.subarray(t,t+r)}function Qr(y,e){return y[e]===255&&(246&y[e+1])==240}function ga(y,e){return 1&y[e+1]?7:9}function Vi(y,e){return(3&y[e+3])<<11|y[e+4]<<3|(224&y[e+5])>>>5}function Ur(y,e){return e+1<y.length&&Qr(y,e)}function ta(y,e,t,r,i){if(!y.samplerate){let a=function(n,l,h,p){let v=l[h+2],w=v>>2&15;if(w>12){let Se=Error(`invalid ADTS sampling index:${w}`);n.emit(o.ERROR,o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_PARSING_ERROR,fatal:!0,error:Se,reason:Se.message});return}let P=(v>>6&3)+1,D=l[h+3]>>6&3|(1&v)<<2,G="mp4a.40."+P,z=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350][w],H=w;(P===5||P===29)&&(H-=3);let oe=[P<<3|(14&H)>>1,(1&H)<<7|D<<3];return se.log(`manifest codec:${p}, parsed codec:${G}, channels:${D}, rate:${z} (ADTS object type:${P} sampling index:${w})`),{config:oe,samplerate:z,channelCount:D,codec:G,parsedCodec:G,manifestCodec:p}}(e,t,r,i);a&&_(y,a)}}function Ii(y,e,t,r,i){let a,n=r+9216e4/y.samplerate*i,l=function(p,v){let w=ga(p,v);if(v+w<=p.length){let P=Vi(p,v)-w;if(P>0)return{headerLength:w,frameLength:P}}}(e,t);if(l){let{frameLength:p,headerLength:v}=l,w=v+p,P=Math.max(0,t+w-e.length);P?(a=new Uint8Array(w-v)).set(e.subarray(t+v,e.length),0):a=e.subarray(t+v,t+w);let D={unit:a,pts:n};return P||y.samples.push(D),{sample:D,length:w,missing:P}}let h=e.length-t;return(a=new Uint8Array(h)).set(e.subarray(t,e.length),0),{sample:{unit:a,pts:n},length:h,missing:-1}}function ni(y,e=0,t=1/0){return function(r,i,a,n){let l=r instanceof ArrayBuffer?r:r.buffer,h=1;"BYTES_PER_ELEMENT"in n&&(h=n.BYTES_PER_ELEMENT);let p=r&&r.buffer instanceof ArrayBuffer&&r.byteLength!==void 0&&r.byteOffset!==void 0?r.byteOffset:0,v=(p+r.byteLength)/h,w=Math.floor(Math.max(0,Math.min((p+i)/h,v))),P=Math.floor(Math.min(w+Math.max(a,0),v));return new n(l,w,P-w)}(y,e,t,Uint8Array)}function qi(y){let e=0,t=[];for(;ir(y,e);){let r=wr(y,e+6);y[e+5]>>6&1&&(e+=10);let i=(e+=10)+r;for(;e+10<i;){let a=function(l){let h=String.fromCharCode(l[0],l[1],l[2],l[3]),p=wr(l,4);return{type:h,size:p,data:l.subarray(10,10+p)}}(y.subarray(e)),n=a.type==="PRIV"?function(l){if(l.size<2)return;let h=M(l.data,!0),p=new Uint8Array(l.data.subarray(h.length+1));return{key:l.type,info:h,data:p.buffer}}(a):a.type[0]==="W"?function(l){if(l.type==="WXXX"){if(l.size<2)return;let p=1,v=M(l.data.subarray(p),!0);p+=v.length+1;let w=M(l.data.subarray(p));return{key:l.type,info:v,data:w}}let h=M(l.data);return{key:l.type,info:"",data:h}}(a):a.type==="APIC"?function(l){let h,p={key:l.type,description:"",data:"",mimeType:null,pictureType:null};if(l.size<2)return;if(l.data[0]!==3){console.log("Ignore frame with unrecognized character encoding");return}let v=l.data.subarray(1).indexOf(0);if(v===-1)return;let w=M(ni(l.data,1,v)),P=l.data[2+v],D=l.data.subarray(3+v).indexOf(0);if(D===-1)return;let G=M(ni(l.data,3+v,D));if(w==="-->")h=M(ni(l.data,4+v+D));else{var z;h=(z=l.data.subarray(4+v+D))instanceof ArrayBuffer?z:z.byteOffset==0&&z.byteLength==z.buffer.byteLength?z.buffer:new Uint8Array(z).buffer}return p.mimeType=w,p.pictureType=P,p.description=G,p.data=h,p}(a):function(l){if(l.size<2)return;if(l.type==="TXXX"){let p=1,v=M(l.data.subarray(p),!0);p+=v.length+1;let w=M(l.data.subarray(p));return{key:l.type,info:v,data:w}}let h=M(l.data.subarray(1));return{key:l.type,info:"",data:h}}(a);n&&t.push(n),e+=a.size+10}zt(y,e)&&(e+=10)}return t}function wa(y){return y&&y.key==="PRIV"&&y.info==="com.apple.streaming.transportStreamTimestamp"}function Ki(y){let e=qi(y);for(let t=0;t<e.length;t++){let r=e[t];if(wa(r))return function(i){if(i.data.byteLength===8){let a=new Uint8Array(i.data),n=1&a[3],l=(a[4]<<23)+(a[5]<<15)+(a[6]<<7)+a[7];return l/=45,n&&(l+=4772185884e-2),Math.round(l)}}(r)}}let ra=function(y){return y.audioId3="org.id3",y.dateRange="com.apple.quicktime.HLS",y.emsg="https://aomedia.org/emsg/ID3",y.misbklv="urn:misb:KLV:bin:1910.1",y}({});function la(y="",e=9e4){return{type:y,id:-1,pid:-1,inputTimeScale:e,sequenceNumber:-1,samples:[],dropped:0}}class Xn{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,r,i){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,r){}demux(e,t){let r;this.cachedData&&(e=tt(this.cachedData,e),this.cachedData=null);let i=_r(e,0),a=i?i.length:0,n=this._audioTrack,l=this._id3Track,h=i?Ki(i):void 0,p=e.length;for((this.basePTS===null||this.frameIndex===0&&x(h))&&(this.basePTS=an(h,t,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),i&&i.length>0&&l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:ra.audioId3,duration:Number.POSITIVE_INFINITY});a<p;){if(this.canParse(e,a)){let P=this.appendFrame(n,e,a);P?(this.frameIndex++,this.lastPTS=P.sample.pts,a+=P.length,r=a):a=p}else{var v,w;ir(v=e,w=a)&&wr(v,w+6)+10<=v.length-w?(i=_r(e,a),l.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:i,type:ra.audioId3,duration:Number.POSITIVE_INFINITY}),a+=i.length,r=a):a++}if(a===p&&r!==p){let P=e.slice(r);this.cachedData?this.cachedData=tt(this.cachedData,P):this.cachedData=P}}return{audioTrack:n,videoTrack:la(),id3Track:l,textTrack:la()}}demuxSampleAes(e,t,r){return Promise.reject(Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){let t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:la(),id3Track:this._id3Track,textTrack:la()}}destroy(){this.cachedData=null,this._audioTrack=this._id3Track=void 0}}let an=(y,e,t)=>x(y)?90*y:9e4*e+(t?9e4*t.baseTime/t.timescale:0),cn=null,Dn=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],os=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],ps=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],$a=[0,1,1,4];function Bn(y,e,t,r,i){if(t+24>e.length)return;let a=xn(e,t);if(a&&t+a.frameLength<=e.length){let n=r+9e4*a.samplesPerFrame/a.sampleRate*i,l={unit:e.subarray(t,t+a.frameLength),pts:n,dts:n};return y.config=[],y.channelCount=a.channelCount,y.samplerate=a.sampleRate,y.samples.push(l),{sample:l,length:a.frameLength,missing:0}}}function xn(y,e){let t=y[e+1]>>3&3,r=y[e+1]>>1&3,i=y[e+2]>>4&15,a=y[e+2]>>2&3;if(t!==1&&i!==0&&i!==15&&a!==3){let n=y[e+2]>>1&1,l=y[e+3]>>6,h=1e3*Dn[14*(t===3?3-r:r===3?3:4)+i-1],p=os[3*(t===3?0:t===2?1:2)+a],v=ps[t][r],w=$a[r],P=Math.floor(v*h/p+n)*w;if(cn===null){let D=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);cn=D?parseInt(D[1]):0}return cn&&cn<=87&&r===2&&h>=224e3&&l===0&&(y[e+3]=128|y[e+3]),{sampleRate:p,channelCount:l===3?1:2,frameLength:P,samplesPerFrame:8*v*w}}}function Gn(y,e){return y[e]===255&&(224&y[e+1])==224&&(6&y[e+1])!=0}function Zn(y,e){return e+1<y.length&&Gn(y,e)}function Li(y,e){if(e+1<y.length&&Gn(y,e)){let t=xn(y,e),r=4;t!=null&&t.frameLength&&(r=t.frameLength);let i=e+r;return i===y.length||Zn(y,i)}return!1}class Qn extends Xn{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e,t){if(!e)return!1;let r=_r(e,0),i=r?.length||0;if(Li(e,i))return!1;for(let a=e.length;i<a;i++)if(function(n,l){if(Ur(n,l)){let h=ga(n,l);if(l+h>=n.length)return!1;let p=Vi(n,l);if(p<=h)return!1;let v=l+p;return v===n.length||Ur(n,v)}return!1}(e,i))return t.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return t+5<e.length&&Qr(e,t)&&Vi(e,t)<=e.length-t}appendFrame(e,t,r){ta(e,this.observer,t,r,e.manifestCodec);let i=Ii(e,t,r,this.basePTS,this.frameIndex);if(i&&i.missing===0)return i}}let ja=(y,e)=>{let t=0,r=5;e+=5;let i=new Uint32Array(1),a=new Uint32Array(1),n=new Uint8Array(1);for(;r>0;){n[0]=y[e];let l=Math.min(r,8),h=8-l;a[0]=4278190080>>>24+h<<h,i[0]=(n[0]&a[0])>>h,t=t?t<<l|i[0]:i[0],e+=1,r-=l}return t};class Ha extends Xn{constructor(e){super(),this.observer=void 0,this.observer=e}resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/ac-3",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"ac3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}canParse(e,t){return t+64<e.length}appendFrame(e,t,r){let i=On(e,t,r,this.basePTS,this.frameIndex);if(i!==-1)return{sample:e.samples[e.samples.length-1],length:i,missing:0}}static probe(e){if(!e)return!1;let t=_r(e,0);if(!t)return!1;let r=t.length;return e[r]===11&&e[r+1]===119&&Ki(t)!==void 0&&16>ja(e,r)}}function On(y,e,t,r,i){if(t+8>e.length||e[t]!==11||e[t+1]!==119)return-1;let a=e[t+4]>>6;if(a>=3)return-1;let n=[48e3,44100,32e3][a],l=63&e[t+4],h=2*[64,69,96,64,70,96,80,87,120,80,88,120,96,104,144,96,105,144,112,121,168,112,122,168,128,139,192,128,140,192,160,174,240,160,175,240,192,208,288,192,209,288,224,243,336,224,244,336,256,278,384,256,279,384,320,348,480,320,349,480,384,417,576,384,418,576,448,487,672,448,488,672,512,557,768,512,558,768,640,696,960,640,697,960,768,835,1152,768,836,1152,896,975,1344,896,976,1344,1024,1114,1536,1024,1115,1536,1152,1253,1728,1152,1254,1728,1280,1393,1920,1280,1394,1920][3*l+a];if(t+h>e.length)return-1;let p=e[t+6]>>5,v=0;p===2?v+=2:(1&p&&p!==1&&(v+=2),4&p&&(v+=2));let w=(e[t+6]<<8|e[t+7])>>12-v&1,P=[2,1,2,3,3,4,4,5][p]+w,D=e[t+5]>>3,G=7&e[t+5],z=new Uint8Array([a<<6|D<<1|G>>2,(3&G)<<6|p<<3|w<<2|l>>4,l<<4&224]),H=e.subarray(t,t+h);return y.config=z,y.channelCount=P,y.samplerate=n,y.samples.push({unit:H,pts:r+1536/n*9e4*i}),h}class ma extends Xn{resetInitSegment(e,t,r,i){super.resetInitSegment(e,t,r,i),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:i,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=_r(e,0),r=t?.length||0;if(t&&e[r]===11&&e[r+1]===119&&Ki(t)!==void 0&&16>=ja(e,r))return!1;for(let i=e.length;r<i;r++)if(Li(e,r))return se.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return Gn(e,t)&&4<=e.length-t}appendFrame(e,t,r){if(this.basePTS!==null)return Bn(e,t,r,this.basePTS,this.frameIndex)}}let Tn=/\/emsg[-/]ID3/i;class hn{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,r,i){let a=this.videoTrack=la("video",1),n=this.audioTrack=la("audio",1),l=this.txtTrack=la("text",1);if(this.id3Track=la("id3",1),this.timeOffset=0,!(e!=null&&e.byteLength))return;let h=Ge(e);if(h.video){let{id:p,timescale:v,codec:w,supplemental:P}=h.video;a.id=p,a.timescale=l.timescale=v,a.codec=w,a.supplemental=P}if(h.audio){let{id:p,timescale:v,codec:w}=h.audio;n.id=p,n.timescale=v,n.codec=w}l.id=Z.text,a.sampleDuration=0,a.duration=n.duration=i}resetContiguity(){this.remainderData=null}static probe(e){return function(t){let r=t.byteLength;for(let i=0;i<r;){let a=Q(t,i);if(a>8&&t[i+4]===109&&t[i+5]===111&&t[i+6]===111&&t[i+7]===102)return!0;i=a>1?i+a:r}return!1}(e)}demux(e,t){this.timeOffset=t;let r=e,i=this.videoTrack,a=this.txtTrack;if(this.config.progressive){this.remainderData&&(r=tt(this.remainderData,e));let l=function(h){let p={valid:null,remainder:null},v=ye(h,["moof"]);if(v.length<2)return p.remainder=h,p;let w=v[v.length-1];return p.valid=h.slice(0,w.byteOffset-8),p.remainder=h.slice(w.byteOffset-8),p}(r);this.remainderData=l.remainder,i.samples=l.valid||new Uint8Array}else i.samples=r;let n=this.extractID3Track(i,t);return a.samples=Ct(t,i),{videoTrack:i,audioTrack:this.audioTrack,id3Track:n,textTrack:this.txtTrack}}flush(){let e=this.timeOffset,t=this.videoTrack,r=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;let i=this.extractID3Track(t,this.timeOffset);return r.samples=Ct(e,t),{videoTrack:t,audioTrack:la(),id3Track:i,textTrack:la()}}extractID3Track(e,t){let r=this.id3Track;if(e.samples.length){let i=ye(e.samples,["emsg"]);i&&i.forEach(a=>{let n=function(l){let h=l[0],p="",v="",w=0,P=0,D=0,G=0,z=0,H=0;if(h===0){for(;ne(l.subarray(H,H+1))!=="\0";)p+=ne(l.subarray(H,H+1)),H+=1;for(p+=ne(l.subarray(H,H+1)),H+=1;ne(l.subarray(H,H+1))!=="\0";)v+=ne(l.subarray(H,H+1)),H+=1;v+=ne(l.subarray(H,H+1)),H+=1,w=Q(l,12),P=Q(l,16),G=Q(l,20),z=Q(l,24),H=28}else if(h===1){H+=4,w=Q(l,H);let oe=Q(l,H+=4),Se=Q(l,H+=4);for(H+=4,k(D=4294967296*oe+Se)||(D=Number.MAX_SAFE_INTEGER,se.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),G=Q(l,H),H+=4,z=Q(l,H),H+=4;ne(l.subarray(H,H+1))!=="\0";)p+=ne(l.subarray(H,H+1)),H+=1;for(p+=ne(l.subarray(H,H+1)),H+=1;ne(l.subarray(H,H+1))!=="\0";)v+=ne(l.subarray(H,H+1)),H+=1;v+=ne(l.subarray(H,H+1)),H+=1}return{schemeIdUri:p,value:v,timeScale:w,presentationTime:D,presentationTimeDelta:P,eventDuration:G,id:z,payload:l.subarray(H,l.byteLength)}}(a);if(Tn.test(n.schemeIdUri)){let l=za(n,t),h=n.eventDuration===4294967295?Number.POSITIVE_INFINITY:n.eventDuration/n.timeScale;h<=.001&&(h=Number.POSITIVE_INFINITY);let p=n.payload;r.samples.push({data:p,len:p.byteLength,dts:l,pts:l,type:ra.emsg,duration:h})}else if(this.config.enableEmsgKLVMetadata&&n.schemeIdUri.startsWith("urn:misb:KLV:bin:1910.1")){let l=za(n,t);r.samples.push({data:n.payload,len:n.payload.byteLength,dts:l,pts:l,type:ra.misbklv,duration:Number.POSITIVE_INFINITY})}})}return r}demuxSampleAes(e,t,r){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){this.config=null,this.remainderData=null,this.videoTrack=this.audioTrack=this.id3Track=this.txtTrack=void 0}}function za(y,e){return x(y.presentationTime)?y.presentationTime/y.timeScale:e+y.presentationTimeDelta/y.timeScale}class Rr{constructor(e,t,r){this.keyData=void 0,this.decrypter=void 0,this.keyData=r,this.decrypter=new vn(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer,tn.cbc)}decryptAacSample(e,t,r){let i=e[t].unit;if(i.length<=16)return;let a=i.subarray(16,i.length-i.length%16),n=a.buffer.slice(a.byteOffset,a.byteOffset+a.length);this.decryptBuffer(n).then(l=>{let h=new Uint8Array(l);i.set(h,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,r)}).catch(r)}decryptAacSamples(e,t,r){for(;;t++){if(t>=e.length){r();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,r),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){let t=new Int8Array(16*Math.floor((e.length-48)/160)+16),r=0;for(let i=32;i<e.length-16;i+=160,r+=16)t.set(e.subarray(i,i+16),r);return t}getAvcDecryptedUnit(e,t){let r=new Uint8Array(t),i=0;for(let a=32;a<e.length-16;a+=160,i+=16)e.set(r.subarray(i,i+16),a);return e}decryptAvcSample(e,t,r,i,a){let n=Dt(a.data),l=this.getAvcEncryptedData(n);this.decryptBuffer(l.buffer).then(h=>{a.data=this.getAvcDecryptedUnit(n,h),this.decrypter.isSync()||this.decryptAvcSamples(e,t,r+1,i)}).catch(i)}decryptAvcSamples(e,t,r,i){if(e instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");for(;;t++,r=0){if(t>=e.length){i();return}let a=e[t].units;for(;!(r>=a.length);r++){let n=a[r];if(!(n.data.length<=48)&&(n.type===1||n.type===5)&&(this.decryptAvcSample(e,t,r,i,n),!this.decrypter.isSync()))return}}}}class pr{constructor(){this.VideoSample=null}createVideoSample(e,t,r){return{key:e,frame:!1,pts:t,dts:r,units:[],length:0}}getLastNalUnit(e){var t;let r,i=this.VideoSample;if(i&&i.units.length!==0||(i=e[e.length-1]),(t=i)!=null&&t.units){let a=i.units;r=a[a.length-1]}return r}pushAccessUnit(e,t){if(e.units.length&&e.frame){if(e.pts===void 0){let r=t.samples,i=r.length;if(i){let a=r[i-1];e.pts=a.pts,e.dts=a.dts}else{t.dropped++;return}}t.samples.push(e)}}parseNALu(e,t,r){let i,a,n,l=t.byteLength,h=e.naluState||0,p=h,v=[],w=0,P=-1,D=0;for(h===-1&&(P=0,D=this.getNALuType(t,0),h=0,w=1);w<l;){if(i=t[w++],!h){h=i?0:1;continue}if(h===1){h=i?0:2;continue}if(i)if(i===1){if(a=w-h-1,P>=0){let G={data:t.subarray(P,a),type:D};v.push(G)}else{let G=this.getLastNalUnit(e.samples);G&&(p&&w<=4-p&&G.state&&(G.data=G.data.subarray(0,G.data.byteLength-p)),a>0&&(G.data=tt(G.data,t.subarray(0,a)),G.state=0))}w<l?(n=this.getNALuType(t,w),P=w,D=n,h=0):h=-1}else h=0;else h=3}if(P>=0&&h>=0){let G={data:t.subarray(P,l),type:D,state:h};v.push(G)}if(v.length===0){let G=this.getLastNalUnit(e.samples);G&&(G.data=tt(G.data,t))}return e.naluState=h,v}}class Cr{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let e=this.data,t=this.bytesAvailable,r=e.byteLength-t,i=new Uint8Array(4),a=Math.min(4,t);if(a===0)throw Error("no bytes available");i.set(e.subarray(r,r+a)),this.word=new DataView(i.buffer).getUint32(0),this.bitsAvailable=8*a,this.bytesAvailable-=a}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e||(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e}readBits(e){let t=Math.min(this.bitsAvailable,e),r=this.word>>>32-t;if(e>32&&se.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw Error("no bits available");return(t=e-t)>0&&this.bitsAvailable?r<<t|this.readBits(t):r}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!=0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let e=this.skipLZ();return this.readBits(e+1)-1}readEG(){let e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return this.readBits(1)===1}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}}class $r extends pr{parsePES(e,t,r,i){let a,n=this.parseNALu(e,r.data,i),l=this.VideoSample,h=!1;r.data=null,l&&n.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),n.forEach(p=>{var v,w,P,D,G;switch(p.type){case 1:{let z=!1;a=!0;let H=p.data;if(h&&H.length>4){let oe=this.readSliceType(H);(oe===2||oe===4||oe===7||oe===9)&&(z=!0)}z&&(P=l)!=null&&P.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),l.frame=!0,l.key=z;break}case 5:a=!0,(v=l)!=null&&v.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 6:a=!0,Tt(p.data,1,r.pts,t.samples);break;case 7:{a=!0,h=!0;let z=p.data,H=this.readSPS(z);if(!e.sps||e.width!==H.width||e.height!==H.height||((D=e.pixelRatio)==null?void 0:D[0])!==H.pixelRatio[0]||((G=e.pixelRatio)==null?void 0:G[1])!==H.pixelRatio[1]){e.width=H.width,e.height=H.height,e.pixelRatio=H.pixelRatio,e.sps=[z];let oe=z.subarray(1,4),Se="avc1.";for(let me=0;me<3;me++){let Te=oe[me].toString(16);Te.length<2&&(Te="0"+Te),Se+=Te}e.codec=Se}break}case 8:a=!0,e.pps=[p.data];break;case 9:a=!0,e.audFound=!0,(w=l)!=null&&w.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;case 12:a=!0;break;default:a=!1}l&&a&&l.units.push(p)}),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}getNALuType(e,t){return 31&e[t]}readSliceType(e){let t=new Cr(e);return t.readUByte(),t.readUEG(),t.readUEG()}skipScalingList(e,t){let r=8,i=8;for(let a=0;a<e;a++)i!==0&&(i=(r+t.readEG()+256)%256),r=i===0?r:i}readSPS(e){let t,r,i,a=new Cr(e),n=0,l=0,h=0,p=0,v=a.readUByte.bind(a),w=a.readBits.bind(a),P=a.readUEG.bind(a),D=a.readBoolean.bind(a),G=a.skipBits.bind(a),z=a.skipEG.bind(a),H=a.skipUEG.bind(a),oe=this.skipScalingList.bind(this);v();let Se=v();if(w(5),G(3),v(),H(),Se===100||Se===110||Se===122||Se===244||Se===44||Se===83||Se===86||Se===118||Se===128){let ze=P();if(ze===3&&G(1),H(),H(),G(1),D())for(i=0,r=ze!==3?8:12;i<r;i++)D()&&oe(i<6?16:64,a)}H();let me=P();if(me===0)P();else if(me===1)for(G(1),z(),z(),t=P(),i=0;i<t;i++)z();H(),G(1);let Te=P(),Be=P(),je=w(1);je===0&&G(1),G(1),D()&&(n=P(),l=P(),h=P(),p=P());let ge=[1,1];if(D()&&D())switch(v()){case 1:ge=[1,1];break;case 2:ge=[12,11];break;case 3:ge=[10,11];break;case 4:ge=[16,11];break;case 5:ge=[40,33];break;case 6:ge=[24,11];break;case 7:ge=[20,11];break;case 8:ge=[32,11];break;case 9:ge=[80,33];break;case 10:ge=[18,11];break;case 11:ge=[15,11];break;case 12:ge=[64,33];break;case 13:ge=[160,99];break;case 14:ge=[4,3];break;case 15:ge=[3,2];break;case 16:ge=[2,1];break;case 255:ge=[v()<<8|v(),v()<<8|v()]}return{width:Math.ceil((Te+1)*16-2*n-2*l),height:(2-je)*(Be+1)*16-(je?2:4)*(h+p),pixelRatio:ge}}}class ya extends pr{constructor(...e){super(...e),this.initVPS=null}parsePES(e,t,r,i){let a,n=this.parseNALu(e,r.data,i),l=this.VideoSample,h=!1;r.data=null,l&&n.length&&!e.audFound&&(this.pushAccessUnit(l,e),l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),n.forEach(p=>{var v,w,P;switch(p.type){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:l||(l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts)),l.frame=!0,a=!0;break;case 16:case 17:case 18:case 21:a=!0,h&&(P=l)!=null&&P.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 19:case 20:a=!0,(v=l)!=null&&v.frame&&!l.key&&(this.pushAccessUnit(l,e),l=this.VideoSample=null),l||(l=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),l.key=!0,l.frame=!0;break;case 39:a=!0,Tt(p.data,2,r.pts,t.samples);break;case 32:a=!0,e.vps||(typeof e.params!="object"&&(e.params={}),e.params=_(e.params,this.readVPS(p.data)),this.initVPS=p.data),e.vps=[p.data];break;case 33:if(a=!0,h=!0,e.vps===void 0||e.vps[0]===this.initVPS||e.sps===void 0||this.matchSPS(e.sps[0],p.data)||(this.initVPS=e.vps[0],e.sps=e.pps=void 0),!e.sps){let D=this.readSPS(p.data);for(let G in e.width=D.width,e.height=D.height,e.pixelRatio=D.pixelRatio,e.codec=D.codecString,e.sps=[],typeof e.params!="object"&&(e.params={}),D.params)e.params[G]=D.params[G]}this.pushParameterSet(e.sps,p.data,e.vps),l||(l=this.VideoSample=this.createVideoSample(!0,r.pts,r.dts)),l.key=!0;break;case 34:if(a=!0,typeof e.params=="object"){if(!e.pps){e.pps=[];let D=this.readPPS(p.data);for(let G in D)e.params[G]=D[G]}this.pushParameterSet(e.pps,p.data,e.vps)}break;case 35:a=!0,e.audFound=!0,(w=l)!=null&&w.frame&&(this.pushAccessUnit(l,e),l=null),l||(l=this.VideoSample=this.createVideoSample(!1,r.pts,r.dts));break;default:a=!1}l&&a&&l.units.push(p)}),i&&l&&(this.pushAccessUnit(l,e),this.VideoSample=null)}pushParameterSet(e,t,r){(!r||r[0]!==this.initVPS)&&(r||e.length)||e.push(t)}getNALuType(e,t){return(126&e[t])>>>1}ebsp2rbsp(e){let t=new Uint8Array(e.byteLength),r=0;for(let i=0;i<e.byteLength;i++)(!(i>=2)||e[i]!==3||e[i-1]!==0||e[i-2]!==0)&&(t[r]=e[i],r++);return new Uint8Array(t.buffer,0,r)}pushAccessUnit(e,t){super.pushAccessUnit(e,t),this.initVPS&&(this.initVPS=null)}readVPS(e){let t=new Cr(e);return t.readUByte(),t.readUByte(),t.readBits(4),t.skipBits(2),t.readBits(6),{numTemporalLayers:t.readBits(3)+1,temporalIdNested:t.readBoolean()}}readSPS(e){let t=new Cr(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.readBits(4);let r=t.readBits(3);t.readBoolean();let i=t.readBits(2),a=t.readBoolean(),n=t.readBits(5),l=t.readUByte(),h=t.readUByte(),p=t.readUByte(),v=t.readUByte(),w=t.readUByte(),P=t.readUByte(),D=t.readUByte(),G=t.readUByte(),z=t.readUByte(),H=t.readUByte(),oe=t.readUByte(),Se=[],me=[];for(let Ut=0;Ut<r;Ut++)Se.push(t.readBoolean()),me.push(t.readBoolean());if(r>0)for(let Ut=r;Ut<8;Ut++)t.readBits(2);for(let Ut=0;Ut<r;Ut++)Se[Ut]&&(t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte(),t.readUByte()),me[Ut]&&t.readUByte();t.readUEG();let Te=t.readUEG();Te==3&&t.skipBits(1);let Be=t.readUEG(),je=t.readUEG(),ge=t.readBoolean(),ze=0,Fe=0,rt=0,st=0;ge&&(ze+=t.readUEG(),Fe+=t.readUEG(),rt+=t.readUEG(),st+=t.readUEG());let kt=t.readUEG(),Ye=t.readUEG(),et=t.readUEG(),dt=t.readBoolean();for(let Ut=dt?0:r;Ut<=r;Ut++)t.skipUEG(),t.skipUEG(),t.skipUEG();if(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG(),t.readBoolean()&&t.readBoolean())for(let Ut=0;Ut<4;Ut++)for(let oi=0;oi<(Ut===3?2:6);oi++)if(t.readBoolean()){let xi=Math.min(64,1<<4+(Ut<<1));Ut>1&&t.readEG();for(let fa=0;fa<xi;fa++)t.readEG()}else t.readUEG();t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.skipUEG(),t.skipUEG(),t.readBoolean());let bt=t.readUEG(),_t=0;for(let Ut=0;Ut<bt;Ut++){let oi=!1;if(Ut!==0&&(oi=t.readBoolean()),oi){Ut===bt&&t.readUEG(),t.readBoolean(),t.readUEG();let xi=0;for(let fa=0;fa<=_t;fa++){let Qi=t.readBoolean(),Ji=!1;Qi||(Ji=t.readBoolean()),(Qi||Ji)&&xi++}_t=xi}else{let xi=t.readUEG(),fa=t.readUEG();_t=xi+fa;for(let Qi=0;Qi<xi;Qi++)t.readUEG(),t.readBoolean();for(let Qi=0;Qi<fa;Qi++)t.readUEG(),t.readBoolean()}}if(t.readBoolean()){let Ut=t.readUEG();for(let oi=0;oi<Ut;oi++){for(let xi=0;xi<et+4;xi++)t.readBits(1);t.readBits(1)}}let xt=0,at=1,nt=1,Zt=!0,lr=1,ar=0;if(t.readBoolean(),t.readBoolean(),t.readBoolean()){if(t.readBoolean()){let Ut=t.readUByte();Ut>0&&Ut<16?(at=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][Ut-1],nt=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][Ut-1]):Ut===255&&(at=t.readBits(16),nt=t.readBits(16))}if(t.readBoolean()&&t.readBoolean(),t.readBoolean()&&(t.readBits(3),t.readBoolean(),t.readBoolean()&&(t.readUByte(),t.readUByte(),t.readUByte())),t.readBoolean()&&(t.readUEG(),t.readUEG()),t.readBoolean(),t.readBoolean(),t.readBoolean(),t.readBoolean()&&(t.skipUEG(),t.skipUEG(),t.skipUEG(),t.skipUEG()),t.readBoolean()&&(lr=t.readBits(32),ar=t.readBits(32),t.readBoolean()&&t.readUEG(),t.readBoolean())){let Ut=t.readBoolean(),oi=t.readBoolean(),xi=!1;(Ut||oi)&&((xi=t.readBoolean())&&(t.readUByte(),t.readBits(5),t.readBoolean(),t.readBits(5)),t.readBits(4),t.readBits(4),xi&&t.readBits(4),t.readBits(5),t.readBits(5),t.readBits(5));for(let fa=0;fa<=r;fa++){let Qi=(Zt=t.readBoolean())||t.readBoolean(),Ji=!1;Qi?t.readEG():Ji=t.readBoolean();let Ta=Ji?1:t.readUEG()+1;if(Ut)for(let Lr=0;Lr<Ta;Lr++)t.readUEG(),t.readUEG(),xi&&(t.readUEG(),t.readUEG()),t.skipBits(1);if(oi)for(let Lr=0;Lr<Ta;Lr++)t.readUEG(),t.readUEG(),xi&&(t.readUEG(),t.readUEG()),t.skipBits(1)}}t.readBoolean()&&(t.readBoolean(),t.readBoolean(),t.readBoolean(),xt=t.readUEG())}let Mt=Be,Pt=je;if(ge){let Ut=1,oi=1;Te===1?Ut=oi=2:Te==2&&(Ut=2),Mt=Be-Ut*Fe-Ut*ze,Pt=je-oi*st-oi*rt}let nr=i?["A","B","C"][i]:"",qt=l<<24|h<<16|p<<8|v,si=0;for(let Ut=0;Ut<32;Ut++)si=(si|(qt>>Ut&1)<<31-Ut)>>>0;let $i=si.toString(16);return n===1&&$i==="2"&&($i="6"),{codecString:`hvc1.${nr}${n}.${$i}.${a?"H":"L"}${oe}.B0`,params:{general_tier_flag:a,general_profile_idc:n,general_profile_space:i,general_profile_compatibility_flags:[l,h,p,v],general_constraint_indicator_flags:[w,P,D,G,z,H],general_level_idc:oe,bit_depth:kt+8,bit_depth_luma_minus8:kt,bit_depth_chroma_minus8:Ye,min_spatial_segmentation_idc:xt,chroma_format_idc:Te,frame_rate:{fixed:Zt,fps:ar/lr}},width:Mt,height:Pt,pixelRatio:[at,nt]}}readPPS(e){let t=new Cr(this.ebsp2rbsp(e));t.readUByte(),t.readUByte(),t.skipUEG(),t.skipUEG(),t.skipBits(2),t.skipBits(3),t.skipBits(2),t.skipUEG(),t.skipUEG(),t.skipEG(),t.skipBits(2),t.readBoolean()&&t.skipUEG(),t.skipEG(),t.skipEG(),t.skipBits(4);let r=t.readBoolean(),i=t.readBoolean(),a=1;return i&&r?a=0:i?a=3:r&&(a=2),{parallelismType:a}}matchSPS(e,t){return String.fromCharCode.apply(null,e).substr(3)===String.fromCharCode.apply(null,t).substr(3)}}class Vr{constructor(e,t,r,i){this.logger=void 0,this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._pmtId=-1,this._videoTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.remainderData=null,this.videoParser=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.logger=i,this.videoParser=null}static probe(e,t){let r=Vr.syncOffset(e);return r>0&&t.warn(`MPEG2-TS detected but first sync word found @ offset ${r}`),r!==-1}static syncOffset(e){let t=e.length,r=Math.min(940,t-188)+1,i=0;for(;i<r;){let a=!1,n=-1,l=0;for(let h=i;h<t;h+=188)if(e[h]===71&&(t-h==188||e[h+188]===71)){if(l++,n===-1&&(n=h)!==0&&(r=Math.min(n+18612,e.length-188)+1),a||(a=Wi(e,h)===0),a&&l>1&&(n===0&&l>2||h+188>r))return n}else{if(l)return-1;break}i++}return-1}static createTrack(e,t){return{container:e==="video"||e==="audio"?"video/mp2t":void 0,type:e,id:Z[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:e==="audio"?t:void 0}}resetInitSegment(e,t,r,i){this.pmtParsed=!1,this._pmtId=-1,this._videoTrack=Vr.createTrack("video"),this._videoTrack.duration=i,this._audioTrack=Vr.createTrack("audio",i),this._id3Track=Vr.createTrack("id3"),this._txtTrack=Vr.createTrack("text"),this._audioTrack.segmentCodec="aac",this.videoParser=null,this.aacOverFlow=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=r}resetTimeStamp(){}resetContiguity(){let{_audioTrack:e,_videoTrack:t,_id3Track:r}=this;e&&(e.pesData=null),t&&(t.pesData=null),r&&(r.pesData=null),this.aacOverFlow=null,this.remainderData=null}demux(e,t,r=!1,i=!1){let a;r||(this.sampleAes=null);let n=this._videoTrack,l=this._audioTrack,h=this._id3Track,p=this._txtTrack,v=n.pid,w=n.pesData,P=l.pid,D=h.pid,G=l.pesData,z=h.pesData,H=null,oe=this.pmtParsed,Se=this._pmtId,me=e.length;if(this.remainderData&&(me=(e=tt(this.remainderData,e)).length,this.remainderData=null),me<188&&!i)return this.remainderData=e,{audioTrack:l,videoTrack:n,id3Track:h,textTrack:p};let Te=Math.max(0,Vr.syncOffset(e));(me-=(me-Te)%188)<e.byteLength&&!i&&(this.remainderData=new Uint8Array(e.buffer,me,e.buffer.byteLength-me));let Be=0;for(let Fe=Te;Fe<me;Fe+=188)if(e[Fe]===71){let rt,st=!!(64&e[Fe+1]),kt=Wi(e,Fe);if((48&e[Fe+3])>>4>1){if((rt=Fe+5+e[Fe+4])===Fe+188)continue}else rt=Fe+4;switch(kt){case v:st&&(w&&(a=Jr(w,this.logger))&&(this.readyVideoParser(n.segmentCodec),this.videoParser!==null&&this.videoParser.parsePES(n,p,a,!1)),w={data:[],size:0}),w&&(w.data.push(e.subarray(rt,Fe+188)),w.size+=Fe+188-rt);break;case P:if(st){if(G&&(a=Jr(G,this.logger)))switch(l.segmentCodec){case"aac":this.parseAACPES(l,a);break;case"mp3":this.parseMPEGPES(l,a);break;case"ac3":this.parseAC3PES(l,a)}G={data:[],size:0}}G&&(G.data.push(e.subarray(rt,Fe+188)),G.size+=Fe+188-rt);break;case D:st&&(z&&(a=Jr(z,this.logger))&&this.parseID3PES(h,a),z={data:[],size:0}),z&&(z.data.push(e.subarray(rt,Fe+188)),z.size+=Fe+188-rt);break;case 0:var je,ge;st&&(rt+=e[rt]+1),Se=this._pmtId=(31&(je=e)[(ge=rt)+10])<<8|je[ge+11];break;case Se:{st&&(rt+=e[rt]+1);let Ye=function(et,dt,bt,_t,xt,at){let nt={audioPid:-1,videoPid:-1,id3Pid:-1,segmentVideoCodec:"avc",segmentAudioCodec:"aac"},Zt=(15&et[dt+1])<<8|et[dt+2],lr=dt+3+Zt-4,ar=(15&et[dt+10])<<8|et[dt+11];for(dt+=12+ar;dt<lr;){let Mt=Wi(et,dt),Pt=(15&et[dt+3])<<8|et[dt+4];switch(et[dt]){case 207:if(!_t){ri("ADTS AAC",at);break}case 15:nt.audioPid===-1&&(nt.audioPid=Mt);break;case 21:nt.id3Pid===-1&&(nt.id3Pid=Mt);break;case 219:if(!_t){ri("H.264",at);break}case 27:nt.videoPid===-1&&(nt.videoPid=Mt);break;case 3:case 4:bt.mpeg||bt.mp3?nt.audioPid===-1&&(nt.audioPid=Mt,nt.segmentAudioCodec="mp3"):at.log("MPEG audio found, not supported in this browser");break;case 193:if(!_t){ri("AC-3",at);break}case 129:bt.ac3?nt.audioPid===-1&&(nt.audioPid=Mt,nt.segmentAudioCodec="ac3"):at.log("AC-3 audio found, not supported in this browser");break;case 6:if(nt.audioPid===-1&&Pt>0){let nr=dt+5,qt=Pt;for(;qt>2;){et[nr]===106&&(bt.ac3!==!0?at.log("AC-3 audio found, not supported in this browser for now"):(nt.audioPid=Mt,nt.segmentAudioCodec="ac3"));let si=et[nr+1]+2;nr+=si,qt-=si}}break;case 194:case 135:return Gt(xt,Error("Unsupported EC-3 in M2TS found"),void 0,at),nt;case 36:nt.videoPid===-1&&(nt.videoPid=Mt,nt.segmentVideoCodec="hevc",at.log("HEVC in M2TS found"))}dt+=Pt+5}return nt}(e,rt,this.typeSupported,r,this.observer,this.logger);(v=Ye.videoPid)>0&&(n.pid=v,n.segmentCodec=Ye.segmentVideoCodec),(P=Ye.audioPid)>0&&(l.pid=P,l.segmentCodec=Ye.segmentAudioCodec),(D=Ye.id3Pid)>0&&(h.pid=D),H===null||oe||(this.logger.warn(`MPEG-TS PMT found at ${Fe} after unknown PID '${H}'. Backtracking to sync byte @${Te} to parse all TS packets.`),H=null,Fe=Te-188),oe=this.pmtParsed=!0;break}case 17:case 8191:break;default:H=kt}}else Be++;Be>0&&Gt(this.observer,Error(`Found ${Be} TS packet/s that do not start with 0x47`),void 0,this.logger),n.pesData=w,l.pesData=G,h.pesData=z;let ze={audioTrack:l,videoTrack:n,id3Track:h,textTrack:p};return i&&this.extractRemainingSamples(ze),ze}flush(){let e,{remainderData:t}=this;return this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._videoTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(e){let t,{audioTrack:r,videoTrack:i,id3Track:a,textTrack:n}=e,l=i.pesData,h=r.pesData,p=a.pesData;if(l&&(t=Jr(l,this.logger))?(this.readyVideoParser(i.segmentCodec),this.videoParser!==null&&(this.videoParser.parsePES(i,n,t,!0),i.pesData=null)):i.pesData=l,h&&(t=Jr(h,this.logger))){switch(r.segmentCodec){case"aac":this.parseAACPES(r,t);break;case"mp3":this.parseMPEGPES(r,t);break;case"ac3":this.parseAC3PES(r,t)}r.pesData=null}else h!=null&&h.size&&this.logger.log("last AAC PES packet truncated,might overlap between fragments"),r.pesData=h;p&&(t=Jr(p,this.logger))?(this.parseID3PES(a,t),a.pesData=null):a.pesData=p}demuxSampleAes(e,t,r){let i=this.demux(e,r,!0,!this.config.progressive),a=this.sampleAes=new Rr(this.observer,this.config,t);return this.decrypt(i,a)}readyVideoParser(e){this.videoParser===null&&(e==="avc"?this.videoParser=new $r:e==="hevc"&&(this.videoParser=new ya))}decrypt(e,t){return new Promise(r=>{let{audioTrack:i,videoTrack:a}=e;i.samples&&i.segmentCodec==="aac"?t.decryptAacSamples(i.samples,0,()=>{a.samples?t.decryptAvcSamples(a.samples,0,0,()=>{r(e)}):r(e)}):a.samples&&t.decryptAvcSamples(a.samples,0,0,()=>{r(e)})})}destroy(){this.observer&&this.observer.removeAllListeners(),this.config=this.logger=this.observer=null,this.aacOverFlow=this.videoParser=this.remainderData=this.sampleAes=null,this._videoTrack=this._audioTrack=this._id3Track=this._txtTrack=void 0}parseAACPES(e,t){let r,i,a,n,l=0,h=this.aacOverFlow,p=t.data;if(h){this.aacOverFlow=null;let w=h.missing,P=h.sample.unit.byteLength;w===-1?p=tt(h.sample.unit,p):(h.sample.unit.set(p.subarray(0,w),P-w),e.samples.push(h.sample),l=h.missing)}for(r=l,i=p.length;r<i-1&&!Ur(p,r);r++);if(r!==l){let w,P=r<i-1;if(w=P?`AAC PES did not start with ADTS header,offset:${r}`:"No ADTS header found in AAC PES",Gt(this.observer,Error(w),P,this.logger),!P)return}if(ta(e,this.observer,p,r,this.audioCodec),t.pts!==void 0)a=t.pts;else if(h){let w=9216e4/e.samplerate;a=h.sample.pts+w}else{this.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}let v=0;for(;r<i;){if(n=Ii(e,p,r,a,v),r+=n.length,n.missing){this.aacOverFlow=n;break}for(v++;r<i-1&&!Ur(p,r);r++);}}parseMPEGPES(e,t){let r=t.data,i=r.length,a=0,n=0,l=t.pts;if(l===void 0){this.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;n<i;)if(Zn(r,n)){let h=Bn(e,r,n,l,a);if(h)n+=h.length,a++;else break}else n++}parseAC3PES(e,t){{let r,i=t.data,a=t.pts;if(a===void 0){this.logger.warn("[tsdemuxer]: AC3 PES unknown PTS");return}let n=i.length,l=0,h=0;for(;h<n&&(r=On(e,i,h,a,l++))>0;)h+=r}}parseID3PES(e,t){if(t.pts===void 0){this.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}let r=_({},t,{type:this._videoTrack?ra.emsg:ra.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(r)}}function Wi(y,e){return((31&y[e+1])<<8)+y[e+2]}function Gt(y,e,t,r){r.warn(`parsing error: ${e.message}`),y.emit(o.ERROR,o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:e,reason:e.message})}function ri(y,e){e.log(`${y} with AES-128-CBC encryption found in unencrypted stream`)}function Jr(y,e){let t,r,i,a,n,l=0,h=y.data;if(!y||y.size===0)return null;for(;h[0].length<19&&h.length>1;)h[0]=tt(h[0],h[1]),h.splice(1,1);if(((t=h[0])[0]<<16)+(t[1]<<8)+t[2]===1){if((r=(t[4]<<8)+t[5])&&r>y.size-6)return null;let p=t[7];192&p&&(a=(14&t[9])*536870912+(255&t[10])*4194304+(254&t[11])*16384+(255&t[12])*128+(254&t[13])/2,64&p?a-(n=(14&t[14])*536870912+(255&t[15])*4194304+(254&t[16])*16384+(255&t[17])*128+(254&t[18])/2)>54e5&&(e.warn(`${Math.round((a-n)/9e4)}s delta between PTS and DTS, align them`),a=n):n=a);let v=(i=t[8])+9;if(y.size<=v)return null;y.size-=v;let w=new Uint8Array(y.size);for(let P=0,D=h.length;P<D;P++){let G=(t=h[P]).byteLength;if(v){if(v>G){v-=G;continue}t=t.subarray(v),G-=v,v=0}w.set(t,l),l+=G}return r&&(r-=i+3),{data:w,pts:a,dts:n,len:r}}return null}class zi{static getSilentFrame(e,t){if(e==="mp4a.40.2"){if(t===1)return new Uint8Array([0,200,0,128,35,128]);if(t===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(t===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(t===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(t===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(t===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(t===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(t===2||t===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}class Ne{static init(){let e;for(e in Ne.types={avc1:[],avcC:[],hvc1:[],hvcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],dac3:[],"ac-3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},Ne.types)Ne.types.hasOwnProperty(e)&&(Ne.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);let t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),r=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);Ne.HDLR_TYPES={video:t,audio:r};let i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a=new Uint8Array([0,0,0,0,0,0,0,0]);Ne.STTS=Ne.STSC=Ne.STCO=a,Ne.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),Ne.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),Ne.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),Ne.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let n=new Uint8Array([105,115,111,109]),l=new Uint8Array([97,118,99,49]),h=new Uint8Array([0,0,0,1]);Ne.FTYP=Ne.box(Ne.types.ftyp,n,h,n,l),Ne.DINF=Ne.box(Ne.types.dinf,Ne.box(Ne.types.dref,i))}static box(e,...t){let r=8,i=t.length,a=i;for(;i--;)r+=t[i].byteLength;let n=new Uint8Array(r);for(n[0]=r>>24&255,n[1]=r>>16&255,n[2]=r>>8&255,n[3]=255&r,n.set(e,4),i=0,r=8;i<a;i++)n.set(t[i],r),r+=t[i].byteLength;return n}static hdlr(e){return Ne.box(Ne.types.hdlr,Ne.HDLR_TYPES[e])}static mdat(e){return Ne.box(Ne.types.mdat,e)}static mdhd(e,t){let r=Math.floor((t*=e)/4294967296),i=Math.floor(t%4294967296);return Ne.box(Ne.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))}static mdia(e){return Ne.box(Ne.types.mdia,Ne.mdhd(e.timescale||0,e.duration||0),Ne.hdlr(e.type),Ne.minf(e))}static mfhd(e){return Ne.box(Ne.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return e.type==="audio"?Ne.box(Ne.types.minf,Ne.box(Ne.types.smhd,Ne.SMHD),Ne.DINF,Ne.stbl(e)):Ne.box(Ne.types.minf,Ne.box(Ne.types.vmhd,Ne.VMHD),Ne.DINF,Ne.stbl(e))}static moof(e,t,r){return Ne.box(Ne.types.moof,Ne.mfhd(e),Ne.traf(r,t))}static moov(e){let t=e.length,r=[];for(;t--;)r[t]=Ne.trak(e[t]);return Ne.box.apply(null,[Ne.types.moov,Ne.mvhd(e[0].timescale||0,e[0].duration||0)].concat(r).concat(Ne.mvex(e)))}static mvex(e){let t=e.length,r=[];for(;t--;)r[t]=Ne.trex(e[t]);return Ne.box.apply(null,[Ne.types.mvex,...r])}static mvhd(e,t){let r=Math.floor((t*=e)/4294967296),i=Math.floor(t%4294967296),a=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return Ne.box(Ne.types.mvhd,a)}static sdtp(e){let t,r,i=e.samples||[],a=new Uint8Array(4+i.length);for(t=0;t<i.length;t++)r=i[t].flags,a[t+4]=r.dependsOn<<4|r.isDependedOn<<2|r.hasRedundancy;return Ne.box(Ne.types.sdtp,a)}static stbl(e){return Ne.box(Ne.types.stbl,Ne.stsd(e),Ne.box(Ne.types.stts,Ne.STTS),Ne.box(Ne.types.stsc,Ne.STSC),Ne.box(Ne.types.stsz,Ne.STSZ),Ne.box(Ne.types.stco,Ne.STCO))}static avc1(e){let t,r,i,a=[],n=[];for(t=0;t<e.sps.length;t++)i=(r=e.sps[t]).byteLength,a.push(i>>>8&255),a.push(255&i),a=a.concat(Array.prototype.slice.call(r));for(t=0;t<e.pps.length;t++)i=(r=e.pps[t]).byteLength,n.push(i>>>8&255),n.push(255&i),n=n.concat(Array.prototype.slice.call(r));let l=Ne.box(Ne.types.avcC,new Uint8Array([1,a[3],a[4],a[5],255,224|e.sps.length].concat(a).concat([e.pps.length]).concat(n))),h=e.width,p=e.height,v=e.pixelRatio[0],w=e.pixelRatio[1];return Ne.box(Ne.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,p>>8&255,255&p,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,Ne.box(Ne.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ne.box(Ne.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,255&v,w>>24,w>>16&255,w>>8&255,255&w])))}static esds(e){return new Uint8Array([0,0,0,0,3,25,0,1,0,4,17,64,21,0,0,0,0,0,0,0,0,0,0,0,5,2,...e.config,6,1,2])}static audioStsd(e){let t=e.samplerate||0;return new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount||0,0,16,0,0,0,0,t>>8&255,255&t,0,0])}static mp4a(e){return Ne.box(Ne.types.mp4a,Ne.audioStsd(e),Ne.box(Ne.types.esds,Ne.esds(e)))}static mp3(e){return Ne.box(Ne.types[".mp3"],Ne.audioStsd(e))}static ac3(e){return Ne.box(Ne.types["ac-3"],Ne.audioStsd(e),Ne.box(Ne.types.dac3,e.config))}static stsd(e){let{segmentCodec:t}=e;if(e.type==="audio"){if(t==="aac")return Ne.box(Ne.types.stsd,Ne.STSD,Ne.mp4a(e));if(t==="ac3"&&e.config)return Ne.box(Ne.types.stsd,Ne.STSD,Ne.ac3(e));if(t==="mp3"&&e.codec==="mp3")return Ne.box(Ne.types.stsd,Ne.STSD,Ne.mp3(e))}else if(e.pps&&e.sps){if(t==="avc")return Ne.box(Ne.types.stsd,Ne.STSD,Ne.avc1(e));if(t==="hevc"&&e.vps)return Ne.box(Ne.types.stsd,Ne.STSD,Ne.hvc1(e))}else throw Error("video track missing pps or sps");throw Error(`unsupported ${e.type} segment codec (${t}/${e.codec})`)}static tkhd(e){let t=e.id,r=(e.duration||0)*(e.timescale||0),i=e.width||0,a=e.height||0,n=Math.floor(r/4294967296),l=Math.floor(r%4294967296);return Ne.box(Ne.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,l>>24,l>>16&255,l>>8&255,255&l,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>8&255,255&i,0,0,a>>8&255,255&a,0,0]))}static traf(e,t){let r=Ne.sdtp(e),i=e.id,a=Math.floor(t/4294967296),n=Math.floor(t%4294967296);return Ne.box(Ne.types.traf,Ne.box(Ne.types.tfhd,new Uint8Array([0,0,0,0,i>>24,i>>16&255,i>>8&255,255&i])),Ne.box(Ne.types.tfdt,new Uint8Array([1,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,n>>24,n>>16&255,n>>8&255,255&n])),Ne.trun(e,r.length+16+20+8+16+8+8),r)}static trak(e){return e.duration=e.duration||4294967295,Ne.box(Ne.types.trak,Ne.tkhd(e),Ne.mdia(e))}static trex(e){let t=e.id;return Ne.box(Ne.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){let r,i,a,n,l,h,p=e.samples||[],v=p.length,w=12+16*v,P=new Uint8Array(w);for(t+=8+w,P.set([e.type==="video"?1:0,0,15,1,v>>>24&255,v>>>16&255,v>>>8&255,255&v,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),r=0;r<v;r++)a=(i=p[r]).duration,n=i.size,l=i.flags,h=i.cts,P.set([a>>>24&255,a>>>16&255,a>>>8&255,255&a,n>>>24&255,n>>>16&255,n>>>8&255,255&n,l.isLeading<<2|l.dependsOn,l.isDependedOn<<6|l.hasRedundancy<<4|l.paddingValue<<1|l.isNonSync,61440&l.degradPrio,15&l.degradPrio,h>>>24&255,h>>>16&255,h>>>8&255,255&h],12+16*r);return Ne.box(Ne.types.trun,P)}static initSegment(e){Ne.types||Ne.init();let t=Ne.moov(e);return tt(Ne.FTYP,t)}static hvc1(e){let t=e.params,r=[e.vps,e.sps,e.pps],i=new Uint8Array([1,t.general_profile_space<<6|(t.general_tier_flag?32:0)|t.general_profile_idc,t.general_profile_compatibility_flags[0],t.general_profile_compatibility_flags[1],t.general_profile_compatibility_flags[2],t.general_profile_compatibility_flags[3],t.general_constraint_indicator_flags[0],t.general_constraint_indicator_flags[1],t.general_constraint_indicator_flags[2],t.general_constraint_indicator_flags[3],t.general_constraint_indicator_flags[4],t.general_constraint_indicator_flags[5],t.general_level_idc,240|t.min_spatial_segmentation_idc>>8,255&t.min_spatial_segmentation_idc,252|t.parallelismType,252|t.chroma_format_idc,248|t.bit_depth_luma_minus8,248|t.bit_depth_chroma_minus8,0,parseInt(t.frame_rate.fps),3|t.temporal_id_nested<<2|t.num_temporal_layers<<3|(t.frame_rate.fixed?64:0),r.length]),a=i.length;for(let D=0;D<r.length;D+=1){a+=3;for(let G=0;G<r[D].length;G+=1)a+=2+r[D][G].length}let n=new Uint8Array(a);n.set(i,0),a=i.length;let l=r.length-1;for(let D=0;D<r.length;D+=1){n.set(new Uint8Array([32+D|(D===l?128:0),0,r[D].length]),a),a+=3;for(let G=0;G<r[D].length;G+=1)n.set(new Uint8Array([r[D][G].length>>8,255&r[D][G].length]),a),a+=2,n.set(r[D][G],a),a+=r[D][G].length}let h=Ne.box(Ne.types.hvcC,n),p=e.width,v=e.height,w=e.pixelRatio[0],P=e.pixelRatio[1];return Ne.box(Ne.types.hvc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,p>>8&255,255&p,v>>8&255,255&v,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),h,Ne.box(Ne.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),Ne.box(Ne.types.pasp,new Uint8Array([w>>24,w>>16&255,w>>8&255,255&w,P>>24,P>>16&255,P>>8&255,255&P])))}}function Sa(y,e,t=1,r=!1){let i=y*e*t;return r?Math.round(i):i}function br(y,e=!1){return Sa(y,1e3,11111111111111112e-21,e)}Ne.types=void 0,Ne.HDLR_TYPES=void 0,Ne.STTS=void 0,Ne.STSC=void 0,Ne.STCO=void 0,Ne.STSZ=void 0,Ne.VMHD=void 0,Ne.SMHD=void 0,Ne.STSD=void 0,Ne.FTYP=void 0,Ne.DINF=void 0;let Pi=null,ka=null;function nn(y,e,t,r){return{duration:e,size:t,cts:r,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:y?2:1,isNonSync:y?0:1}}}class da extends L{constructor(e,t,r,i){if(super("mp4-remuxer",i),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextVideoTs=null,this.nextAudioTs=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.videoTrackConfig=void 0,this.observer=e,this.config=t,this.typeSupported=r,this.ISGenerated=!1,Pi===null){let a=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Pi=a?parseInt(a[1]):0}if(ka===null){let a=navigator.userAgent.match(/Safari\/(\d+)/i);ka=a?parseInt(a[1]):0}}destroy(){this.config=this.videoTrackConfig=this._initPTS=this._initDTS=null}resetTimeStamp(e){this.log("initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){this.log("reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){this.log("ISGenerated flag reset"),this.ISGenerated=!1,this.videoTrackConfig=void 0}getVideoStartPts(e){let t=!1,r=e[0].pts,i=e.reduce((a,n)=>{let l=n.pts,h=l-a;return h<-4294967296&&(t=!0,h=(l=ia(l,r))-a),h>0?a:l},r);return t&&this.debug("PTS rollover detected"),i}remux(e,t,r,i,a,n,l,h){let p,v,w,P,D,G,z=a,H=a,oe=e.pid>-1,Se=t.pid>-1,me=t.samples.length,Te=e.samples.length>0,Be=l&&me>0||me>1;if((!oe||Te)&&(!Se||Be)||this.ISGenerated||l){let rt;if(this.ISGenerated){var je,ge,ze,Fe;let Ye=this.videoTrackConfig;(Ye&&(t.width!==Ye.width||t.height!==Ye.height||((je=t.pixelRatio)==null?void 0:je[0])!==((ge=Ye.pixelRatio)==null?void 0:ge[0])||((ze=t.pixelRatio)==null?void 0:ze[1])!==((Fe=Ye.pixelRatio)==null?void 0:Fe[1]))||!Ye&&Be||this.nextAudioTs===null&&Te)&&this.resetInitSegment()}this.ISGenerated||(w=this.generateIS(e,t,a,n));let st=this.isVideoContiguous,kt=-1;if(Be&&(kt=function(Ye){for(let et=0;et<Ye.length;et++)if(Ye[et].key)return et;return-1}(t.samples),!st&&this.config.forceKeyFrameOnDiscontinuity))if(G=!0,kt>0){this.warn(`Dropped ${kt} out of ${me} video samples due to a missing keyframe`);let Ye=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(kt),t.dropped+=kt,H+=(t.samples[0].pts-Ye)/t.inputTimeScale,rt=H}else kt===-1&&(this.warn(`No keyframe found out of ${me} video samples`),G=!1);if(this.ISGenerated){if(Te&&Be){let Ye=this.getVideoStartPts(t.samples),et=(ia(e.samples[0].pts,Ye)-Ye)/t.inputTimeScale;z+=Math.max(0,et),H+=Math.max(0,-et)}if(Te){if(e.samplerate||(this.warn("regenerate InitSegment as audio detected"),w=this.generateIS(e,t,a,n)),v=this.remuxAudio(e,z,this.isAudioContiguous,n,Se||Be||h===m.AUDIO?H:void 0),Be){let Ye=v?v.endPTS-v.startPTS:0;t.inputTimeScale||(this.warn("regenerate InitSegment as video detected"),w=this.generateIS(e,t,a,n)),p=this.remuxVideo(t,H,st,Ye)}}else Be&&(p=this.remuxVideo(t,H,st,0));p&&(p.firstKeyFrame=kt,p.independent=kt!==-1,p.firstKeyFramePTS=rt)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(r.samples.length&&(D=Ya(r,a,this._initPTS,this._initDTS)),i.samples.length&&(P=Jn(i,a,this._initPTS))),{audio:v,video:p,initSegment:w,independent:G,text:P,id3:D}}generateIS(e,t,r,i){let a,n,l,h=e.samples,p=t.samples,v=this.typeSupported,w={},P=this._initPTS,D=!P||i,G="audio/mp4",z=-1;if(D&&(a=n=1/0),e.config&&h.length){switch(e.timescale=e.samplerate,e.segmentCodec){case"mp3":v.mpeg?(G="audio/mpeg",e.codec=""):v.mp3&&(e.codec="mp3");break;case"ac3":e.codec="ac-3"}w.audio={id:"audio",container:G,codec:e.codec,initSegment:e.segmentCodec==="mp3"&&v.mpeg?new Uint8Array(0):Ne.initSegment([e]),metadata:{channelCount:e.channelCount}},D&&(z=e.id,l=e.inputTimeScale,P&&l===P.timescale?D=!1:a=n=h[0].pts-Math.round(l*r))}if(t.sps&&t.pps&&p.length){if(t.timescale=t.inputTimeScale,w.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:Ne.initSegment([t]),metadata:{width:t.width,height:t.height}},D)if(z=t.id,l=t.inputTimeScale,P&&l===P.timescale)D=!1;else{let H=this.getVideoStartPts(p),oe=Math.round(l*r);n=Math.min(n,ia(p[0].dts,H)-oe),a=Math.min(a,H-oe)}this.videoTrackConfig={width:t.width,height:t.height,pixelRatio:t.pixelRatio}}if(Object.keys(w).length)return this.ISGenerated=!0,D?(P&&this.warn(`Timestamps at playlist time: ${i?"":"~"}${r} ${a/l} != initPTS: ${P.baseTime/P.timescale} (${P.baseTime}/${P.timescale}) trackId: ${P.trackId}`),this.log(`Found initPTS at playlist time: ${r} offset: ${a/l} (${a}/${l}) trackId: ${z}`),this._initPTS={baseTime:a,timescale:l,trackId:z},this._initDTS={baseTime:n,timescale:l,trackId:z}):a=l=void 0,{tracks:w,initPTS:a,timescale:l,trackId:z}}remuxVideo(e,t,r,i){let a,n,l,h=e.inputTimeScale,p=e.samples,v=[],w=p.length,P=this._initPTS,D=P.baseTime*h/P.timescale,G=this.nextVideoTs,z=8,H=this.videoSampleDuration,oe=Number.POSITIVE_INFINITY,Se=Number.NEGATIVE_INFINITY,me=!1;if(!r||G===null){let at=D+t*h,nt=p[0].pts-ia(p[0].dts,p[0].pts);Pi&&G!==null&&15e3>Math.abs(at-nt-(G+D))?r=!0:G=at-nt-D}let Te=G+D;for(let at=0;at<w;at++){let nt=p[at];nt.pts=ia(nt.pts,Te),nt.dts=ia(nt.dts,Te),nt.dts<p[at>0?at-1:at].dts&&(me=!0)}me&&p.sort(function(at,nt){let Zt=at.dts-nt.dts,lr=at.pts-nt.pts;return Zt||lr}),a=p[0].dts;let Be=(n=p[p.length-1].dts)-a,je=Be?Math.round(Be/(w-1)):H||e.inputTimeScale/30;if(r){let at=a-Te,nt=at>je,Zt=at<-1;if((nt||Zt)&&(nt?this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${br(at,!0)} ms (${at}dts) hole between fragments detected at ${t.toFixed(3)}`):this.warn(`${(e.segmentCodec||"").toUpperCase()}: ${br(-at,!0)} ms (${at}dts) overlapping between fragments detected at ${t.toFixed(3)}`),!Zt||Te>=p[0].pts||Pi)){a=Te;let lr=p[0].pts-at;if(nt)p[0].dts=a,p[0].pts=lr;else{let ar=!0;for(let Mt=0;Mt<p.length&&(!(p[Mt].dts>lr)||!ar);Mt++){let Pt=p[Mt].pts;if(p[Mt].dts-=at,p[Mt].pts-=at,Mt<p.length-1){let nr=p[Mt+1].pts;ar=nr<=p[Mt].pts==nr<=Pt}}}this.log(`Video: Initial PTS/DTS adjusted: ${br(lr,!0)}/${br(a,!0)}, delta: ${br(at,!0)} ms`)}}let ge=0,ze=0,Fe=a=Math.max(0,a);for(let at=0;at<w;at++){let nt=p[at],Zt=nt.units,lr=Zt.length,ar=0;for(let Mt=0;Mt<lr;Mt++)ar+=Zt[Mt].data.length;ze+=ar,ge+=lr,nt.length=ar,nt.dts<Fe?(nt.dts=Fe,Fe+=je/4|0||1):Fe=nt.dts,oe=Math.min(nt.pts,oe),Se=Math.max(nt.pts,Se)}n=p[w-1].dts;let rt=ze+4*ge+8;try{l=new Uint8Array(rt)}catch(at){this.observer.emit(o.ERROR,o.ERROR,{type:S.MUX_ERROR,details:d.REMUX_ALLOC_ERROR,fatal:!1,error:at,bytes:rt,reason:`fail allocating video mdat ${rt}`});return}let st=new DataView(l.buffer);st.setUint32(0,rt),l.set(Ne.types.mdat,4);let kt=!1,Ye=Number.POSITIVE_INFINITY,et=Number.POSITIVE_INFINITY,dt=Number.NEGATIVE_INFINITY,bt=Number.NEGATIVE_INFINITY;for(let at=0;at<w;at++){let nt,Zt=p[at],lr=Zt.units,ar=0;for(let Pt=0,nr=lr.length;Pt<nr;Pt++){let qt=lr[Pt],si=qt.data,$i=qt.data.byteLength;st.setUint32(z,$i),z+=4,l.set(si,z),z+=$i,ar+=4+$i}if(at<w-1)H=p[at+1].dts-Zt.dts,nt=p[at+1].pts-Zt.pts;else{let Pt=this.config,nr=at>0?Zt.dts-p[at-1].dts:je;if(nt=at>0?Zt.pts-p[at-1].pts:je,Pt.stretchShortVideoTrack&&this.nextAudioTs!==null){let qt=Math.floor(Pt.maxBufferHole*h),si=(i?oe+i*h:this.nextAudioTs+D)-Zt.pts;si>qt?((H=si-nr)<0?H=nr:kt=!0,this.log(`It is approximately ${si/90} ms to the next segment; using duration ${H/90} ms for the last video frame.`)):H=nr}else H=nr}let Mt=Math.round(Zt.pts-Zt.dts);Ye=Math.min(Ye,H),dt=Math.max(dt,H),et=Math.min(et,nt),bt=Math.max(bt,nt),v.push(nn(Zt.key,H,ar,Mt))}if(v.length){if(Pi){if(Pi<70){let at=v[0].flags;at.dependsOn=2,at.isNonSync=0}}else if(ka&&bt-et<dt-Ye&&je/dt<.025&&v[0].cts===0){this.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let at=a;for(let nt=0,Zt=v.length;nt<Zt;nt++){let lr=at+v[nt].duration,ar=at+v[nt].cts;if(nt<Zt-1){let Mt=lr+v[nt+1].cts;v[nt].duration=Mt-ar}else v[nt].duration=nt?v[nt-1].duration:je;v[nt].cts=0,at=lr}}}let _t=n+(H=kt||!H?je:H);this.nextVideoTs=G=_t-D,this.videoSampleDuration=H,this.isVideoContiguous=!0;let xt={data1:Ne.moof(e.sequenceNumber++,a,_(e,{samples:v})),data2:l,startPTS:(oe-D)/h,endPTS:(Se+H-D)/h,startDTS:(a-D)/h,endDTS:G/h,type:"video",hasAudio:!1,hasVideo:!0,nb:v.length,dropped:e.dropped};return e.samples=[],e.dropped=0,xt}getSamplesPerFrame(e){switch(e.segmentCodec){case"mp3":return 1152;case"ac3":return 1536;default:return 1024}}remuxAudio(e,t,r,i,a){let n,l=e.inputTimeScale,h=e.samplerate?e.samplerate:l,p=l/h,v=this.getSamplesPerFrame(e),w=v*p,P=this._initPTS,D=e.segmentCodec==="mp3"&&this.typeSupported.mpeg,G=[],z=a!==void 0,H=e.samples,oe=D?0:8,Se=this.nextAudioTs||-1,me=P.baseTime*l/P.timescale,Te=me+t*l;if(this.isAudioContiguous=r=r||H.length&&Se>0&&(i&&9e3>Math.abs(Te-(Se+me))||Math.abs(ia(H[0].pts,Te)-(Se+me))<20*w),H.forEach(function(dt){dt.pts=ia(dt.pts,Te)}),!r||Se<0){if(!(H=H.filter(dt=>dt.pts>=0)).length)return;Se=a===0?0:i&&!z?Math.max(0,Te-me):H[0].pts-me}if(e.segmentCodec==="aac"){let dt=this.config.maxAudioFramesDrift;for(let bt=0,_t=Se+me;bt<H.length;bt++){let xt=H[bt],at=xt.pts,nt=at-_t,Zt=Math.abs(1e3*nt/l);if(nt<=-dt*w&&z)bt===0&&(this.warn(`Audio frame @ ${(at/l).toFixed(3)}s overlaps marker by ${Math.round(1e3*nt/l)} ms.`),this.nextAudioTs=Se=at-me,_t=at);else if(nt>=dt*w&&Zt<1e4&&z){let lr=Math.round(nt/w);for(_t=at-lr*w;_t<0&&lr&&w;)lr--,_t+=w;bt===0&&(this.nextAudioTs=Se=_t-me),this.warn(`Injecting ${lr} audio frames @ ${((_t-me)/l).toFixed(3)}s due to ${Math.round(1e3*nt/l)} ms gap.`);for(let ar=0;ar<lr;ar++){let Mt=zi.getSilentFrame(e.parsedCodec||e.manifestCodec||e.codec,e.channelCount);Mt||(this.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),Mt=xt.unit.subarray()),H.splice(bt,0,{unit:Mt,pts:_t}),_t+=w,bt++}}xt.pts=_t,_t+=w}}let Be=null,je=null,ge=0,ze=H.length;for(;ze--;)ge+=H[ze].unit.byteLength;for(let dt=0,bt=H.length;dt<bt;dt++){let _t=H[dt],xt=_t.unit,at=_t.pts;if(je!==null)G[dt-1].duration=Math.round((at-je)/p);else{if(r&&e.segmentCodec==="aac"&&(at=Se+me),Be=at,!(ge>0))return;ge+=oe;try{n=new Uint8Array(ge)}catch(Zt){this.observer.emit(o.ERROR,o.ERROR,{type:S.MUX_ERROR,details:d.REMUX_ALLOC_ERROR,fatal:!1,error:Zt,bytes:ge,reason:`fail allocating audio mdat ${ge}`});return}D||(new DataView(n.buffer).setUint32(0,ge),n.set(Ne.types.mdat,4))}n.set(xt,oe);let nt=xt.byteLength;oe+=nt,G.push(nn(!0,v,nt,0)),je=at}let Fe=G.length;if(!Fe)return;let rt=G[G.length-1];Se=je-me,this.nextAudioTs=Se+p*rt.duration;let st=D?new Uint8Array(0):Ne.moof(e.sequenceNumber++,Be/p,_({},e,{samples:G}));e.samples=[];let kt=(Be-me)/l,Ye=Se/l,et={data1:st,data2:n,startPTS:kt,endPTS:Ye,startDTS:kt,endDTS:Ye,type:"audio",hasAudio:!0,hasVideo:!1,nb:Fe};return this.isAudioContiguous=!0,et}}function ia(y,e){let t;if(e===null)return y;for(t=e<y?-8589934592:8589934592;Math.abs(y-e)>4294967296;)y+=t;return y}function Ya(y,e,t,r){let i=y.samples.length;if(!i)return;let a=y.inputTimeScale;for(let l=0;l<i;l++){let h=y.samples[l];h.pts=ia(h.pts-t.baseTime*a/t.timescale,e*a)/a,h.dts=ia(h.dts-r.baseTime*a/r.timescale,e*a)/a}let n=y.samples;return y.samples=[],{samples:n}}function Jn(y,e,t){let r=y.samples.length;if(!r)return;let i=y.inputTimeScale;for(let n=0;n<r;n++){let l=y.samples[n];l.pts=ia(l.pts-t.baseTime*i/t.timescale,e*i)/i}y.samples.sort((n,l)=>n.pts-l.pts);let a=y.samples;return y.samples=[],{samples:a}}class Xa extends L{constructor(e,t,r,i){super("passthrough-remuxer",i),this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null,this.isVideoContiguous=!1}destroy(){}resetTimeStamp(e){this.lastEndTime=null;let t=this.initPTS;t&&e&&t.baseTime===e.baseTime&&t.timescale===e.timescale||(this.initPTS=e)}resetNextTimestamp(){this.isVideoContiguous=!1,this.lastEndTime=null}resetInitSegment(e,t,r,i){this.audioCodec=t,this.videoCodec=r,this.generateInitSegment(e,i),this.emitInitSegment=!0}generateInitSegment(e,t){let{audioCodec:r,videoCodec:i}=this;if(!(e!=null&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let{audio:a,video:n}=this.initData=Ge(e);if(t)(function(h,p){if(!h||!p)return;let v=p.keyId;v&&p.isCommonEncryption&&ye(h,["moov","trak"]).forEach(w=>{let P=ye(w,["mdia","minf","stbl","stsd"])[0].subarray(8),D=ye(P,["enca"]),G=D.length>0;G||(D=ye(P,["encv"])),D.forEach(z=>{ye(G?z.subarray(28):z.subarray(78),["sinf"]).forEach(H=>{let oe=Xe(H);if(oe){let Se=oe.subarray(8,24);Se.some(me=>me!==0)||(se.log(`[eme] Patching keyId in 'enc${G?"a":"v"}>sinf>>tenc' box: ${b(Se)} -> ${b(v)}`),oe.set(v,8))}})})})})(e,t);else{let h=a||n;h!=null&&h.encrypted&&this.warn(`Init segment with encrypted track with has no key ("${h.codec}")!`)}a&&(r=ls(a,K.AUDIO,this)),n&&(i=ls(n,K.VIDEO,this));let l={};a&&n?l.audiovideo={container:"video/mp4",codec:r+","+i,supplemental:n.supplemental,encrypted:n.encrypted,initSegment:e,id:"main"}:a?l.audio={container:"audio/mp4",codec:r,encrypted:a.encrypted,initSegment:e,id:"audio"}:n?l.video={container:"video/mp4",codec:i,supplemental:n.supplemental,encrypted:n.encrypted,initSegment:e,id:"main"}:this.warn("initSegment does not contain moov or trak boxes."),this.initTracks=l}remux(e,t,r,i,a,n){var l,h;let{initPTS:p,lastEndTime:v}=this,w={audio:void 0,video:void 0,text:i,id3:r,initSegment:void 0};x(v)||(v=this.lastEndTime=a||0);let P=t.samples;if(!P.length)return w;let D={initPTS:void 0,timescale:void 0,trackId:void 0},G=this.initData;if((l=G)!=null&&l.length||(this.generateInitSegment(P),G=this.initData),!((h=G)!=null&&h.length))return this.warn("Failed to generate initSegment."),w;this.emitInitSegment&&(D.tracks=this.initTracks,this.emitInitSegment=!1);let z=function(_t,xt,at){let nt={},Zt=ye(_t,["moof","traf"]);for(let lr=0;lr<Zt.length;lr++){let ar=Zt[lr],Mt=ye(ar,["tfhd"])[0],Pt=Q(Mt,4),nr=xt[Pt];if(!nr)continue;nt[Pt]||(nt[Pt]={start:NaN,duration:0,sampleCount:0,timescale:nr.timescale,type:nr.type});let qt=nt[Pt],si=ye(ar,["tfdt"])[0];if(si){let Ta=si[0],Lr=Q(si,4);Ta===1&&(Lr===4294967295?at.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"):(Lr*=4294967296,Lr+=Q(si,8))),x(Lr)&&(!x(qt.start)||Lr<qt.start)&&(qt.start=Lr)}let $i=nr.default,Ut=Q(Mt,0)|$i?.flags,oi=$i?.duration||0;8&Ut&&(oi=2&Ut?Q(Mt,12):Q(Mt,8));let xi=ye(ar,["trun"]),fa=qt.start||0,Qi=0,Ji=oi;for(let Ta=0;Ta<xi.length;Ta++){let Lr=xi[Ta],yn=Q(Lr,4),An=qt.sampleCount;qt.sampleCount+=yn;let Cn=1&Lr[3],el=4&Lr[3],Oo=1&Lr[2],Mo=2&Lr[2],Xo=4&Lr[2],Zo=8&Lr[2],ii=8,Ti=yn;for(Cn&&(ii+=4),el&&yn&&(1&Lr[ii+1]||qt.keyFrameIndex!==void 0||(qt.keyFrameIndex=An),ii+=4,Oo?(Ji=Q(Lr,ii),ii+=4):Ji=oi,Mo&&(ii+=4),Zo&&(ii+=4),fa+=Ji,Qi+=Ji,Ti--);Ti--;)Oo?(Ji=Q(Lr,ii),ii+=4):Ji=oi,Mo&&(ii+=4),Xo&&(1&Lr[ii+1]||qt.keyFrameIndex!==void 0||(qt.keyFrameIndex=qt.sampleCount-(Ti+1),qt.keyFrameStart=fa),ii+=4),Zo&&(ii+=4),fa+=Ji,Qi+=Ji;!Qi&&oi&&(Qi+=oi*yn)}qt.duration+=Qi}if(!Object.keys(nt).some(lr=>nt[lr].duration)){let lr=1/0,ar=0,Mt=ye(_t,["sidx"]);for(let Pt=0;Pt<Mt.length;Pt++){let nr=function(qt){let si=[],$i=qt[0],Ut=8,oi=Q(qt,8);Ut+=4;let xi=0,fa=0;$i===0?(xi=Q(qt,Ut),fa=Q(qt,Ut+4),Ut+=8):(xi=de(qt,Ut),fa=de(qt,Ut+8),Ut+=16),Ut+=2;let Qi=qt.length+fa,Ji=W(qt,Ut);Ut+=2;for(let Ta=0;Ta<Ji;Ta++){let Lr=Ut,yn=Q(qt,Lr);Lr+=4;let An=2147483647&yn;if((2147483648&yn)>>>31==1)return se.warn("SIDX has hierarchical references (not supported)"),null;let Cn=Q(qt,Lr);Lr+=4,si.push({referenceSize:An,subsegmentDuration:Cn,info:{duration:Cn/oi,start:Qi,end:Qi+An-1}}),Qi+=An,Lr+=4,Ut=Lr}return{earliestPresentationTime:xi,timescale:oi,version:$i,referencesCount:Ji,references:si}}(Mt[Pt]);if(nr!=null&&nr.references){lr=Math.min(lr,nr.earliestPresentationTime/nr.timescale);let qt=nr.references.reduce((si,$i)=>si+$i.info.duration||0,0);ar=Math.max(ar,qt+nr.earliestPresentationTime/nr.timescale)}}ar&&x(ar)&&Object.keys(nt).forEach(Pt=>{nt[Pt].duration||(nt[Pt].duration=ar*nt[Pt].timescale-nt[Pt].start)})}return nt}(P,G,this),H=G.audio?z[G.audio.id]:null,oe=G.video?z[G.video.id]:null,Se=fn(oe,1/0),me=fn(H,1/0),Te=fn(oe,0,!0),Be=fn(H,0,!0),je=a,ge=0,ze=H&&(!oe||!p&&me<Se||p&&p.trackId===G.audio.id),Fe=ze?H:oe;if(Fe){let _t=Fe.timescale,xt=Fe.start-a*_t,at=ze?G.audio.id:G.video.id;je=Fe.start/_t,ge=ze?Be-me:Te-Se,(n||!p)&&(function(nt,Zt,lr,ar){if(nt===null)return!0;let Mt=Math.max(ar,1);return Math.abs(Zt-nt.baseTime/nt.timescale-lr)>Mt}(p,je,a,ge)||_t!==p.timescale)&&(p&&this.warn(`Timestamps at playlist time: ${n?"":"~"}${a} ${xt/_t} != initPTS: ${p.baseTime/p.timescale} (${p.baseTime}/${p.timescale}) trackId: ${p.trackId}`),this.log(`Found initPTS at playlist time: ${a} offset: ${je-a} (${xt}/${_t}) trackId: ${at}`),p=null,D.initPTS=xt,D.timescale=_t,D.trackId=at)}else this.warn(`No audio or video samples found for initPTS at playlist time: ${a}`);p?(D.initPTS=p.baseTime,D.timescale=p.timescale,D.trackId=p.trackId):(D.timescale&&D.trackId!==void 0&&D.initPTS!==void 0||(this.warn("Could not set initPTS"),D.initPTS=je,D.timescale=1,D.trackId=-1),this.initPTS=p={baseTime:D.initPTS,timescale:D.timescale,trackId:D.trackId});let rt=je-p.baseTime/p.timescale,st=rt+ge;ge>0?this.lastEndTime=st:(this.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());let kt=!!G.audio,Ye=!!G.video,et="";kt&&(et+="audio"),Ye&&(et+="video");let dt={data1:P,startPTS:rt,startDTS:rt,endPTS:st,endDTS:st,type:et,hasAudio:kt,hasVideo:Ye,nb:1,dropped:0,encrypted:!!G.audio&&G.audio.encrypted||!!G.video&&G.video.encrypted};w.audio=kt&&!Ye?dt:void 0,w.video=Ye?dt:void 0;let bt=oe?.sampleCount;if(bt){let _t=oe.keyFrameIndex,xt=_t!==-1;dt.nb=bt,dt.dropped=_t===0||this.isVideoContiguous?0:xt?_t:bt,dt.independent=xt,dt.firstKeyFrame=_t,xt&&oe.keyFrameStart&&(dt.firstKeyFramePTS=(oe.keyFrameStart-p.baseTime)/p.timescale),this.isVideoContiguous||(w.independent=xt),this.isVideoContiguous||(this.isVideoContiguous=xt),dt.dropped&&this.warn(`fmp4 does not start with IDR: firstIDR ${_t}/${bt} dropped: ${dt.dropped} start: ${dt.firstKeyFramePTS||"NA"}`)}return w.initSegment=D,w.id3=Ya(r,a,p,p),i.samples.length&&(w.text=Jn(i,a,p)),w}}function fn(y,e,t=!1){return y?.start!==void 0?(y.start+(t?y.duration:0))/y.timescale:e}function ls(y,e,t){let r=y.codec;return r&&r.length>4?r:e===K.AUDIO?r==="ec-3"||r==="ac-3"||r==="alac"?r:r==="fLaC"||r==="Opus"?hr(r,!1):(t.warn(`Unhandled audio codec "${r}" in mp4 MAP`),r||"mp4a"):(t.warn(`Unhandled video codec "${r}" in mp4 MAP`),r||"avc1")}try{s=ut.performance.now.bind(ut.performance)}catch{s=Date.now}let es=[{demux:hn,remux:Xa},{demux:Vr,remux:da},{demux:Qn,remux:da},{demux:ma,remux:da}];es.splice(2,0,{demux:Ha,remux:da});class zs{constructor(e,t,r,i,a,n){this.asyncResult=!1,this.logger=void 0,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=r,this.id=a,this.logger=n}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,r,i){let a,n=r.transmuxing;n.executeStart=s();let l=new Uint8Array(e),{currentTransmuxState:h,transmuxConfig:p}=this;i&&(this.currentTransmuxState=i);let{contiguous:v,discontinuity:w,trackSwitch:P,accurateTimeOffset:D,timeOffset:G,initSegmentChange:z}=i||h,{audioCodec:H,videoCodec:oe,defaultInitPts:Se,duration:me,initSegmentData:Te}=p,Be=(a=null,l.byteLength>0&&t?.key!=null&&t.iv!==null&&t.method!=null&&(a=t),a);if(Be&&vi(Be.method)){let Fe=this.getDecrypter(),rt=Ze(Be.method);if(!Fe.isSync())return this.asyncResult=!0,this.decryptionPromise=Fe.webCryptoDecrypt(l,Be.key.buffer,Be.iv.buffer,rt).then(st=>{let kt=this.push(st,null,r);return this.decryptionPromise=null,kt}),this.decryptionPromise;{let st=Fe.softwareDecrypt(l,Be.key.buffer,Be.iv.buffer,rt);if(r.part>-1){let kt=Fe.flush();st=kt&&kt.buffer}if(!st)return n.executeEnd=s(),Ys(r);l=new Uint8Array(st)}}let je=this.needsProbing(w,P);if(je){let Fe=this.configureTransmuxer(l);if(Fe)return this.logger.warn(`[transmuxer] ${Fe.message}`),this.observer.emit(o.ERROR,o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_PARSING_ERROR,fatal:!1,error:Fe,reason:Fe.message}),n.executeEnd=s(),Ys(r)}(w||P||z||je)&&this.resetInitSegment(Te,H,oe,me,t),(w||z||je)&&this.resetInitialTimestamp(Se),v||this.resetContiguity();let ge=this.transmux(l,Be,G,D,r);this.asyncResult=ts(ge);let ze=this.currentTransmuxState;return ze.contiguous=!0,ze.discontinuity=!1,ze.trackSwitch=!1,n.executeEnd=s(),ge}flush(e){let t=e.transmuxing;t.executeStart=s();let{decrypter:r,currentTransmuxState:i,decryptionPromise:a}=this;if(a)return this.asyncResult=!0,a.then(()=>this.flush(e));let n=[],{timeOffset:l}=i;if(r){let w=r.flush();w&&n.push(this.push(w.buffer,null,e))}let{demuxer:h,remuxer:p}=this;if(!h||!p){t.executeEnd=s();let w=[Ys(e)];return this.asyncResult?Promise.resolve(w):w}let v=h.flush(l);return ts(v)?(this.asyncResult=!0,v.then(w=>(this.flushRemux(n,w,e),n))):(this.flushRemux(n,v,e),this.asyncResult?Promise.resolve(n):n)}flushRemux(e,t,r){let{audioTrack:i,videoTrack:a,id3Track:n,textTrack:l}=t,{accurateTimeOffset:h,timeOffset:p}=this.currentTransmuxState;this.logger.log(`[transmuxer.ts]: Flushed ${this.id} sn: ${r.sn}${r.part>-1?" part: "+r.part:""} of ${this.id===m.MAIN?"level":"track"} ${r.level}`);let v=this.remuxer.remux(i,a,n,l,p,h,!0,this.id);e.push({remuxResult:v,chunkMeta:r}),r.transmuxing.executeEnd=s()}resetInitialTimestamp(e){let{demuxer:t,remuxer:r}=this;t&&r&&(t.resetTimeStamp(e),r.resetTimeStamp(e))}resetContiguity(){let{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,r,i,a){let{demuxer:n,remuxer:l}=this;n&&l&&(n.resetInitSegment(e,t,r,i),l.resetInitSegment(e,t,r,a))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,r,i,a){return t&&t.method==="SAMPLE-AES"?this.transmuxSampleAes(e,t,r,i,a):this.transmuxUnencrypted(e,r,i,a)}transmuxUnencrypted(e,t,r,i){let{audioTrack:a,videoTrack:n,id3Track:l,textTrack:h}=this.demuxer.demux(e,t,!1,!this.config.progressive);return{remuxResult:this.remuxer.remux(a,n,l,h,t,r,!1,this.id),chunkMeta:i}}transmuxSampleAes(e,t,r,i,a){return this.demuxer.demuxSampleAes(e,t,r).then(n=>({remuxResult:this.remuxer.remux(n.audioTrack,n.videoTrack,n.id3Track,n.textTrack,r,i,!1,this.id),chunkMeta:a}))}configureTransmuxer(e){let t,{config:r,observer:i,typeSupported:a}=this;for(let w=0,P=es.length;w<P;w++){var n;if((n=es[w].demux)!=null&&n.probe(e,this.logger)){t=es[w];break}}if(!t)return Error("Failed to find demuxer by probing fragment data");let l=this.demuxer,h=this.remuxer,p=t.remux,v=t.demux;h&&h instanceof p||(this.remuxer=new p(i,r,a,this.logger)),l&&l instanceof v||(this.demuxer=new v(i,r,a,this.logger),this.probe=v.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new vn(this.config)),e}}let Ys=y=>({remuxResult:{},chunkMeta:y});function ts(y){return"then"in y&&y.then instanceof Function}class Qo{constructor(e,t,r,i,a){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=r,this.duration=i,this.defaultInitPts=a||null}}class No{constructor(e,t,r,i,a,n){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=r,this.trackSwitch=i,this.timeOffset=a,this.initSegmentChange=n}}let Xs=0;class yo{constructor(e,t,r,i){this.error=null,this.hls=void 0,this.id=void 0,this.instanceNo=Xs++,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.onWorkerMessage=h=>{let p=h.data,v=this.hls;if(v&&p!=null&&p.event&&p.instanceNo===this.instanceNo)switch(p.event){case"init":{var w;let P=(w=this.workerContext)==null?void 0:w.objectURL;P&&ut.URL.revokeObjectURL(P);break}case"transmuxComplete":this.handleTransmuxComplete(p.data);break;case"flush":this.onFlush(p.data);break;case"workerLog":v.logger[p.data.logType]&&v.logger[p.data.logType](p.data.message);break;default:p.data=p.data||{},p.data.frag=this.frag,p.data.part=this.part,p.data.id=this.id,v.trigger(p.event,p.data)}},this.onWorkerError=h=>{if(!this.hls)return;let p=Error(`${h.message}  (${h.filename}:${h.lineno})`);this.hls.config.enableWorker=!1,this.hls.logger.warn(`Error in "${this.id}" Web Worker, fallback to inline`),this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:p})};let a=e.config;this.hls=e,this.id=t,this.useWorker=!!a.enableWorker,this.onTransmuxComplete=r,this.onFlush=i;let n=(h,p)=>{(p=p||{}).frag=this.frag||void 0,h===o.ERROR&&(p.parent=this.id,p.part=this.part,this.error=p.error),this.hls.trigger(h,p)};this.observer=new or,this.observer.on(o.FRAG_DECRYPTED,n),this.observer.on(o.ERROR,n);let l=Ir(a.preferManagedMediaSource);if(this.useWorker&&typeof Worker<"u"){let h=this.hls.logger;if(a.workerPath||typeof __HLS_WORKER_BUNDLE__=="function"){try{a.workerPath?(h.log(`loading Web Worker ${a.workerPath} for "${t}"`),this.workerContext=function(v){let w=rr[v];if(w)return w.clientCount++,w;let P=new ut.URL(v,ut.location.href).href,D={worker:new ut.Worker(P),scriptURL:P,clientCount:1};return rr[v]=D,D}(a.workerPath)):(h.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){let v=rr[tr];if(v)return v.clientCount++,v;let w=new ut.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),P=ut.URL.createObjectURL(w),D={worker:new ut.Worker(P),objectURL:P,clientCount:1};return rr[tr]=D,D}());let{worker:p}=this.workerContext;p.addEventListener("message",this.onWorkerMessage),p.addEventListener("error",this.onWorkerError),p.postMessage({instanceNo:this.instanceNo,cmd:"init",typeSupported:l,id:t,config:Xt(a)})}catch(p){h.warn(`Error setting up "${t}" Web Worker, fallback to inline`,p),this.terminateWorker(),this.error=null,this.transmuxer=new zs(this.observer,l,a,"",t,e.logger)}return}}this.transmuxer=new zs(this.observer,l,a,"",t,e.logger)}reset(){if(this.frag=null,this.part=null,this.workerContext){let e=this.instanceNo;this.instanceNo=Xs++;let t=this.hls.config,r=Ir(t.preferManagedMediaSource);this.workerContext.worker.postMessage({instanceNo:this.instanceNo,cmd:"reset",resetNo:e,typeSupported:r,id:this.id,config:Xt(t)})}}terminateWorker(){if(this.workerContext){let{worker:e}=this.workerContext;this.workerContext=null,e.removeEventListener("message",this.onWorkerMessage),e.removeEventListener("error",this.onWorkerError),function(t){let r=rr[t||tr];if(r&&r.clientCount--==1){let{worker:i,objectURL:a}=r;delete rr[t||tr],a&&ut.URL.revokeObjectURL(a),i.terminate()}}(this.hls.config.workerPath)}}destroy(){if(this.workerContext)this.terminateWorker(),this.onWorkerMessage=this.onWorkerError=null;else{let t=this.transmuxer;t&&(t.destroy(),this.transmuxer=null)}let e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.part=null,this.observer=null,this.hls=null}push(e,t,r,i,a,n,l,h,p,v){var w,P;p.transmuxing.start=ut.performance.now();let{instanceNo:D,transmuxer:G}=this,z=n?n.start:a.start,H=a.decryptdata,oe=this.frag,Se=!(oe&&a.cc===oe.cc),me=!(oe&&p.level===oe.level),Te=oe?p.sn-oe.sn:-1,Be=this.part?p.part-this.part.index:-1,je=Te===0&&p.id>1&&p.id===oe?.stats.chunkCount,ge=!me&&(Te===1||Te===0&&(Be===1||je&&Be<=0)),ze=ut.performance.now();(me||Te||a.stats.parsing.start===0)&&(a.stats.parsing.start=ze),n&&(Be||!ge)&&(n.stats.parsing.start=ze);let Fe=!(oe&&((w=a.initSegment)==null?void 0:w.url)===((P=oe.initSegment)==null?void 0:P.url)),rt=new No(Se,ge,h,me,z,Fe);if(!ge||Se||Fe){this.hls.logger.log(`[transmuxer-interface]: Starting new transmux session for ${a.type} sn: ${p.sn}${p.part>-1?" part: "+p.part:""} ${this.id===m.MAIN?"level":"track"}: ${p.level} id: ${p.id}
        discontinuity: ${Se}
        trackSwitch: ${me}
        contiguous: ${ge}
        accurateTimeOffset: ${h}
        timeOffset: ${z}
        initSegmentChange: ${Fe}`);let st=new Qo(r,i,t,l,v);this.configureTransmuxer(st)}if(this.frag=a,this.part=n,this.workerContext)this.workerContext.worker.postMessage({instanceNo:D,cmd:"demux",data:e,decryptdata:H,chunkMeta:p,state:rt},e instanceof ArrayBuffer?[e]:[]);else if(G){let st=G.push(e,H,p,rt);ts(st)?st.then(kt=>{this.handleTransmuxComplete(kt)}).catch(kt=>{this.transmuxerError(kt,p,"transmuxer-interface push error")}):this.handleTransmuxComplete(st)}}flush(e){e.transmuxing.start=ut.performance.now();let{instanceNo:t,transmuxer:r}=this;if(this.workerContext)this.workerContext.worker.postMessage({instanceNo:t,cmd:"flush",chunkMeta:e});else if(r){let i=r.flush(e);ts(i)?i.then(a=>{this.handleFlushResult(a,e)}).catch(a=>{this.transmuxerError(a,e,"transmuxer-interface flush error")}):this.handleFlushResult(i,e)}}transmuxerError(e,t,r){this.hls&&(this.error=e,this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_PARSING_ERROR,chunkMeta:t,frag:this.frag||void 0,part:this.part||void 0,fatal:!1,error:e,err:e,reason:r}))}handleFlushResult(e,t){e.forEach(r=>{this.handleTransmuxComplete(r)}),this.onFlush(t)}configureTransmuxer(e){let{instanceNo:t,transmuxer:r}=this;this.workerContext?this.workerContext.worker.postMessage({instanceNo:t,cmd:"configure",config:e}):r&&r.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=ut.performance.now(),this.onTransmuxComplete(e)}}class vo extends Bt{constructor(e,t,r){super(e,t,r,"audio-stream-controller",m.AUDIO),this.mainAnchor=null,this.mainFragLoading=null,this.audioOnly=!1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.flushing=!1,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.resetItem()}resetItem(){this.mainDetails=this.mainAnchor=this.mainFragLoading=this.bufferedTrack=this.switchingTrack=this.waitingData=this.cachedTrackLoadedData=null}registerListeners(){super.registerListeners();let{hls:e}=this;e.on(o.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(o.BUFFER_RESET,this.onBufferReset,this),e.on(o.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(o.FRAG_LOADING,this.onFragLoading,this),e.on(o.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){let{hls:e}=this;e&&(super.unregisterListeners(),e.off(o.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(o.BUFFER_RESET,this.onBufferReset,this),e.off(o.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(o.FRAG_LOADING,this.onFragLoading,this),e.off(o.FRAG_BUFFERED,this.onFragBuffered,this))}onInitPtsFound(e,{frag:t,id:r,initPTS:i,timescale:a,trackId:n}){if(r===m.MAIN){let l=t.cc,h=this.fragCurrent;if(this.initPTS[l]={baseTime:i,timescale:a,trackId:n},this.log(`InitPTS for cc: ${l} found from main: ${i/a} (${i}/${a}) trackId: ${n}`),this.mainAnchor=t,this.state===Ie.WAITING_INIT_PTS){let p=this.waitingData;(p||this.loadingParts)&&(!p||p.frag.cc===l)||this.syncWithAnchor(t,p?.frag)}else!this.hls.hasEnoughToStart&&h&&h.cc!==l?(h.abortRequests(),this.syncWithAnchor(t,h)):this.state===Ie.IDLE&&this.tick()}}getLoadPosition(){return!this.startFragRequested&&this.nextLoadPosition>=0?this.nextLoadPosition:super.getLoadPosition()}syncWithAnchor(e,t){var r;let i=((r=this.mainFragLoading)==null?void 0:r.frag)||null;if(t&&i?.cc===t.cc)return;let a=(i||e).cc,n=Ri(this.getLevelDetails(),a,this.getLoadPosition());n&&(this.log(`Syncing with main frag at ${n.start} cc ${n.cc}`),this.startFragRequested=!1,this.nextLoadPosition=n.start,this.resetLoadingState(),this.state===Ie.IDLE&&this.doTickIdle())}startLoad(e,t){if(!this.levels){this.startPosition=e,this.state=Ie.STOPPED;return}let r=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),r>0&&e===-1?(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r,this.state=Ie.IDLE):this.state=Ie.WAITING_TRACK,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}doTick(){switch(this.state){case Ie.IDLE:this.doTickIdle();break;case Ie.WAITING_TRACK:{let{levels:e,trackId:t}=this,r=e?.[t],i=r?.details;if(i&&!this.waitForLive(r)){if(this.waitForCdnTuneIn(i))break;this.state=Ie.WAITING_INIT_PTS}break}case Ie.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate();break;case Ie.WAITING_INIT_PTS:{let e=this.waitingData;if(e){let{frag:t,part:r,cache:i,complete:a}=e,n=this.mainAnchor;if(this.initPTS[t.cc]!==void 0){this.waitingData=null,this.state=Ie.FRAG_LOADING;let l={frag:t,part:r,payload:i.flush().buffer,networkDetails:null};this._handleFragmentLoadProgress(l),a&&super._handleFragmentLoadComplete(l)}else n&&n.cc!==e.frag.cc&&this.syncWithAnchor(n,e.frag)}else this.state=Ie.IDLE}}this.onTickEnd()}resetLoadingState(){let e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null),super.resetLoadingState()}onTickEnd(){let{media:e}=this;e!=null&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){var e;let{hls:t,levels:r,media:i,trackId:a}=this,n=t.config;if(!this.buffering||!i&&!this.primaryPrefetch&&(this.startFragRequested||!n.startFragPrefetch)||!(r!=null&&r[a]))return;let l=r[a],h=l.details;if(!h||this.waitForLive(l)||this.waitForCdnTuneIn(h)){this.state=Ie.WAITING_TRACK,this.startFragRequested=!1;return}let p=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&p&&(this.bufferFlushed=!1,this.afterBufferFlushed(p,K.AUDIO,m.AUDIO));let v=this.getFwdBufferInfo(p,m.AUDIO);if(v===null)return;if(!this.switchingTrack&&this._streamEnded(v,h)){t.trigger(o.BUFFER_EOS,{type:"audio"}),this.state=Ie.ENDED;return}let w=v.len,P=t.maxBufferLength,D=h.fragments,G=D[0].start,z=this.getLoadPosition(),H=this.flushing?z:v.end;if(this.switchingTrack&&i&&h.PTSKnown&&z<G&&(v.end>G||v.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=G+.05),w>=P&&!this.switchingTrack&&H<D[D.length-1].start)return;let oe=this.getNextFragment(H,h);if(oe&&this.isLoopLoading(oe,H)&&(oe=this.getNextFragmentLoopLoading(oe,h,v,m.MAIN,P)),!oe){this.bufferFlushed=!0;return}let Se=((e=this.mainFragLoading)==null?void 0:e.frag)||null;if(!this.audioOnly&&this.startFragRequested&&Se&&ke(oe)&&!oe.endList&&(!h.live||!this.loadingParts&&H<this.hls.liveSyncPosition)&&(this.fragmentTracker.getState(Se)===Xr.OK&&(this.mainFragLoading=Se=null),Se&&ke(Se))){if(oe.start>Se.end){let me=this.fragmentTracker.getFragAtPos(H,m.MAIN);me&&me.end>Se.end&&(Se=me,this.mainFragLoading={frag:me,targetBufferTime:null})}if(oe.start>Se.end)return}this.loadFragment(oe,l,H)}onMediaDetaching(e,t){this.bufferFlushed=this.flushing=!1,super.onMediaDetaching(e,t)}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(r=>new Wr(r))}onAudioTrackSwitching(e,t){let r=!!t.url;this.trackId=t.id;let{fragCurrent:i}=this;i&&(i.abortRequests(),this.removeUnbufferedFrags(i.start)),this.resetLoadingState(),r?(this.switchingTrack=t,this.flushAudioIfNeeded(t),this.state!==Ie.STOPPED&&(this.setInterval(100),this.state=Ie.IDLE,this.tick())):(this.resetTransmuxer(),this.switchingTrack=null,this.bufferedTrack=t,this.clearInterval())}onManifestLoading(){super.onManifestLoading(),this.bufferFlushed=this.flushing=this.audioOnly=!1,this.resetItem(),this.trackId=-1}onLevelLoaded(e,t){this.mainDetails=t.details;let r=this.cachedTrackLoadedData;r&&(this.cachedTrackLoadedData=null,this.onAudioTrackLoaded(o.AUDIO_TRACK_LOADED,r))}onAudioTrackLoaded(e,t){var r,i;let{levels:a}=this,{details:n,id:l,groupId:h,track:p}=t;if(!a){this.warn(`Audio tracks reset while loading track ${l} "${p.name}" of "${h}"`);return}let v=this.mainDetails;if(!v||n.endCC>v.endCC||v.expired){this.cachedTrackLoadedData=t,this.state!==Ie.STOPPED&&(this.state=Ie.WAITING_TRACK);return}this.cachedTrackLoadedData=null,this.log(`Audio track ${l} "${p.name}" of "${h}" loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""},duration:${n.totalduration}`);let w=a[l],P=0;if(n.live||(r=w.details)!=null&&r.live){if(this.checkLiveUpdate(n),n.deltaUpdateFailed)return;w.details&&(P=this.alignPlaylists(n,w.details,(i=this.levelLastLoaded)==null?void 0:i.details)),n.alignedSliding||(Lt(n,v),n.alignedSliding||Rt(n,v),P=n.fragmentStart)}w.details=n,this.levelLastLoaded=w,this.startFragRequested||this.setStartPosition(v,P),this.hls.trigger(o.AUDIO_TRACK_UPDATED,{details:n,id:l,groupId:t.groupId}),this.state!==Ie.WAITING_TRACK||this.waitForCdnTuneIn(n)||(this.state=Ie.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;let r=e.frag,{part:i,payload:a}=e,{config:n,trackId:l,levels:h}=this;if(!h){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}let p=h[l];if(!p){this.warn("Audio track is undefined on fragment load progress");return}let v=p.details;if(!v){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(r.start);return}let w=n.defaultAudioCodec||p.audioCodec||"mp4a.40.2",P=this.transmuxer;P||(P=this.transmuxer=new yo(this.hls,m.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let D=this.initPTS[r.cc],G=(t=r.initSegment)==null?void 0:t.data;if(D!==void 0){let z=i?i.index:-1,H=new jn(r.level,r.sn,r.stats.chunkCount,a.byteLength,z,z!==-1);P.push(a,G,w,"",r,i,v.totalduration,!1,H,D)}else{this.log(`Unknown video PTS for cc ${r.cc}, waiting for video PTS before demuxing audio frag ${r.sn} of [${v.startSN} ,${v.endSN}],track ${l}`);let{cache:z}=this.waitingData=this.waitingData||{frag:r,part:i,cache:new Nt,complete:!1};z.push(new Uint8Array(a)),this.state!==Ie.STOPPED&&(this.state=Ie.WAITING_INIT_PTS)}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=null}onBufferCreated(e,t){this.bufferFlushed=this.flushing=!1;let r=t.tracks.audio;r&&(this.mediaBuffer=r.buffer||null)}onFragLoading(e,t){!this.audioOnly&&t.frag.type===m.MAIN&&ke(t.frag)&&(this.mainFragLoading=t,this.state===Ie.IDLE&&this.tick())}onFragBuffered(e,t){let{frag:r,part:i}=t;if(r.type!==m.AUDIO){this.audioOnly||r.type!==m.MAIN||r.elementaryStreams.video||r.elementaryStreams.audiovideo||(this.audioOnly=!0,this.mainFragLoading=null);return}if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${i?" p: "+i.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if(ke(r)){this.fragPrevious=r;let a=this.switchingTrack;a&&(this.bufferedTrack=a,this.switchingTrack=null,this.hls.trigger(o.AUDIO_TRACK_SWITCHED,F({},a)))}this.fragBufferedComplete(r,i),this.media&&this.tick()}onError(e,t){var r;if(t.fatal){this.state=Ie.ERROR;return}switch(t.details){case d.FRAG_GAP:case d.FRAG_PARSING_ERROR:case d.FRAG_DECRYPT_ERROR:case d.FRAG_LOAD_ERROR:case d.FRAG_LOAD_TIMEOUT:case d.KEY_LOAD_ERROR:case d.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(m.AUDIO,t);break;case d.AUDIO_TRACK_LOAD_ERROR:case d.AUDIO_TRACK_LOAD_TIMEOUT:case d.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ie.WAITING_TRACK||((r=t.context)==null?void 0:r.type)!==f.AUDIO_TRACK||(this.state=Ie.IDLE);break;case d.BUFFER_ADD_CODEC_ERROR:case d.BUFFER_APPEND_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)||this.resetLoadingState();break;case d.BUFFER_FULL_ERROR:if(t.parent!=="audio")return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case d.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushing(e,{type:t}){t!==K.VIDEO&&(this.flushing=!0)}onBufferFlushed(e,{type:t}){if(t!==K.VIDEO){this.flushing=!1,this.bufferFlushed=!0,this.state===Ie.ENDED&&(this.state=Ie.IDLE);let r=this.mediaBuffer||this.media;r&&(this.afterBufferFlushed(r,t,m.AUDIO),this.tick())}}_handleTransmuxComplete(e){var t;let r="audio",{hls:i}=this,{remuxResult:a,chunkMeta:n}=e,l=this.getCurrentContext(n);if(!l){this.resetWhenMissingContext(n);return}let{frag:h,part:p,level:v}=l,{details:w}=v,{audio:P,text:D,id3:G,initSegment:z}=a;if(this.fragContextChanged(h)||!w){this.fragmentTracker.removeFragment(h);return}if(this.state=Ie.PARSING,this.switchingTrack&&P&&this.completeAudioSwitch(this.switchingTrack),z!=null&&z.tracks){let H=h.initSegment||h;if(this.unhandledEncryptionError(z,h))return;this._bufferInitSegment(v,z.tracks,H,n),i.trigger(o.FRAG_PARSING_INIT_SEGMENT,{frag:H,id:r,tracks:z.tracks})}if(P){let{startPTS:H,endPTS:oe,startDTS:Se,endDTS:me}=P;p&&(p.elementaryStreams[K.AUDIO]={startPTS:H,endPTS:oe,startDTS:Se,endDTS:me}),h.setElementaryStreamInfo(K.AUDIO,H,oe,Se,me),this.bufferFragmentData(P,h,p,n)}if(G!=null&&(t=G.samples)!=null&&t.length){let H=_({id:r,frag:h,details:w},G);i.trigger(o.FRAG_PARSING_METADATA,H)}if(D){let H=_({id:r,frag:h,details:w},D);i.trigger(o.FRAG_PARSING_USERDATA,H)}}_bufferInitSegment(e,t,r,i){if(this.state!==Ie.PARSING||(t.video&&delete t.video,t.audiovideo&&delete t.audiovideo,!t.audio))return;let a=t.audio;a.id=m.AUDIO;let n=e.audioCodec;this.log(`Init audio buffer, container:${a.container}, codecs[level/parsed]=[${n}/${a.codec}]`),n&&n.split(",").length===1&&(a.levelCodec=n),this.hls.trigger(o.BUFFER_CODECS,t);let l=a.initSegment;if(l!=null&&l.byteLength){let h={type:"audio",frag:r,part:null,chunkMeta:i,parent:r.type,data:l};this.hls.trigger(o.BUFFER_APPENDING,h)}this.tickImmediate()}loadFragment(e,t,r){let i=this.fragmentTracker.getState(e);if(this.switchingTrack||i===Xr.NOT_LOADED||i===Xr.PARTIAL){var a;if(ke(e))if((a=t.details)!=null&&a.live&&!this.initPTS[e.cc]){this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=Ie.WAITING_INIT_PTS;let n=this.mainDetails;n&&n.fragmentStart!==t.details.fragmentStart&&Rt(t.details,n)}else super.loadFragment(e,t,r);else this._loadInitSegment(e,t)}else this.clearTrackerIfNeeded(e)}flushAudioIfNeeded(e){if(this.media&&this.bufferedTrack){let{name:t,lang:r,assocLang:i,characteristics:a,audioCodec:n,channels:l}=this.bufferedTrack;Mi({name:t,lang:r,assocLang:i,characteristics:a,audioCodec:n,channels:l},e,Fi)||(_i(e.url,this.hls)?(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"),this.bufferedTrack=null):this.bufferedTrack=e)}}completeAudioSwitch(e){let{hls:t}=this;this.flushAudioIfNeeded(e),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(o.AUDIO_TRACK_SWITCHED,F({},e))}}class As extends L{constructor(e,t){super(t,e.logger),this.hls=void 0,this.canLoad=!1,this.timer=-1,this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){this.timer!==-1&&(ut.clearTimeout(this.timer),this.timer=-1)}startLoad(){this.canLoad=!0,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t,r){let i=t?.renditionReports;if(i){let a=-1;for(let n=0;n<i.length;n++){let l,h=i[n];try{l=new ut.URL(h.URI,t.url).href}catch(p){this.warn(`Could not construct new URL for Rendition Report: ${p}`),l=h.URI||""}if(l===e){a=n;break}l===e.substring(0,l.length)&&(a=n)}if(a!==-1){let n=i[a],l=parseInt(n["LAST-MSN"])||t.lastPartSn,h=parseInt(n["LAST-PART"])||t.lastPartIndex;if(this.hls.config.lowLatencyMode){let p=Math.min(t.age-t.partTarget,t.targetduration);h>=0&&p>t.partTarget&&(h+=1)}return new ba(l,h>=0?h:void 0,r&&Br(r))}}}loadPlaylist(e){this.clearTimer()}loadingPlaylist(e,t){this.clearTimer()}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}getUrlWithDirectives(e,t){if(t)try{return t.addDirectives(e)}catch(r){this.warn(`Could not construct new URL with HLS Delivery Directives: ${r}`)}return e}playlistLoaded(e,t,r){let{details:i,stats:a}=t,n=ut.performance.now(),l=a.loading.first?Math.max(0,n-a.loading.first):0;i.advancedDateTime=Date.now()-l;let h=this.hls.config.timelineOffset;if(h!==i.appliedTimelineOffset){let v=Math.max(h||0,0);i.appliedTimelineOffset=v,i.fragments.forEach(w=>{w.setStart(w.playlistOffset+v)})}if(i.live||r!=null&&r.live){let v,w,P,D="levelInfo"in t?t.levelInfo:t.track;if(i.reloaded(r),r&&i.fragments.length>0){(function(me,Te,Be){let je;if(me===Te)return;let ge=null,ze=me.fragments;for(let Ye=ze.length-1;Ye>=0;Ye--){let et=ze[Ye].initSegment;if(et){ge=et;break}}me.fragmentHint&&delete me.fragmentHint.endPTS,function(Ye,et,dt){let bt=et.skippedSegments,_t=Math.max(Ye.startSN,et.startSN)-et.startSN,xt=(Ye.fragmentHint?1:0)+(bt?et.endSN:Math.min(Ye.endSN,et.endSN))-et.startSN,at=et.startSN-Ye.startSN,nt=et.fragmentHint?et.fragments.concat(et.fragmentHint):et.fragments,Zt=Ye.fragmentHint?Ye.fragments.concat(Ye.fragmentHint):Ye.fragments;for(let Mt=_t;Mt<=xt;Mt++){let Pt=Zt[at+Mt],nr=nt[Mt];if(bt&&!nr&&Pt&&(nr=et.fragments[Mt]=Pt),Pt&&nr){var lr,ar;dt(Pt,nr,Mt,nt);let qt=Pt.relurl,si=nr.relurl;if(qt&&(lr=qt)!==(ar=si)&&ar&&Ke(lr)!==Ke(ar)){et.playlistParsingError=he(`media sequence mismatch ${nr.sn}:`,Ye,et,Pt,nr);return}if(Pt.cc!==nr.cc){et.playlistParsingError=he(`discontinuity sequence mismatch (${Pt.cc}!=${nr.cc})`,Ye,et,Pt,nr);return}}}}(me,Te,(Ye,et,dt,bt)=>{if((!Te.startCC||Te.skippedSegments)&&et.cc!==Ye.cc){let _t=Ye.cc-et.cc;for(let xt=dt;xt<bt.length;xt++)bt[xt].cc+=_t;Te.endCC=bt[bt.length-1].cc}x(Ye.startPTS)&&x(Ye.endPTS)&&(et.setStart(et.startPTS=Ye.startPTS),et.startDTS=Ye.startDTS,et.maxStartPTS=Ye.maxStartPTS,et.endPTS=Ye.endPTS,et.endDTS=Ye.endDTS,et.minEndPTS=Ye.minEndPTS,et.setDuration(Ye.endPTS-Ye.startPTS),et.duration&&(je=et),Te.PTSKnown=Te.alignedSliding=!0),Ye.hasStreams&&(et.elementaryStreams=Ye.elementaryStreams),et.loader=Ye.loader,Ye.hasStats&&(et.stats=Ye.stats),Ye.initSegment&&(et.initSegment=Ye.initSegment,ge=Ye.initSegment)});let Fe=Te.fragments,rt=Te.fragmentHint?Fe.concat(Te.fragmentHint):Fe;if(ge&&rt.forEach(Ye=>{var et;Ye&&(!Ye.initSegment||Ye.initSegment.relurl===((et=ge)==null?void 0:et.relurl))&&(Ye.initSegment=ge)}),Te.skippedSegments){if(Te.deltaUpdateFailed=Fe.some(Ye=>!Ye),Te.deltaUpdateFailed){Be.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let Ye=Te.skippedSegments;Ye--;)Fe.shift();Te.startSN=Fe[0].sn}else{Te.canSkipDateRanges&&(Te.dateRanges=function(et,dt,bt){let{dateRanges:_t,recentlyRemovedDateranges:xt}=dt,at=_({},et);xt&&xt.forEach(Zt=>{delete at[Zt]});let nt=Object.keys(at).length;return nt?(Object.keys(_t).forEach(Zt=>{let lr=at[Zt],ar=new It(_t[Zt].attr,lr);ar.isValid?(at[Zt]=ar,lr||(ar.tagOrder+=nt)):bt.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${Xt(_t[Zt].attr)}"`)}),at):_t}(me.dateRanges,Te,Be));let Ye=me.fragments.filter(et=>et.rawProgramDateTime);if(me.hasProgramDateTime&&!Te.hasProgramDateTime)for(let et=1;et<rt.length;et++)rt[et].programDateTime===null&&Mr(rt[et],rt[et-1],Ye);Pn(Ye,Te)}Te.endCC=Fe[Fe.length-1].cc}if(!Te.startCC){var st;let Ye=Ve(me,Te.startSN-1);Te.startCC=(st=Ye?.cc)!=null?st:Fe[0].cc}(function(Ye,et,dt){if(Ye&&et){let bt=0;for(let _t=0,xt=Ye.length;_t<=xt;_t++){let at=Ye[_t],nt=et[_t+bt];at&&nt&&at.index===nt.index&&at.fragment.sn===nt.fragment.sn?dt(at,nt):bt--}}})(me.partList,Te.partList,(Ye,et)=>{et.elementaryStreams=Ye.elementaryStreams,et.stats=Ye.stats}),je?re(Te,je,je.startPTS,je.endPTS,je.startDTS,je.endDTS,Be):xe(me,Te),Fe.length&&(Te.totalduration=Te.edge-Fe[0].start),Te.driftStartTime=me.driftStartTime,Te.driftStart=me.driftStart;let kt=Te.advancedDateTime;if(Te.advanced&&kt){let Ye=Te.edge;Te.driftStart||(Te.driftStartTime=kt,Te.driftStart=Ye),Te.driftEndTime=kt,Te.driftEnd=Ye}else Te.driftEndTime=me.driftEndTime,Te.driftEnd=me.driftEnd,Te.advancedDateTime=me.advancedDateTime;Te.requestScheduled===-1&&(Te.requestScheduled=me.requestScheduled)})(r,i,this);let Se=i.playlistParsingError;if(Se){this.warn(Se);let me=this.hls;if(!me.config.ignorePlaylistParsingErrors){var p;let{networkDetails:Te}=t;me.trigger(o.ERROR,{type:S.NETWORK_ERROR,details:d.LEVEL_PARSING_ERROR,fatal:!1,url:i.url,error:Se,reason:Se.message,level:t.level||void 0,parent:(p=i.fragments[0])==null?void 0:p.type,networkDetails:Te,stats:a});return}i.playlistParsingError=null}}i.requestScheduled===-1&&(i.requestScheduled=a.loading.start);let G=this.hls.mainForwardBufferInfo,z=G?G.end-G.len:0,H=(i.edge-z)*1e3,oe=Ce(i,H);if(i.requestScheduled+oe<n?i.requestScheduled=n:i.requestScheduled+=oe,this.log(`live playlist ${e} ${i.advanced?"REFRESHED "+i.lastPartSn+"-"+i.lastPartIndex:i.updated?"UPDATED":"MISSED"}`),!this.canLoad||!i.live)return;if(i.canBlockReload&&i.endSN&&i.advanced){let Se=this.hls.config.lowLatencyMode,me=i.lastPartSn,Te=i.endSN,Be=i.lastPartIndex,je=me===Te;Be!==-1?je?(w=Te+1,P=Se?0:Be):(w=me,P=Se?Be+1:i.maxPartIndex):w=Te+1;let ge=i.age,ze=ge+i.ageHeader,Fe=Math.min(ze-i.partTarget,1.5*i.targetduration);if(Fe>0){if(ze>3*i.targetduration)this.log(`Playlist last advanced ${ge.toFixed(2)}s ago. Omitting segment and part directives.`),w=void 0,P=void 0;else if(r!=null&&r.tuneInGoal&&ze-i.partTarget>r.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${r.tuneInGoal} to: ${Fe} with playlist age: ${i.age}`),Fe=0;else{let rt=Math.floor(Fe/i.targetduration);w+=rt,P!==void 0&&(P+=Math.round(Fe%i.targetduration/i.partTarget)),this.log(`CDN Tune-in age: ${i.ageHeader}s last advanced ${ge.toFixed(2)}s goal: ${Fe} skip sn ${rt} to part ${P}`)}i.tuneInGoal=Fe}if(v=this.getDeliveryDirectives(i,t.deliveryDirectives,w,P),Se||!je){i.requestScheduled=n,this.loadingPlaylist(D,v);return}}else(i.canBlockReload||i.canSkipUntil)&&(v=this.getDeliveryDirectives(i,t.deliveryDirectives,w,P));v&&w!==void 0&&i.canBlockReload&&(i.requestScheduled=a.loading.first+Math.max(oe-2*l,oe/2)),this.scheduleLoading(D,v,i)}else this.clearTimer()}scheduleLoading(e,t,r){let i=r||e.details;if(!i){this.loadingPlaylist(e,t);return}let a=ut.performance.now(),n=i.requestScheduled;if(a>=n){this.loadingPlaylist(e,t);return}let l=n-a;this.log(`reload live playlist ${e.name||e.bitrate+"bps"} in ${Math.round(l)} ms`),this.clearTimer(),this.timer=ut.setTimeout(()=>this.loadingPlaylist(e,t),l)}getDeliveryDirectives(e,t,r,i){let a=Br(e);return t!=null&&t.skip&&e.deltaUpdateFailed&&(r=t.msn,i=t.part,a=Ar.No),new ba(r,i,a)}checkRetry(e){let t=e.details,r=fi(e),i=e.errorAction,{action:a,retryCount:n=0,retryConfig:l}=i||{},h=!!i&&!!l&&(a===Yr.RetryRequest||!i.resolved&&a===Yr.SendAlternateToPenaltyBox);if(h){var p;if(n>=l.maxNumRetry)return!1;if(r&&(p=e.context)!=null&&p.deliveryDirectives)this.warn(`Retrying playlist loading ${n+1}/${l.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{let v=Bi(l,n);this.clearTimer(),this.timer=ut.setTimeout(()=>this.loadPlaylist(),v),this.warn(`Retrying playlist loading ${n+1}/${l.maxNumRetry} after "${t}" in ${v}ms`)}e.levelRetry=!0,i.resolved=!0}return h}}function Fo(y,e){if(y.length!==e.length)return!1;for(let t=0;t<y.length;t++)if(!Mn(y[t].attrs,e[t].attrs))return!1;return!0}function Mn(y,e,t){let r=y["STABLE-RENDITION-ID"];return r&&!t?r===e["STABLE-RENDITION-ID"]:!(t||["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED","ASSOC-LANGUAGE"]).some(i=>y[i]!==e[i])}function ds(y,e){return e.label.toLowerCase()===y.name.toLowerCase()&&(!e.language||e.language.toLowerCase()===(y.lang||"").toLowerCase())}class us extends As{constructor(e){super(e,"audio-track-controller"),this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(o.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(o.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(o.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.tracksInGroup=[],this.groupIds=null,this.currentTrack=null,this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){let{id:r,groupId:i,details:a}=t,n=this.tracksInGroup[r];if(!n||n.groupId!==i){this.warn(`Audio track with id:${r} and group:${i} not found in active group ${n?.groupId}`);return}let l=n.details;n.details=t.details,this.log(`Audio track ${r} "${n.name}" lang:${n.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!t)return;let r=t.audioGroups||null,i=this.groupIds,a=this.currentTrack;if(!r||i?.length!==r?.length||r!=null&&r.some(l=>i?.indexOf(l)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;let l=this.tracks.filter(w=>!r||r.indexOf(w.groupId)!==-1);if(l.length)this.selectDefaultTrack&&!l.some(w=>w.default)&&(this.selectDefaultTrack=!1),l.forEach((w,P)=>{w.id=P});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=l;let h=this.hls.config.audioPreference;if(!a&&h){let w=Qt(h,l,Fi);if(w>-1)a=l[w];else{let P=Qt(h,this.tracks);a=this.tracks[P]}}let p=this.findTrackId(a);p===-1&&a&&(p=this.findTrackId(null)),this.log(`Updating audio tracks, ${l.length} track(s) found in group(s): ${r?.join(",")}`),this.hls.trigger(o.AUDIO_TRACKS_UPDATED,{audioTracks:l});let v=this.trackId;if(p!==-1&&v===-1)this.setAudioTrack(p);else if(l.length&&v===-1){var n;let w=Error(`No audio track selected for current audio group-ID(s): ${(n=this.groupIds)==null?void 0:n.join(",")} track count: ${l.length}`);this.warn(w.message),this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:w})}}}onError(e,t){!t.fatal&&t.context&&(t.context.type!==f.AUDIO_TRACK||t.context.id!==this.trackId||this.groupIds&&this.groupIds.indexOf(t.context.groupId)===-1||this.checkRetry(t))}get allAudioTracks(){return this.tracks}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioOption(e){let t=this.hls;if(t.config.audioPreference=e,e){let r=this.allAudioTracks;if(this.selectDefaultTrack=!1,r.length){let i=this.currentTrack;if(i&&Mi(e,i,Fi))return i;let a=Qt(e,this.tracksInGroup,Fi);if(a>-1){let n=this.tracksInGroup[a];return this.setAudioTrack(a),n}if(i){let n=t.loadLevel;n===-1&&(n=t.firstAutoLevel);let l=function(h,p,v,w,P){let D=p[w],G=p.reduce((me,Te,Be)=>{let je=Te.uri;return(me[je]||(me[je]=[])).push(Be),me},{})[D.uri];G.length>1&&(w=Math.max.apply(Math,G));let z=D.videoRange,H=D.frameRate,oe=D.codecSet.substring(0,4),Se=ji(p,w,me=>{if(me.videoRange!==z||me.frameRate!==H||me.codecSet.substring(0,4)!==oe)return!1;let Te=me.audioGroups;return Qt(h,v.filter(Be=>!Te||Te.indexOf(Be.groupId)!==-1),P)>-1});return Se>-1?Se:ji(p,w,me=>{let Te=me.audioGroups;return Qt(h,v.filter(Be=>!Te||Te.indexOf(Be.groupId)!==-1),P)>-1})}(e,t.levels,r,n,Fi);if(l===-1)return null;t.nextLoadLevel=l}if(e.channels||e.audioCodec){let n=Qt(e,r);if(n>-1)return r[n]}}}return null}setAudioTrack(e){let t=this.tracksInGroup;if(e<0||e>=t.length){this.warn(`Invalid audio track id: ${e}`);return}this.selectDefaultTrack=!1;let r=this.currentTrack,i=t[e],a=i.details&&!i.details.live;if(e===this.trackId&&i===r&&a||(this.log(`Switching to audio-track ${e} "${i.name}" lang:${i.lang} group:${i.groupId} channels:${i.channels}`),this.trackId=e,this.currentTrack=i,this.hls.trigger(o.AUDIO_TRACK_SWITCHING,F({},i)),a))return;let n=this.switchParams(i.url,r?.details,i.details);this.loadPlaylist(n)}findTrackId(e){let t=this.tracksInGroup;for(let r=0;r<t.length;r++){let i=t[r];if((!this.selectDefaultTrack||i.default)&&(!e||Mi(e,i,Fi)))return r}if(e){let{name:r,lang:i,assocLang:a,characteristics:n,audioCodec:l,channels:h}=e;for(let p=0;p<t.length;p++)if(Mi({name:r,lang:i,assocLang:a,characteristics:n,audioCodec:l,channels:h},t[p],Fi))return p;for(let p=0;p<t.length;p++){let v=t[p];if(Mn(e.attrs,v.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return p}for(let p=0;p<t.length;p++){let v=t[p];if(Mn(e.attrs,v.attrs,["LANGUAGE"]))return p}}return-1}loadPlaylist(e){super.loadPlaylist();let t=this.currentTrack;this.shouldLoadPlaylist(t)&&_i(t.url,this.hls)&&this.scheduleLoading(t,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);let r=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),n=e.details,l=n?.age;this.log(`Loading audio-track ${r} "${e.name}" lang:${e.lang} group:${i}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&n.live?" age "+l.toFixed(1)+(n.type?" "+n.type:""):""} ${a}`),this.hls.trigger(o.AUDIO_TRACK_LOADING,{url:a,id:r,groupId:i,deliveryDirectives:t||null,track:e})}}class Uo{constructor(e){this.tracks=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.tracks=e}destroy(){this.tracks=this.queues=null}append(e,t,r){if(this.queues===null||this.tracks===null)return;let i=this.queues[t];i.push(e),i.length!==1||r||this.executeNext(t)}appendBlocker(e){return new Promise(t=>{this.append({label:"async-blocker",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}},e)})}prependBlocker(e){return new Promise(t=>{this.queues&&this.queues[e].unshift({label:"async-blocker-prepend",execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}})})}removeBlockers(){this.queues!==null&&[this.queues.video,this.queues.audio,this.queues.audiovideo].forEach(e=>{var t;let r=(t=e[0])==null?void 0:t.label;(r==="async-blocker"||r==="async-blocker-prepend")&&(e[0].execute(),e.splice(0,1))})}unblockAudio(e){this.queues!==null&&this.queues.audio[0]===e&&this.shiftAndExecuteNext("audio")}executeNext(e){if(this.queues===null||this.tracks===null)return;let t=this.queues[e];if(t.length){let i=t[0];try{i.execute()}catch(a){var r;if(i.onError(a),this.queues===null||this.tracks===null)return;let n=(r=this.tracks[e])==null?void 0:r.buffer;n!=null&&n.updating||this.shiftAndExecuteNext(e)}}}shiftAndExecuteNext(e){this.queues!==null&&(this.queues[e].shift(),this.executeNext(e))}current(e){var t;return((t=this.queues)==null?void 0:t[e][0])||null}toString(){let{queues:e,tracks:t}=this;return e===null||t===null?"<destroyed>":`
${this.list("video")}
${this.list("audio")}
${this.list("audiovideo")}}`}list(e){var t,r;return(t=this.queues)!=null&&t[e]||(r=this.tracks)!=null&&r[e]?`${e}: (${this.listSbInfo(e)}) ${this.listOps(e)}`:""}listSbInfo(e){var t;let r=(t=this.tracks)==null?void 0:t[e],i=r?.buffer;return i?`SourceBuffer${i.updating?" updating":""}${r.ended?" ended":""}${r.ending?" ending":""}`:"none"}listOps(e){var t;return((t=this.queues)==null?void 0:t[e].map(r=>r.label).join(", "))||""}}let Zs=/(avc[1234]|hvc1|hev1|dvh[1e]|vp09|av01)(?:\.[^.,]+)+/,Qs="HlsJsTrackRemovedError";class $o extends Error{constructor(e){super(e),this.name=Qs}}class Cs extends L{constructor(e,t){var r;super("buffer-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.details=null,this._objectUrl=null,this.operationQueue=null,this.bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.blockedAudioAppend=null,this.lastVideoAppendEnd=0,this.appendSource=void 0,this.transferData=void 0,this.overrides=void 0,this.appendErrors={audio:0,video:0,audiovideo:0},this.tracks={},this.sourceBuffers=[[null,null],[null,null]],this._onEndStreaming=i=>{var a;this.hls&&((a=this.mediaSource)==null?void 0:a.readyState)==="open"&&this.hls.pauseBuffering()},this._onStartStreaming=i=>{this.hls&&this.hls.resumeBuffering()},this._onMediaSourceOpen=i=>{let{media:a,mediaSource:n}=this;i&&this.log("Media source opened"),a&&n&&(n.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("emptied",this._onMediaEmptied),this.updateDuration(),this.hls.trigger(o.MEDIA_ATTACHED,{media:a,mediaSource:n}),this.mediaSource!==null&&this.checkPendingTracks())},this._onMediaSourceClose=()=>{this.log("Media source closed")},this._onMediaSourceEnded=()=>{this.log("Media source ended")},this._onMediaEmptied=()=>{let{mediaSrc:i,_objectUrl:a}=this;i!==a&&this.error(`Media element src was set while attaching MediaSource (${a} > ${i})`)},this.hls=e,this.fragmentTracker=t,this.appendSource=(r=J(e.config.preferManagedMediaSource),typeof ut<"u"&&r===ut.ManagedMediaSource),this.initTracks(),this.registerListeners()}hasSourceTypes(){return Object.keys(this.tracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.transferData=this.overrides=void 0,this.operationQueue&&(this.operationQueue.destroy(),this.operationQueue=null),this.hls=this.fragmentTracker=null,this._onMediaSourceOpen=this._onMediaSourceClose=null,this._onMediaSourceEnded=null,this._onStartStreaming=this._onEndStreaming=null}registerListeners(){let{hls:e}=this;e.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.BUFFER_RESET,this.onBufferReset,this),e.on(o.BUFFER_APPENDING,this.onBufferAppending,this),e.on(o.BUFFER_CODECS,this.onBufferCodecs,this),e.on(o.BUFFER_EOS,this.onBufferEos,this),e.on(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(o.FRAG_PARSED,this.onFragParsed,this),e.on(o.FRAG_CHANGED,this.onFragChanged,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.BUFFER_RESET,this.onBufferReset,this),e.off(o.BUFFER_APPENDING,this.onBufferAppending,this),e.off(o.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.BUFFER_EOS,this.onBufferEos,this),e.off(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(o.FRAG_PARSED,this.onFragParsed,this),e.off(o.FRAG_CHANGED,this.onFragChanged,this),e.off(o.ERROR,this.onError,this)}transferMedia(){let{media:e,mediaSource:t}=this;if(!e)return null;let r={};if(this.operationQueue){let a=this.isUpdating();a||this.operationQueue.removeBlockers();let n=this.isQueued();(a||n)&&this.warn(`Transfering MediaSource with${n?" operations in queue":""}${a?" updating SourceBuffer(s)":""} ${this.operationQueue}`),this.operationQueue.destroy()}let i=this.transferData;return!this.sourceBufferCount&&i&&i.mediaSource===t?_(r,i.tracks):this.sourceBuffers.forEach(a=>{let[n]=a;n&&(r[n]=_({},this.tracks[n]),this.removeBuffer(n)),a[0]=a[1]=null}),{media:e,mediaSource:t,tracks:r}}initTracks(){this.sourceBuffers=[[null,null],[null,null]],this.tracks={},this.resetQueue(),this.resetAppendErrors(),this.lastMpegAudioChunk=this.blockedAudioAppend=null,this.lastVideoAppendEnd=0}onManifestLoading(){this.bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){var r;let i=2;(!t.audio||t.video)&&t.altAudio||(i=1),this.bufferCodecEventsTotal=i,this.log(`${i} bufferCodec event(s) expected.`),(r=this.transferData)!=null&&r.mediaSource&&this.sourceBufferCount&&i&&this.bufferCreated()}onMediaAttaching(e,t){let r=this.media=t.media;this.transferData=this.overrides=void 0;let i=J(this.appendSource);if(i){let a=!!t.mediaSource;(a||t.overrides)&&(this.transferData=t,this.overrides=t.overrides);let n=this.mediaSource=t.mediaSource||new i;if(this.assignMediaSource(n),a)this._objectUrl=r.src,this.attachTransferred();else{let l=this._objectUrl=ut.URL.createObjectURL(n);if(this.appendSource)try{r.removeAttribute("src");let h=ut.ManagedMediaSource;r.disableRemotePlayback=r.disableRemotePlayback||h&&n instanceof h,cs(r),function(p,v){let w=ut.document.createElement("source");w.type="video/mp4",w.src=v,p.appendChild(w)}(r,l),r.load()}catch{r.src=l}else r.src=l}r.addEventListener("emptied",this._onMediaEmptied)}}assignMediaSource(e){var t,r;this.log(`${((t=this.transferData)==null?void 0:t.mediaSource)===e?"transferred":"created"} media source: ${(r=e.constructor)==null?void 0:r.name}`),e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(e.addEventListener("startstreaming",this._onStartStreaming),e.addEventListener("endstreaming",this._onEndStreaming))}attachTransferred(){let e=this.media,t=this.transferData;if(!t||!e)return;let r=this.tracks,i=t.tracks,a=i?Object.keys(i):null,n=a?a.length:0,l=()=>{Promise.resolve().then(()=>{this.media&&this.mediaSourceOpenOrEnded&&this._onMediaSourceOpen()})};if(i&&a&&n){if(!this.tracksReady){this.hls.config.startFragPrefetch=!0,this.log("attachTransferred: waiting for SourceBuffer track info");return}if(this.log(`attachTransferred: (bufferCodecEventsTotal ${this.bufferCodecEventsTotal})
required tracks: ${Xt(r,(h,p)=>h==="initSegment"?void 0:p)};
transfer tracks: ${Xt(i,(h,p)=>h==="initSegment"?void 0:p)}}`),!j(i,r)){t.mediaSource=null,t.tracks=void 0;let h=e.currentTime,p=this.details,v=Math.max(h,p?.fragments[0].start||0);if(v-h>1){this.log(`attachTransferred: waiting for playback to reach new tracks start time ${h} -> ${v}`);return}this.warn(`attachTransferred: resetting MediaSource for incompatible tracks ("${Object.keys(i)}"->"${Object.keys(r)}") start time: ${v} currentTime: ${h}`),this.onMediaDetaching(o.MEDIA_DETACHING,{}),this.onMediaAttaching(o.MEDIA_ATTACHING,t),e.currentTime=v;return}this.transferData=void 0,a.forEach(h=>{let p=i[h];if(p){let v=p.buffer;if(v){let w=this.fragmentTracker,P=p.id;if(w.hasFragments(P)||w.hasParts(P)){let z=le.getBuffered(v);w.detectEvictedFragments(h,z,P,null,!0)}let D=Hn(h),G=[h,v];this.sourceBuffers[D]=G,v.updating&&this.operationQueue&&this.operationQueue.prependBlocker(h),this.trackSourceBuffer(h,p)}}}),l(),this.bufferCreated()}else this.log("attachTransferred: MediaSource w/o SourceBuffers"),l()}get mediaSourceOpenOrEnded(){var e;let t=(e=this.mediaSource)==null?void 0:e.readyState;return t==="open"||t==="ended"}onMediaDetaching(e,t){let r=!!t.transferMedia;this.transferData=this.overrides=void 0;let{media:i,mediaSource:a,_objectUrl:n}=this;if(a){if(this.log(`media source ${r?"transferring":"detaching"}`),r)this.sourceBuffers.forEach(([l])=>{l&&this.removeBuffer(l)}),this.resetQueue();else{if(this.mediaSourceOpenOrEnded){let l=a.readyState==="open";try{let h=a.sourceBuffers;for(let p=h.length;p--;)l&&h[p].abort(),a.removeSourceBuffer(h[p]);l&&a.endOfStream()}catch(h){this.warn(`onMediaDetaching: ${h.message} while calling endOfStream`)}}this.sourceBufferCount&&this.onBufferReset()}a.removeEventListener("sourceopen",this._onMediaSourceOpen),a.removeEventListener("sourceended",this._onMediaSourceEnded),a.removeEventListener("sourceclose",this._onMediaSourceClose),this.appendSource&&(a.removeEventListener("startstreaming",this._onStartStreaming),a.removeEventListener("endstreaming",this._onEndStreaming)),this.mediaSource=null,this._objectUrl=null}i&&(i.removeEventListener("emptied",this._onMediaEmptied),r||(n&&ut.URL.revokeObjectURL(n),this.mediaSrc===n?(i.removeAttribute("src"),this.appendSource&&cs(i),i.load()):this.warn("media|source.src was changed by a third party - skip cleanup")),this.media=null),this.hls.trigger(o.MEDIA_DETACHED,t)}onBufferReset(){this.sourceBuffers.forEach(([e])=>{e&&this.resetBuffer(e)}),this.initTracks()}resetBuffer(e){var t,r;let i=(t=this.tracks[e])==null?void 0:t.buffer;if(this.removeBuffer(e),i)try{(r=this.mediaSource)!=null&&r.sourceBuffers.length&&this.mediaSource.removeSourceBuffer(i)}catch(a){this.warn(`onBufferReset ${e}`,a)}delete this.tracks[e]}removeBuffer(e){this.removeBufferListeners(e),this.sourceBuffers[Hn(e)]=[null,null];let t=this.tracks[e];t&&(t.buffer=void 0)}resetQueue(){this.operationQueue&&this.operationQueue.destroy(),this.operationQueue=new Uo(this.tracks)}onBufferCodecs(e,t){let r=this.tracks,i=Object.keys(t);this.log(`BUFFER_CODECS: "${i}" (current SB count ${this.sourceBufferCount})`);let a="audiovideo"in t&&(r.audio||r.video)||r.audiovideo&&("audio"in t||"video"in t),n=!a&&this.sourceBufferCount&&this.media&&i.some(l=>!r[l]);if(a||n){this.warn(`Unsupported transition between "${Object.keys(r)}" and "${i}" SourceBuffers`);return}i.forEach(l=>{var h,p;let{id:v,codec:w,levelCodec:P,container:D,metadata:G,supplemental:z}=t[l],H=r[l],oe=(h=this.transferData)==null||(h=h.tracks)==null?void 0:h[l],Se=oe!=null&&oe.buffer?oe:H,me=Se?.pendingCodec||Se?.codec,Te=Se?.levelCodec;H||(H=r[l]={buffer:void 0,listeners:[],codec:w,supplemental:z,container:D,levelCodec:P,metadata:G,id:v});let Be=gr(me,Te),je=Be?.replace(Zs,"$1"),ge=gr(w,P),ze=(p=ge)==null?void 0:p.replace(Zs,"$1");ge&&Be&&je!==ze&&(l.slice(0,5)==="audio"&&(ge=hr(ge,this.appendSource)),this.log(`switching codec ${me} to ${ge}`),ge!==(H.pendingCodec||H.codec)&&(H.pendingCodec=ge),H.container=D,this.appendChangeType(l,D,ge))}),(this.tracksReady||this.sourceBufferCount)&&(t.tracks=this.sourceBufferTracks),!this.sourceBufferCount&&this.mediaSourceOpenOrEnded&&this.checkPendingTracks()}get sourceBufferTracks(){return Object.keys(this.tracks).reduce((e,t)=>{let r=this.tracks[t];return e[t]={id:r.id,container:r.container,codec:r.codec,levelCodec:r.levelCodec},e},{})}appendChangeType(e,t,r){let i=`${t};codecs=${r}`,a={label:`change-type=${i}`,execute:()=>{let n=this.tracks[e];if(n){let l=n.buffer;l!=null&&l.changeType&&(this.log(`changing ${e} sourceBuffer type to ${i}`),l.changeType(i),n.codec=r,n.container=t)}this.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:n=>{this.warn(`Failed to change ${e} SourceBuffer type`,n)}};this.append(a,e,this.isPending(this.tracks[e]))}blockAudio(e){var t;let r=e.start,i=r+.05*e.duration;if(((t=this.fragmentTracker.getAppendedFrag(r,m.MAIN))==null?void 0:t.gap)===!0)return;let a={label:"block-audio",execute:()=>{var n;let l=this.tracks.video;(this.lastVideoAppendEnd>i||l!=null&&l.buffer&&le.isBuffered(l.buffer,i)||((n=this.fragmentTracker.getAppendedFrag(i,m.MAIN))==null?void 0:n.gap)===!0)&&(this.blockedAudioAppend=null,this.shiftAndExecuteNext("audio"))},onStart:()=>{},onComplete:()=>{},onError:n=>{this.warn("Error executing block-audio operation",n)}};this.blockedAudioAppend={op:a,frag:e},this.append(a,"audio",!0)}unblockAudio(){let{blockedAudioAppend:e,operationQueue:t}=this;e&&t&&(this.blockedAudioAppend=null,t.unblockAudio(e.op))}onBufferAppending(e,t){let{tracks:r}=this,{data:i,type:a,parent:n,frag:l,part:h,chunkMeta:p,offset:v}=t,w=p.buffering[a],{sn:P,cc:D}=l,G=ut.performance.now();w.start=G;let z=l.stats.buffering,H=h?h.stats.buffering:null;z.start===0&&(z.start=G),H&&H.start===0&&(H.start=G);let oe=r.audio,Se=!1;a==="audio"&&oe?.container==="audio/mpeg"&&(Se=!this.lastMpegAudioChunk||p.id===1||this.lastMpegAudioChunk.sn!==p.sn,this.lastMpegAudioChunk=p);let me=r.video,Te=me?.buffer;if(Te&&P!=="initSegment"){let ge=h||l,ze=this.blockedAudioAppend;if(a!=="audio"||n==="main"||this.blockedAudioAppend||me.ending||me.ended){if(a==="video"){let Fe=ge.end;if(ze){let rt=ze.frag.start;(Fe>rt||Fe<this.lastVideoAppendEnd||le.isBuffered(Te,rt))&&this.unblockAudio()}this.lastVideoAppendEnd=Fe}}else{let Fe=ge.start+.05*ge.duration,rt=Te.buffered,st=this.currentOp("video");(rt.length||st)&&(st||le.isBuffered(Te,Fe)||!(this.lastVideoAppendEnd<Fe))||this.blockAudio(ge)}}let Be=(h||l).start,je={label:`append-${a}`,execute:()=>{var ge;w.executeStart=ut.performance.now();let ze=(ge=this.tracks[a])==null?void 0:ge.buffer;ze&&(Se?this.updateTimestampOffset(ze,Be,.1,a,P,D):v!==void 0&&x(v)&&this.updateTimestampOffset(ze,v,1e-6,a,P,D)),this.appendExecutor(i,a)},onStart:()=>{},onComplete:()=>{let ge=ut.performance.now();w.executeEnd=w.end=ge,z.first===0&&(z.first=ge),H&&H.first===0&&(H.first=ge);let ze={};this.sourceBuffers.forEach(([Fe,rt])=>{Fe&&(ze[Fe]=le.getBuffered(rt))}),this.appendErrors[a]=0,a==="audio"||a==="video"?this.appendErrors.audiovideo=0:(this.appendErrors.audio=0,this.appendErrors.video=0),this.hls.trigger(o.BUFFER_APPENDED,{type:a,frag:l,part:h,chunkMeta:p,parent:l.type,timeRanges:ze})},onError:ge=>{var ze;let Fe={type:S.MEDIA_ERROR,parent:l.type,details:d.BUFFER_APPEND_ERROR,sourceBufferName:a,frag:l,part:h,chunkMeta:p,error:ge,err:ge,fatal:!1},rt=(ze=this.media)==null?void 0:ze.error;if(ge.code===DOMException.QUOTA_EXCEEDED_ERR||ge.name=="QuotaExceededError"||"quota"in ge)Fe.details=d.BUFFER_FULL_ERROR;else if(ge.code===DOMException.INVALID_STATE_ERR&&this.mediaSourceOpenOrEnded&&!rt)Fe.errorAction=Fa(!0);else if(ge.name===Qs&&this.sourceBufferCount===0)Fe.errorAction=Fa(!0);else{let st=++this.appendErrors[a];this.warn(`Failed ${st}/${this.hls.config.appendErrorMaxRetry} times to append segment in "${a}" sourceBuffer (${rt||"no media error"})`),(st>=this.hls.config.appendErrorMaxRetry||rt)&&(Fe.fatal=!0)}this.hls.trigger(o.ERROR,Fe)}};this.append(je,a,this.isPending(this.tracks[a]))}getFlushOp(e,t,r){return this.log(`queuing "${e}" remove ${t}-${r}`),{label:"remove",execute:()=>{this.removeExecutor(e,t,r)},onStart:()=>{},onComplete:()=>{this.hls.trigger(o.BUFFER_FLUSHED,{type:e})},onError:i=>{this.warn(`Failed to remove ${t}-${r} from "${e}" SourceBuffer`,i)}}}onBufferFlushing(e,t){let{type:r,startOffset:i,endOffset:a}=t;r?this.append(this.getFlushOp(r,i,a),r):this.sourceBuffers.forEach(([n])=>{n&&this.append(this.getFlushOp(n,i,a),n)})}onFragParsed(e,t){let{frag:r,part:i}=t,a=[],n=i?i.elementaryStreams:r.elementaryStreams;n[K.AUDIOVIDEO]?a.push("audiovideo"):(n[K.AUDIO]&&a.push("audio"),n[K.VIDEO]&&a.push("video")),a.length===0&&this.warn(`Fragments must have at least one ElementaryStreamType set. type: ${r.type} level: ${r.level} sn: ${r.sn}`),this.blockBuffers(()=>{let l=ut.performance.now();r.stats.buffering.end=l,i&&(i.stats.buffering.end=l);let h=i?i.stats:r.stats;this.hls.trigger(o.FRAG_BUFFERED,{frag:r,part:i,stats:h,id:r.type})},a).catch(l=>{this.warn(`Fragment buffered callback ${l}`),this.stepOperationQueue(this.sourceBufferTypes)})}onFragChanged(e,t){this.trimBuffers()}get bufferedToEnd(){return this.sourceBufferCount>0&&!this.sourceBuffers.some(([e])=>{if(e){let t=this.tracks[e];if(t)return!t.ended||t.ending}return!1})}onBufferEos(e,t){var r;this.sourceBuffers.forEach(([a])=>{if(a){let n=this.tracks[a];t.type&&t.type!==a||(n.ending=!0,n.ended||(n.ended=!0,this.log(`${a} buffer reached EOS`)))}});let i=((r=this.overrides)==null?void 0:r.endOfStream)!==!1;this.sourceBufferCount>0&&!this.sourceBuffers.some(([a])=>{var n;return a&&!((n=this.tracks[a])!=null&&n.ended)})?i?(this.log("Queueing EOS"),this.blockUntilOpen(()=>{this.tracksEnded();let{mediaSource:a}=this;if(!a||a.readyState!=="open"){a&&this.log(`Could not call mediaSource.endOfStream(). mediaSource.readyState: ${a.readyState}`);return}this.log("Calling mediaSource.endOfStream()"),a.endOfStream(),this.hls.trigger(o.BUFFERED_TO_END,void 0)})):(this.tracksEnded(),this.hls.trigger(o.BUFFERED_TO_END,void 0)):t.type==="video"&&this.unblockAudio()}tracksEnded(){this.sourceBuffers.forEach(([e])=>{if(e!==null){let t=this.tracks[e];t&&(t.ending=!1)}})}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.updateDuration())}updateDuration(){this.blockUntilOpen(()=>{let e=this.getDurationAndRange();e&&this.updateMediaSource(e)})}onError(e,t){if(t.details===d.BUFFER_APPEND_ERROR&&t.frag){var r;let i=(r=t.errorAction)==null?void 0:r.nextAutoLevel;x(i)&&i!==t.frag.level&&this.resetAppendErrors()}}resetAppendErrors(){this.appendErrors={audio:0,video:0,audiovideo:0}}trimBuffers(){let{hls:e,details:t,media:r}=this;if(!r||t===null||!this.sourceBufferCount)return;let i=e.config,a=r.currentTime,n=t.levelTargetDuration,l=t.live&&i.liveBackBufferLength!==null?i.liveBackBufferLength:i.backBufferLength;if(x(l)&&l>=0){let p=Math.max(l,n);this.flushBackBuffer(a,n,Math.floor(a/n)*n-p)}let h=i.frontBufferFlushThreshold;if(x(h)&&h>0){let p=Math.max(Math.max(i.maxBufferLength,h),n);this.flushFrontBuffer(a,n,Math.floor(a/n)*n+p)}}flushBackBuffer(e,t,r){this.sourceBuffers.forEach(([i,a])=>{if(a){let l=le.getBuffered(a);if(l.length>0&&r>l.start(0)){var n;this.hls.trigger(o.BACK_BUFFER_REACHED,{bufferEnd:r});let h=this.tracks[i];if((n=this.details)!=null&&n.live)this.hls.trigger(o.LIVE_BACK_BUFFER_REACHED,{bufferEnd:r});else if(h!=null&&h.ended){this.log(`Cannot flush ${i} back buffer while SourceBuffer is in ended state`);return}this.hls.trigger(o.BUFFER_FLUSHING,{startOffset:0,endOffset:r,type:i})}}})}flushFrontBuffer(e,t,r){this.sourceBuffers.forEach(([i,a])=>{if(a){let n=le.getBuffered(a),l=n.length;if(l<2)return;let h=n.start(l-1),p=n.end(l-1);r>h||e>=h&&e<=p||this.hls.trigger(o.BUFFER_FLUSHING,{startOffset:h,endOffset:1/0,type:i})}})}getDurationAndRange(){var e;let{details:t,mediaSource:r}=this;if(!t||!this.media||r?.readyState!=="open")return null;let i=t.edge;if(t.live&&this.hls.config.liveDurationInfinity){if(t.fragments.length&&r.setLiveSeekableRange){let l=Math.max(0,t.fragmentStart),h=Math.max(l,i);return{duration:1/0,start:l,end:h}}return{duration:1/0}}let a=(e=this.overrides)==null?void 0:e.duration;if(a)return x(a)?{duration:a}:null;let n=this.media.duration;return i>(x(r.duration)?r.duration:0)&&i>n||!x(n)?{duration:i}:null}updateMediaSource({duration:e,start:t,end:r}){let i=this.mediaSource;this.media&&i&&i.readyState==="open"&&(i.duration!==e&&(x(e)&&this.log(`Updating MediaSource duration to ${e.toFixed(3)}`),i.duration=e),t!==void 0&&r!==void 0&&(this.log(`MediaSource duration is set to ${i.duration}. Setting seekable range to ${t}-${r}.`),i.setLiveSeekableRange(t,r)))}get tracksReady(){let e=this.pendingTrackCount;return e>0&&(e>=this.bufferCodecEventsTotal||this.isPending(this.tracks.audiovideo))}checkPendingTracks(){let{bufferCodecEventsTotal:e,pendingTrackCount:t,tracks:r}=this;if(this.log(`checkPendingTracks (pending: ${t} codec events expected: ${e}) ${Xt(r)}`),this.tracksReady){var i;let a=(i=this.transferData)==null?void 0:i.tracks;a&&Object.keys(a).length?this.attachTransferred():this.createSourceBuffers()}}bufferCreated(){if(this.sourceBufferCount){let e={};this.sourceBuffers.forEach(([t,r])=>{if(t){let i=this.tracks[t];e[t]={buffer:r,container:i.container,codec:i.codec,supplemental:i.supplemental,levelCodec:i.levelCodec,id:i.id,metadata:i.metadata}}}),this.hls.trigger(o.BUFFER_CREATED,{tracks:e}),this.log(`SourceBuffers created. Running queue: ${this.operationQueue}`),this.sourceBuffers.forEach(([t])=>{this.executeNext(t)})}else{let e=Error("could not create source buffer for media codec(s)");this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}createSourceBuffers(){let{tracks:e,sourceBuffers:t,mediaSource:r}=this;if(!r)throw Error("createSourceBuffers called when mediaSource was null");for(let a in e){let n=e[a];if(this.isPending(n)){let l=this.getTrackCodec(n,a),h=`${n.container};codecs=${l}`;n.codec=l,this.log(`creating sourceBuffer(${h})${this.currentOp(a)?" Queued":""} ${Xt(n)}`);try{let p=r.addSourceBuffer(h),v=Hn(a),w=[a,p];t[v]=w,n.buffer=p}catch(p){var i;this.error(`error while trying to add sourceBuffer: ${p.message}`),this.shiftAndExecuteNext(a),(i=this.operationQueue)==null||i.removeBlockers(),delete this.tracks[a],this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:p,sourceBufferName:a,mimeType:h,parent:n.id});return}this.trackSourceBuffer(a,n)}}this.bufferCreated()}getTrackCodec(e,t){let r=e.supplemental,i=e.codec;r&&(t==="video"||t==="audiovideo")&&Ht(r,"video")&&(i=function(n,l){let h=[];if(n){let p=n.split(",");for(let v=0;v<p.length;v++)kr(p[v],"video")||h.push(p[v])}return l&&h.push(l),h.join(",")}(i,r));let a=gr(i,e.levelCodec);return a?t.slice(0,5)==="audio"?hr(a,this.appendSource):a:""}trackSourceBuffer(e,t){let r=t.buffer;if(!r)return;let i=this.getTrackCodec(t,e);this.tracks[e]={buffer:r,codec:i,container:t.container,levelCodec:t.levelCodec,supplemental:t.supplemental,metadata:t.metadata,id:t.id,listeners:[]},this.removeBufferListeners(e),this.addBufferListener(e,"updatestart",this.onSBUpdateStart),this.addBufferListener(e,"updateend",this.onSBUpdateEnd),this.addBufferListener(e,"error",this.onSBUpdateError),this.appendSource&&this.addBufferListener(e,"bufferedchange",(a,n)=>{let l=n.removedRanges;l!=null&&l.length&&this.hls.trigger(o.BUFFER_FLUSHED,{type:a})})}get mediaSrc(){var e,t;let r=((e=this.media)==null||(t=e.querySelector)==null?void 0:t.call(e,"source"))||this.media;return r?.src}onSBUpdateStart(e){let t=this.currentOp(e);t&&t.onStart()}onSBUpdateEnd(e){var t;if(((t=this.mediaSource)==null?void 0:t.readyState)==="closed"){this.resetBuffer(e);return}let r=this.currentOp(e);r&&(r.onComplete(),this.shiftAndExecuteNext(e))}onSBUpdateError(e,t){var r;let i=Error(`${e} SourceBuffer error. MediaSource readyState: ${(r=this.mediaSource)==null?void 0:r.readyState}`);this.error(`${i}`,t),this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_APPENDING_ERROR,sourceBufferName:e,error:i,fatal:!1});let a=this.currentOp(e);a&&a.onError(i)}updateTimestampOffset(e,t,r,i,a,n){Math.abs(t-e.timestampOffset)>=r&&(this.log(`Updating ${i} SourceBuffer timestampOffset to ${t} (sn: ${a} cc: ${n})`),e.timestampOffset=t)}removeExecutor(e,t,r){let{media:i,mediaSource:a}=this,n=this.tracks[e],l=n?.buffer;if(!i||!a||!l){this.warn(`Attempting to remove from the ${e} SourceBuffer, but it does not exist`),this.shiftAndExecuteNext(e);return}let h=x(i.duration)?i.duration:1/0,p=x(a.duration)?a.duration:1/0,v=Math.max(0,t),w=Math.min(r,h,p);w>v&&(!n.ending||n.ended)?(n.ended=!1,this.log(`Removing [${v},${w}] from the ${e} SourceBuffer`),l.remove(v,w)):this.shiftAndExecuteNext(e)}appendExecutor(e,t){let r=this.tracks[t],i=r?.buffer;if(!i)throw new $o(`Attempting to append to the ${t} SourceBuffer, but it does not exist`);r.ending=!1,r.ended=!1,i.appendBuffer(e)}blockUntilOpen(e){if(this.isUpdating()||this.isQueued())this.blockBuffers(e).catch(t=>{this.warn(`SourceBuffer blocked callback ${t}`),this.stepOperationQueue(this.sourceBufferTypes)});else try{e()}catch(t){this.warn(`Callback run without blocking ${this.operationQueue} ${t}`)}}isUpdating(){return this.sourceBuffers.some(([e,t])=>e&&t.updating)}isQueued(){return this.sourceBuffers.some(([e])=>e&&!!this.currentOp(e))}isPending(e){return!!e&&!e.buffer}blockBuffers(e,t=this.sourceBufferTypes){if(!t.length)return this.log("Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);let{operationQueue:r}=this,i=t.map(a=>this.appendBlocker(a));return t.length>1&&this.blockedAudioAppend&&this.unblockAudio(),Promise.all(i).then(a=>{r===this.operationQueue&&(e(),this.stepOperationQueue(this.sourceBufferTypes))})}stepOperationQueue(e){e.forEach(t=>{var r;let i=(r=this.tracks[t])==null?void 0:r.buffer;i&&!i.updating&&this.shiftAndExecuteNext(t)})}append(e,t,r){this.operationQueue&&this.operationQueue.append(e,t,r)}appendBlocker(e){if(this.operationQueue)return this.operationQueue.appendBlocker(e)}currentOp(e){return this.operationQueue?this.operationQueue.current(e):null}executeNext(e){e&&this.operationQueue&&this.operationQueue.executeNext(e)}shiftAndExecuteNext(e){this.operationQueue&&this.operationQueue.shiftAndExecuteNext(e)}get pendingTrackCount(){return Object.keys(this.tracks).reduce((e,t)=>e+(this.isPending(this.tracks[t])?1:0),0)}get sourceBufferCount(){return this.sourceBuffers.reduce((e,[t])=>e+(t?1:0),0)}get sourceBufferTypes(){return this.sourceBuffers.map(([e])=>e).filter(e=>!!e)}addBufferListener(e,t,r){let i=this.tracks[e];if(!i)return;let a=i.buffer;if(!a)return;let n=r.bind(this,e);i.listeners.push({event:t,listener:n}),a.addEventListener(t,n)}removeBufferListeners(e){let t=this.tracks[e];if(!t)return;let r=t.buffer;r&&(t.listeners.forEach(i=>{r.removeEventListener(i.event,i.listener)}),t.listeners.length=0)}}function cs(y){let e=y.querySelectorAll("source");[].slice.call(e).forEach(t=>{y.removeChild(t)})}function Hn(y){return y==="audio"?1:0}class Va{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.hls&&this.unregisterListener(),this.timer&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:e}=this;e.on(o.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.BUFFER_CODECS,this.onBufferCodecs,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:e}=this;e.off(o.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){let r=this.hls.levels[t.droppedLevel];this.isLevelAllowed(r)&&this.restrictedLevels.push({bitrate:r.bitrate,height:r.height,width:r.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null,this.timer&&this.hls.levels.length&&this.detectPlayerSize()}onManifestParsed(e,t){let r=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,r.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onLevelsUpdated(e,t){this.timer&&x(this.autoLevelCapping)&&this.detectPlayerSize()}onBufferCodecs(e,t){this.hls.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping(),this.media=null}detectPlayerSize(){if(this.media){if(this.mediaHeight<=0||this.mediaWidth<=0){this.clientRect=null;return}let e=this.hls.levels;if(e.length){let t=this.hls,r=this.getMaxLevel(e.length-1);r!==this.autoLevelCapping&&t.logger.log(`Setting autoLevelCapping to ${r}: ${e[r].height}p@${e[r].bitrate} for media ${this.mediaWidth}x${this.mediaHeight}`),t.autoLevelCapping=r,t.autoLevelEnabled&&t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){let t=this.hls.levels;if(!t.length)return-1;let r=t.filter((i,a)=>this.isLevelAllowed(i)&&a<=e);return this.clientRect=null,Va.getMaxLevelByMediaSize(r,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,ut.clearInterval(this.timer),this.timer=ut.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(ut.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let e=this.media,t={width:0,height:0};if(e){let r=e.getBoundingClientRect();t.width=r.width,t.height=r.height,t.width||t.height||(t.width=r.right-r.left||e.width||0,t.height=r.bottom-r.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=ut.devicePixelRatio}catch{}return Math.min(e,this.hls.config.maxDevicePixelRatio)}isLevelAllowed(e){return!this.restrictedLevels.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,r){if(!(e!=null&&e.length))return-1;let i=(l,h)=>!h||l.width!==h.width||l.height!==h.height,a=e.length-1,n=Math.max(t,r);for(let l=0;l<e.length;l+=1){let h=e[l];if((h.width>=n||h.height>=n)&&i(h,e[l+1])){a=l;break}}return a}}let Ca={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",TIMED_TEXT:"tt"},jo={HLS:"h"};class En{constructor(e,t){Array.isArray(e)&&(e=e.map(r=>r instanceof En?r:new En(r))),this.value=e,this.params=t}}function wn(y,e,t){return Error(`failed to serialize "${Array.isArray(y)?JSON.stringify(y):y instanceof Map?"Map{}":y instanceof Set?"Set{}":typeof y=="object"?JSON.stringify(y):String(y)}" as ${e}`,{cause:t})}class bo{constructor(e){this.description=e}}let Is="Bare Item";function So(y){if(y<-999999999999999||999999999999999<y)throw wn(y,"Integer");return y.toString()}let qa=/[\x00-\x1f\x7f]+/;function Js(y){let e=y.description||y.toString().slice(7,-1);if(/^([a-zA-Z*])([!#$%&'*+\-.^_`|~\w:/]*)$/.test(e)===!1)throw wn(e,"Token");return e}function Ls(y){switch(typeof y){case"number":if(!x(y))throw wn(y,Is);return Number.isInteger(y)?So(y):function(e){let t=function i(a,n){if(a<0)return-i(-a,n);let l=Math.pow(10,n);if(!(Math.abs(a*l%1-.5)<Number.EPSILON))return Math.round(a*l)/l;{let h=Math.floor(a*l);return(h%2==0?h:h+1)/l}}(e,3);if(Math.floor(Math.abs(t)).toString().length>12)throw wn(e,"Decimal");let r=t.toString();return r.includes(".")?r:`${r}.0`}(y);case"string":return function(e){if(qa.test(e))throw wn(e,"String");return`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`}(y);case"symbol":return Js(y);case"boolean":return function(e){if(typeof e!="boolean")throw wn(e,"Boolean");return e?"?1":"?0"}(y);case"object":if(y instanceof Date)return`@${So(y.getTime()/1e3)}`;if(y instanceof Uint8Array)return function(e){if(ArrayBuffer.isView(e)===!1)throw wn(e,"Byte Sequence");return`:${btoa(String.fromCharCode(...e))}:`}(y);if(y instanceof bo)return Js(y);default:throw wn(y,Is)}}function pn(y){if(/^[a-z*][a-z0-9\-_.*]*$/.test(y)===!1)throw wn(y,"Key");return y}function xo(y){return y==null?"":Object.entries(y).map(([e,t])=>t===!0?`;${pn(e)}`:`;${pn(e)}=${Ls(t)}`).join("")}function gs(y){return y instanceof En?`${Ls(y.value)}${xo(y.params)}`:Ls(y)}function eo(y,e){return function(t,r={whitespace:!0}){if(typeof t!="object"||t==null)throw wn(t,"Dict");let i=t instanceof Map?t.entries():Object.entries(t),a=r?.whitespace?" ":"";return Array.from(i).map(([n,l])=>{!(l instanceof En)&&(l=new En(l));let h=pn(n);if(l.value===!0)h+=xo(l.params);else if(h+="=",Array.isArray(l.value)){var p;h+=(p=l,`(${p.value.map(gs).join(" ")})${xo(p.params)}`)}else h+=gs(l);return h}).join(`,${a}`)}(y,e)}let gn="CMCD-Object",Yi="CMCD-Request",kn="CMCD-Session",Nn="CMCD-Status",To={br:gn,ab:gn,d:gn,ot:gn,tb:gn,tpb:gn,lb:gn,tab:gn,lab:gn,url:gn,pb:Yi,bl:Yi,tbl:Yi,dl:Yi,ltc:Yi,mtp:Yi,nor:Yi,nrr:Yi,rc:Yi,sn:Yi,sta:Yi,su:Yi,ttfb:Yi,ttfbb:Yi,ttlb:Yi,cmsdd:Yi,cmsds:Yi,smrt:Yi,df:Yi,cs:Yi,ts:Yi,cid:kn,pr:kn,sf:kn,sid:kn,st:kn,v:kn,msd:kn,bs:Nn,bsd:Nn,cdn:Nn,rtp:Nn,bg:Nn,pt:Nn,ec:Nn,e:Nn},to={REQUEST:Yi},Ps="event",ms=y=>Math.round(y),ro=(y,e)=>Array.isArray(y)?y.map(t=>ro(t,e)):y instanceof En&&typeof y.value=="string"?new En(ro(y.value,e),y.params):(e.baseUrl&&(y=function(t,r){let i=new URL(t),a=new URL(r);if(i.origin!==a.origin)return t;let n=i.pathname.split("/").slice(1),l=a.pathname.split("/").slice(1,-1);for(;n[0]===l[0];)n.shift(),l.shift();for(;l.length;)l.shift(),n.unshift("..");return n.join("/")+i.search+i.hash}(y,e.baseUrl)),e.version===1?encodeURIComponent(y):y),Ds=y=>100*ms(y/100),io={br:ms,d:ms,bl:Ds,dl:Ds,mtp:Ds,nor:(y,e)=>{let t=y;return e.version>=2&&(y instanceof En&&typeof y.value=="string"?t=new En([y]):typeof y=="string"&&(t=[y])),ro(t,e)},rtp:Ds,tb:ms},Eo="request",rs="response",Os=["ab","bg","bl","br","bs","bsd","cdn","cid","cs","df","ec","lab","lb","ltc","msd","mtp","pb","pr","pt","sf","sid","sn","st","sta","tab","tb","tbl","tpb","ts","v"],A=["e"],T=/^[a-zA-Z0-9-.]+-[a-zA-Z0-9-.]+$/;function V(y){return T.test(y)}let ee=["d","dl","nor","ot","rtp","su"],ie=["cmsdd","cmsds","rc","smrt","ttfb","ttfbb","ttlb","url"],Ee=["bl","br","bs","cid","d","dl","mtp","nor","nrr","ot","pr","rtp","sf","sid","st","su","tb","v"];function He(y){return Ee.includes(y)||V(y)}let Me={[rs]:function(y){return Os.includes(y)||ee.includes(y)||ie.includes(y)||V(y)},[Ps]:function(y){return Os.includes(y)||A.includes(y)||V(y)},[Eo]:function(y){return Os.includes(y)||ee.includes(y)||V(y)}};function ht(y,e={}){let t={};if(y==null||typeof y!="object")return t;let r=e.version||y.v||1,i=e.reportingMode||Eo,a=r===1?He:Me[i],n=Object.keys(y).filter(a),l=e.filter;typeof l=="function"&&(n=n.filter(l));let h=i===rs||i===Ps;h&&!n.includes("ts")&&n.push("ts"),r>1&&!n.includes("v")&&n.push("v");let p=_({},io,e.formatters),v={version:r,reportingMode:i,baseUrl:e.baseUrl};return n.sort().forEach(w=>{var P;let D=y[w],G=p[w];if(typeof G=="function"&&(D=G(D,v)),w==="v"){if(r===1)return;D=r}(w!="pr"||D!==1)&&(h&&w==="ts"&&!x(D)&&(D=Date.now()),(typeof(P=D)=="number"?x(P):P!=null&&P!==""&&P!==!1)&&(["ot","sf","st","e","sta"].includes(w)&&typeof D=="string"&&(D=new bo(D)),t[w]=D))}),t}let pt=/CMCD=[^&#]+/;class jt{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.includeKeys=void 0,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=i=>{try{this.apply(i,{ot:Ca.MANIFEST,su:!this.initialized})}catch(a){this.hls.logger.warn("Could not generate manifest CMCD data.",a)}},this.applyFragmentData=i=>{try{let{frag:a,part:n}=i,l=this.hls.levels[a.level],h=this.getObjectType(a),p={d:1e3*(n||a).duration,ot:h};(h===Ca.VIDEO||h===Ca.AUDIO||h==Ca.MUXED)&&(p.br=l.bitrate/1e3,p.tb=this.getTopBandwidth(h)/1e3,p.bl=this.getBufferLength(h));let v=n?this.getNextPart(n):this.getNextFrag(a);v!=null&&v.url&&v.url!==a.url&&(p.nor=v.url),this.apply(i,p)}catch(a){this.hls.logger.warn("Could not generate segment CMCD data.",a)}},this.hls=e;let t=this.config=e.config,{cmcd:r}=t;r!=null&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=r.sessionId||e.sessionId,this.cid=r.contentId,this.useHeaders=r.useHeaders===!0,this.includeKeys=r.includeKeys,this.registerListeners())}registerListeners(){let e=this.hls;e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHED,this.onMediaDetached,this),e.on(o.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let e=this.hls;e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHED,this.onMediaDetached,this),e.off(o.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null,this.onWaiting=this.onPlaying=this.media=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var r,i;this.audioBuffer=(r=t.tracks.audio)==null?void 0:r.buffer,this.videoBuffer=(i=t.tracks.video)==null?void 0:i.buffer}createData(){var e;return{v:1,sf:jo.HLS,sid:this.sid,cid:this.cid,pr:(e=this.media)==null?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){_(t,this.createData());let r=t.ot===Ca.INIT||t.ot===Ca.VIDEO||t.ot===Ca.MUXED;this.starved&&r&&(t.bs=!0,t.su=!0,this.starved=!1),t.su==null&&(t.su=this.buffering);let{includeKeys:i}=this;i&&(t=Object.keys(t).reduce((l,h)=>(i.includes(h)&&(l[h]=t[h]),l),{}));let a={baseUrl:e.url};if(this.useHeaders){var n;e.headers||(e.headers={}),n=e.headers,_(n,function(l,h={}){let p={};return l?Object.entries(function(v,w){let P={};if(!v)return P;let D=Object.keys(v),G=w?Object.keys(w).reduce((z,H)=>{var oe;return(oe=w[H])===null||oe===void 0||oe.forEach(Se=>z[Se]=H),z},{}):{};return D.reduce((z,H)=>{var oe;let Se=To[H]||G[H]||to.REQUEST;return((oe=z[Se])!==null&&oe!==void 0?oe:z[Se]={})[H]=v[H],z},P)}(ht(l,h),h?.customHeaderMap)).reduce((v,[w,P])=>{let D=eo(P,{whitespace:!1});return D&&(v[w]=D),v},p):p}(t,a))}else e.url=function(l,h,p){let v=function(P,D={}){return P?`CMCD=${function(z,H={}){return z?encodeURIComponent(function(oe,Se={}){return oe?eo(ht(oe,Se),{whitespace:!1}):""}(z,H)):""}(P,D)}`:""}(h,p);if(!v)return l;if(pt.test(l))return l.replace(pt,v);let w=l.includes("?")?"&":"?";return`${l}${w}${v}`}(e.url,t,a)}getNextFrag(e){var t;let r=(t=this.hls.levels[e.level])==null?void 0:t.details;if(r){let i=e.sn-r.startSN;return r.fragments[i+1]}}getNextPart(e){var t;let{index:r,fragment:i}=e,a=(t=this.hls.levels[i.level])==null||(t=t.details)==null?void 0:t.partList;if(a){let{sn:n}=i;for(let l=a.length-1;l>=0;l--){let h=a[l];if(h.index===r&&h.fragment.sn===n)return a[l+1]}}}getObjectType(e){let{type:t}=e;return t==="subtitle"?Ca.TIMED_TEXT:e.sn==="initSegment"?Ca.INIT:t==="audio"?Ca.AUDIO:t==="main"?this.hls.audioTracks.length?Ca.VIDEO:Ca.MUXED:void 0}getTopBandwidth(e){let t,r=0,i=this.hls;if(e===Ca.AUDIO)t=i.audioTracks;else{let a=i.maxAutoLevel,n=a>-1?a+1:i.levels.length;t=i.levels.slice(0,n)}return t.forEach(a=>{a.bitrate>r&&(r=a.bitrate)}),r>0?r:NaN}getBufferLength(e){let t=this.media,r=e===Ca.AUDIO?this.audioBuffer:this.videoBuffer;return r&&t?1e3*le.bufferInfo(r,t.currentTime,this.config.maxBufferHole).len:NaN}createPlaylistLoader(){let{pLoader:e}=this.config,t=this.applyPlaylistData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,n){t(i),this.loader.load(i,a,n)}}}createFragmentLoader(){let{fLoader:e}=this.config,t=this.applyFragmentData,r=e||this.config.loader;return class{constructor(i){this.loader=void 0,this.loader=new r(i)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(i,a,n){t(i),this.loader.load(i,a,n)}}}}class Et extends L{constructor(e){super("content-steering",e.logger),this.hls=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this._pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.registerListeners()}registerListeners(){let e=this.hls;e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let e=this.hls;e&&(e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.ERROR,this.onError,this))}pathways(){return(this.levels||[]).reduce((e,t)=>(e.indexOf(t.pathwayId)===-1&&e.push(t.pathwayId),e),[])}get pathwayPriority(){return this._pathwayPriority}set pathwayPriority(e){this.updatePathwayPriority(e)}startLoad(){if(this.started=!0,this.clearTimeout(),this.enabled&&this.uri){if(this.updated){let e=1e3*this.timeToLoad-(performance.now()-this.updated);if(e>0){this.scheduleRefresh(this.uri,e);return}}this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),this.clearTimeout()}clearTimeout(){this.reloadTimer!==-1&&(ut.clearTimeout(this.reloadTimer),this.reloadTimer=-1)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){let t=this.levels;t&&(this.levels=t.filter(r=>r!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){let{contentSteering:r}=t;r!==null&&(this.pathwayId=r.pathwayId,this.uri=r.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){let{errorAction:r}=t;if(r?.action===Yr.SendAlternateToPenaltyBox&&r.flags===yi.MoveAllAlternatesMatchingHost){let i=this.levels,a=this._pathwayPriority,n=this.pathwayId;if(t.context){let{groupId:l,pathwayId:h,type:p}=t.context;l&&i?n=this.getPathwayForGroupId(l,p,n):h&&(n=h)}n in this.penalizedPathways||(this.penalizedPathways[n]=performance.now()),!a&&i&&(a=this.pathways()),a&&a.length>1&&(this.updatePathwayPriority(a),r.resolved=this.pathwayId!==n),t.details!==d.BUFFER_APPEND_ERROR||t.fatal?r.resolved||this.warn(`Could not resolve ${t.details} ("${t.error.message}") with content-steering for Pathway: ${n} levels: ${i&&i.length} priorities: ${Xt(a)} penalized: ${Xt(this.penalizedPathways)}`):r.resolved=!0}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(t.length===0){let r=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${r}"`),t=this.getLevelsForPathway(r),this.pathwayId=r}return t.length!==e.length&&this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t}getLevelsForPathway(e){return this.levels===null?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this._pathwayPriority=e;let r=this.penalizedPathways,i=performance.now();Object.keys(r).forEach(a=>{i-r[a]>3e5&&delete r[a]});for(let a=0;a<e.length;a++){let n=e[a];if(n in r)continue;if(n===this.pathwayId)return;let l=this.hls.nextLoadLevel,h=this.hls.levels[l];if((t=this.getLevelsForPathway(n)).length>0){this.log(`Setting Pathway to "${n}"`),this.pathwayId=n,We(t),this.hls.trigger(o.LEVELS_UPDATED,{levels:t});let p=this.hls.levels[l];h&&p&&this.levels&&(p.attrs["STABLE-VARIANT-ID"]!==h.attrs["STABLE-VARIANT-ID"]&&p.bitrate!==h.bitrate&&this.log(`Unstable Pathways change from bitrate ${h.bitrate} to ${p.bitrate}`),this.hls.nextLoadLevel=l);break}}}getPathwayForGroupId(e,t,r){let i=this.getLevelsForPathway(r).concat(this.levels||[]);for(let a=0;a<i.length;a++)if(t===f.AUDIO_TRACK&&i[a].hasAudioGroup(e)||t===f.SUBTITLE_TRACK&&i[a].hasSubtitleGroup(e))return i[a].pathwayId;return r}clonePathways(e){let t=this.levels;if(!t)return;let r={},i={};e.forEach(a=>{let{ID:n,"BASE-ID":l,"URI-REPLACEMENT":h}=a;if(t.some(v=>v.pathwayId===n))return;let p=this.getLevelsForPathway(l).map(v=>{let w=new St(v.attrs);w["PATHWAY-ID"]=n;let P=w.AUDIO&&`${w.AUDIO}_clone_${n}`,D=w.SUBTITLES&&`${w.SUBTITLES}_clone_${n}`;P&&(r[w.AUDIO]=P,w.AUDIO=P),D&&(i[w.SUBTITLES]=D,w.SUBTITLES=D);let G=Sr(v.uri,w["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",h),z=new Wr({attrs:w,audioCodec:v.audioCodec,bitrate:v.bitrate,height:v.height,name:v.name,url:G,videoCodec:v.videoCodec,width:v.width});if(v.audioGroups)for(let H=1;H<v.audioGroups.length;H++)z.addGroupId("audio",`${v.audioGroups[H]}_clone_${n}`);if(v.subtitleGroups)for(let H=1;H<v.subtitleGroups.length;H++)z.addGroupId("text",`${v.subtitleGroups[H]}_clone_${n}`);return z});t.push(...p),dr(this.audioTracks,r,h,n),dr(this.subtitleTracks,i,h,n)})}loadSteeringManifest(e){let t,r=this.hls.config,i=r.loader;this.loader&&this.loader.destroy(),this.loader=new i(r);try{t=new ut.URL(e)}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if(t.protocol!=="data:"){let p=0|(this.hls.bandwidthEstimate||r.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+p)}let a={responseType:"json",url:t.href},n=r.steeringManifestLoadPolicy.default,l=n.errorRetry||n.timeoutRetry||{},h={loadPolicy:n,timeout:n.maxLoadTimeMs,maxRetry:l.maxNumRetry||0,retryDelay:l.retryDelayMs||0,maxRetryDelay:l.maxRetryDelayMs||0};this.log(`Requesting steering manifest: ${t}`),this.loader.load(a,h,{onSuccess:(p,v,w,P)=>{this.log(`Loaded steering manifest: "${t}"`);let D=p.data;if(D?.VERSION!==1){this.log(`Steering VERSION ${D.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=D.TTL;let{"RELOAD-URI":G,"PATHWAY-CLONES":z,"PATHWAY-PRIORITY":H}=D;if(G)try{this.uri=new ut.URL(G,t).href}catch{this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${G}`);return}this.scheduleRefresh(this.uri||w.url),z&&this.clonePathways(z);let oe={steeringManifest:D,url:t.toString()};this.hls.trigger(o.STEERING_MANIFEST_LOADED,oe),H&&this.updatePathwayPriority(H)},onError:(p,v,w,P)=>{if(this.log(`Error loading steering manifest: ${p.code} ${p.text} (${v.url})`),this.stopLoad(),p.code===410){this.enabled=!1,this.log(`Steering manifest ${v.url} no longer available`);return}let D=1e3*this.timeToLoad;if(p.code===429){let G=this.loader;if(typeof G?.getResponseHeader=="function"){let z=G.getResponseHeader("Retry-After");z&&(D=1e3*parseFloat(z))}this.log(`Steering manifest ${v.url} rate limited`);return}this.scheduleRefresh(this.uri||v.url,D)},onTimeout:(p,v,w)=>{this.log(`Timeout loading steering manifest (${v.url})`),this.scheduleRefresh(this.uri||v.url)}})}scheduleRefresh(e,t=1e3*this.timeToLoad){this.clearTimeout(),this.reloadTimer=ut.setTimeout(()=>{var r;let i=(r=this.hls)==null?void 0:r.media;if(i&&!i.ended){this.loadSteeringManifest(e);return}this.scheduleRefresh(e,1e3*this.timeToLoad)},t)}}function dr(y,e,t,r){y&&Object.keys(e).forEach(i=>{let a=y.filter(n=>n.groupId===i).map(n=>{let l=_({},n);return l.details=void 0,l.attrs=new St(l.attrs),l.url=l.attrs.URI=Sr(n.url,n.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",t),l.groupId=l.attrs["GROUP-ID"]=e[i],l.attrs["PATHWAY-ID"]=r,l});y.push(...a)})}function Sr(y,e,t,r){let i,{HOST:a,PARAMS:n,[t]:l}=r;e&&(i=l?.[e])&&(y=i);let h=new ut.URL(y);return a&&!i&&(h.host=a),n&&Object.keys(n).sort().forEach(p=>{p&&h.searchParams.set(p,n[p])}),h.href}class xr extends L{constructor(e){super("eme",e.logger),this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.mediaKeys=null,this.setMediaKeysQueue=xr.CDMCleanupPromise?[xr.CDMCleanupPromise]:[],this.bannedKeyIds={},this.onMediaEncrypted=t=>{let{initDataType:r,initData:i}=t,a=`"${t.type}" event: init data type: "${r}"`;if(this.debug(a),i!==null){if(!this.keyFormatPromise){let n=Object.keys(this.keySystemAccessPromises);n.length||(n=wi(this.config));let l=n.map(Ei).filter(h=>!!h);this.keyFormatPromise=this.getKeyFormatPromise(l)}this.keyFormatPromise.then(n=>{let l,h=Tr(n);if(r!=="sinf"||h!==Wt.FAIRPLAY){this.log(`Ignoring "${t.type}" event with init data type: "${r}" for selected key-system ${h}`);return}try{let D=ne(new Uint8Array(i)),G=Kt(JSON.parse(D).sinf),z=Xe(G);if(!z)throw Error("'schm' box missing or not cbcs/cenc with schi > tenc");l=new Uint8Array(z.subarray(8,24))}catch(D){this.warn(`${a} Failed to parse sinf: ${D}`);return}let p=b(l),{keyIdToKeySessionPromise:v,mediaKeySessions:w}=this,P=v[p];for(let D=0;D<w.length;D++){let G=w[D],z=G.decryptdata;if(!z.keyId)continue;let H=b(z.keyId);if(p===H||z.uri.replace(/-/g,"").indexOf(p)!==-1){if(!(P=v[H]))continue;if(z.pssh)break;delete v[H],z.pssh=new Uint8Array(i),z.keyId=l,(P=v[p]=P.then(()=>this.generateRequestWithPreferredKeySession(G,r,i,"encrypted-event-key-match"))).catch(oe=>this.handleError(oe));break}}P||this.handleError(Error(`Key ID ${p} not encountered in playlist. Key-system sessions ${w.length}.`))}).catch(n=>this.handleError(n))}},this.onWaitingForKey=t=>{this.log(`"${t.type}" event`)},this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.onDestroying(),this.onMediaDetached();let e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.config=this.keyIdToKeySessionPromise=null,this.onMediaEncrypted=this.onWaitingForKey=null}registerListeners(){this.hls.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(o.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(o.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(o.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.on(o.DESTROYING,this.onDestroying,this)}unregisterListeners(){this.hls.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(o.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(o.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(o.MANIFEST_LOADED,this.onManifestLoaded,this),this.hls.off(o.DESTROYING,this.onDestroying,this)}getLicenseServerUrl(e){let{drmSystems:t,widevineLicenseUrl:r}=this.config,i=t?.[e];return i?i.licenseUrl:e===Wt.WIDEVINE&&r?r:void 0}getLicenseServerUrlOrThrow(e){let t=this.getLicenseServerUrl(e);if(t===void 0)throw Error(`no license server URL configured for key-system "${e}"`);return t}getServerCertificateUrl(e){let{drmSystems:t}=this.config,r=t?.[e];if(r)return r.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){let t=this.hls.levels,r=(n,l,h)=>!!n&&h.indexOf(n)===l,i=t.map(n=>n.audioCodec).filter(r),a=t.map(n=>n.videoCodec).filter(r);return i.length+a.length===0&&a.push("avc1.42e01e"),new Promise((n,l)=>{let h=p=>{let v=p.shift();this.getMediaKeysPromise(v,i,a).then(w=>n({keySystem:v,mediaKeys:w})).catch(w=>{p.length?h(p):w instanceof Vt?l(w):l(new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_NO_ACCESS,error:w,fatal:!0},w.message))})};h(e)})}requestMediaKeySystemAccess(e,t){let{requestMediaKeySystemAccessFunc:r}=this.config;if(typeof r!="function"){let i=`Configured requestMediaKeySystemAccess is not a function ${r}`;return ci===null&&ut.location.protocol==="http:"&&(i=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(Error(i))}return r(e,t)}getMediaKeysPromise(e,t,r){var i;let a=function(h,p,v,w){let P;switch(h){case Wt.FAIRPLAY:P=["cenc","sinf"];break;case Wt.WIDEVINE:case Wt.PLAYREADY:P=["cenc"];break;case Wt.CLEARKEY:P=["cenc","keyids"];break;default:throw Error(`Unknown key-system: ${h}`)}return[{initDataTypes:P,persistentState:w.persistentState||"optional",distinctiveIdentifier:w.distinctiveIdentifier||"optional",sessionTypes:w.sessionTypes||[w.sessionType||"temporary"],audioCapabilities:p.map(D=>({contentType:`audio/mp4; codecs=${D}`,robustness:w.audioRobustness||"",encryptionScheme:w.audioEncryptionScheme||null})),videoCapabilities:v.map(D=>({contentType:`video/mp4; codecs=${D}`,robustness:w.videoRobustness||"",encryptionScheme:w.videoEncryptionScheme||null}))}]}(e,t,r,this.config.drmSystemOptions||{}),n=this.keySystemAccessPromises[e],l=(i=n)==null?void 0:i.keySystemAccess;if(!l){this.log(`Requesting encrypted media "${e}" key-system access with config: ${Xt(a)}`),l=this.requestMediaKeySystemAccess(e,a);let h=n=this.keySystemAccessPromises[e]={keySystemAccess:l};return l.catch(p=>{this.log(`Failed to obtain access to key-system "${e}": ${p}`)}),l.then(p=>{this.log(`Access for key-system "${p.keySystem}" obtained`);let v=this.fetchServerCertificate(e);this.log(`Create media-keys for "${e}"`);let w=h.mediaKeys=p.createMediaKeys().then(P=>(this.log(`Media-keys created for "${e}"`),h.hasMediaKeys=!0,v.then(D=>D?this.setMediaKeysServerCertificate(P,e,D):P)));return w.catch(P=>{this.error(`Failed to create media-keys for "${e}"}: ${P}`)}),w})}return l.then(()=>n.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:r}){this.log(`Creating key-system session "${t}" keyId: ${b(e.keyId||[])}`);let i=r.createSession(),a={decryptdata:e,keySystem:t,mediaKeys:r,mediaKeysSession:i,keyStatus:"status-pending"};return this.mediaKeySessions.push(a),a}renewKeySession(e){let t=e.decryptdata;if(t.pssh){let r=this.createMediaKeySessionContext(e),i=this.getKeyIdString(t);this.keyIdToKeySessionPromise[i]=this.generateRequestWithPreferredKeySession(r,"cenc",t.pssh.buffer,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw Error("Could not read keyId of undefined decryptdata");if(e.keyId===null)throw Error("keyId is null");return b(e.keyId)}updateKeySession(e,t){let r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyId ${b(e.decryptdata.keyId||[])}
      } (data length: ${t.byteLength})`),r.update(t)}getSelectedKeySystemFormats(){return Object.keys(this.keySystemAccessPromises).map(e=>({keySystem:e,hasMediaKeys:this.keySystemAccessPromises[e].hasMediaKeys})).filter(({hasMediaKeys:e})=>!!e).map(({keySystem:e})=>Ei(e)).filter(e=>!!e)}getKeySystemAccess(e){return this.getKeySystemSelectionPromise(e).then(({keySystem:t,mediaKeys:r})=>this.attemptSetMediaKeys(t,r))}selectKeySystem(e){return new Promise((t,r)=>{this.getKeySystemSelectionPromise(e).then(({keySystem:i})=>{let a=Ei(i);a?t(a):r(Error(`Unable to find format for key-system "${i}"`))}).catch(r)})}selectKeySystemFormat(e){let t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){let t=wi(this.config),r=e.map(Tr).filter(i=>!!i&&t.indexOf(i)!==-1);return this.selectKeySystem(r)}loadKey(e){let t=e.keyInfo.decryptdata,r=this.getKeyIdString(t),i=this.bannedKeyIds[r];if(i){let l=ur(i,t);return this.handleError(l,e.frag),Promise.reject(l)}let a=`(keyId: ${r} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${a}`);let n=this.keyIdToKeySessionPromise[r];if(!n){let l=this.getKeySystemForKeyPromise(t).then(({keySystem:h,mediaKeys:p})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${a}`),this.attemptSetMediaKeys(h,p).then(()=>(this.throwIfDestroyed(),this.createMediaKeySessionContext({keySystem:h,mediaKeys:p,decryptdata:t}))))).then(h=>{let p=t.pssh?t.pssh.buffer:null;return this.generateRequestWithPreferredKeySession(h,"cenc",p,"playlist-key")});return l.catch(h=>this.handleError(h,e.frag)),this.keyIdToKeySessionPromise[r]=l,l}return n}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw Error("invalid state")}handleError(e,t){this.hls&&(this.error(e.message),e instanceof Vt?(t&&(e.data.frag=t),this.hls.trigger(o.ERROR,e.data)):this.hls.trigger(o.ERROR,{type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){let t=this.getKeyIdString(e),r=this.keyIdToKeySessionPromise[t];if(!r){let i=Tr(e.keyFormat),a=i?[i]:wi(this.config);return this.attemptKeySystemAccess(a)}return r}getKeySystemSelectionPromise(e){if(e.length||(e=wi(this.config)),e.length===0)throw new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${Xt({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}attemptSetMediaKeys(e,t){if(this.mediaKeys===t)return Promise.resolve();let r=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);let i=Promise.all(r).then(()=>{if(!this.media)throw this.mediaKeys=null,Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.mediaKeys=t,this.setMediaKeysQueue.push(i),i.then(()=>{this.log(`Media-keys set for "${e}"`),r.push(i),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(a=>r.indexOf(a)===-1)})}generateRequestWithPreferredKeySession(e,t,r,i){var a;let n=(a=this.config.drmSystems)==null||(a=a[e.keySystem])==null?void 0:a.generateRequest;if(n)try{let P=n.call(this.hls,t,r,e);if(!P)throw Error("Invalid response from configured generateRequest filter");t=P.initDataType,r=P.initData?P.initData:null,e.decryptdata.pssh=r?new Uint8Array(r):null}catch(P){if(this.warn(P.message),this.hls&&this.hls.config.debug)throw P}if(r===null)return this.log(`Skipping key-session request for "${i}" (no initData)`),Promise.resolve(e);let l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${i}": ${l} (init data type: ${t} length: ${r.byteLength})`);let h=new or,p=e._onmessage=P=>{let D=e.mediaKeysSession;if(!D){h.emit("error",Error("invalid state"));return}let{messageType:G,message:z}=P;this.log(`"${G}" message event for session "${D.sessionId}" message size: ${z.byteLength}`),G==="license-request"||G==="license-renewal"?this.renewLicense(e,z).catch(H=>{h.eventNames().length?h.emit("error",H):this.handleError(H)}):G==="license-release"?e.keySystem===Wt.FAIRPLAY&&(this.updateKeySession(e,Gr("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${G}"`)},v=e._onkeystatuseschange=P=>{if(!e.mediaKeysSession){h.emit("error",Error("invalid state"));return}let D=e.keyStatus;this.onKeyStatusChange(e);let G=e.keyStatus;G!==D&&(h.emit("keyStatus",G,e),G==="expired"&&(this.log(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e)))};ot(e.mediaKeysSession,"message",p),ot(e.mediaKeysSession,"keystatuseschange",v);let w=new Promise((P,D)=>{h.on("error",D),h.on("keyStatus",(G,{decryptdata:z})=>{G.startsWith("usable")?P():G==="internal-error"||G==="output-restricted"?D(ur(G,z)):G==="expired"?D(Error(`key expired while generating request (keyId: ${l})`)):this.warn(`unhandled key status change "${G}" (keyId: ${l})`)})});return e.mediaKeysSession.generateRequest(t,r).then(()=>{this.log(`Request generated for key-session "${e.mediaKeysSession.sessionId}" keyId: ${l}`)}).catch(P=>{throw new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_NO_SESSION,error:P,decryptdata:e.decryptdata,fatal:!1},`Error generating key-session request: ${P}`)}).then(()=>w).catch(P=>{throw h.removeAllListeners(),this.removeSession(e),P}).then(()=>(h.removeAllListeners(),e))}onKeyStatusChange(e){let t=b(new Uint8Array(e.decryptdata.keyId||[]));e.mediaKeysSession.keyStatuses.forEach((r,i)=>{if(typeof i=="string"&&typeof r=="object"){let l=i;i=r,r=l}let a=b("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i));r==="internal-error"&&(this.bannedKeyIds[a]=r);let n=a===t;this.log(`${n?"":"un"}matched key status change "${r}" for keyStatuses keyId: ${a} session keyId: ${t} uri: ${e.decryptdata.uri}`),n&&(e.keyStatus=r)})}fetchServerCertificate(e){let t=this.config,r=new t.loader(t),i=this.getServerCertificateUrl(e);return i?(this.log(`Fetching server certificate for "${e}"`),new Promise((a,n)=>{let l={responseType:"arraybuffer",url:i},h=t.certLoadPolicy.default,p={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};r.load(l,p,{onSuccess:(v,w,P,D)=>{a(v.data)},onError:(v,w,P,D)=>{n(new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:P,response:F({url:l.url,data:void 0},v)},`"${e}" certificate request failed (${i}). Status: ${v.code} (${v.text})`))},onTimeout:(v,w,P)=>{n(new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:P,response:{url:l.url,data:void 0}},`"${e}" certificate request timed out (${i})`))},onAbort:(v,w,P)=>{n(Error("aborted"))}})})):Promise.resolve()}setMediaKeysServerCertificate(e,t,r){return new Promise((i,a)=>{e.setServerCertificate(r).then(n=>{this.log(`setServerCertificate ${n?"success":"not supported by CDM"} (${r.byteLength}) on "${t}"`),i(e)}).catch(n=>{a(new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:n,fatal:!0},n.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(r=>this.updateKeySession(e,new Uint8Array(r)).catch(i=>{throw new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_SESSION_UPDATE_FAILED,decryptdata:e.decryptdata,error:i,fatal:!1},i.message)}))}unpackPlayReadyKeyMessage(e,t){let r=String.fromCharCode.apply(null,new Uint16Array(t.buffer));if(!r.includes("PlayReadyKeyMessage"))return e.setRequestHeader("Content-Type","text/xml; charset=utf-8"),t;let i=new DOMParser().parseFromString(r,"application/xml"),a=i.querySelectorAll("HttpHeader");if(a.length>0){let v;for(let w=0,P=a.length;w<P;w++){var n,l;let D=(n=(v=a[w]).querySelector("name"))==null?void 0:n.textContent,G=(l=v.querySelector("value"))==null?void 0:l.textContent;D&&G&&e.setRequestHeader(D,G)}}let h=i.querySelector("Challenge"),p=h?.textContent;if(!p)throw Error("Cannot find <Challenge> in key message");return Gr(atob(p))}setupLicenseXHR(e,t,r,i){let a=this.config.licenseXhrSetup;return a?Promise.resolve().then(()=>{if(!r.decryptdata)throw Error("Key removed");return a.call(this.hls,e,t,r,i)}).catch(n=>{if(!r.decryptdata)throw n;return e.open("POST",t,!0),a.call(this.hls,e,t,r,i)}).then(n=>(e.readyState||e.open("POST",t,!0),{xhr:e,licenseChallenge:n||i})):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:i}))}requestLicense(e,t){let r=this.config.keyLoadPolicy.default;return new Promise((i,a)=>{let n=this.getLicenseServerUrlOrThrow(e.keySystem);this.log(`Sending license request to URL: ${n}`);let l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return a(Error("invalid state"));if(l.readyState===4)if(l.status===200){this._requestLicenseFailureCount=0;let h=l.response;this.log(`License received ${h instanceof ArrayBuffer?h.byteLength:h}`);let p=this.config.licenseResponseCallback;if(p)try{h=p.call(this.hls,l,n,e)}catch(v){this.error(v)}i(h)}else{let h=r.errorRetry,p=h?h.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>p||l.status>=400&&l.status<500)a(new Vt({type:S.KEY_SYSTEM_ERROR,details:d.KEY_SYSTEM_LICENSE_REQUEST_FAILED,decryptdata:e.decryptdata,fatal:!0,networkDetails:l,response:{url:n,data:void 0,code:l.status,text:l.statusText}},`License Request XHR failed (${n}). Status: ${l.status} (${l.statusText})`));else{let v=p-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${v} attempts left`),this.requestLicense(e,t).then(i,a)}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=l,this.setupLicenseXHR(l,n,e,t).then(({xhr:h,licenseChallenge:p})=>{e.keySystem==Wt.PLAYREADY&&(p=this.unpackPlayReadyKeyMessage(h,p)),h.send(p)}).catch(a)})}onDestroying(){this.unregisterListeners(),this._clear()}onMediaAttached(e,t){if(!this.config.emeEnabled)return;let r=t.media;this.media=r,ot(r,"encrypted",this.onMediaEncrypted),ot(r,"waitingforkey",this.onWaitingForKey)}onMediaDetached(){let e=this.media;e&&(Ot(e,"encrypted",this.onMediaEncrypted),Ot(e,"waitingforkey",this.onWaitingForKey),this.media=null,this.mediaKeys=null)}_clear(){var e;if(this._requestLicenseFailureCount=0,this.keyIdToKeySessionPromise={},this.bannedKeyIds={},!this.mediaKeys&&!this.mediaKeySessions.length)return;let t=this.media,r=this.mediaKeySessions.slice();this.mediaKeySessions=[],this.mediaKeys=null,sr.clearKeyUriToKeyIdMap();let i=r.length;xr.CDMCleanupPromise=Promise.all(r.map(a=>this.removeSession(a)).concat(t==null||(e=t.setMediaKeys(null))==null?void 0:e.catch(a=>{this.log(`Could not clear media keys: ${a}`),this.hls&&this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.KEY_SYSTEM_DESTROY_MEDIA_KEYS_ERROR,fatal:!1,error:Error(`Could not clear media keys: ${a}`)})}))).catch(a=>{this.log(`Could not close sessions and clear media keys: ${a}`),this.hls&&this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:Error(`Could not close sessions and clear media keys: ${a}`)})}).then(()=>{i&&this.log("finished closing key sessions and clearing media keys")})}onManifestLoading(){this.keyFormatPromise=null,this.bannedKeyIds={}}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){let r=t.reduce((i,a)=>(i.indexOf(a.keyFormat)===-1&&i.push(a.keyFormat),i),[]);this.log(`Selecting key-system from session-keys ${r.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(r)}}removeSession(e){let{mediaKeysSession:t,licenseXhr:r,decryptdata:i}=e;if(t){var a;this.log(`Remove licenses and keys and close session "${t.sessionId}" keyId: ${b(i?.keyId||[])}`),e._onmessage&&(t.removeEventListener("message",e._onmessage),e._onmessage=void 0),e._onkeystatuseschange&&(t.removeEventListener("keystatuseschange",e._onkeystatuseschange),e._onkeystatuseschange=void 0),r&&r.readyState!==XMLHttpRequest.DONE&&r.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;let n=this.mediaKeySessions.indexOf(e);n>-1&&this.mediaKeySessions.splice(n,1);let{drmSystemOptions:l}=this.config;return(l&&(l.sessionType==="persistent-license"||(a=l.sessionTypes)!=null&&a.some(h=>h==="persistent-license"))?new Promise((h,p)=>{ut.setTimeout(()=>p(Error("MediaKeySession.remove() timeout")),8e3),t.remove().then(h).catch(p)}):Promise.resolve()).catch(h=>{this.log(`Could not remove session: ${h}`),this.hls&&this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.KEY_SYSTEM_DESTROY_REMOVE_SESSION_ERROR,fatal:!1,error:Error(`Could not remove session: ${h}`)})}).then(()=>t.close()).catch(h=>{this.log(`Could not close session: ${h}`),this.hls&&this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.KEY_SYSTEM_DESTROY_CLOSE_SESSION_ERROR,fatal:!1,error:Error(`Could not close session: ${h}`)})})}}}xr.CDMCleanupPromise=void 0;class Vt extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=Error(t)),this.data=e,e.err=e.error}}function ur(y,e){let t=y==="output-restricted",r=t?d.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:d.KEY_SYSTEM_STATUS_INTERNAL_ERROR;return new Vt({type:S.KEY_SYSTEM_ERROR,details:r,fatal:!1,decryptdata:e},t?"HDCP level output restricted":`key status changed to "${y}"`)}class wt{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.on(o.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListeners(){this.hls.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),this.hls.off(o.MEDIA_DETACHING,this.onMediaDetaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){let r=this.hls.config;if(r.capLevelOnFPSDrop){let i=t.media instanceof ut.HTMLVideoElement?t.media:null;this.media=i,i&&typeof i.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),ut.clearInterval(this.timer),this.timer=ut.setInterval(this.checkFPSInterval.bind(this),r.fpsDroppedMonitoringPeriod)}}onMediaDetaching(){this.media=null}checkFPS(e,t,r){let i=performance.now();if(t){if(this.lastTime){let a=i-this.lastTime,n=r-this.lastDroppedFrames,l=t-this.lastDecodedFrames,h=1e3*n/a,p=this.hls;if(p.trigger(o.FPS_DROP,{currentDropped:n,currentDecoded:l,totalDroppedFrames:r}),h>0&&n>p.config.fpsDroppedMonitoringThreshold*l){let v=p.currentLevel;p.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+v),v>0&&(p.autoLevelCapping===-1||p.autoLevelCapping>=v)&&(v-=1,p.trigger(o.FPS_DROP_LEVEL_CAPPING,{level:v,droppedLevel:p.currentLevel}),p.autoLevelCapping=v,this.streamController.nextLevelSwitch())}}this.lastTime=i,this.lastDroppedFrames=r,this.lastDecodedFrames=t}}checkFPSInterval(){let e=this.media;if(e)if(this.isVideoPlaybackQualityAvailable){let t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}function Ra(y,e){let t;try{t=new Event("addtrack")}catch{(t=document.createEvent("Event")).initEvent("addtrack",!1,!1)}t.track=y,e.dispatchEvent(t)}function gt(y,e){let t=y.mode;if(t==="disabled"&&(y.mode="hidden"),y.cues&&!y.cues.getCueById(e.id))try{if(y.addCue(e),!y.cues.getCueById(e.id))throw Error(`addCue is failed for: ${e}`)}catch(r){se.debug(`[texttrack-utils]: ${r}`);try{let i=new ut.TextTrackCue(e.startTime,e.endTime,e.text);i.id=e.id,y.addCue(i)}catch(i){se.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${i}`)}}t==="disabled"&&(y.mode=t)}function ei(y,e){let t=y.mode;if(t==="disabled"&&(y.mode="hidden"),y.cues)for(let r=y.cues.length;r--;)e&&y.cues[r].removeEventListener("enter",e),y.removeCue(y.cues[r]);t==="disabled"&&(y.mode=t)}function Yt(y,e,t,r){let i=y.mode;if(i==="disabled"&&(y.mode="hidden"),y.cues&&y.cues.length>0){let a=function(n,l,h){let p=[],v=function(w,P){let D;if(P<=w[0].startTime)return 0;let G=w.length-1;if(P>w[G].endTime)return-1;let z=0,H=G;for(;z<=H;)if(P<w[D=Math.floor((H+z)/2)].startTime)H=D-1;else{if(!(P>w[D].startTime)||!(z<G))return D;z=D+1}return w[z].startTime-P<P-w[H].startTime?z:H}(n,l);if(v>-1)for(let w=v,P=n.length;w<P;w++){let D=n[w];if(D.startTime>=l&&D.endTime<=h)p.push(D);else if(D.startTime>h)break}return p}(y.cues,e,t);for(let n=0;n<a.length;n++)(!r||r(a[n]))&&y.removeCue(a[n])}i==="disabled"&&(y.mode=i)}function Di(y){let e=[];for(let t=0;t<y.length;t++){let r=y[t];(r.kind==="subtitles"||r.kind==="captions")&&r.label&&e.push(y[t])}return e}class va extends As{constructor(e){super(e,"subtitle-track-controller"),this.media=null,this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.onTextTracksChanged=()=>{if(this.useTextTrackPolling||ut.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let t=null,r=Di(this.media.textTracks);for(let a=0;a<r.length;a++)if(r[a].mode==="hidden")t=r[a];else if(r[a].mode==="showing"){t=r[a];break}let i=this.findTrackForTextTrack(t);this.subtitleTrack!==i&&this.setSubtitleTrack(i)},this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,this.onTextTracksChanged=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes()}registerListeners(){let{hls:e}=this;e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(o.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(o.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(o.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(o.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){ut.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=ut.setInterval(this.onTextTracksChanged,e)}onMediaDetaching(e,t){let r=this.media;if(!r)return;let i=!!t.transferMedia;ut.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||r.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),this.subtitleTrack=-1,this.media=null,i||Di(r.textTracks).forEach(a=>{ei(a)})}onManifestLoading(){this.tracks=[],this.groupIds=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){let{id:r,groupId:i,details:a}=t,n=this.tracksInGroup[r];if(!n||n.groupId!==i){this.warn(`Subtitle track with id:${r} and group:${i} not found in active group ${n?.groupId}`);return}let l=n.details;n.details=t.details,this.log(`Subtitle track ${r} "${n.name}" lang:${n.lang} group:${i} loaded [${a.startSN}-${a.endSN}]`),r===this.trackId&&this.playlistLoaded(r,t,l)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!t)return;let r=t.subtitleGroups||null,i=this.groupIds,a=this.currentTrack;if(!r||i?.length!==r?.length||r!=null&&r.some(n=>i?.indexOf(n)===-1)){this.groupIds=r,this.trackId=-1,this.currentTrack=null;let n=this.tracks.filter(p=>!r||r.indexOf(p.groupId)!==-1);if(n.length)this.selectDefaultTrack&&!n.some(p=>p.default)&&(this.selectDefaultTrack=!1),n.forEach((p,v)=>{p.id=v});else if(!a&&!this.tracksInGroup.length)return;this.tracksInGroup=n;let l=this.hls.config.subtitlePreference;if(!a&&l){this.selectDefaultTrack=!1;let p=Qt(l,n);if(p>-1)a=n[p];else{let v=Qt(l,this.tracks);a=this.tracks[v]}}let h=this.findTrackId(a);h===-1&&a&&(h=this.findTrackId(null)),this.log(`Updating subtitle tracks, ${n.length} track(s) found in "${r?.join(",")}" group-id`),this.hls.trigger(o.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n}),h!==-1&&this.trackId===-1&&this.setSubtitleTrack(h)}}findTrackId(e){let t=this.tracksInGroup,r=this.selectDefaultTrack;for(let i=0;i<t.length;i++){let a=t[i];if((!r||a.default)&&(r||e)&&(!e||Mi(a,e)))return i}if(e){for(let i=0;i<t.length;i++){let a=t[i];if(Mn(e.attrs,a.attrs,["LANGUAGE","ASSOC-LANGUAGE","CHARACTERISTICS"]))return i}for(let i=0;i<t.length;i++){let a=t[i];if(Mn(e.attrs,a.attrs,["LANGUAGE"]))return i}}return-1}findTrackForTextTrack(e){if(e){let t=this.tracksInGroup;for(let r=0;r<t.length;r++)if(ds(t[r],e))return r}return-1}onError(e,t){!t.fatal&&t.context&&(t.context.type!==f.SUBTITLE_TRACK||t.context.id!==this.trackId||this.groupIds&&this.groupIds.indexOf(t.context.groupId)===-1||this.checkRetry(t))}get allSubtitleTracks(){return this.tracks}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1,this.setSubtitleTrack(e)}setSubtitleOption(e){if(this.hls.config.subtitlePreference=e,e){if(e.id===-1)return this.setSubtitleTrack(-1),null;let t=this.allSubtitleTracks;if(this.selectDefaultTrack=!1,t.length){let r=this.currentTrack;if(r&&Mi(e,r))return r;let i=Qt(e,this.tracksInGroup);if(i>-1){let a=this.tracksInGroup[i];return this.setSubtitleTrack(i),a}if(!r){let a=Qt(e,t);if(a>-1)return t[a]}}}return null}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentTrack)&&this.scheduleLoading(this.currentTrack,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);let r=e.id,i=e.groupId,a=this.getUrlWithDirectives(e.url,t),n=e.details,l=n?.age;this.log(`Loading subtitle ${r} "${e.name}" lang:${e.lang} group:${i}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${l&&n.live?" age "+l.toFixed(1)+(n.type?" "+n.type:""):""} ${a}`),this.hls.trigger(o.SUBTITLE_TRACK_LOADING,{url:a,id:r,groupId:i,deliveryDirectives:t||null,track:e})}toggleTrackModes(){let e,{media:t}=this;if(!t)return;let r=Di(t.textTracks),i=this.currentTrack;if(!i||(e=r.filter(a=>ds(i,a))[0])||this.warn(`Unable to find subtitle TextTrack with name "${i.name}" and language "${i.lang}"`),[].slice.call(r).forEach(a=>{a.mode!=="disabled"&&a!==e&&(a.mode="disabled")}),e){let a=this.subtitleDisplay?"showing":"hidden";e.mode!==a&&(e.mode=a)}}setSubtitleTrack(e){let t=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(e<-1||e>=t.length||!x(e)){this.warn(`Invalid subtitle track id: ${e}`);return}this.selectDefaultTrack=!1;let r=this.currentTrack,i=t[e]||null;if(this.trackId=e,this.currentTrack=i,this.toggleTrackModes(),!i){this.hls.trigger(o.SUBTITLE_TRACK_SWITCH,{id:e});return}let a=!!i.details&&!i.details.live;if(e===this.trackId&&i===r&&a)return;this.log(`Switching to subtitle-track ${e}`+(i?` "${i.name}" lang:${i.lang} group:${i.groupId}`:""));let{id:n,groupId:l="",name:h,type:p,url:v}=i;this.hls.trigger(o.SUBTITLE_TRACK_SWITCH,{id:n,groupId:l,name:h,type:p,url:v});let w=this.switchParams(i.url,r?.details,i.details);this.loadPlaylist(w)}}function Xi(y){let e=5381,t=y.length;for(;t;)e=33*e^y.charCodeAt(--t);return(e>>>0).toString()}let ua=function(y){return y[y.Point=0]="Point",y[y.Range=1]="Range",y}({});class Za{constructor(e,t){this.base=void 0,this._duration=null,this._timelineStart=null,this.appendInPlaceDisabled=void 0,this.appendInPlaceStarted=void 0,this.dateRange=void 0,this.hasPlayed=!1,this.cumulativeDuration=0,this.resumeOffset=NaN,this.playoutLimit=NaN,this.restrictions={skip:!1,jump:!1},this.snapOptions={out:!1,in:!1},this.assetList=[],this.assetListLoader=void 0,this.assetListResponse=null,this.resumeAnchor=void 0,this.error=void 0,this.resetOnResume=void 0,this.base=t,this.dateRange=e,this.setDateRange(e)}setDateRange(e){this.dateRange=e,this.resumeOffset=e.attr.optionalFloat("X-RESUME-OFFSET",this.resumeOffset),this.playoutLimit=e.attr.optionalFloat("X-PLAYOUT-LIMIT",this.playoutLimit),this.restrictions=e.attr.enumeratedStringList("X-RESTRICT",this.restrictions),this.snapOptions=e.attr.enumeratedStringList("X-SNAP",this.snapOptions)}reset(){var e;this.appendInPlaceStarted=!1,(e=this.assetListLoader)==null||e.destroy(),this.assetListLoader=void 0,this.supplementsPrimary||(this.assetListResponse=null,this.assetList=[],this._duration=null)}isAssetPastPlayoutLimit(e){var t;if(e>0&&e>=this.assetList.length)return!0;let r=this.playoutLimit;return!(e<=0||isNaN(r))&&(r===0||(((t=this.assetList[e])==null?void 0:t.startOffset)||0)>r)}findAssetIndex(e){return this.assetList.indexOf(e)}get identifier(){return this.dateRange.id}get startDate(){return this.dateRange.startDate}get startTime(){let e=this.dateRange.startTime;if(this.snapOptions.out){let t=this.dateRange.tagAnchor;if(t)return Ka(e,t)}return e}get startOffset(){return this.cue.pre?0:this.startTime}get startIsAligned(){if(this.startTime===0||this.snapOptions.out)return!0;let e=this.dateRange.tagAnchor;if(e){let t=this.dateRange.startTime,r=Ka(t,e);return t-r<.1}return!1}get resumptionOffset(){let e=this.resumeOffset,t=x(e)?e:this.duration;return this.cumulativeDuration+t}get resumeTime(){let e=this.startOffset+this.resumptionOffset;if(this.snapOptions.in){let t=this.resumeAnchor;if(t)return Ka(e,t)}return e}get appendInPlace(){return!!this.appendInPlaceStarted||!this.appendInPlaceDisabled&&!!(!this.cue.once&&!this.cue.pre&&this.startIsAligned&&(isNaN(this.playoutLimit)&&isNaN(this.resumeOffset)||this.resumeOffset&&this.duration&&.025>Math.abs(this.resumeOffset-this.duration)))}set appendInPlace(e){if(this.appendInPlaceStarted){this.resetOnResume=!e;return}this.appendInPlaceDisabled=!e}get timelineStart(){return this._timelineStart!==null?this._timelineStart:this.startTime}set timelineStart(e){this._timelineStart=e}get duration(){let e,t=this.playoutLimit;return e=this._duration!==null?this._duration:this.dateRange.duration?this.dateRange.duration:this.dateRange.plannedDuration||0,!isNaN(t)&&t<e&&(e=t),e}set duration(e){this._duration=e}get cue(){return this.dateRange.cue}get timelineOccupancy(){return this.dateRange.attr["X-TIMELINE-OCCUPIES"]==="RANGE"?ua.Range:ua.Point}get supplementsPrimary(){return this.dateRange.attr["X-TIMELINE-STYLE"]==="PRIMARY"}get contentMayVary(){return this.dateRange.attr["X-CONTENT-MAY-VARY"]!=="NO"}get assetUrl(){return this.dateRange.attr["X-ASSET-URI"]}get assetListUrl(){return this.dateRange.attr["X-ASSET-LIST"]}get baseUrl(){return this.base.url}get assetListLoaded(){return this.assetList.length>0||this.assetListResponse!==null}toString(){return`["${this.identifier}" ${this.cue.pre?"<pre>":this.cue.post?"<post>":""}${this.timelineStart.toFixed(2)}-${this.resumeTime.toFixed(2)}]`}}function Ka(y,e){return y-e.start<e.duration/2&&!(.025>Math.abs(y-(e.start+e.duration)))?e.start:e.start+e.duration}function _n(y,e,t){let r=new ut.URL(y,t);return r.protocol!=="data:"&&r.searchParams.set("_HLS_primary_id",e),r}function Qa(y,e){for(;(t=y.assetList[++e])!=null&&t.error;)var t;return e}function Oa(y){let e=y.timelineStart,t=y.duration||0;return`["${y.identifier}" ${e.toFixed(2)}-${(e+t).toFixed(2)}]`}class ui{constructor(e,t,r,i){this.hls=void 0,this.interstitial=void 0,this.assetItem=void 0,this.tracks=null,this.hasDetails=!1,this.mediaAttached=null,this._currentTime=void 0,this._bufferedEosTime=void 0,this.checkPlayout=()=>{this.reachedPlayout(this.currentTime)&&this.hls&&this.hls.trigger(o.PLAYOUT_LIMIT_REACHED,{})};let a=this.hls=new e(t);this.interstitial=r,this.assetItem=i;let n=()=>{this.hasDetails=!0};a.once(o.LEVEL_LOADED,n),a.once(o.AUDIO_TRACK_LOADED,n),a.once(o.SUBTITLE_TRACK_LOADED,n),a.on(o.MEDIA_ATTACHING,(l,{media:h})=>{this.removeMediaListeners(),this.mediaAttached=h,this.interstitial.playoutLimit&&(h.addEventListener("timeupdate",this.checkPlayout),this.appendInPlace&&a.on(o.BUFFER_APPENDED,()=>{let p=this.bufferedEnd;this.reachedPlayout(p)&&(this._bufferedEosTime=p,a.trigger(o.BUFFERED_TO_END,void 0))}))})}get appendInPlace(){return this.interstitial.appendInPlace}loadSource(){let e=this.hls;if(e)if(e.url)e.levels.length&&!e.started&&e.startLoad(-1,!0);else{let t=this.assetItem.uri;try{t=_n(t,e.config.primarySessionId||"").href}catch{}e.loadSource(t)}}bufferedInPlaceToEnd(e){var t;if(!this.appendInPlace)return!1;if((t=this.hls)!=null&&t.bufferedToEnd)return!0;if(!e)return!1;let r=Math.min(this._bufferedEosTime||1/0,this.duration),i=this.timelineOffset,a=le.bufferInfo(e,i,0);return this.getAssetTime(a.end)>=r-.02}reachedPlayout(e){let t=this.interstitial.playoutLimit;return this.startOffset+e>=t}get destroyed(){var e;return!((e=this.hls)!=null&&e.userConfig)}get assetId(){return this.assetItem.identifier}get interstitialId(){return this.assetItem.parentIdentifier}get media(){var e;return((e=this.hls)==null?void 0:e.media)||null}get bufferedEnd(){let e=this.media||this.mediaAttached;if(!e)return this._bufferedEosTime?this._bufferedEosTime:this.currentTime;let t=le.bufferInfo(e,e.currentTime,.001);return this.getAssetTime(t.end)}get currentTime(){let e=this.media||this.mediaAttached;return e?this.getAssetTime(e.currentTime):this._currentTime||0}get duration(){let e=this.assetItem.duration;if(!e)return 0;let t=this.interstitial.playoutLimit;if(t){let r=t-this.startOffset;if(r>0&&r<e)return r}return e}get remaining(){let e=this.duration;return e?Math.max(0,e-this.currentTime):0}get startOffset(){return this.assetItem.startOffset}get timelineOffset(){var e;return((e=this.hls)==null?void 0:e.config.timelineOffset)||0}set timelineOffset(e){let t=this.timelineOffset;if(e!==t&&Math.abs(e-t)>11111111111111112e-21&&this.hls){if(this.hasDetails)throw Error("Cannot set timelineOffset after playlists are loaded");this.hls.config.timelineOffset=e}}getAssetTime(e){return Math.min(Math.max(0,e-this.timelineOffset),this.duration)}removeMediaListeners(){let e=this.mediaAttached;e&&(this._currentTime=e.currentTime,this.bufferSnapShot(),e.removeEventListener("timeupdate",this.checkPlayout))}bufferSnapShot(){if(this.mediaAttached){var e;(e=this.hls)!=null&&e.bufferedToEnd&&(this._bufferedEosTime=this.bufferedEnd)}}destroy(){this.removeMediaListeners(),this.hls&&this.hls.destroy(),this.hls=null,this.tracks=this.mediaAttached=this.checkPlayout=null}attachMedia(e){var t;this.loadSource(),(t=this.hls)==null||t.attachMedia(e)}detachMedia(){var e;this.removeMediaListeners(),this.mediaAttached=null,(e=this.hls)==null||e.detachMedia()}resumeBuffering(){var e;(e=this.hls)==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.hls)==null||e.pauseBuffering()}transferMedia(){var e;return this.bufferSnapShot(),((e=this.hls)==null?void 0:e.transferMedia())||null}resetDetails(){let e=this.hls;if(e&&this.hasDetails){e.stopLoad();let t=r=>delete r.details;e.levels.forEach(t),e.allAudioTracks.forEach(t),e.allSubtitleTracks.forEach(t),this.hasDetails=!1}}on(e,t,r){var i;(i=this.hls)==null||i.on(e,t)}once(e,t,r){var i;(i=this.hls)==null||i.once(e,t)}off(e,t,r){var i;(i=this.hls)==null||i.off(e,t)}toString(){var e;return`HlsAssetPlayer: ${Oa(this.assetItem)} ${(e=this.hls)==null?void 0:e.sessionId} ${this.appendInPlace?"append-in-place":""}`}}class sn extends L{constructor(e,t){super("interstitials-sched",t),this.onScheduleUpdate=void 0,this.eventMap={},this.events=null,this.items=null,this.durations={primary:0,playout:0,integrated:0},this.onScheduleUpdate=e}destroy(){this.reset(),this.onScheduleUpdate=null}reset(){this.eventMap={},this.setDurations(0,0,0),this.events&&this.events.forEach(e=>e.reset()),this.events=this.items=null}resetErrorsInRange(e,t){return this.events?this.events.reduce((r,i)=>e<=i.startOffset&&t>i.startOffset?(delete i.error,r+1):r,0):0}get duration(){let e=this.items;return e?e[e.length-1].end:0}get length(){return this.items?this.items.length:0}getEvent(e){return e&&this.eventMap[e]||null}hasEvent(e){return e in this.eventMap}findItemIndex(e,t){if(e.event)return this.findEventIndex(e.event.identifier);let r=-1;e.nextEvent?r=this.findEventIndex(e.nextEvent.identifier)-1:e.previousEvent&&(r=this.findEventIndex(e.previousEvent.identifier)+1);let i=this.items;if(i)for(i[r]||(t===void 0&&(t=e.start),r=this.findItemIndexAtTime(t));r>=0&&(a=i[r])!=null&&a.event;){var a;r--}return r}findItemIndexAtTime(e,t){let r=this.items;if(r)for(let i=0;i<r.length;i++){let a=r[i];if(t&&t!=="primary"&&(a=a[t]),e===a.start||e>a.start&&e<a.end)return i}return-1}findJumpRestrictedIndex(e,t){let r=this.items;if(r)for(let i=e;i<=t&&r[i];i++){let a=r[i].event;if(a!=null&&a.restrictions.jump&&!a.appendInPlace)return i}return-1}findEventIndex(e){let t=this.items;if(t)for(let i=t.length;i--;){var r;if(((r=t[i].event)==null?void 0:r.identifier)===e)return i}return-1}findAssetIndex(e,t){let r=e.assetList,i=r.length;if(i>1)for(let a=0;a<i;a++){let n=r[a];if(!n.error){let l=n.timelineStart;if(t===l||t>l&&(t<l+(n.duration||0)||a===i-1))return a}}return 0}get assetIdAtEnd(){var e;let t=(e=this.items)==null||(e=e[this.length-1])==null?void 0:e.event;if(t){let r=t.assetList,i=r[r.length-1];if(i)return i.identifier}return null}parseInterstitialDateRanges(e,t){let r=e.main.details,{dateRanges:i}=r,a=this.events,n=this.parseDateRanges(i,{url:r.url},t),l=Object.keys(i),h=a?a.filter(p=>!l.includes(p.identifier)):[];n.length&&n.sort((p,v)=>{let w=p.cue.pre,P=p.cue.post,D=v.cue.pre,G=v.cue.post;if(w&&!D)return-1;if(D&&!w||P&&!G)return 1;if(G&&!P)return-1;if(!w&&!D&&!P&&!G){let z=p.startTime,H=v.startTime;if(z!==H)return z-H}return p.dateRange.tagOrder-v.dateRange.tagOrder}),this.events=n,h.forEach(p=>{this.removeEvent(p)}),this.updateSchedule(e,h)}updateSchedule(e,t=[],r=!1){let i=this.events||[];if(i.length||t.length||this.length<2){let a=this.items,n=this.parseSchedule(i,e);(r||t.length||a?.length!==n.length||n.some((l,h)=>Math.abs(l.playout.start-a[h].playout.start)>.005||Math.abs(l.playout.end-a[h].playout.end)>.005))&&(this.items=n,this.onScheduleUpdate(t,a))}}parseDateRanges(e,t,r){let i=[],a=Object.keys(e);for(let n=0;n<a.length;n++){let l=a[n],h=e[l];if(h.isInterstitial){let p=this.eventMap[l];p?p.setDateRange(h):(p=new Za(h,t),this.eventMap[l]=p,r===!1&&(p.appendInPlace=r)),i.push(p)}}return i}parseSchedule(e,t){let r=[],i=t.main.details,a=i.live?1/0:i.edge,n=0;if((e=e.filter(h=>!h.error&&!(h.cue.once&&h.hasPlayed))).length){this.resolveOffsets(e,t);let h=0,p=0;if(e.forEach((v,w)=>{let P=v.cue.pre,D=v.cue.post,G=e[w-1]||null,z=v.appendInPlace,H=D?a:v.startOffset,oe=v.duration,Se=v.timelineOccupancy===ua.Range?oe:0,me=v.resumptionOffset,Te=G?.startTime===H,Be=H+v.cumulativeDuration,je=z?Be+oe:H+me;if(P||!D&&H<=0){let ze=p;p+=Se,v.timelineStart=Be;let Fe=n;n+=oe,r.push({event:v,start:Be,end:je,playout:{start:Fe,end:n},integrated:{start:ze,end:p}})}else{if(!(H<=a))return;if(!Te){let rt=H-h;if(rt>.033){let st=h,kt=p;p+=rt;let Ye=n;n+=rt;let et={previousEvent:e[w-1]||null,nextEvent:v,start:st,end:st+rt,playout:{start:Ye,end:n},integrated:{start:kt,end:p}};r.push(et)}else rt>0&&G&&(G.cumulativeDuration+=rt,r[r.length-1].end=H)}D&&(je=Be),v.timelineStart=Be;let ze=p;p+=Se;let Fe=n;n+=oe,r.push({event:v,start:Be,end:je,playout:{start:Fe,end:n},integrated:{start:ze,end:p}})}let ge=v.resumeTime;h=D||ge>a?a:ge}),h<a){var l;let v=h,w=p,P=a-h;p+=P;let D=n;n+=P,r.push({previousEvent:((l=r[r.length-1])==null?void 0:l.event)||null,nextEvent:null,start:h,end:v+P,playout:{start:D,end:n},integrated:{start:w,end:p}})}this.setDurations(a,n,p)}else r.push({previousEvent:null,nextEvent:null,start:0,end:a,playout:{start:0,end:a},integrated:{start:0,end:a}}),this.setDurations(a,a,a);return r}setDurations(e,t,r){this.durations={primary:e,playout:t,integrated:r}}resolveOffsets(e,t){let r=t.main.details,i=r.live?1/0:r.edge,a=0,n=-1;e.forEach((l,h)=>{let p=l.cue.pre,v=l.cue.post,w=p?0:v?i:l.startTime;this.updateAssetDurations(l),n===w?l.cumulativeDuration=a:(a=0,n=w),!v&&l.snapOptions.in&&(l.resumeAnchor=gi(null,r.fragments,l.startOffset+l.resumptionOffset,0,0)||void 0),!l.appendInPlace||l.appendInPlaceStarted||this.primaryCanResumeInPlaceAt(l,t)||(l.appendInPlace=!1),!l.appendInPlace&&h+1<e.length&&e[h+1].startTime-e[h].resumeTime<.033&&(e[h+1].appendInPlace=!1,e[h+1].appendInPlace&&this.warn(`Could not change append strategy for abutting event ${l}`));let P=x(l.resumeOffset)?l.resumeOffset:l.duration;a+=P})}primaryCanResumeInPlaceAt(e,t){let r=e.resumeTime,i=e.startTime+e.resumptionOffset;return Math.abs(r-i)>.025?(this.log(`"${e.identifier}" resumption ${r} not aligned with estimated timeline end ${i}`),!1):!Object.keys(t).some(a=>{let n=t[a].details,l=n.edge;if(r>=l)return this.log(`"${e.identifier}" resumption ${r} past ${a} playlist end ${l}`),!1;let h=gi(null,n.fragments,r);if(!h)return this.log(`"${e.identifier}" resumption ${r} does not align with any fragments in ${a} playlist (${n.fragStart}-${n.fragmentEnd})`),!0;let p=a==="audio"?.175:0;return!(Math.abs(h.start-r)<.025+p||Math.abs(h.end-r)<.025+p)&&(this.log(`"${e.identifier}" resumption ${r} not aligned with ${a} fragment bounds (${h.start}-${h.end} sn: ${h.sn} cc: ${h.cc})`),!0)})}updateAssetDurations(e){if(!e.assetListLoaded)return;let t=e.timelineStart,r=0,i=!1,a=!1;for(let n=0;n<e.assetList.length;n++){let l=e.assetList[n],h=t+r;l.startOffset=r,l.timelineStart=h,i||(i=l.duration===null),a||(a=!!l.error),r+=l.error?0:l.duration||0}i&&!a?e.duration=Math.max(r,e.duration):e.duration=r}removeEvent(e){e.reset(),delete this.eventMap[e.identifier]}}function xa(y){return`[${y.event?'"'+y.event.identifier+'"':"primary"}: ${y.start.toFixed(2)}-${y.end.toFixed(2)}]`}class Ia{constructor(e){this.hls=void 0,this.hls=e}destroy(){this.hls=null}loadAssetList(e,t){let r,i=e.assetListUrl;try{r=_n(i,this.hls.sessionId,e.baseUrl)}catch(v){let w=this.assignAssetListError(e,d.ASSET_LIST_LOAD_ERROR,v,i);this.hls.trigger(o.ERROR,w);return}t&&r.protocol!=="data:"&&r.searchParams.set("_HLS_start_offset",""+t);let a=this.hls.config,n=new a.loader(a),l={responseType:"json",url:r.href},h=a.interstitialAssetListLoadPolicy.default,p={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};return n.load(l,p,{onSuccess:(v,w,P,D)=>{let G=v.data;if(!Array.isArray(G?.ASSETS)){let z=this.assignAssetListError(e,d.ASSET_LIST_PARSING_ERROR,Error("Invalid interstitial asset list"),P.url,w,D);this.hls.trigger(o.ERROR,z);return}e.assetListResponse=G,this.hls.trigger(o.ASSET_LIST_LOADED,{event:e,assetListResponse:G,networkDetails:D})},onError:(v,w,P,D)=>{let G=this.assignAssetListError(e,d.ASSET_LIST_LOAD_ERROR,Error(`Error loading X-ASSET-LIST: HTTP status ${v.code} ${v.text} (${w.url})`),w.url,D,P);this.hls.trigger(o.ERROR,G)},onTimeout:(v,w,P)=>{let D=this.assignAssetListError(e,d.ASSET_LIST_LOAD_TIMEOUT,Error(`Timeout loading X-ASSET-LIST (${w.url})`),w.url,v,P);this.hls.trigger(o.ERROR,D)}}),this.hls.trigger(o.ASSET_LIST_LOADING,{event:e}),n}assignAssetListError(e,t,r,i,a,n){return e.error=r,{type:S.NETWORK_ERROR,details:t,fatal:!1,interstitial:e,url:i,error:r,networkDetails:n,stats:a}}}function ca(y){y?.play().catch(()=>{})}function Nr(y,e){return`[${y}] Advancing timeline position to ${e}`}class Ma extends L{constructor(e,t){super("interstitials",e.logger),this.HlsPlayerClass=void 0,this.hls=void 0,this.assetListLoader=void 0,this.mediaSelection=null,this.altSelection=null,this.media=null,this.detachedData=null,this.requiredTracks=null,this.manager=null,this.playerQueue=[],this.bufferedPos=-1,this.timelinePos=-1,this.schedule=void 0,this.playingItem=null,this.bufferingItem=null,this.waitingItem=null,this.endedItem=null,this.playingAsset=null,this.endedAsset=null,this.bufferingAsset=null,this.shouldPlay=!1,this.onPlay=()=>{this.shouldPlay=!0},this.onPause=()=>{this.shouldPlay=!1},this.onSeeking=()=>{var r,i;let a=this.currentTime;if(a===void 0||this.playbackDisabled||!this.schedule)return;let n=a-this.timelinePos;if(Math.abs(n)<14172335600907028e-25)return;let l=n<=-.01;this.timelinePos=a,this.bufferedPos=a;let h=this.playingItem;if(!h){this.checkBuffer();return}if(l&&this.schedule.resetErrorsInRange(a,a-n)&&this.updateSchedule(!0),this.checkBuffer(),l&&a<h.start||a>=h.end){let P=this.findItemIndex(h),D=this.schedule.findItemIndexAtTime(a);if(D===-1&&(D=P+(l?-1:1),this.log(`seeked ${l?"back ":""}to position not covered by schedule ${a} (resolving from ${P} to ${D})`)),!this.isInterstitial(h)&&(r=this.media)!=null&&r.paused&&(this.shouldPlay=!1),!l&&D>P){let G=this.schedule.findJumpRestrictedIndex(P+1,D);if(G>P){this.setSchedulePosition(G);return}}this.setSchedulePosition(D);return}let p=this.playingAsset;if(!p){if(this.playingLastItem&&this.isInterstitial(h)){let P=h.event.assetList[0];P&&(this.endedItem=this.playingItem,this.playingItem=null,this.setScheduleToAssetAtTime(a,P))}return}let v=p.timelineStart,w=p.duration||0;(l&&a<v||a>=v+w)&&((i=h.event)!=null&&i.appendInPlace&&(this.clearInterstitial(h.event,h),this.flushFrontBuffer(a)),this.setScheduleToAssetAtTime(a,p))},this.onTimeupdate=()=>{let r=this.currentTime;if(r===void 0||this.playbackDisabled||!(r>this.timelinePos))return;this.timelinePos=r,r>this.bufferedPos&&this.checkBuffer();let i=this.playingItem;if(!i||this.playingLastItem)return;if(r>=i.end){this.timelinePos=i.end;let n=this.findItemIndex(i);this.setSchedulePosition(n+1)}let a=this.playingAsset;a&&r>=a.timelineStart+(a.duration||0)&&this.setScheduleToAssetAtTime(r,a)},this.onScheduleUpdate=(r,i)=>{let a=this.schedule;if(!a)return;let n=this.playingItem,l=a.events||[],h=a.items||[],p=a.durations,v=r.map(z=>z.identifier),w=!!(l.length||v.length);(w||i)&&this.log(`INTERSTITIALS_UPDATED (${l.length}): ${l}
Schedule: ${h.map(z=>xa(z))} pos: ${this.timelinePos}`),v.length&&this.log(`Removed events ${v}`);let P=null,D=null;n&&(P=this.updateItem(n,this.timelinePos),this.itemsMatch(n,P)?this.playingItem=P:this.waitingItem=this.endedItem=null),this.waitingItem=this.updateItem(this.waitingItem),this.endedItem=this.updateItem(this.endedItem);let G=this.bufferingItem;if(G&&(D=this.updateItem(G,this.bufferedPos),this.itemsMatch(G,D)?this.bufferingItem=D:G.event&&(this.bufferingItem=this.playingItem,this.clearInterstitial(G.event,null))),r.forEach(z=>{z.assetList.forEach(H=>{this.clearAssetPlayer(H.identifier,null)})}),this.playerQueue.forEach(z=>{if(z.interstitial.appendInPlace){let H=z.assetItem.timelineStart,oe=z.timelineOffset-H;if(oe)try{z.timelineOffset=H}catch(Se){Math.abs(oe)>.025&&this.warn(`${Se} ("${z.assetId}" ${z.timelineOffset}->${H})`)}}}),w||i){if(this.hls.trigger(o.INTERSTITIALS_UPDATED,{events:l.slice(0),schedule:h.slice(0),durations:p,removedIds:v}),this.isInterstitial(n)&&v.includes(n.event.identifier)){this.warn(`Interstitial "${n.event.identifier}" removed while playing`),this.primaryFallback(n.event);return}n&&this.trimInPlace(P,n),G&&D!==P&&this.trimInPlace(D,G),this.checkBuffer()}},this.hls=e,this.HlsPlayerClass=t,this.assetListLoader=new Ia(e),this.schedule=new sn(this.onScheduleUpdate,e.logger),this.registerListeners()}registerListeners(){let e=this.hls;e&&(e.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.on(o.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(o.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.on(o.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.on(o.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.on(o.BUFFER_APPENDED,this.onBufferAppended,this),e.on(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.BUFFERED_TO_END,this.onBufferedToEnd,this),e.on(o.MEDIA_ENDED,this.onMediaEnded,this),e.on(o.ERROR,this.onError,this),e.on(o.DESTROYING,this.onDestroying,this))}unregisterListeners(){let e=this.hls;e&&(e.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.AUDIO_TRACK_UPDATED,this.onAudioTrackUpdated,this),e.off(o.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(o.SUBTITLE_TRACK_UPDATED,this.onSubtitleTrackUpdated,this),e.off(o.EVENT_CUE_ENTER,this.onInterstitialCueEnter,this),e.off(o.ASSET_LIST_LOADED,this.onAssetListLoaded,this),e.off(o.BUFFER_CODECS,this.onBufferCodecs,this),e.off(o.BUFFER_APPENDED,this.onBufferAppended,this),e.off(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.BUFFERED_TO_END,this.onBufferedToEnd,this),e.off(o.MEDIA_ENDED,this.onMediaEnded,this),e.off(o.ERROR,this.onError,this),e.off(o.DESTROYING,this.onDestroying,this))}startLoad(){this.resumeBuffering()}stopLoad(){this.pauseBuffering()}resumeBuffering(){var e;(e=this.getBufferingPlayer())==null||e.resumeBuffering()}pauseBuffering(){var e;(e=this.getBufferingPlayer())==null||e.pauseBuffering()}destroy(){this.unregisterListeners(),this.stopLoad(),this.assetListLoader&&this.assetListLoader.destroy(),this.emptyPlayerQueue(),this.clearScheduleState(),this.schedule&&this.schedule.destroy(),this.media=this.detachedData=this.mediaSelection=this.requiredTracks=this.altSelection=this.schedule=this.manager=null,this.hls=this.HlsPlayerClass=this.log=null,this.assetListLoader=null,this.onPlay=this.onPause=this.onSeeking=this.onTimeupdate=null,this.onScheduleUpdate=null}onDestroying(){let e=this.primaryMedia||this.media;e&&this.removeMediaListeners(e)}removeMediaListeners(e){Ot(e,"play",this.onPlay),Ot(e,"pause",this.onPause),Ot(e,"seeking",this.onSeeking),Ot(e,"timeupdate",this.onTimeupdate)}onMediaAttaching(e,t){let r=this.media=t.media;ot(r,"seeking",this.onSeeking),ot(r,"timeupdate",this.onTimeupdate),ot(r,"play",this.onPlay),ot(r,"pause",this.onPause)}onMediaAttached(e,t){let r=this.effectivePlayingItem,i=this.detachedData;if(this.detachedData=null,r===null)this.checkStart();else if(!i){this.clearScheduleState();let a=this.findItemIndex(r);this.setSchedulePosition(a)}}clearScheduleState(){this.log("clear schedule state"),this.playingItem=this.bufferingItem=this.waitingItem=this.endedItem=this.playingAsset=this.endedAsset=this.bufferingAsset=null}onMediaDetaching(e,t){let r=!!t.transferMedia,i=this.media;if(this.media=null,!r&&(i&&this.removeMediaListeners(i),this.detachedData)){let a=this.getBufferingPlayer();a&&(this.log(`Removing schedule state for detachedData and ${a}`),this.playingAsset=this.endedAsset=this.bufferingAsset=this.bufferingItem=this.waitingItem=this.detachedData=null,a.detachMedia()),this.shouldPlay=!1}}get interstitialsManager(){if(!this.hls)return null;if(this.manager)return this.manager;let e=this,t=()=>e.bufferingItem||e.waitingItem,r=w=>w&&e.getAssetPlayer(w.identifier),i=(w,P,D,G,z)=>{if(w){let H=w[P].start,oe=w.event;if(oe){if(P==="playout"||oe.timelineOccupancy!==ua.Point){let Se=r(D);Se?.interstitial===oe&&(H+=Se.assetItem.startOffset+Se[z])}}else H+=(G==="bufferedPos"?n():e[G])-w.start;return H}return 0},a=(w,P)=>{var D,G;if(w!==0&&P!=="primary"&&(D=e.schedule)!=null&&D.length){let z=e.schedule.findItemIndexAtTime(w),H=(G=e.schedule.items)==null?void 0:G[z];if(H)return w+(H[P].start-H.start)}return w},n=()=>{let w=e.bufferedPos;return w===Number.MAX_VALUE?l("primary"):Math.max(w,0)},l=w=>{var P,D;return(P=e.primaryDetails)!=null&&P.live?e.primaryDetails.edge:((D=e.schedule)==null?void 0:D.durations[w])||0},h=(w,P)=>{var D,G;let z=e.effectivePlayingItem;if(z!=null&&(D=z.event)!=null&&D.restrictions.skip||!e.schedule)return;e.log(`seek to ${w} "${P}"`);let H=e.effectivePlayingItem,oe=e.schedule.findItemIndexAtTime(w,P),Se=(G=e.schedule.items)==null?void 0:G[oe],me=e.getBufferingPlayer(),Te=me?.interstitial,Be=Te?.appendInPlace,je=H&&e.itemsMatch(H,Se);if(H&&(Be||je)){let ge=r(e.playingAsset),ze=ge?.media||e.primaryMedia;if(ze){let Fe=P==="primary"?ze.currentTime:i(H,P,e.playingAsset,"timelinePos","currentTime"),rt=w-Fe,st=(Be?Fe:ze.currentTime)+rt;if(st>=0&&(!ge||Be||st<=ge.duration)){ze.currentTime=st;return}}}if(Se){let ge=w;if(P!=="primary"){let Fe=w-Se[P].start;ge=Se.start+Fe}let ze=!e.isInterstitial(Se);if((!e.isInterstitial(H)||H.event.appendInPlace)&&(ze||Se.event.appendInPlace)){let Fe=e.media||(Be?me?.media:null);Fe&&(Fe.currentTime=ge)}else if(H){let Fe=e.findItemIndex(H);if(oe>Fe){let st=e.schedule.findJumpRestrictedIndex(Fe+1,oe);if(st>Fe){e.setSchedulePosition(st);return}}let rt=0;if(ze)e.timelinePos=ge,e.checkBuffer();else{let st=Se.event.assetList,kt=w-(Se[P]||Se).start;for(let Ye=st.length;Ye--;){let et=st[Ye];if(et.duration&&kt>=et.startOffset&&kt<et.startOffset+et.duration){rt=Ye;break}}}e.setSchedulePosition(oe,rt)}}},p=()=>{let w=e.effectivePlayingItem;if(e.isInterstitial(w))return w;let P=t();return e.isInterstitial(P)?P:null},v={get bufferedEnd(){let w=t(),P=e.bufferingItem;if(P&&P===w){var D;return i(P,"playout",e.bufferingAsset,"bufferedPos","bufferedEnd")-P.playout.start||((D=e.bufferingAsset)==null?void 0:D.startOffset)||0}return 0},get currentTime(){let w=p(),P=e.effectivePlayingItem;return P&&P===w?i(P,"playout",e.effectivePlayingAsset,"timelinePos","currentTime")-P.playout.start:0},set currentTime(w){let P=p(),D=e.effectivePlayingItem;D&&D===P&&h(w+D.playout.start,"playout")},get duration(){let w=p();return w?w.playout.end-w.playout.start:0},get assetPlayers(){var w;let P=(w=p())==null?void 0:w.event.assetList;return P?P.map(D=>e.getAssetPlayer(D.identifier)):[]},get playingIndex(){var w;let P=(w=p())==null?void 0:w.event;return P&&e.effectivePlayingAsset?P.findAssetIndex(e.effectivePlayingAsset):-1},get scheduleItem(){return p()}};return this.manager={get events(){var w;return((w=e.schedule)==null||(w=w.events)==null?void 0:w.slice(0))||[]},get schedule(){var w;return((w=e.schedule)==null||(w=w.items)==null?void 0:w.slice(0))||[]},get interstitialPlayer(){return p()?v:null},get playerQueue(){return e.playerQueue.slice(0)},get bufferingAsset(){return e.bufferingAsset},get bufferingItem(){return t()},get bufferingIndex(){let w=t();return e.findItemIndex(w)},get playingAsset(){return e.effectivePlayingAsset},get playingItem(){return e.effectivePlayingItem},get playingIndex(){let w=e.effectivePlayingItem;return e.findItemIndex(w)},primary:{get bufferedEnd(){return n()},get currentTime(){let w=e.timelinePos;return w>0?w:0},set currentTime(w){h(w,"primary")},get duration(){return l("primary")},get seekableStart(){var w;return((w=e.primaryDetails)==null?void 0:w.fragmentStart)||0}},integrated:{get bufferedEnd(){return i(t(),"integrated",e.bufferingAsset,"bufferedPos","bufferedEnd")},get currentTime(){return i(e.effectivePlayingItem,"integrated",e.effectivePlayingAsset,"timelinePos","currentTime")},set currentTime(w){h(w,"integrated")},get duration(){return l("integrated")},get seekableStart(){var w;return a(((w=e.primaryDetails)==null?void 0:w.fragmentStart)||0,"integrated")}},skip:()=>{let w=e.effectivePlayingItem,P=w?.event;if(P&&!P.restrictions.skip){let D=e.findItemIndex(w);P.appendInPlace?h(w.playout.start+w.event.duration+.001,"playout"):e.advanceAfterAssetEnded(P,D,1/0)}}}}get effectivePlayingItem(){return this.waitingItem||this.playingItem||this.endedItem}get effectivePlayingAsset(){return this.playingAsset||this.endedAsset}get playingLastItem(){var e;let t=this.playingItem,r=(e=this.schedule)==null?void 0:e.items;return!!this.playbackStarted&&!!t&&!!r&&this.findItemIndex(t)===r.length-1}get playbackStarted(){return this.effectivePlayingItem!==null}get currentTime(){var e,t;if(this.mediaSelection===null)return;let r=this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&!r.event.appendInPlace)return;let i=this.media;!i&&(e=this.bufferingItem)!=null&&(e=e.event)!=null&&e.appendInPlace&&(i=this.primaryMedia);let a=(t=i)==null?void 0:t.currentTime;if(a!==void 0&&x(a))return a}get primaryMedia(){var e;return this.media||((e=this.detachedData)==null?void 0:e.media)||null}isInterstitial(e){return!!(e!=null&&e.event)}retreiveMediaSource(e,t){let r=this.getAssetPlayer(e);r&&this.transferMediaFromPlayer(r,t)}transferMediaFromPlayer(e,t){let r=e.interstitial.appendInPlace,i=e.media;if(r&&i===this.primaryMedia){if(this.bufferingAsset=null,(!t||this.isInterstitial(t)&&!t.event.appendInPlace)&&t&&i){this.detachedData={media:i};return}let a=e.transferMedia();this.log(`transfer MediaSource from ${e} ${Xt(a)}`),this.detachedData=a}else t&&i&&(this.shouldPlay||(this.shouldPlay=!i.paused))}transferMediaTo(e,t){var r,i;let a;if(e.media===t)return;let n=null,l=this.hls,h=e!==l,p=h&&e.interstitial.appendInPlace,v=(r=this.detachedData)==null?void 0:r.mediaSource;if(l.media)p&&(n=l.transferMedia(),this.detachedData=n),a="Primary";else if(v){let G=this.getBufferingPlayer();G?(n=G.transferMedia(),a=`${G}`):a="detached MediaSource"}else a="detached media";if(!n){if(v)n=this.detachedData,this.log(`using detachedData: MediaSource ${Xt(n)}`);else if(!this.detachedData||l.media===t){let G=this.playerQueue;G.length>1&&G.forEach(z=>{if(h&&z.interstitial.appendInPlace!==p){let H=z.interstitial;this.clearInterstitial(z.interstitial,null),H.appendInPlace=!1,H.appendInPlace&&this.warn(`Could not change append strategy for queued assets ${H}`)}}),this.hls.detachMedia(),this.detachedData={media:t}}}let w=n&&"mediaSource"in n&&((i=n.mediaSource)==null?void 0:i.readyState)!=="closed",P=w&&n?n:t;this.log(`${w?"transfering MediaSource":"attaching media"} to ${h?e:"Primary"} from ${a} (media.currentTime: ${t.currentTime})`);let D=this.schedule;if(P===n&&D){let G=h&&e.assetId===D.assetIdAtEnd;P.overrides={duration:D.duration,endOfStream:!h||G,cueRemoval:!h}}e.attachMedia(P)}onInterstitialCueEnter(){this.onTimeupdate()}checkStart(){let e=this.schedule,t=e?.events;if(!t||this.playbackDisabled||!this.media)return;this.bufferedPos===-1&&(this.bufferedPos=0);let r=this.timelinePos,i=this.effectivePlayingItem;if(r===-1){let a=this.hls.startPosition;if(this.log(Nr("checkStart",a)),this.timelinePos=a,t.length&&t[0].cue.pre){let n=e.findEventIndex(t[0].identifier);this.setSchedulePosition(n)}else if(a>=0||!this.primaryLive){let n=this.timelinePos=a>0?a:0,l=e.findItemIndexAtTime(n);this.setSchedulePosition(l)}}else if(i&&!this.playingItem){let a=e.findItemIndex(i);this.setSchedulePosition(a)}}advanceAssetBuffering(e,t){let r=e.event,i=r.findAssetIndex(t),a=Qa(r,i);if(r.isAssetPastPlayoutLimit(a)){if(this.schedule){var n;let l=(n=this.schedule.items)==null?void 0:n[this.findItemIndex(e)+1];l&&this.bufferedToItem(l)}}else this.bufferedToEvent(e,a)}advanceAfterAssetEnded(e,t,r){let i=Qa(e,r);if(e.isAssetPastPlayoutLimit(i)){if(this.schedule){let a=this.schedule.items;if(a){let n=t+1;if(n>=a.length){this.setSchedulePosition(-1);return}let l=e.resumeTime;this.timelinePos<l&&(this.log(Nr("advanceAfterAssetEnded",l)),this.timelinePos=l,e.appendInPlace&&this.advanceInPlace(l),this.checkBuffer(this.bufferedPos<l)),this.setSchedulePosition(n)}}}else{if(e.appendInPlace){let a=e.assetList[i];a&&this.advanceInPlace(a.timelineStart)}this.setSchedulePosition(t,i)}}setScheduleToAssetAtTime(e,t){let r=this.schedule;if(!r)return;let i=t.parentIdentifier,a=r.getEvent(i);if(a){let n=r.findEventIndex(i),l=r.findAssetIndex(a,e);this.advanceAfterAssetEnded(a,n,l-1)}}setSchedulePosition(e,t){var r,i,a;let n=(r=this.schedule)==null?void 0:r.items;if(!n||this.playbackDisabled)return;let l=e>=0?n[e]:null;this.log(`setSchedulePosition ${e}, ${t} (${l&&xa(l)}) pos: ${this.timelinePos}`);let h=this.waitingItem||this.playingItem,p=this.playingLastItem;if(this.isInterstitial(h)){let v=h.event,w=this.playingAsset,P=w?.identifier,D=P?this.getAssetPlayer(P):null;if(D&&P&&(!this.eventItemsMatch(h,l)||t!==void 0&&P!==v.assetList[t].identifier)){let G=v.findAssetIndex(w);if(this.log(`INTERSTITIAL_ASSET_ENDED ${G+1}/${v.assetList.length} ${Oa(w)}`),this.endedAsset=w,this.playingAsset=null,this.hls.trigger(o.INTERSTITIAL_ASSET_ENDED,{asset:w,assetListIndex:G,event:v,schedule:n.slice(0),scheduleIndex:e,player:D}),h!==this.playingItem){this.itemsMatch(h,this.playingItem)&&!this.playingAsset&&this.advanceAfterAssetEnded(v,this.findItemIndex(this.playingItem),G);return}this.retreiveMediaSource(P,l),D.media&&!((i=this.detachedData)!=null&&i.mediaSource)&&D.detachMedia()}if(!this.eventItemsMatch(h,l)&&(this.endedItem=h,this.playingItem=null,this.log(`INTERSTITIAL_ENDED ${v} ${xa(h)}`),v.hasPlayed=!0,this.hls.trigger(o.INTERSTITIAL_ENDED,{event:v,schedule:n.slice(0),scheduleIndex:e}),v.cue.once)){this.updateSchedule();let G=(a=this.schedule)==null?void 0:a.items;if(l&&G){let z=this.findItemIndex(l);this.advanceSchedule(z,G,t,h,p)}return}}this.advanceSchedule(e,n,t,h,p)}advanceSchedule(e,t,r,i,a){let n=this.schedule;if(!n)return;let l=t[e]||null,h=this.primaryMedia,p=this.playerQueue;if(p.length&&p.forEach(v=>{let w=v.interstitial,P=n.findEventIndex(w.identifier);(P<e||P>e+1)&&this.clearInterstitial(w,l)}),this.isInterstitial(l)){this.timelinePos=Math.min(Math.max(this.timelinePos,l.start),l.end);let v=l.event;if(r===void 0){r=n.findAssetIndex(v,this.timelinePos);let G=Qa(v,r-1);if(v.isAssetPastPlayoutLimit(G)||v.appendInPlace&&this.timelinePos===l.end){this.advanceAfterAssetEnded(v,e,r);return}r=G}let w=this.waitingItem;this.assetsBuffered(l,h)||this.setBufferingItem(l);let P=this.preloadAssets(v,r);if(this.eventItemsMatch(l,w||i)||(this.waitingItem=l,this.log(`INTERSTITIAL_STARTED ${xa(l)} ${v.appendInPlace?"append in place":""}`),this.hls.trigger(o.INTERSTITIAL_STARTED,{event:v,schedule:t.slice(0),scheduleIndex:e})),!v.assetListLoaded){this.log(`Waiting for ASSET-LIST to complete loading ${v}`);return}if(v.assetListLoader&&(v.assetListLoader.destroy(),v.assetListLoader=void 0),!h){this.log(`Waiting for attachMedia to start Interstitial ${v}`);return}this.waitingItem=this.endedItem=null,this.playingItem=l;let D=v.assetList[r];if(!D){this.advanceAfterAssetEnded(v,e,r||0);return}if(P||(P=this.getAssetPlayer(D.identifier)),P===null||P.destroyed){let G=v.assetList.length;this.warn(`asset ${r+1}/${G} player destroyed ${v}`),(P=this.createAssetPlayer(v,D,r)).loadSource()}if(!this.eventItemsMatch(l,this.bufferingItem)&&v.appendInPlace&&this.isAssetBuffered(D))return;this.startAssetPlayer(P,r,t,e,h),this.shouldPlay&&ca(P.media)}else l?(this.resumePrimary(l,e,i),this.shouldPlay&&ca(this.hls.media)):a&&this.isInterstitial(i)&&(this.endedItem=null,this.playingItem=i,i.event.appendInPlace||this.attachPrimary(n.durations.primary,null))}get playbackDisabled(){return this.hls.config.enableInterstitialPlayback===!1}get primaryDetails(){var e;return(e=this.mediaSelection)==null?void 0:e.main.details}get primaryLive(){var e;return!!((e=this.primaryDetails)!=null&&e.live)}resumePrimary(e,t,r){var i,a;if(this.playingItem=e,this.playingAsset=this.endedAsset=null,this.waitingItem=this.endedItem=null,this.bufferedToItem(e),this.log(`resuming ${xa(e)}`),!((i=this.detachedData)!=null&&i.mediaSource)){let l=this.timelinePos;(l<e.start||l>=e.end)&&(l=this.getPrimaryResumption(e,t),this.log(Nr("resumePrimary",l)),this.timelinePos=l),this.attachPrimary(l,e)}if(!r)return;let n=(a=this.schedule)==null?void 0:a.items;n&&(this.log(`INTERSTITIALS_PRIMARY_RESUMED ${xa(e)}`),this.hls.trigger(o.INTERSTITIALS_PRIMARY_RESUMED,{schedule:n.slice(0),scheduleIndex:t}),this.checkBuffer())}getPrimaryResumption(e,t){let r=e.start;if(this.primaryLive){let i=this.primaryDetails;if(t===0)return this.hls.startPosition;if(i&&(r<i.fragmentStart||r>i.edge))return this.hls.liveSyncPosition||-1}return r}isAssetBuffered(e){let t=this.getAssetPlayer(e.identifier);return t!=null&&t.hls?t.hls.bufferedToEnd:le.bufferInfo(this.primaryMedia,this.timelinePos,0).end+1>=e.timelineStart+(e.duration||0)}attachPrimary(e,t,r){t?this.setBufferingItem(t):this.bufferingItem=this.playingItem,this.bufferingAsset=null;let i=this.primaryMedia;if(!i)return;let a=this.hls;a.media?this.checkBuffer():(this.transferMediaTo(a,i),r&&this.startLoadingPrimaryAt(e,r)),r||(this.log(Nr("attachPrimary",e)),this.timelinePos=e,this.startLoadingPrimaryAt(e,r))}startLoadingPrimaryAt(e,t){var r;let i=this.hls;!i.loadingEnabled||!i.media||Math.abs((((r=i.mainForwardBufferInfo)==null?void 0:r.start)||i.media.currentTime)-e)>.5?i.startLoad(e,t):i.bufferingEnabled||i.resumeBuffering()}onManifestLoading(){var e;this.stopLoad(),(e=this.schedule)==null||e.reset(),this.emptyPlayerQueue(),this.clearScheduleState(),this.shouldPlay=!1,this.bufferedPos=this.timelinePos=-1,this.mediaSelection=this.altSelection=this.manager=this.requiredTracks=null,this.hls.off(o.BUFFER_CODECS,this.onBufferCodecs,this),this.hls.on(o.BUFFER_CODECS,this.onBufferCodecs,this)}onLevelUpdated(e,t){if(t.level===-1||!this.schedule)return;let r=this.hls.levels[t.level],i=F(F({},this.mediaSelection||this.altSelection),{},{main:r});this.mediaSelection=i,this.schedule.parseInterstitialDateRanges(i,this.hls.config.interstitialAppendInPlace),!this.effectivePlayingItem&&this.schedule.items&&this.checkStart()}onAudioTrackUpdated(e,t){let r=this.hls.audioTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=F(F({},this.altSelection),{},{audio:r});return}let a=F(F({},i),{},{audio:r});this.mediaSelection=a}onSubtitleTrackUpdated(e,t){let r=this.hls.subtitleTracks[t.id],i=this.mediaSelection;if(!i){this.altSelection=F(F({},this.altSelection),{},{subtitles:r});return}let a=F(F({},i),{},{subtitles:r});this.mediaSelection=a}onAudioTrackSwitching(e,t){let r=$t(t);this.playerQueue.forEach(({hls:i})=>i&&(i.setAudioOption(t)||i.setAudioOption(r)))}onSubtitleTrackSwitch(e,t){let r=$t(t);this.playerQueue.forEach(({hls:i})=>i&&(i.setSubtitleOption(t)||t.id!==-1&&i.setSubtitleOption(r)))}onBufferCodecs(e,t){let r=t.tracks;r&&(this.requiredTracks=r)}onBufferAppended(e,t){this.checkBuffer()}onBufferFlushed(e,t){let r=this.playingItem;if(r&&!this.itemsMatch(r,this.bufferingItem)&&!this.isInterstitial(r)){let i=this.timelinePos;this.bufferedPos=i,this.checkBuffer()}}onBufferedToEnd(e){if(!this.schedule)return;let t=this.schedule.events;if(this.bufferedPos<Number.MAX_VALUE&&t){for(let i=0;i<t.length;i++){let a=t[i];if(a.cue.post){var r;let n=this.schedule.findEventIndex(a.identifier),l=(r=this.schedule.items)==null?void 0:r[n];this.isInterstitial(l)&&this.eventItemsMatch(l,this.bufferingItem)&&this.bufferedToItem(l,0);break}}this.bufferedPos=Number.MAX_VALUE}}onMediaEnded(e){let t=this.playingItem;if(!this.playingLastItem&&t){let r=this.findItemIndex(t);this.setSchedulePosition(r+1)}else this.shouldPlay=!1}updateItem(e,t){var r;let i=(r=this.schedule)==null?void 0:r.items;return e&&i&&i[this.findItemIndex(e,t)]||null}trimInPlace(e,t){if(this.isInterstitial(e)&&e.event.appendInPlace&&t.end-e.end>.25){e.event.assetList.forEach((a,n)=>{e.event.isAssetPastPlayoutLimit(n)&&this.clearAssetPlayer(a.identifier,null)});let r=e.end+.25,i=le.bufferInfo(this.primaryMedia,r,0);(i.end>r||(i.nextStart||0)>r)&&(this.log(`trim buffered interstitial ${xa(e)} (was ${xa(t)})`),this.attachPrimary(r,null,!0),this.flushFrontBuffer(r))}}itemsMatch(e,t){return!!t&&(e===t||e.event&&t.event&&this.eventItemsMatch(e,t)||!e.event&&!t.event&&this.findItemIndex(e)===this.findItemIndex(t))}eventItemsMatch(e,t){var r;return!!t&&(e===t||e.event.identifier===((r=t.event)==null?void 0:r.identifier))}findItemIndex(e,t){return e&&this.schedule?this.schedule.findItemIndex(e,t):-1}updateSchedule(e=!1){var t;let r=this.mediaSelection;r&&((t=this.schedule)==null||t.updateSchedule(r,[],e))}checkBuffer(e){var t;let r=(t=this.schedule)==null?void 0:t.items;if(!r)return;let i=le.bufferInfo(this.primaryMedia,this.timelinePos,0);e&&(this.bufferedPos=this.timelinePos),e||(e=i.len<1),this.updateBufferedPos(i.end,r,e)}updateBufferedPos(e,t,r){let i=this.schedule,a=this.bufferingItem;if(this.bufferedPos>e||!i)return;if(t.length===1&&this.itemsMatch(t[0],a)){this.bufferedPos=e;return}let n=this.playingItem,l=this.findItemIndex(n),h=i.findItemIndexAtTime(e);if(this.bufferedPos<e){var p;let v=this.findItemIndex(a),w=Math.min(v+1,t.length-1),P=t[w];if((h===-1&&a&&e>=a.end||(p=P.event)!=null&&p.appendInPlace&&e+.01>=P.start)&&(h=w),this.isInterstitial(a)){let D=a.event;if(w-l>1&&D.appendInPlace===!1||D.assetList.length===0&&D.assetListLoader)return}if(this.bufferedPos=e,h>v&&h>l)this.bufferedToItem(P);else{let D=this.primaryDetails;this.primaryLive&&D&&e>D.edge-D.targetduration&&P.start<D.edge+this.hls.config.interstitialLiveLookAhead&&this.isInterstitial(P)&&this.preloadAssets(P.event,0)}}else r&&n&&!this.itemsMatch(n,a)&&(h===l?this.bufferedToItem(n):h===l+1&&this.bufferedToItem(t[h]))}assetsBuffered(e,t){return e.event.assetList.length!==0&&!e.event.assetList.some(r=>{let i=this.getAssetPlayer(r.identifier);return!(i!=null&&i.bufferedInPlaceToEnd(t))})}setBufferingItem(e){let t=this.bufferingItem,r=this.schedule;if(!this.itemsMatch(e,t)&&r){let{items:i,events:a}=r;if(!i||!a)return t;let n=this.isInterstitial(e),l=this.getBufferingPlayer();this.bufferingItem=e,this.bufferedPos=Math.max(e.start,Math.min(e.end,this.timelinePos));let h=l?l.remaining:t?t.end-this.timelinePos:0;if(this.log(`INTERSTITIALS_BUFFERED_TO_BOUNDARY ${xa(e)}`+(t?` (${h.toFixed(2)} remaining)`:"")),!this.playbackDisabled)if(n){let p=r.findAssetIndex(e.event,this.bufferedPos);e.event.assetList.forEach((v,w)=>{let P=this.getAssetPlayer(v.identifier);P&&(w===p&&P.loadSource(),P.resumeBuffering())})}else this.hls.resumeBuffering(),this.playerQueue.forEach(p=>p.pauseBuffering());this.hls.trigger(o.INTERSTITIALS_BUFFERED_TO_BOUNDARY,{events:a.slice(0),schedule:i.slice(0),bufferingIndex:this.findItemIndex(e),playingIndex:this.findItemIndex(this.playingItem)})}else this.bufferingItem!==e&&(this.bufferingItem=e);return t}bufferedToItem(e,t=0){let r=this.setBufferingItem(e);if(!this.playbackDisabled){if(this.isInterstitial(e))this.bufferedToEvent(e,t);else if(r!==null){this.bufferingAsset=null;let i=this.detachedData;i&&i.mediaSource?this.attachPrimary(e.start,e,!0):this.preloadPrimary(e)}}}preloadPrimary(e){let t=this.findItemIndex(e),r=this.getPrimaryResumption(e,t);this.startLoadingPrimaryAt(r)}bufferedToEvent(e,t){let r=e.event,i=r.assetList.length===0&&!r.assetListLoader,a=r.cue.once;if(i||!a){let n=this.preloadAssets(r,t);if(n!=null&&n.interstitial.appendInPlace){let l=this.primaryMedia;l&&this.bufferAssetPlayer(n,l)}}}preloadAssets(e,t){let r=e.assetUrl,i=e.assetList.length,a=i===0&&!e.assetListLoader,n=e.cue.once;if(a){let h,p=e.timelineStart;if(e.appendInPlace){var l;let P=this.playingItem;this.isInterstitial(P)||(P==null||(l=P.nextEvent)==null?void 0:l.identifier)!==e.identifier||this.flushFrontBuffer(p+.25)}let v=0;if(!this.playingItem&&this.primaryLive&&(v=this.hls.startPosition)===-1&&(v=this.hls.liveSyncPosition||0),v&&!(e.cue.pre||e.cue.post)){let P=v-p;P>0&&(h=Math.round(1e3*P)/1e3)}if(this.log(`Load interstitial asset ${t+1}/${r?1:i} ${e}${h?` live-start: ${v} start-offset: ${h}`:""}`),r)return this.createAsset(e,0,0,p,e.duration,r);let w=this.assetListLoader.loadAssetList(e,h);w&&(e.assetListLoader=w)}else if(!n&&i){for(let p=t;p<i;p++){let v=e.assetList[p],w=this.getAssetPlayerQueueIndex(v.identifier);(w===-1||this.playerQueue[w].destroyed)&&!v.error&&this.createAssetPlayer(e,v,p)}let h=e.assetList[t];if(h){let p=this.getAssetPlayer(h.identifier);return p&&p.loadSource(),p}}return null}flushFrontBuffer(e){let t=this.requiredTracks;t&&(this.log(`Removing front buffer starting at ${e}`),Object.keys(t).forEach(r=>{this.hls.trigger(o.BUFFER_FLUSHING,{startOffset:e,endOffset:1/0,type:r})}))}getAssetPlayerQueueIndex(e){let t=this.playerQueue;for(let r=0;r<t.length;r++)if(e===t[r].assetId)return r;return-1}getAssetPlayer(e){let t=this.getAssetPlayerQueueIndex(e);return this.playerQueue[t]||null}getBufferingPlayer(){let{playerQueue:e,primaryMedia:t}=this;if(t){for(let r=0;r<e.length;r++)if(e[r].media===t)return e[r]}return null}createAsset(e,t,r,i,a,n){let l={parentIdentifier:e.identifier,identifier:`${e.identifier}-${t+1}-${Xi(n)}`,duration:a,startOffset:r,timelineStart:i,uri:n};return this.createAssetPlayer(e,l,t)}createAssetPlayer(e,t,r){let i=this.hls,a=i.userConfig,n=a.videoPreference,l=i.loadLevelObj||i.levels[i.currentLevel];(n||l)&&(n=_({},n),l.videoCodec&&(n.videoCodec=l.videoCodec),l.videoRange&&(n.allowedVideoRanges=[l.videoRange]));let h=i.audioTracks[i.audioTrack],p=i.subtitleTracks[i.subtitleTrack],v=0;if(this.primaryLive||e.appendInPlace){let me=this.timelinePos-t.timelineStart;if(me>1){let Te=t.duration;Te&&me<Te&&(v=me)}}let w=t.identifier,P=F(F({},a),{},{maxMaxBufferLength:Math.min(180,i.config.maxMaxBufferLength),autoStartLoad:!0,startFragPrefetch:!0,primarySessionId:i.sessionId,assetPlayerId:w,abrEwmaDefaultEstimate:i.bandwidthEstimate,interstitialsController:void 0,startPosition:v,liveDurationInfinity:!1,testBandwidth:!1,videoPreference:n,audioPreference:h||a.audioPreference,subtitlePreference:p||a.subtitlePreference});e.appendInPlace&&(e.appendInPlaceStarted=!0,t.timelineStart&&(P.timelineOffset=t.timelineStart));let D=P.cmcd;D!=null&&D.sessionId&&D.contentId&&(P.cmcd=_({},D,{contentId:Xi(t.uri)})),this.getAssetPlayer(w)&&this.warn(`Duplicate date range identifier ${e} and asset ${w}`);let G=new ui(this.HlsPlayerClass,P,e,t);this.playerQueue.push(G),e.assetList[r]=t;let z=!0,H=me=>{if(me.live){var Te;let ge=Error(`Interstitials MUST be VOD assets ${e}`),ze={fatal:!0,type:S.OTHER_ERROR,details:d.INTERSTITIAL_ASSET_ITEM_ERROR,error:ge},Fe=((Te=this.schedule)==null?void 0:Te.findEventIndex(e.identifier))||-1;this.handleAssetItemError(ze,e,Fe,r,ge.message);return}let Be=me.edge-me.fragmentStart,je=t.duration;(z||je===null||Be>je)&&(z=!1,this.log(`Interstitial asset "${w}" duration change ${je} > ${Be}`),t.duration=Be,this.updateSchedule())};G.on(o.LEVEL_UPDATED,(me,{details:Te})=>H(Te)),G.on(o.LEVEL_PTS_UPDATED,(me,{details:Te})=>H(Te)),G.on(o.EVENT_CUE_ENTER,()=>this.onInterstitialCueEnter());let oe=(me,Te)=>{let Be=this.getAssetPlayer(w);if(Be&&Te.tracks){Be.off(o.BUFFER_CODECS,oe),Be.tracks=Te.tracks;let je=this.primaryMedia;this.bufferingAsset===Be.assetItem&&je&&!Be.media&&this.bufferAssetPlayer(Be,je)}};G.on(o.BUFFER_CODECS,oe),G.on(o.BUFFERED_TO_END,()=>{var me;let Te=this.getAssetPlayer(w);if(this.log(`buffered to end of asset ${Te}`),!Te||!this.schedule)return;let Be=this.schedule.findEventIndex(e.identifier),je=(me=this.schedule.items)==null?void 0:me[Be];this.isInterstitial(je)&&this.advanceAssetBuffering(je,t)});let Se=me=>()=>{if(!this.getAssetPlayer(w)||!this.schedule)return;this.shouldPlay=!0;let Te=this.schedule.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,Te,me)};return G.once(o.MEDIA_ENDED,Se(r)),G.once(o.PLAYOUT_LIMIT_REACHED,Se(1/0)),G.on(o.ERROR,(me,Te)=>{if(!this.schedule)return;let Be=this.getAssetPlayer(w);if(Te.details===d.BUFFER_STALLED_ERROR){if(Be!=null&&Be.appendInPlace){this.handleInPlaceStall(e);return}this.onTimeupdate(),this.checkBuffer(!0);return}this.handleAssetItemError(Te,e,this.schedule.findEventIndex(e.identifier),r,`Asset player error ${Te.error} ${e}`)}),G.on(o.DESTROYING,()=>{if(!this.getAssetPlayer(w)||!this.schedule)return;let me=Error(`Asset player destroyed unexpectedly ${w}`),Te={fatal:!0,type:S.OTHER_ERROR,details:d.INTERSTITIAL_ASSET_ITEM_ERROR,error:me};this.handleAssetItemError(Te,e,this.schedule.findEventIndex(e.identifier),r,me.message)}),this.log(`INTERSTITIAL_ASSET_PLAYER_CREATED ${Oa(t)}`),this.hls.trigger(o.INTERSTITIAL_ASSET_PLAYER_CREATED,{asset:t,assetListIndex:r,event:e,player:G}),G}clearInterstitial(e,t){e.assetList.forEach(r=>{this.clearAssetPlayer(r.identifier,t)}),e.reset()}resetAssetPlayer(e){let t=this.getAssetPlayerQueueIndex(e);if(t!==-1){this.log(`reset asset player "${e}" after error`);let r=this.playerQueue[t];this.transferMediaFromPlayer(r,null),r.resetDetails()}}clearAssetPlayer(e,t){let r=this.getAssetPlayerQueueIndex(e);if(r!==-1){let i=this.playerQueue[r];this.log(`clear ${i} toSegment: ${t&&xa(t)}`),this.transferMediaFromPlayer(i,t),this.playerQueue.splice(r,1),i.destroy()}}emptyPlayerQueue(){let e;for(;e=this.playerQueue.pop();)e.destroy();this.playerQueue=[]}startAssetPlayer(e,t,r,i,a){let{interstitial:n,assetItem:l,assetId:h}=e,p=n.assetList.length,v=this.playingAsset;this.endedAsset=null,this.playingAsset=l,v&&v.identifier===h||(v&&(this.clearAssetPlayer(v.identifier,r[i]),delete v.error),this.log(`INTERSTITIAL_ASSET_STARTED ${t+1}/${p} ${Oa(l)}`),this.hls.trigger(o.INTERSTITIAL_ASSET_STARTED,{asset:l,assetListIndex:t,event:n,schedule:r.slice(0),scheduleIndex:i,player:e})),this.bufferAssetPlayer(e,a)}bufferAssetPlayer(e,t){var r,i;if(!this.schedule)return;let{interstitial:a,assetItem:n}=e,l=this.schedule.findEventIndex(a.identifier),h=(r=this.schedule.items)==null?void 0:r[l];if(!h)return;e.loadSource(),this.setBufferingItem(h),this.bufferingAsset=n;let p=this.getBufferingPlayer();if(p===e)return;let v=a.appendInPlace;if(v&&p?.interstitial.appendInPlace===!1)return;let w=p?.tracks||((i=this.detachedData)==null?void 0:i.tracks)||this.requiredTracks;if(v&&n!==this.playingAsset){if(!e.tracks){this.log(`Waiting for track info before buffering ${e}`);return}if(w&&!j(w,e.tracks)){let P=Error(`Asset ${Oa(n)} SourceBuffer tracks ('${Object.keys(e.tracks)}') are not compatible with primary content tracks ('${Object.keys(w)}')`),D={fatal:!0,type:S.OTHER_ERROR,details:d.INTERSTITIAL_ASSET_ITEM_ERROR,error:P},G=a.findAssetIndex(n);this.handleAssetItemError(D,a,l,G,P.message);return}}this.transferMediaTo(e,t)}handleInPlaceStall(e){let t=this.schedule,r=this.primaryMedia;if(!t||!r)return;let i=r.currentTime,a=t.findAssetIndex(e,i),n=e.assetList[a];if(n){let l=this.getAssetPlayer(n.identifier);if(l){let h=l.currentTime||i-n.timelineStart,p=l.duration-h;if(this.warn(`Stalled at ${h} of ${h+p} in ${l} ${e} (media.currentTime: ${i})`),h&&(p/r.playbackRate<.5||l.bufferedInPlaceToEnd(r))&&l.hls){let v=t.findEventIndex(e.identifier);this.advanceAfterAssetEnded(e,v,a)}}}}advanceInPlace(e){let t=this.primaryMedia;t&&t.currentTime<e&&(t.currentTime=e)}handleAssetItemError(e,t,r,i,a){if(e.details===d.BUFFER_STALLED_ERROR)return;let n=t.assetList[i]||null;if(this.warn(`INTERSTITIAL_ASSET_ERROR ${n&&Oa(n)} ${e.error}`),!this.schedule)return;let l=n?.identifier||"",h=this.getAssetPlayerQueueIndex(l),p=this.playerQueue[h]||null,v=this.schedule.items,w=_({},e,{fatal:!1,errorAction:Fa(!0),asset:n,assetListIndex:i,event:t,schedule:v,scheduleIndex:r,player:p});if(this.hls.trigger(o.INTERSTITIAL_ASSET_ERROR,w),!e.fatal)return;let P=this.playingAsset,D=this.bufferingAsset,G=Error(a);if(n&&(this.clearAssetPlayer(l,null),n.error=G),t.assetList.some(z=>!z.error))for(let z=i;z<t.assetList.length;z++)this.resetAssetPlayer(t.assetList[z].identifier);else t.error=G;this.updateSchedule(!0),t.error?this.primaryFallback(t):P&&P.identifier===l?this.advanceAfterAssetEnded(t,r,i):D&&D.identifier===l&&this.isInterstitial(this.bufferingItem)&&this.advanceAssetBuffering(this.bufferingItem,D)}primaryFallback(e){let t=e.timelineStart,r=this.effectivePlayingItem;if(r){this.log(`Fallback to primary from event "${e.identifier}" start: ${t} pos: ${this.timelinePos} playing: ${xa(r)} error: ${e.error}`);let i=this.timelinePos;i===-1&&(i=this.hls.startPosition);let a=this.updateItem(r,i);if(this.itemsMatch(r,a)&&this.clearInterstitial(e,null),e.appendInPlace&&(this.attachPrimary(t,null),this.flushFrontBuffer(t)),!this.schedule)return;let n=this.schedule.findItemIndexAtTime(i);this.setSchedulePosition(n)}else this.checkStart()}onAssetListLoaded(e,t){var r,i,a;let n=t.event,l=n.identifier,h=t.assetListResponse.ASSETS;if(!((r=this.schedule)!=null&&r.hasEvent(l)))return;let p=n.timelineStart,v=n.duration,w=0;h.forEach((z,H)=>{let oe=parseFloat(z.DURATION);this.createAsset(n,H,w,p+w,oe,z.URI),w+=oe}),n.duration=w,this.log(`Loaded asset-list with duration: ${w} (was: ${v}) ${n}`);let P=this.waitingItem,D=P?.event.identifier===l;this.updateSchedule();let G=(i=this.bufferingItem)==null?void 0:i.event;if(D){let z=this.schedule.findEventIndex(l),H=(a=this.schedule.items)==null?void 0:a[z];if(H){if(!this.playingItem&&this.timelinePos>H.end&&this.schedule.findItemIndexAtTime(this.timelinePos)!==z){n.error=Error(`Interstitial no longer within playback range ${this.timelinePos} ${n}`),this.updateSchedule(!0),this.primaryFallback(n);return}this.setBufferingItem(H)}this.setSchedulePosition(z)}else if(G?.identifier===l){let z=n.assetList[0];if(z){let H=this.getAssetPlayer(z.identifier);if(G.appendInPlace){let oe=this.primaryMedia;H&&oe&&this.bufferAssetPlayer(H,oe)}else H&&H.loadSource()}}}onError(e,t){if(this.schedule)switch(t.details){case d.ASSET_LIST_PARSING_ERROR:case d.ASSET_LIST_LOAD_ERROR:case d.ASSET_LIST_LOAD_TIMEOUT:{let r=t.interstitial;r&&(this.updateSchedule(!0),this.primaryFallback(r));break}case d.BUFFER_STALLED_ERROR:{let r=this.endedItem||this.waitingItem||this.playingItem;if(this.isInterstitial(r)&&r.event.appendInPlace){this.handleInPlaceStall(r.event);return}this.log(`Primary player stall @${this.timelinePos} bufferedPos: ${this.bufferedPos}`),this.onTimeupdate(),this.checkBuffer(!0)}}}}class Fn extends Bt{constructor(e,t,r){super(e,t,r,"subtitle-stream-controller",m.SUBTITLE),this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this.registerListeners()}onHandlerDestroying(){this.unregisterListeners(),super.onHandlerDestroying(),this.mainDetails=null}registerListeners(){super.registerListeners();let{hls:e}=this;e.on(o.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(o.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(o.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(o.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(o.BUFFER_FLUSHING,this.onBufferFlushing,this)}unregisterListeners(){super.unregisterListeners();let{hls:e}=this;e.off(o.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(o.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(o.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(o.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(o.BUFFER_FLUSHING,this.onBufferFlushing,this)}startLoad(e,t){this.stopLoad(),this.state=Ie.IDLE,this.setInterval(500),this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}onManifestLoading(){super.onManifestLoading(),this.mainDetails=null}onMediaDetaching(e,t){this.tracksBuffered=[],super.onMediaDetaching(e,t)}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){let r,{frag:i,success:a}=t;if(this.fragContextChanged(i)||(ke(i)&&(this.fragPrevious=i),this.state=Ie.IDLE),!a)return;let n=this.tracksBuffered[this.currentTrackId];if(!n)return;let l=i.start;for(let p=0;p<n.length;p++)if(l>=n[p].start&&l<=n[p].end){r=n[p];break}let h=i.start+i.duration;r?r.end=h:(r={start:l,end:h},n.push(r)),this.fragmentTracker.fragBuffered(i),this.fragBufferedComplete(i,null),this.media&&this.tick()}onBufferFlushing(e,t){let{startOffset:r,endOffset:i}=t;if(r===0&&i!==Number.POSITIVE_INFINITY){let a=i-1;if(a<=0)return;t.endOffsetSubtitles=Math.max(0,a),this.tracksBuffered.forEach(n=>{for(let l=0;l<n.length;){if(n[l].end<=a){n.shift();continue}if(n[l].start<a)n[l].start=a;else break;l++}}),this.fragmentTracker.removeFragmentsInRange(r,a,m.SUBTITLE)}}onError(e,t){let r=t.frag;r?.type===m.SUBTITLE&&(t.details===d.FRAG_GAP&&this.fragmentTracker.fragBuffered(r,!0),this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==Ie.STOPPED&&(this.state=Ie.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(this.levels&&Fo(this.levels,t)){this.levels=t.map(r=>new Wr(r));return}this.tracksBuffered=[],this.levels=t.map(r=>{let i=new Wr(r);return this.tracksBuffered[i.id]=[],i}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,m.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){var r;if(this.currentTrackId=t.id,!((r=this.levels)!=null&&r.length)||this.currentTrackId===-1){this.clearInterval();return}let i=this.levels[this.currentTrackId];i!=null&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.state!==Ie.STOPPED&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var r,i;let{currentTrackId:a,levels:n}=this,{details:l,id:h}=t;if(!n){this.warn(`Subtitle tracks were reset while loading level ${h}`);return}let p=n[h];if(h>=n.length||!p)return;this.log(`Subtitle track ${h} loaded [${l.startSN},${l.endSN}]${l.lastPartSn?`[part-${l.lastPartSn}-${l.lastPartIndex}]`:""},duration:${l.totalduration}`),this.mediaBuffer=this.mediaBufferTimeRanges;let v=0;if(l.live||(r=p.details)!=null&&r.live){if(l.deltaUpdateFailed)return;let w=this.mainDetails;if(!w){this.startFragRequested=!1;return}let P=w.fragments[0];p.details?(v=this.alignPlaylists(l,p.details,(i=this.levelLastLoaded)==null?void 0:i.details))===0&&P&&Le(l,v=P.start):l.hasProgramDateTime&&w.hasProgramDateTime?(Rt(l,w),v=l.fragmentStart):P&&Le(l,v=P.start),w&&!this.startFragRequested&&this.setStartPosition(w,v)}p.details=l,this.levelLastLoaded=p,h===a&&(this.hls.trigger(o.SUBTITLE_TRACK_UPDATED,{details:l,id:h,groupId:t.groupId}),this.tick(),l.live&&!this.fragCurrent&&this.media&&this.state===Ie.IDLE&&!gi(null,l.fragments,this.media.currentTime,0)&&(this.warn("Subtitle playlist not aligned with playback"),p.details=void 0))}_handleFragmentLoadComplete(e){let{frag:t,payload:r}=e,i=t.decryptdata,a=this.hls;if(!this.fragContextChanged(t)&&r&&r.byteLength>0&&i!=null&&i.key&&i.iv&&vi(i.method)){let n=performance.now();this.decrypter.decrypt(new Uint8Array(r),i.key.buffer,i.iv.buffer,Ze(i.method)).catch(l=>{throw a.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.FRAG_DECRYPT_ERROR,fatal:!1,error:l,reason:l.message,frag:t}),l}).then(l=>{let h=performance.now();a.trigger(o.FRAG_DECRYPTED,{frag:t,payload:l,stats:{tstart:n,tdecrypt:h}})}).catch(l=>{this.warn(`${l.name}: ${l.message}`),this.state=Ie.IDLE})}}doTick(){if(!this.media){this.state=Ie.IDLE;return}if(this.state===Ie.IDLE){let{currentTrackId:e,levels:t}=this,r=t?.[e];if(!r||!t.length||!r.details||this.waitForLive(r))return;let{config:i}=this,a=this.getLoadPosition(),{end:n,len:l}=le.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],a,i.maxBufferHole),h=r.details;if(l>this.hls.maxBufferLength+h.levelTargetDuration)return;let p=h.fragments,v=p.length,w=h.edge,P=null,D=this.fragPrevious;if(n<w){let z=i.maxFragLookUpTolerance;(P=gi(D,p,Math.max(p[0].start,n),n>w-z?0:z))||!D||!(D.start<p[0].start)||(P=p[0])}else P=p[v-1];if(!(P=this.filterReplacedPrimary(P,r.details)))return;let G=p[P.sn-h.startSN-1];if(G&&G.cc===P.cc&&this.fragmentTracker.getState(G)===Xr.NOT_LOADED&&(P=G),this.fragmentTracker.getState(P)===Xr.NOT_LOADED){let z=this.mapToInitFragWhenRequired(P);z&&this.loadFragment(z,r,n)}}}loadFragment(e,t,r){ke(e)?super.loadFragment(e,t,r):this._loadInitSegment(e,t)}get mediaBufferTimeRanges(){return new Zi(this.tracksBuffered[this.currentTrackId]||[])}}class Zi{constructor(e){this.buffered=void 0;let t=(r,i,a)=>{if((i>>>=0)>a-1)throw new DOMException(`Failed to execute '${r}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${a})`);return e[i][r]};this.buffered={get length(){return e.length},end:r=>t("end",r,e.length),start:r=>t("start",r,e.length)}}}let Ja={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},La=y=>String.fromCharCode(Ja[y]||y),ha={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Wa={17:2,18:4,21:6,22:8,23:10,19:13,20:15},mn={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},on={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Vn=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class Bo{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){let r=typeof t=="function"?t():t;se.log(`${this.time} [${e}] ${r}`)}}}let is=function(y){let e=[];for(let t=0;t<y.length;t++)e.push(y[t].toString(16));return e};class wo{constructor(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){let t=["foreground","underline","italics","background","flash"];for(let r=0;r<t.length;r++){let i=t[r];e.hasOwnProperty(i)&&(this[i]=e[i])}}isDefault(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class Go{constructor(){this.uchar=" ",this.penState=new wo}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return this.uchar===" "&&this.penState.isDefault()}}class Ho{constructor(e){this.chars=[],this.pos=0,this.currPenState=new wo,this.cueStartTime=null,this.logger=void 0;for(let t=0;t<100;t++)this.chars.push(new Go);this.logger=e}equals(e){for(let t=0;t<100;t++)if(!this.chars[t].equals(e.chars[t]))return!1;return!0}copy(e){for(let t=0;t<100;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=100)}moveCursor(e){let t=this.pos+e;if(e>1)for(let r=this.pos+1;r<t+1;r++)this.chars[r].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();let t=La(e);if(this.pos>=100){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<100;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let e=[],t=!0;for(let r=0;r<100;r++){let i=this.chars[r].uchar;i!==" "&&(t=!1),e.push(i)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e),this.chars[this.pos].setPenState(this.currPenState)}}class Ms{constructor(e){this.rows=[],this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.logger=void 0;for(let t=0;t<15;t++)this.rows.push(new Ho(e));this.logger=e}reset(){for(let e=0;e<15;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let r=0;r<15;r++)if(!this.rows[r].equals(e.rows[r])){t=!1;break}return t}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){this.rows[this.currRow].backSpace()}clearToEndOfRow(){this.rows[this.currRow].clearToEndOfRow()}insertChar(e){this.rows[this.currRow].insertChar(e)}setPen(e){this.rows[this.currRow].setPenStyles(e)}moveCursor(e){this.rows[this.currRow].moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e),this.rows[this.currRow].setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+Xt(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let l=0;l<15;l++)this.rows[l].clear();let a=this.currRow+1-this.nrRollUpRows,n=this.lastOutputScreen;if(n){let l=n.rows[a].cueStartTime,h=this.logger.time;if(l!==null&&h!==null&&l<h)for(let p=0;p<this.nrRollUpRows;p++)this.rows[t-this.nrRollUpRows+p+1].copy(n.rows[a+p])}}this.currRow=t;let r=this.rows[this.currRow];if(e.indent!==null){let a=Math.max(e.indent-1,0);r.setCursor(e.indent),e.color=r.chars[a].penState.foreground}let i={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(i)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+Xt(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(this.nrRollUpRows===null){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());let e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;let t=[],r="",i=-1;for(let a=0;a<15;a++){let n=this.rows[a].getTextString();n&&(i=a+1,e?t.push("Row "+i+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(r=e?"["+t.join(" | ")+"]":t.join(`
`)),r}getTextAndFormat(){return this.rows}}class ao{constructor(e,t,r){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new Ms(r),this.nonDisplayedMemory=new Ms(r),this.lastOutputScreen=new Ms(r),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=r}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let r=0;r<e.length;r++)this.writeScreen.insertChar(e[r]);let t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){let e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){let t={flash:!1};if(t.underline=e%2==1,t.italics=e>=46,t.italics)t.foreground="white";else{let r=Math.floor(e/2)-16;t.foreground=["white","green","blue","cyan","red","yellow","magenta"][r]}this.logger.log(2,"MIDROW: "+Xt(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){let t=this.logger.time;t!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&!this.displayedMemory.isEmpty()&&(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e)}}class no{constructor(e,t,r){this.channels=void 0,this.currentChannel=0,this.cmdHistory={a:null,b:null},this.logger=void 0;let i=this.logger=new Bo;this.channels=[null,new ao(e,t,i),new ao(e+1,r,i)]}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){this.logger.time=e;for(let i=0;i<t.length;i+=2){var r;let a=127&t[i],n=127&t[i+1],l=!1,h=null;if(a===0&&n===0)continue;this.logger.log(3,()=>"["+is([t[i],t[i+1]])+"] -> ("+is([a,n])+")");let p=this.cmdHistory;if(a>=16&&a<=31){if(p.a===a&&p.b===n){p.a=null,p.b=null,this.logger.log(3,()=>"Repeated command ("+is([a,n])+") is dropped");continue}(r=this.cmdHistory).a=a,r.b=n,(l=this.parseCmd(a,n))||(l=this.parseMidrow(a,n)),l||(l=this.parsePAC(a,n)),l||(l=this.parseBackgroundAttributes(a,n))}else p.a=null,p.b=null;if(!l&&(h=this.parseChars(a,n))){let v=this.currentChannel;v&&v>0?this.channels[v].insertChars(h):this.logger.log(2,"No channel found yet. TEXT-MODE?")}l||h||this.logger.log(2,()=>"Couldn't parse cleaned data "+is([a,n])+" orig: "+is([t[i],t[i+1]]))}}parseCmd(e,t){if(!((e===20||e===28||e===21||e===29)&&t>=32&&t<=47||(e===23||e===31)&&t>=33&&t<=35))return!1;let r=e===20||e===21||e===23?1:2,i=this.channels[r];return e===20||e===21||e===28||e===29?t===32?i.ccRCL():t===33?i.ccBS():t===34?i.ccAOF():t===35?i.ccAON():t===36?i.ccDER():t===37?i.ccRU(2):t===38?i.ccRU(3):t===39?i.ccRU(4):t===40?i.ccFON():t===41?i.ccRDC():t===42?i.ccTR():t===43?i.ccRTD():t===44?i.ccEDM():t===45?i.ccCR():t===46?i.ccENM():t===47&&i.ccEOC():i.ccTO(t-32),this.currentChannel=r,!0}parseMidrow(e,t){let r=0;if((e===17||e===25)&&t>=32&&t<=47){if((r=e===17?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;let i=this.channels[r];return!!i&&(i.ccMIDROW(t),this.logger.log(3,()=>"MIDROW ("+is([e,t])+")"),!0)}return!1}parsePAC(e,t){let r,i=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(e===16||e===24)&&t>=64&&t<=95;if(!(i||a))return!1;let n=e<=23?1:2;r=t>=64&&t<=95?n===1?ha[e]:mn[e]:n===1?Wa[e]:on[e];let l=this.channels[n];return!!l&&(l.setPAC(this.interpretPAC(r,t)),this.currentChannel=n,!0)}interpretPAC(e,t){let r,i={color:null,italics:!1,indent:null,underline:!1,row:e};return r=t>95?t-96:t-64,i.underline=(1&r)==1,r<=13?i.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(r/2)]:r<=15?(i.italics=!0,i.color="white"):i.indent=4*Math.floor((r-16)/2),i}parseChars(e,t){let r,i=null,a=null;if(e>=25?(r=2,a=e-8):(r=1,a=e),a>=17&&a<=19){let n;n=a===17?t+80:a===18?t+112:t+144,this.logger.log(2,()=>"Special char '"+La(n)+"' in channel "+r),i=[n]}else e>=32&&e<=127&&(i=t===0?[e]:[e,t]);return i&&this.logger.log(3,()=>"Char codes =  "+is(i).join(",")),i}parseBackgroundAttributes(e,t){let r;if(!((e===16||e===24)&&t>=32&&t<=47||(e===23||e===31)&&t>=45&&t<=47))return!1;let i={};return e===16||e===24?(r=Math.floor((t-32)/2),i.background=Vn[r],t%2==1&&(i.background=i.background+"_semi")):t===45?i.background="transparent":(i.foreground="black",t===47&&(i.underline=!0)),this.channels[e<=23?1:2].setBkgData(i),!0}reset(){var e;for(let t=0;t<Object.keys(this.channels).length;t++){let r=this.channels[t];r&&r.reset()}(e=this.cmdHistory).a=null,e.b=null}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){let r=this.channels[t];r&&r.cueSplitAtTime(e)}}}var Ns=function(){if(bi!=null&&bi.VTTCue)return ut.VTTCue;let y=["","lr","rl"],e=["start","middle","end","left","right"];function t(a,n){if(typeof n!="string"||!Array.isArray(a))return!1;let l=n.toLowerCase();return!!~a.indexOf(l)&&l}function r(a,...n){let l=1;for(;l<arguments.length;l++){let h=arguments[l];for(let p in h)a[p]=h[p]}return a}function i(a,n,l){let h={enumerable:!0};this.hasBeenReset=!1;let p="",v=!1,w=a,P=n,D=l,G=null,z="",H=!0,oe="auto",Se="start",me=50,Te="middle",Be=50,je="middle";Object.defineProperty(this,"id",r({},h,{get:function(){return p},set:function(ge){p=""+ge}})),Object.defineProperty(this,"pauseOnExit",r({},h,{get:function(){return v},set:function(ge){v=!!ge}})),Object.defineProperty(this,"startTime",r({},h,{get:function(){return w},set:function(ge){if(typeof ge!="number")throw TypeError("Start time must be set to a number.");w=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"endTime",r({},h,{get:function(){return P},set:function(ge){if(typeof ge!="number")throw TypeError("End time must be set to a number.");P=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"text",r({},h,{get:function(){return D},set:function(ge){D=""+ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"region",r({},h,{get:function(){return G},set:function(ge){G=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"vertical",r({},h,{get:function(){return z},set:function(ge){let ze=t(y,ge);if(ze===!1)throw SyntaxError("An invalid or illegal string was specified.");z=ze,this.hasBeenReset=!0}})),Object.defineProperty(this,"snapToLines",r({},h,{get:function(){return H},set:function(ge){H=!!ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"line",r({},h,{get:function(){return oe},set:function(ge){if(typeof ge!="number"&&ge!=="auto")throw SyntaxError("An invalid number or illegal string was specified.");oe=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"lineAlign",r({},h,{get:function(){return Se},set:function(ge){let ze=t(e,ge);if(!ze)throw SyntaxError("An invalid or illegal string was specified.");Se=ze,this.hasBeenReset=!0}})),Object.defineProperty(this,"position",r({},h,{get:function(){return me},set:function(ge){if(ge<0||ge>100)throw Error("Position must be between 0 and 100.");me=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"positionAlign",r({},h,{get:function(){return Te},set:function(ge){let ze=t(e,ge);if(!ze)throw SyntaxError("An invalid or illegal string was specified.");Te=ze,this.hasBeenReset=!0}})),Object.defineProperty(this,"size",r({},h,{get:function(){return Be},set:function(ge){if(ge<0||ge>100)throw Error("Size must be between 0 and 100.");Be=ge,this.hasBeenReset=!0}})),Object.defineProperty(this,"align",r({},h,{get:function(){return je},set:function(ge){let ze=t(e,ge);if(!ze)throw SyntaxError("An invalid or illegal string was specified.");je=ze,this.hasBeenReset=!0}})),this.displayState=void 0}return i.prototype.getCueAsHTML=function(){return ut.WebVTT.convertCueToDOMTree(ut,this.text)},i}();class Rn{decode(e,t){if(!e)return"";if(typeof e!="string")throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ko(y){function e(r,i,a,n){return(0|r)*3600+(0|i)*60+(0|a)+parseFloat(n||0)}let t=y.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?e(t[2],t[3],0,t[4]):e(t[1],t[2],t[3],t[4]):null}class Fs{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||t===""||(this.values[e]=t)}get(e,t,r){return r?this.has(e)?this.values[e]:t[r]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,r){for(let i=0;i<r.length;++i)if(t===r[i]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){let r=parseFloat(t);if(r>=0&&r<=100)return this.set(e,r),!0}return!1}}function ys(y,e,t,r){let i=r?y.split(r):[y];for(let a in i){if(typeof i[a]!="string")continue;let n=i[a].split(t);n.length===2&&e(n[0],n[1])}}let so=new Ns(0,0,""),Us=so.align==="middle"?"middle":"center";function _o(y){return y.replace(/<br(?: \/)?>/gi,`
`)}class Vo{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new Rn,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){let t=this;function r(){let a=t.buffer,n=0;for(a=_o(a);n<a.length&&a[n]!=="\r"&&a[n]!==`
`;)++n;let l=a.slice(0,n);return a[n]==="\r"&&++n,a[n]===`
`&&++n,t.buffer=a.slice(n),l}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let a="";if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;let l=(a=r()).match(/^()?WEBVTT([ \t].*)?$/);if(!(l!=null&&l[0]))throw Error("Malformed WebVTT signature.");t.state="HEADER"}let n=!1;for(;t.buffer&&/\r\n|\n/.test(t.buffer);)switch(n?n=!1:a=r(),t.state){case"HEADER":if(/:/.test(a)){var i;i=a,ys(i,function(l,h){},/:/)}else a||(t.state="ID");continue;case"NOTE":a||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(a)){t.state="NOTE";break}if(!a)continue;if(t.cue=new Ns(0,0,""),t.state="CUE",a.indexOf("-->")===-1){t.cue.id=a;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{(function(l,h,p){let v=l;function w(){let D=ko(l);if(D===null)throw Error("Malformed timestamp: "+v);return l=l.replace(/^[^\sa-zA-Z-]+/,""),D}function P(){l=l.replace(/^\s+/,"")}if(P(),h.startTime=w(),P(),l.slice(0,3)!=="-->")throw Error("Malformed time stamp (time stamps must be separated by '-->'): "+v);l=l.slice(3),P(),h.endTime=w(),P(),function(D,G){let z=new Fs;ys(D,function(Se,me){let Te;switch(Se){case"region":for(let Be=p.length-1;Be>=0;Be--)if(p[Be].id===me){z.set(Se,p[Be].region);break}break;case"vertical":z.alt(Se,me,["rl","lr"]);break;case"line":Te=me.split(","),z.integer(Se,Te[0]),z.percent(Se,Te[0])&&z.set("snapToLines",!1),z.alt(Se,Te[0],["auto"]),Te.length===2&&z.alt("lineAlign",Te[1],["start",Us,"end"]);break;case"position":Te=me.split(","),z.percent(Se,Te[0]),Te.length===2&&z.alt("positionAlign",Te[1],["start",Us,"end","line-left","line-right","auto"]);break;case"size":z.percent(Se,me);break;case"align":z.alt(Se,me,["start",Us,"end","left","right"])}},/:/,/\s/),G.region=z.get("region",null),G.vertical=z.get("vertical","");let H=z.get("line","auto");H==="auto"&&so.line===-1&&(H=-1),G.line=H,G.lineAlign=z.get("lineAlign","start"),G.snapToLines=z.get("snapToLines",!0),G.size=z.get("size",100),G.align=z.get("align",Us);let oe=z.get("position","auto");oe==="auto"&&so.position===50&&(oe=G.align==="start"||G.align==="left"?0:G.align==="end"||G.align==="right"?100:50),G.position=oe}(l,h)})(a,t.cue,t.regionList)}catch{t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{let l=a.indexOf("-->")!==-1;if(!a||l&&(n=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(t.cue===null)continue;t.cue.text&&(t.cue.text+=`
`),t.cue.text+=a}continue;case"BADCUE":a||(t.state="ID")}}catch{t.state==="CUETEXT"&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this}flush(){try{if((this.cue||this.state==="HEADER")&&(this.buffer+=`

`,this.parse()),this.state==="INITIAL"||this.state==="BADWEBVTT")throw Error("Malformed WebVTT signature.")}catch(e){this.onparsingerror&&this.onparsingerror(e)}return this.onflush&&this.onflush(),this}}let qo=/\r\n|\n\r|\n|\r/g,oo=function(y,e,t=0){return y.slice(t,t+e.length)===e},qn=function(y){let e=parseInt(y.slice(-3)),t=parseInt(y.slice(-6,-4)),r=parseInt(y.slice(-9,-7)),i=y.length>9?parseInt(y.substring(0,y.indexOf(":"))):0;if(!x(e)||!x(t)||!x(r)||!x(i))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${y}`);return e+(1e3*t+6e4*r+36e5*i)};function lo(y,e,t){return Xi(y.toString())+Xi(e.toString())+Xi(t)}let Ko=function(y,e,t){let r=y[e],i=y[r.prevCC];if(!i||!i.new&&r.new){y.ccOffset=y.presentationOffset=r.start,r.new=!1;return}for(;(a=i)!=null&&a.new;){var a;y.ccOffset+=r.start-i.start,r.new=!1,i=y[(r=i).prevCC]}y.presentationOffset=t},hs="stpp.ttml.im1t",vs=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Ro=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,as={left:"start",center:"center",right:"end",start:"start",end:"end"};function bs(y,e,t,r){let i=ye(new Uint8Array(y),["mdat"]);if(i.length===0){r(Error("Could not parse IMSC1 mdat"));return}let a=i.map(l=>M(l)),n=function(l,h,p=1,v=!1){return Sa(l,1,1/p,v)}(e.baseTime,0,e.timescale);try{a.forEach(l=>t(function(h,p){let v=new DOMParser().parseFromString(h,"text/xml").getElementsByTagName("tt")[0];if(!v)throw Error("Invalid ttml");let w={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},P=Object.keys(w).reduce((oe,Se)=>(oe[Se]=v.getAttribute(`ttp:${Se}`)||w[Se],oe),{}),D=v.getAttribute("xml:space")!=="preserve",G=Ss(fs(v,"styling","style")),z=Ss(fs(v,"layout","region")),H=fs(v,"body","[begin]");return[].map.call(H,oe=>{let Se=function rt(st,kt){return[].slice.call(st.childNodes).reduce((Ye,et,dt)=>{var bt;return et.nodeName==="br"&&dt?Ye+`
`:(bt=et.childNodes)!=null&&bt.length?rt(et,kt):kt?Ye+et.textContent.trim().replace(/\s+/g," "):Ye+et.textContent},"")}(oe,D);if(!Se||!oe.hasAttribute("begin"))return null;let me=$s(oe.getAttribute("begin"),P),Te=$s(oe.getAttribute("dur"),P),Be=$s(oe.getAttribute("end"),P);if(me===null)throw uo(oe);if(Be===null){if(Te===null)throw uo(oe);Be=me+Te}let je=new Ns(me-p,Be-p,Se);je.id=lo(je.startTime,je.endTime,je.text);let ge=z[oe.getAttribute("region")],ze=function(rt,st,kt){let Ye="http://www.w3.org/ns/ttml#styling",et=null,dt=rt!=null&&rt.hasAttribute("style")?rt.getAttribute("style"):null;return dt&&kt.hasOwnProperty(dt)&&(et=kt[dt]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((bt,_t)=>{let xt=Un(st,Ye,_t)||Un(rt,Ye,_t)||Un(et,Ye,_t);return xt&&(bt[_t]=xt),bt},{})}(ge,G[oe.getAttribute("style")],G),{textAlign:Fe}=ze;if(Fe){let rt=as[Fe];rt&&(je.lineAlign=rt),je.align=Fe}return _(je,ze),je}).filter(oe=>oe!==null)}(l,n)))}catch(l){r(l)}}function fs(y,e,t){let r=y.getElementsByTagName(e)[0];return r?[].slice.call(r.querySelectorAll(t)):[]}function Ss(y){return y.reduce((e,t)=>{let r=t.getAttribute("xml:id");return r&&(e[r]=t),e},{})}function Un(y,e,t){return y&&y.hasAttributeNS(e,t)?y.getAttributeNS(e,t):null}function uo(y){return Error(`Could not parse ttml timestamp ${y}`)}function $s(y,e){if(!y)return null;let t=ko(y);return t===null&&(vs.test(y)?t=function(r,i){let a=vs.exec(r),n=(0|a[4])+(0|a[5])/i.subFrameRate;return(0|a[1])*3600+(0|a[2])*60+(0|a[3])+n/i.frameRate}(y,e):Ro.test(y)&&(t=function(r,i){let a=Ro.exec(r),n=Number(a[1]);switch(a[2]){case"h":return 3600*n;case"m":return 60*n;case"ms":return 1e3*n;case"f":return n/i.frameRate;case"t":return n/i.tickRate}return n}(y,e))),t}class co{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,r){(this.startTime===null||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=r,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}class xs{constructor(e){this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Co(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},e.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(o.FRAG_LOADING,this.onFragLoading,this),e.on(o.FRAG_LOADED,this.onFragLoaded,this),e.on(o.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(o.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(o.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(o.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(o.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:e}=this;e.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(o.FRAG_LOADING,this.onFragLoading,this),e.off(o.FRAG_LOADED,this.onFragLoaded,this),e.off(o.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(o.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(o.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(o.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(o.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.media=null,this.cea608Parser1=this.cea608Parser2=void 0}initCea608Parsers(){let e=new co(this,"textTrack1"),t=new co(this,"textTrack2"),r=new co(this,"textTrack3"),i=new co(this,"textTrack4");this.cea608Parser1=new no(1,e,t),this.cea608Parser2=new no(3,r,i)}addCues(e,t,r,i,a){let n=!1;for(let h=a.length;h--;){var l;let p=a[h],v=(l=p[0],Math.min(p[1],r)-Math.max(l,t));if(v>=0&&(p[0]=Math.min(p[0],t),p[1]=Math.max(p[1],r),n=!0,v/(r-t)>.5))return}if(n||a.push([t,r]),this.config.renderTextTracksNatively){let h=this.captionsTracks[e];this.Cues.newCue(h,t,r,i)}else{let h=this.Cues.newCue(null,t,r,i);this.hls.trigger(o.CUES_PARSED,{type:"captions",cues:h,track:e})}}onInitPtsFound(e,{frag:t,id:r,initPTS:i,timescale:a,trackId:n}){let{unparsedVttFrags:l}=this;r===m.MAIN&&(this.initPTS[t.cc]={baseTime:i,timescale:a,trackId:n}),l.length&&(this.unparsedVttFrags=[],l.forEach(h=>{this.initPTS[h.frag.cc]?this.onFragLoaded(o.FRAG_LOADED,h):this.hls.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:h.frag,error:Error("Subtitle discontinuity domain does not match main")})}))}getExistingTrack(e,t){let{media:r}=this;if(r)for(let i=0;i<r.textTracks.length;i++){let a=r.textTracks[i];if(js(a,{name:e,lang:t,characteristics:"transcribes-spoken-dialog,describes-music-and-sound"}))return a}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;let{captionsProperties:t,captionsTracks:r,media:i}=this,{label:a,languageCode:n}=t[e],l=this.getExistingTrack(a,n);if(l)r[e]=l,ei(r[e]),Ra(r[e],i);else{let h=this.createTextTrack("captions",a,n);h&&(h[e]=!0,r[e]=h)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;let t=this.captionsProperties[e];if(!t)return;let r={_id:e,label:t.label,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(o.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,r){let i=this.media;if(i)return i.addTextTrack(e,t,r)}onMediaAttaching(e,t){this.media=t.media,t.mediaSource||this._cleanTracks()}onMediaDetaching(e,t){let r=!!t.transferMedia;if(this.media=null,r)return;let{captionsTracks:i}=this;Object.keys(i).forEach(a=>{ei(i[a]),delete i[a]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastCc=-1,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=Co(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:e}=this;if(!e)return;let t=e.textTracks;if(t)for(let r=0;r<t.length;r++)ei(t[r])}onSubtitleTracksUpdated(e,t){let r=t.subtitleTracks||[],i=r.some(a=>a.textCodec===hs);if(this.config.enableWebVTT||i&&this.config.enableIMSC1){if(Fo(this.tracks,r)){this.tracks=r;return}if(this.textTracks=[],this.tracks=r,this.config.renderTextTracksNatively){let a=this.media,n=a?Di(a.textTracks):null;if(this.tracks.forEach((l,h)=>{let p;if(n){let v=null;for(let w=0;w<n.length;w++)if(n[w]&&js(n[w],l)){v=n[w],n[w]=null;break}v&&(p=v)}if(p)ei(p);else{let v=Ao(l);(p=this.createTextTrack(v,l.name,l.lang))&&(p.mode="disabled")}p&&this.textTracks.push(p)}),n!=null&&n.length){let l=n.filter(h=>h!==null).map(h=>h.label);l.length&&this.hls.logger.warn(`Media element contains unused subtitle tracks: ${l.join(", ")}. Replace media element for each source to clear TextTracks and captions menu.`)}}else if(this.tracks.length){let a=this.tracks.map(n=>({label:n.name,kind:n.type.toLowerCase(),default:n.default,subtitleTrack:n}));this.hls.trigger(o.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:a})}}}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(r=>{let i=/(?:CC|SERVICE)([1-4])/.exec(r.instreamId);if(!i)return;let a=`textTrack${i[1]}`,n=this.captionsProperties[a];n&&(n.label=r.name,r.lang&&(n.languageCode=r.lang),n.media=r)})}closedCaptionsForLevel(e){let t=this.hls.levels[e.level];return t?.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){if(this.enabled&&t.frag.type===m.MAIN){var r,i;let{cea608Parser1:a,cea608Parser2:n,lastSn:l}=this,{cc:h,sn:p}=t.frag,v=(r=(i=t.part)==null?void 0:i.index)!=null?r:-1;a&&n&&(p!==l+1||p===l&&v!==this.lastPartIndex+1||h!==this.lastCc)&&(a.reset(),n.reset()),this.lastCc=h,this.lastSn=p,this.lastPartIndex=v}}onFragLoaded(e,t){let{frag:r,payload:i}=t;if(r.type===m.SUBTITLE)if(i.byteLength){let a=r.decryptdata,n="stats"in t;if(a==null||!a.encrypted||n){let l=this.tracks[r.level],h=this.vttCCs;h[r.cc]||(h[r.cc]={start:r.start,prevCC:this.prevCC,new:!0},this.prevCC=r.cc),l&&l.textCodec===hs?this._parseIMSC1(r,i):this._parseVTTs(t)}}else this.hls.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:Error("Empty subtitle payload")})}_parseIMSC1(e,t){let r=this.hls;bs(t,this.initPTS[e.cc],i=>{this._appendCues(i,e.level),r.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},i=>{r.logger.log(`Failed to parse IMSC1: ${i}`),r.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:i})})}_parseVTTs(e){var t;let{frag:r,payload:i}=e,{initPTS:a,unparsedVttFrags:n}=this,l=a.length-1;if(!a[r.cc]&&l===-1){n.push(e);return}let h=this.hls;(function(p,v,w,P,D,G,z){let H,oe=new Vo,Se=M(new Uint8Array(p)).trim().replace(qo,`
`).split(`
`),me=[],Te=v?function(Fe,rt=1){return Sa(Fe,9e4,1/rt)}(v.baseTime,v.timescale):0,Be="00:00.000",je=0,ge=0,ze=!0;oe.oncue=function(Fe){let rt=w[P],st=w.ccOffset,kt=(je-Te)/9e4;if(rt!=null&&rt.new&&(ge!==void 0?st=w.ccOffset=rt.start:Ko(w,P,kt)),kt){if(!v){H=Error("Missing initPTS for VTT MPEGTS");return}st=kt-w.presentationOffset}let Ye=Fe.endTime-Fe.startTime,et=ia((Fe.startTime+st-ge)*9e4,9e4*D)/9e4;Fe.startTime=Math.max(et,0),Fe.endTime=Math.max(et+Ye,0);let dt=Fe.text.trim();Fe.text=decodeURIComponent(encodeURIComponent(dt)),Fe.id||(Fe.id=lo(Fe.startTime,Fe.endTime,dt)),Fe.endTime>0&&me.push(Fe)},oe.onparsingerror=function(Fe){H=Fe},oe.onflush=function(){if(H){z(H);return}G(me)},Se.forEach(Fe=>{if(ze){if(oo(Fe,"X-TIMESTAMP-MAP=")){ze=!1,Fe.slice(16).split(",").forEach(rt=>{oo(rt,"LOCAL:")?Be=rt.slice(6):oo(rt,"MPEGTS:")&&(je=parseInt(rt.slice(7)))});try{ge=qn(Be)/1e3}catch(rt){H=rt}return}Fe===""&&(ze=!1)}oe.parse(Fe+`
`)}),oe.flush()})((t=r.initSegment)!=null&&t.data?tt(r.initSegment.data,new Uint8Array(i)).buffer:i,this.initPTS[r.cc],this.vttCCs,r.cc,r.start,p=>{this._appendCues(p,r.level),h.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:r})},p=>{let v=p.message==="Missing initPTS for VTT MPEGTS";v?n.push(e):this._fallbackToIMSC1(r,i),h.logger.log(`Failed to parse VTT cue: ${p}`),v&&l>r.cc||h.trigger(o.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:r,error:p})})}_fallbackToIMSC1(e,t){let r=this.tracks[e.level];r.textCodec||bs(t,this.initPTS[e.cc],()=>{r.textCodec=hs,this._parseIMSC1(e,t)},()=>{r.textCodec="wvtt"})}_appendCues(e,t){let r=this.hls;if(this.config.renderTextTracksNatively){let i=this.textTracks[t];if(!i||i.mode==="disabled")return;e.forEach(a=>gt(i,a))}else{let i=this.tracks[t];if(!i)return;let a=i.default?"default":"subtitles"+t;r.trigger(o.CUES_PARSED,{type:"subtitles",cues:e,track:a})}}onFragDecrypted(e,t){let{frag:r}=t;r.type===m.SUBTITLE&&this.onFragLoaded(o.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){if(!this.enabled||!this.config.enableCEA708Captions)return;let{frag:r,samples:i}=t;if(r.type!==m.MAIN||this.closedCaptionsForLevel(r)!=="NONE")for(let a=0;a<i.length;a++){let n=i[a].bytes;if(n){this.cea608Parser1||this.initCea608Parsers();let l=this.extractCea608Data(n);this.cea608Parser1.addData(i[a].pts,l[0]),this.cea608Parser2.addData(i[a].pts,l[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:r,endOffsetSubtitles:i,type:a}){let{media:n}=this;if(n&&!(n.currentTime<r)){if(!a||a==="video"){let{captionsTracks:l}=this;Object.keys(l).forEach(h=>Yt(l[h],t,r))}if(this.config.renderTextTracksNatively&&t===0&&i!==void 0){let{textTracks:l}=this;Object.keys(l).forEach(h=>Yt(l[h],t,i))}}}extractCea608Data(e){let t=[[],[]],r=31&e[0],i=2;for(let a=0;a<r;a++){let n=e[i++],l=127&e[i++],h=127&e[i++];if((l!==0||h!==0)&&(4&n)!=0){let p=3&n;(p===0||p===1)&&(t[p].push(l),t[p].push(h))}}return t}}function Ao(y){return y.characteristics&&/transcribes-spoken-dialog/gi.test(y.characteristics)&&/describes-music-and-sound/gi.test(y.characteristics)?"captions":"subtitles"}function js(y,e){return!!y&&y.kind===Ao(e)&&ds(e,y)}function Co(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}let Io=/\s/,Jo=/(\d+)-(\d+)\/(\d+)/;class Kn{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=null,this.response=null,this.controller=void 0,this.context=null,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||ho,this.controller=new ut.AbortController,this.stats=new ae}destroy(){this.loader=this.callbacks=this.context=this.config=this.request=null,this.abortInternal(),this.response=null,this.fetchSetup=this.controller=this.stats=null}abortInternal(){this.controller&&!this.stats.loading.end&&(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,r){let i=this.stats;if(i.loading.start)throw Error("Loader can only be used once.");i.loading.start=ut.performance.now();let a=function(v,w){let P={method:"GET",mode:"cors",credentials:"same-origin",signal:w,headers:new ut.Headers(_({},v.headers))};return v.rangeEnd&&P.headers.set("Range","bytes="+v.rangeStart+"-"+String(v.rangeEnd-1)),P}(e,this.controller.signal),n=e.responseType==="arraybuffer",l=n?"byteLength":"length",{maxTimeToFirstByteMs:h,maxLoadTimeMs:p}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=r,this.request=this.fetchSetup(e,a),ut.clearTimeout(this.requestTimeout),t.timeout=h&&x(h)?h:p,this.requestTimeout=ut.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},t.timeout),(ts(this.request)?this.request.then(ut.fetch):ut.fetch(this.request)).then(v=>{var w;this.response=this.loader=v;let P=Math.max(ut.performance.now(),i.loading.start);if(ut.clearTimeout(this.requestTimeout),t.timeout=p,this.requestTimeout=ut.setTimeout(()=>{this.callbacks&&(this.abortInternal(),this.callbacks.onTimeout(i,e,this.response))},p-(P-i.loading.start)),!v.ok){let{status:G,statusText:z}=v;throw new Bs(z||"fetch, bad network response",G,v)}i.loading.first=P,i.total=function(G){let z=G.get("Content-Range");if(z){let oe=function(Se){let me=Jo.exec(Se);if(me)return parseInt(me[2])-parseInt(me[1])+1}(z);if(x(oe))return oe}let H=G.get("Content-Length");if(H)return parseInt(H)}(v.headers)||i.total;let D=(w=this.callbacks)==null?void 0:w.onProgress;return D&&x(t.highWaterMark)?this.loadProgressively(v,i,e,t.highWaterMark,D):n?v.arrayBuffer():e.responseType==="json"?v.json():v.text()}).then(v=>{var w,P;let D=this.response;if(!D)throw Error("loader destroyed");ut.clearTimeout(this.requestTimeout),i.loading.end=Math.max(ut.performance.now(),i.loading.first);let G=v[l];G&&(i.loaded=i.total=G);let z={url:D.url,data:v,code:D.status},H=(w=this.callbacks)==null?void 0:w.onProgress;H&&!x(t.highWaterMark)&&H(i,e,v,D),(P=this.callbacks)==null||P.onSuccess(z,i,e,D)}).catch(v=>{var w;if(ut.clearTimeout(this.requestTimeout),i.aborted)return;let P=v&&v.code||0,D=v?v.message:null;(w=this.callbacks)==null||w.onError({code:P,text:D},e,v?v.details:null,i)})}getCacheAge(){let e=null;if(this.response){let t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,r,i=0,a){let n=new Nt,l=e.body.getReader(),h=()=>l.read().then(p=>{if(p.done)return n.dataLength&&a(t,r,n.flush().buffer,e),Promise.resolve(new ArrayBuffer(0));let v=p.value,w=v.length;return t.loaded+=w,w<i||n.dataLength?(n.push(v),n.dataLength>=i&&a(t,r,n.flush().buffer,e)):a(t,r,v.buffer,e),h()}).catch(()=>Promise.reject());return h()}}function ho(y,e){return new ut.Request(y.url,e)}class Bs extends Error{constructor(e,t,r){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=r}}let Ts=/^age:\s*[\d.]+\s*$/im;class Gs{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=null,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new ae,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null,this.context=null,this.xhrSetup=null}abortInternal(){let e=this.loader;ut.clearTimeout(this.requestTimeout),ut.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,e.readyState!==4&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),(e=this.callbacks)!=null&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,r){if(this.stats.loading.start)throw Error("Loader can only be used once.");this.stats.loading.start=ut.performance.now(),this.context=e,this.config=t,this.callbacks=r,this.loadInternal()}loadInternal(){let{config:e,context:t}=this;if(!e||!t)return;let r=this.loader=new ut.XMLHttpRequest,i=this.stats;i.loading.first=0,i.loaded=0,i.aborted=!1;let a=this.xhrSetup;a?Promise.resolve().then(()=>{if(this.loader===r&&!this.stats.aborted)return a(r,t.url)}).catch(n=>{if(this.loader===r&&!this.stats.aborted)return r.open("GET",t.url,!0),a(r,t.url)}).then(()=>{this.loader!==r||this.stats.aborted||this.openAndSendXhr(r,t,e)}).catch(n=>{var l;(l=this.callbacks)==null||l.onError({code:r.status,text:n.message},t,r,i)}):this.openAndSendXhr(r,t,e)}openAndSendXhr(e,t,r){e.readyState||e.open("GET",t.url,!0);let i=t.headers,{maxTimeToFirstByteMs:a,maxLoadTimeMs:n}=r.loadPolicy;if(i)for(let l in i)e.setRequestHeader(l,i[l]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,ut.clearTimeout(this.requestTimeout),r.timeout=a&&x(a)?a:n,this.requestTimeout=ut.setTimeout(this.loadtimeout.bind(this),r.timeout),e.send()}readystatechange(){let{context:e,loader:t,stats:r}=this;if(!e||!t)return;let i=t.readyState,a=this.config;if(!r.aborted&&i>=2&&(r.loading.first===0&&(r.loading.first=Math.max(ut.performance.now(),r.loading.start),a.timeout!==a.loadPolicy.maxLoadTimeMs&&(ut.clearTimeout(this.requestTimeout),a.timeout=a.loadPolicy.maxLoadTimeMs,this.requestTimeout=ut.setTimeout(this.loadtimeout.bind(this),a.loadPolicy.maxLoadTimeMs-(r.loading.first-r.loading.start)))),i===4)){var n,l,h;ut.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let p=t.status,v=t.responseType==="text"?t.responseText:null;if(p>=200&&p<300){let P=v??t.response;if(P!=null){r.loading.end=Math.max(ut.performance.now(),r.loading.first);let D=t.responseType==="arraybuffer"?P.byteLength:P.length;r.loaded=r.total=D,r.bwEstimate=8e3*r.total/(r.loading.end-r.loading.first);let G=(n=this.callbacks)==null?void 0:n.onProgress;G&&G(r,e,P,t);let z={url:t.responseURL,data:P,code:p};(l=this.callbacks)==null||l.onSuccess(z,r,e,t);return}}let w=a.loadPolicy.errorRetry;zr(w,r.retry,!1,{url:e.url,data:void 0,code:p})?this.retry(w):(se.error(`${p} while loading ${e.url}`),(h=this.callbacks)==null||h.onError({code:p,text:t.statusText},e,t,r))}}loadtimeout(){if(!this.config)return;let e=this.config.loadPolicy.timeoutRetry;if(zr(e,this.stats.retry,!0))this.retry(e);else{var t;se.warn(`timeout while loading ${(t=this.context)==null?void 0:t.url}`);let r=this.callbacks;r&&(this.abortInternal(),r.onTimeout(this.stats,this.context,this.loader))}}retry(e){let{context:t,stats:r}=this;this.retryDelay=Bi(e,r.retry),r.retry++,se.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t?.url}, retrying ${r.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,ut.clearTimeout(this.retryTimeout),this.retryTimeout=ut.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){let t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&Ts.test(this.loader.getAllResponseHeaders())){let t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}let fo=F(F({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,maxDevicePixelRatio:Number.POSITIVE_INFINITY,preferManagedMediaSource:!0,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,frontBufferFlushThreshold:1/0,startOnSegmentBoundary:!1,maxBufferSize:6e7,maxFragLookUpTolerance:.25,maxBufferHole:.1,detectStallWithCurrentTimeMs:1250,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,nudgeOnVideoHole:!0,liveSyncMode:"edge",liveSyncDurationCount:3,liveSyncOnStallIncrease:1,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,ignorePlaylistParsingErrors:!1,loader:Gs,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:ai,bufferController:Cs,capLevelController:Va,errorController:Na,fpsController:wt,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrEwmaDefaultEstimateMax:5e6,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:ci,requireKeySystemAccessOnStart:!1,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableEmsgKLVMetadata:!1,enableID3MetadataCues:!0,enableInterstitialPlayback:!0,interstitialAppendInPlace:!0,interstitialLiveLookAhead:10,useMediaCapabilities:!0,preserveManualLevelOnError:!1,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},interstitialAssetListLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:3e4,timeoutRetry:{maxNumRetry:0,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:0,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:{newCue(y,e,t,r){let i,a,n,l,h,p=[],v=ut.VTTCue||ut.TextTrackCue;for(let P=0;P<r.rows.length;P++)if(i=r.rows[P],n=!0,l=0,h="",!i.isEmpty()){var w;for(let z=0;z<i.chars.length;z++)Io.test(i.chars[z].uchar)&&n?l++:(h+=i.chars[z].uchar,n=!1);i.cueStartTime=e,e===t&&(t+=1e-4),l>=16?l--:l++;let D=_o(h.trim()),G=lo(e,t,D);y!=null&&(w=y.cues)!=null&&w.getCueById(G)||((a=new v(e,t,D)).id=G,a.line=P+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*l/32)),p.push(a))}return y&&p.length&&(p.sort((P,D)=>P.line==="auto"||D.line==="auto"?0:P.line>8&&D.line>8?D.line-P.line:P.line-D.line),p.forEach(P=>gt(y,P))),p}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:Fn,subtitleTrackController:va,timelineController:xs,audioStreamController:vo,audioTrackController:us,emeController:xr,cmcdController:jt,contentSteeringController:Et,interstitialsController:Ma});class Lo extends Yn{constructor(e,t){super("gap-controller",e.logger),this.hls=void 0,this.fragmentTracker=void 0,this.media=null,this.mediaSource=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.buffered={},this.lastCurrentTime=0,this.ended=0,this.waiting=0,this.onMediaPlaying=()=>{this.ended=0,this.waiting=0},this.onMediaWaiting=()=>{var r;(r=this.media)!=null&&r.seeking||(this.waiting=ut.performance.now(),this.tick())},this.onMediaEnded=()=>{if(this.hls){var r;this.ended=((r=this.media)==null?void 0:r.currentTime)||1,this.hls.trigger(o.MEDIA_ENDED,{stalled:!1})}},this.hls=e,this.fragmentTracker=t,this.registerListeners()}registerListeners(){let{hls:e}=this;e&&(e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.BUFFER_APPENDED,this.onBufferAppended,this))}unregisterListeners(){let{hls:e}=this;e&&(e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.BUFFER_APPENDED,this.onBufferAppended,this))}destroy(){super.destroy(),this.unregisterListeners(),this.media=this.hls=this.fragmentTracker=null,this.mediaSource=void 0}onMediaAttached(e,t){this.setInterval(100),this.mediaSource=t.mediaSource;let r=this.media=t.media;ot(r,"playing",this.onMediaPlaying),ot(r,"waiting",this.onMediaWaiting),ot(r,"ended",this.onMediaEnded)}onMediaDetaching(e,t){this.clearInterval();let{media:r}=this;r&&(Ot(r,"playing",this.onMediaPlaying),Ot(r,"waiting",this.onMediaWaiting),Ot(r,"ended",this.onMediaEnded),this.media=null),this.mediaSource=void 0}onBufferAppended(e,t){this.buffered=t.timeRanges}get hasBuffered(){return Object.keys(this.buffered).length>0}tick(){var e;if(!((e=this.media)!=null&&e.readyState)||!this.hasBuffered)return;let t=this.media.currentTime;this.poll(t,this.lastCurrentTime),this.lastCurrentTime=t}poll(e,t){var r,i,a;let n=(r=this.hls)==null?void 0:r.config;if(!n)return;let l=this.media;if(!l)return;let{seeking:h}=l,p=this.seeking&&!h,v=!this.seeking&&h,w=l.paused&&!h||l.ended||l.playbackRate===0;if(this.seeking=h,e!==t){t&&(this.ended=0),this.moved=!0,!h&&(this.nudgeRetry=0,n.nudgeOnVideoHole&&!w&&e>t&&this.nudgeOnVideoHole(e,t)),this.waiting===0&&this.stallResolved(e);return}if(v||p){p&&this.stallResolved(e);return}if(w){this.nudgeRetry=0,this.stallResolved(e),!this.ended&&l.ended&&this.hls&&(this.ended=e||1,this.hls.trigger(o.MEDIA_ENDED,{stalled:!1}));return}if(!le.getBuffered(l).length){this.nudgeRetry=0;return}let P=le.bufferInfo(l,e,0),D=P.nextStart||0,G=this.fragmentTracker;if(h&&G&&this.hls){let je=Po(this.hls.inFlightFragments,e),ge=P.len>2,ze=!D||je||D-e>2&&!G.getPartialFragment(e);if(ge||ze)return;this.moved=!1}let z=(i=this.hls)==null?void 0:i.latestLevelDetails;if(!this.moved&&this.stalled!==null&&G){if(!(P.len>0)&&!D)return;let je=Math.max(D,P.start||0)-e,ge=z!=null&&z.live?2*z.targetduration:2,ze=Hs(e,G);if(je>0&&(je<=ge||ze)){l.paused||this._trySkipBufferHole(ze);return}}let H=n.detectStallWithCurrentTimeMs,oe=ut.performance.now(),Se=this.waiting,me=this.stalled;if(me===null)if(Se>0&&oe-Se<H)me=this.stalled=Se;else{this.stalled=oe;return}let Te=oe-me;if(!h&&(Te>=H||Se)&&this.hls){if(((a=this.mediaSource)==null?void 0:a.readyState)==="ended"&&!(z!=null&&z.live)&&1>Math.abs(e-(z?.edge||0))){if(this.ended)return;this.ended=e||1,this.hls.trigger(o.MEDIA_ENDED,{stalled:!0});return}if(this._reportStall(P),!this.media||!this.hls)return}let Be=le.bufferInfo(l,e,n.maxBufferHole);this._tryFixBufferStall(Be,Te,e)}stallResolved(e){let t=this.stalled;if(t&&this.hls&&(this.stalled=null,this.stallReported)){let r=ut.performance.now()-t;this.log(`playback not stuck anymore @${e}, after ${Math.round(r)}ms`),this.stallReported=!1,this.waiting=0,this.hls.trigger(o.STALL_RESOLVED,{})}}nudgeOnVideoHole(e,t){var r;let i=this.buffered.video;if(this.hls&&this.media&&this.fragmentTracker&&(r=this.buffered.audio)!=null&&r.length&&i&&i.length>1&&e>i.end(0)){let a=le.bufferedInfo(le.timeRangesToArray(this.buffered.audio),e,0);if(a.len>1&&t>=a.start){let n=le.timeRangesToArray(i),l=le.bufferedInfo(n,t,0).bufferedIndex;if(l>-1&&l<n.length-1){let h=le.bufferedInfo(n,e,0).bufferedIndex,p=n[l].end,v=n[l+1].start;if((h===-1||h>l)&&v-p<1&&e-p<2){let w=Error(`nudging playhead to flush pipeline after video hole. currentTime: ${e} hole: ${p} -> ${v} buffered index: ${h}`);this.warn(w.message),this.media.currentTime+=1e-6;let P=Hs(e,this.fragmentTracker);P&&"fragment"in P?P=P.fragment:P||(P=void 0);let D=le.bufferInfo(this.media,e,0);this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:w,reason:w.message,frag:P,buffer:D.len,bufferInfo:D})}}}}}_tryFixBufferStall(e,t,r){var i,a;let{fragmentTracker:n,media:l}=this,h=(i=this.hls)==null?void 0:i.config;if(!l||!n||!h)return;let p=(a=this.hls)==null?void 0:a.latestLevelDetails,v=Hs(r,n);if((v||p!=null&&p.live&&r<p.fragmentStart)&&(this._trySkipBufferHole(v)||!this.media))return;let w=e.buffered,P=this.adjacentTraversal(e,r);(w&&w.length>1&&e.len>h.maxBufferHole||e.nextStart&&(e.nextStart-r<h.maxBufferHole||P))&&(t>1e3*h.highBufferWatchdogPeriod||this.waiting)&&(this.warn("Trying to nudge playhead over buffer-hole"),this._tryNudgeBuffer(e))}adjacentTraversal(e,t){let r=this.fragmentTracker,i=e.nextStart;if(r&&i){let a=r.getFragAtPos(t,m.MAIN),n=r.getFragAtPos(i,m.MAIN);if(a&&n)return n.sn-a.sn<2}return!1}_reportStall(e){let{hls:t,media:r,stallReported:i,stalled:a}=this;if(!i&&a!==null&&r&&t){this.stallReported=!0;let n=Error(`Playback stalling at @${r.currentTime} due to low buffer (${Xt(e)})`);this.warn(n.message),t.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_STALLED_ERROR,fatal:!1,error:n,buffer:e.len,bufferInfo:e,stalled:{start:a}})}}_trySkipBufferHole(e){var t,r;let{fragmentTracker:i,media:a}=this,n=(t=this.hls)==null?void 0:t.config;if(!a||!i||!n)return 0;let l=a.currentTime,h=le.bufferInfo(a,l,0),p=l<h.start?h.start:h.nextStart;if(p&&this.hls){let v=h.len<=n.maxBufferHole,w=h.len>0&&h.len<1&&a.readyState<3,P=p-l;if(P>0&&(v||w)){if(P>n.maxBufferHole){let G=!1;if(l===0){let z=i.getAppendedFrag(0,m.MAIN);z&&p<z.end&&(G=!0)}if(!G&&e){if(!((r=this.hls.loadLevelObj)!=null&&r.details)||Po(this.hls.inFlightFragments,p))return 0;let z=!1,H=e.end;for(;H<p;){let oe=Hs(H,i);if(oe)H+=oe.duration;else{z=!0;break}}if(z)return 0}}let D=Math.max(p+.05,l+.1);if(this.warn(`skipping hole, adjusting currentTime from ${l} to ${D}`),this.moved=!0,a.currentTime=D,!(e!=null&&e.gap)){let G=Error(`fragment loaded with buffer holes, seeking from ${l} to ${D}`),z={type:S.MEDIA_ERROR,details:d.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:G,reason:G.message,buffer:h.len,bufferInfo:h};e&&("fragment"in e?z.part=e:z.frag=e),this.hls.trigger(o.ERROR,z)}return D}}return 0}_tryNudgeBuffer(e){let{hls:t,media:r,nudgeRetry:i}=this,a=t?.config;if(!r||!a)return 0;let n=r.currentTime;if(this.nudgeRetry++,i<a.nudgeMaxRetry){let l=n+(i+1)*a.nudgeOffset,h=Error(`Nudging 'currentTime' from ${n} to ${l}`);this.warn(h.message),r.currentTime=l,t.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_NUDGE_ON_STALL,error:h,fatal:!1,buffer:e.len,bufferInfo:e})}else{let l=Error(`Playhead still not moving while enough data buffered @${n} after ${a.nudgeMaxRetry} nudges`);this.error(l.message),t.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.BUFFER_STALLED_ERROR,error:l,fatal:!0,buffer:e.len,bufferInfo:e})}}}function Po(y,e){let t=po(y.main);if(t&&t.start<=e)return t;let r=po(y.audio);return r&&r.start<=e?r:null}function po(y){if(!y)return null;switch(y.state){case Ie.IDLE:case Ie.STOPPED:case Ie.ENDED:case Ie.ERROR:return null}return y.frag}function Hs(y,e){return e.getAppendedFrag(y,m.MAIN)||e.getPartialFragment(y)}function Es(){if(typeof ut<"u")return ut.VTTCue||ut.TextTrackCue}function ws(y,e,t,r,i){let a=new y(e,t,"");try{a.value=r,i&&(a.type=i)}catch{a=new y(e,t,Xt(i?F({type:i},r):r))}return a}let Vs=(()=>{let y=Es();try{y&&new y(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();class go{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.removeCues=!0,this.assetCue=void 0,this.onEventCueEnter=()=>{this.hls&&this.hls.trigger(o.EVENT_CUE_ENTER,{})},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=this.onEventCueEnter=null}_registerListeners(){let{hls:e}=this;e&&(e.on(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(o.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}_unregisterListeners(){let{hls:e}=this;e&&(e.off(o.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(o.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(o.LEVEL_PTS_UPDATED,this.onLevelPtsUpdated,this))}onMediaAttaching(e,t){var r;this.media=t.media,((r=t.overrides)==null?void 0:r.cueRemoval)===!1&&(this.removeCues=!1)}onMediaAttached(){var e;let t=(e=this.hls)==null?void 0:e.latestLevelDetails;t&&this.updateDateRangeCues(t)}onMediaDetaching(e,t){this.media=null,t.transferMedia||(this.id3Track&&(this.removeCues&&ei(this.id3Track,this.onEventCueEnter),this.id3Track=null),this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){let t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){let r=e[t];if(r.kind==="metadata"&&r.label==="id3")return Ra(r,this.media),r}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media||!this.hls)return;let{enableEmsgMetadataCues:r,enableID3MetadataCues:i}=this.hls.config;if(!r&&!i)return;let{samples:a}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));let n=Es();if(n)for(let l=0;l<a.length;l++){let h=a[l].type;if(h===ra.emsg&&!r||!i)continue;let p=qi(a[l].data),v=a[l].pts,w=v+a[l].duration;w>Vs&&(w=Vs),w-v<=0&&(w=v+.25);for(let P=0;P<p.length;P++){let D=p[P];if(!wa(D)){this.updateId3CueEnds(v,h);let G=ws(n,v,w,D,h);G&&this.id3Track.addCue(G)}}}}updateId3CueEnds(e,t){var r;let i=(r=this.id3Track)==null?void 0:r.cues;if(i)for(let a=i.length;a--;){let n=i[a];n.type===t&&n.startTime<e&&n.endTime===Vs&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:r,type:i}){let{id3Track:a,hls:n}=this;if(!n)return;let{config:{enableEmsgMetadataCues:l,enableID3MetadataCues:h}}=n;a&&(l||h)&&Yt(a,t,r,i==="audio"?p=>p.type===ra.audioId3&&h:i==="video"?p=>p.type===ra.emsg&&l:p=>p.type===ra.audioId3&&h||p.type===ra.emsg&&l)}onLevelUpdated(e,{details:t}){this.updateDateRangeCues(t,!0)}onLevelPtsUpdated(e,t){Math.abs(t.drift)>.01&&this.updateDateRangeCues(t.details)}updateDateRangeCues(e,t){var r,i;if(!this.hls||!this.media)return;let{assetPlayerId:a,timelineOffset:n,enableDateRangeMetadataCues:l,interstitialsController:h}=this.hls.config;if(!l)return;let p=Es();if(a&&n&&!h){let{fragmentStart:z,fragmentEnd:H}=e,oe=this.assetCue;oe?(oe.startTime=z,oe.endTime=H):p&&(oe=this.assetCue=ws(p,z,H,{assetPlayerId:this.hls.config.assetPlayerId},"hlsjs.interstitial.asset"))&&(oe.id=a,this.id3Track||(this.id3Track=this.createTrack(this.media)),this.id3Track.addCue(oe),oe.addEventListener("enter",this.onEventCueEnter))}if(!e.hasProgramDateTime)return;let{id3Track:v}=this,{dateRanges:w}=e,P=Object.keys(w),D=this.dateRangeCuesAppended;if(v&&t)if((r=v.cues)!=null&&r.length){let z=Object.keys(D).filter(H=>!P.includes(H));for(let H=z.length;H--;){let oe=z[H],Se=(i=D[oe])==null?void 0:i.cues;delete D[oe],Se&&Object.keys(Se).forEach(me=>{let Te=Se[me];if(Te){Te.removeEventListener("enter",this.onEventCueEnter);try{v.removeCue(Te)}catch{}}})}}else D=this.dateRangeCuesAppended={};let G=e.fragments[e.fragments.length-1];if(P.length!==0&&x(G?.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(let z=0;z<P.length;z++){let H=P[z],oe=w[H],Se=oe.startTime,me=D[H],Te=me?.cues||{},Be=me?.durationKnown||!1,je=Vs,{duration:ge,endDate:ze}=oe;if(ze&&ge!==null)je=Se+ge,Be=!0;else if(oe.endOnNext&&!Be){let rt=P.reduce((st,kt)=>{if(kt!==oe.id){let Ye=w[kt];if(Ye.class===oe.class&&Ye.startDate>oe.startDate&&(!st||oe.startDate<st.startDate))return Ye}return st},null);rt&&(je=rt.startTime,Be=!0)}let Fe=Object.keys(oe.attr);for(let rt=0;rt<Fe.length;rt++){let st=Fe[rt];if(!(st!=="ID"&&st!=="CLASS"&&st!=="CUE"&&st!=="START-DATE"&&st!=="DURATION"&&st!=="END-DATE"&&st!=="END-ON-NEXT"))continue;let kt=Te[st];if(kt)Be&&!(me!=null&&me.durationKnown)?kt.endTime=je:Math.abs(kt.startTime-Se)>.01&&(kt.startTime=Se,kt.endTime=je);else if(p){let Ye=oe.attr[st];(st==="SCTE35-OUT"||st==="SCTE35-IN"||st==="SCTE35-CMD")&&(Ye=N(Ye));let et=ws(p,Se,je,{key:st,data:Ye},ra.dateRange);et&&(et.id=H,this.id3Track.addCue(et),Te[st]=et,h&&(st==="X-ASSET-LIST"||st==="X-ASSET-URL")&&et.addEventListener("enter",this.onEventCueEnter))}}D[H]={cues:Te,dateRange:oe,durationKnown:Be}}}}}class Wo{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.currentTime=0,this.stallCount=0,this._latency=null,this._targetLatencyUpdated=!1,this.onTimeupdate=()=>{let{media:t}=this,r=this.levelDetails;if(!t||!r)return;this.currentTime=t.currentTime;let i=this.computeLatency();if(i===null)return;this._latency=i;let{lowLatencyMode:a,maxLiveSyncPlaybackRate:n}=this.config;if(!a||n===1||!r.live)return;let l=this.targetLatency;if(l===null)return;let h=i-l;if(h<Math.min(this.maxLatency,l+r.targetduration)&&h>.05&&this.forwardBufferLength>1){let p=Math.round(2/(1+Math.exp(-.75*h-this.edgeStalled))*20)/20;this.changeMediaPlaybackRate(t,Math.min(Math.min(2,Math.max(1,n)),Math.max(1,p)))}else t.playbackRate!==1&&t.playbackRate!==0&&this.changeMediaPlaybackRate(t,1)},this.hls=e,this.config=e.config,this.registerListeners()}get levelDetails(){var e;return((e=this.hls)==null?void 0:e.latestLevelDetails)||null}get latency(){return this._latency||0}get maxLatency(){let{config:e}=this;if(e.liveMaxLatencyDuration!==void 0)return e.liveMaxLatencyDuration;let t=this.levelDetails;return t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){let e=this.levelDetails;if(e===null||this.hls===null)return null;let{holdBack:t,partHoldBack:r,targetduration:i}=e,{liveSyncDuration:a,liveSyncDurationCount:n,lowLatencyMode:l}=this.config,h=this.hls.userConfig,p=l&&r||t;return(this._targetLatencyUpdated||h.liveSyncDuration||h.liveSyncDurationCount||p===0)&&(p=a!==void 0?a:n*i),p+Math.min(this.stallCount*this.config.liveSyncOnStallIncrease,i)}set targetLatency(e){this.stallCount=0,this.config.liveSyncDuration=e,this._targetLatencyUpdated=!0}get liveSyncPosition(){let e=this.estimateLiveEdge(),t=this.targetLatency;if(e===null||t===null)return null;let r=this.levelDetails;if(r===null)return null;let i=r.edge,a=e-t-this.edgeStalled;return Math.min(Math.max(i-r.totalduration,a),i-(this.config.lowLatencyMode&&r.partTarget||r.targetduration))}get drift(){let e=this.levelDetails;return e===null?1:e.drift}get edgeStalled(){let e=this.levelDetails;if(e===null)return 0;let t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){let{media:e}=this,t=this.levelDetails;if(!e||!t)return 0;let r=e.buffered.length;return(r?e.buffered.end(r-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.hls=null}registerListeners(){let{hls:e}=this;e&&(e.on(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(o.ERROR,this.onError,this))}unregisterListeners(){let{hls:e}=this;e&&(e.off(o.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(o.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(o.ERROR,this.onError,this))}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.onTimeupdate)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.onTimeupdate),this.media=null)}onManifestLoading(){this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){t.advanced&&this.onTimeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.onTimeupdate)}onError(e,t){var r;t.details===d.BUFFER_STALLED_ERROR&&(this.stallCount++,this.hls&&(r=this.levelDetails)!=null&&r.live&&this.hls.logger.warn("[latency-controller]: Stall detected, adjusting target latency"))}changeMediaPlaybackRate(e,t){var r,i;e.playbackRate!==t&&((r=this.hls)==null||r.logger.debug(`[latency-controller]: latency=${this.latency.toFixed(3)}, targetLatency=${(i=this.targetLatency)==null?void 0:i.toFixed(3)}, forwardBufferLength=${this.forwardBufferLength.toFixed(3)}: adjusting playback rate from ${e.playbackRate} to ${t}`),e.playbackRate=t)}estimateLiveEdge(){let e=this.levelDetails;return e===null?null:e.edge+e.age}computeLatency(){let e=this.estimateLiveEdge();return e===null?null:e-this.currentTime}}class zo extends As{constructor(e,t){super(e,"level-controller"),this._levels=[],this._firstLevel=-1,this._maxAutoLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(o.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.FRAG_BUFFERED,this.onFragBuffered,this),e.on(o.ERROR,this.onError,this)}_unregisterListeners(){let{hls:e}=this;e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(o.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.FRAG_BUFFERED,this.onFragBuffered,this),e.off(o.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}stopLoad(){this._levels.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.stopLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[],this._maxAutoLevel=-1}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){let r=this.hls.config.preferManagedMediaSource,i=[],a={},n={},l=!1,h=!1,p=!1;t.levels.forEach(v=>{let w=v.attrs,{audioCodec:P,videoCodec:D}=v;P&&(v.audioCodec=P=hr(P,r)||void 0),D&&(D=v.videoCodec=function(rt){let st=rt.split(",");for(let kt=0;kt<st.length;kt++){let Ye=st[kt].split(".");Ye.length>2&&Ye[0]==="avc1"&&(st[kt]=`avc1.${parseInt(Ye[1]).toString(16)}${("000"+parseInt(Ye[2]).toString(16)).slice(-4)}`)}return st.join(",")}(D));let{width:G,height:z,unknownCodecs:H}=v,oe=H?H.length:0;if(H)for(let rt=oe;rt--;){let st=H[rt];this.isAudioSupported(st)?(v.audioCodec=P=P?`${P},${st}`:st,oe--,cr.audio[P.substring(0,4)]=2):this.isVideoSupported(st)&&(v.videoCodec=D=D?`${D},${st}`:st,oe--,cr.video[D.substring(0,4)]=2)}if(l||(l=!!(G&&z)),h||(h=!!D),p||(p=!!P),oe||P&&!this.isAudioSupported(P)||D&&!this.isVideoSupported(D)){this.log(`Some or all CODECS not supported "${w.CODECS}"`);return}let{CODECS:Se,"FRAME-RATE":me,"HDCP-LEVEL":Te,"PATHWAY-ID":Be,RESOLUTION:je,"VIDEO-RANGE":ge}=w,ze=`${Be||"."}-`,Fe=`${ze}${v.bitrate}-${je}-${me}-${Se}-${ge}-${Te}`;if(a[Fe])if(a[Fe].uri===v.url||v.attrs["PATHWAY-ID"])a[Fe].addGroupId("audio",w.AUDIO),a[Fe].addGroupId("text",w.SUBTITLES);else{let rt=n[Fe]+=1;v.attrs["PATHWAY-ID"]=Array(rt+1).join(".");let st=this.createLevel(v);a[Fe]=st,i.push(st)}else{let rt=this.createLevel(v);a[Fe]=rt,n[Fe]=1,i.push(rt)}}),this.filterAndSortMediaOptions(i,t,l,h,p)}createLevel(e){let t=new Wr(e),r=e.supplemental;if(r!=null&&r.videoCodec&&!this.isVideoSupported(r.videoCodec)){let i=Error(`SUPPLEMENTAL-CODECS not supported "${r.videoCodec}"`);this.log(i.message),t.supportedResult=Kr(i,[])}return t}isAudioSupported(e){return Ht(e,"audio",this.hls.config.preferManagedMediaSource)}isVideoSupported(e){return Ht(e,"video",this.hls.config.preferManagedMediaSource)}filterAndSortMediaOptions(e,t,r,i,a){let n=[],l=[],h=e;if((r||i)&&a&&(h=h.filter(({videoCodec:H,videoRange:oe,width:Se,height:me})=>{var Te;return(!!H||!!(Se&&me))&&!!(Te=oe)&&Dr.indexOf(Te)>-1})),h.length===0){Promise.resolve().then(()=>{if(this.hls){let H="no level with compatible codecs found in manifest",oe=H;t.levels.length&&(oe=`one or more CODECS in variant not supported: ${Xt(t.levels.map(me=>me.attrs.CODECS).filter((me,Te,Be)=>Be.indexOf(me)===Te))}`,this.warn(oe),H+=` (${oe})`);let Se=Error(H);this.hls.trigger(o.ERROR,{type:S.MEDIA_ERROR,details:d.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:Se,reason:oe})}});return}t.audioTracks&&Do(n=t.audioTracks.filter(H=>!H.audioCodec||this.isAudioSupported(H.audioCodec))),t.subtitles&&Do(l=t.subtitles);let p=h.slice(0);h.sort((H,oe)=>{if(H.attrs["HDCP-LEVEL"]!==oe.attrs["HDCP-LEVEL"])return(H.attrs["HDCP-LEVEL"]||"")>(oe.attrs["HDCP-LEVEL"]||"")?1:-1;if(r&&H.height!==oe.height)return H.height-oe.height;if(H.frameRate!==oe.frameRate)return H.frameRate-oe.frameRate;if(H.videoRange!==oe.videoRange)return Dr.indexOf(H.videoRange)-Dr.indexOf(oe.videoRange);if(H.videoCodec!==oe.videoCodec){let Se=Oi(H.videoCodec),me=Oi(oe.videoCodec);if(Se!==me)return me-Se}if(H.uri===oe.uri&&H.codecSet!==oe.codecSet){let Se=li(H.codecSet),me=li(oe.codecSet);if(Se!==me)return me-Se}return H.averageBitrate!==oe.averageBitrate?H.averageBitrate-oe.averageBitrate:0});let v=p[0];if(this.steering&&(h=this.steering.filterParsedLevels(h)).length!==p.length){for(let H=0;H<p.length;H++)if(p[H].pathwayId===h[0].pathwayId){v=p[H];break}}this._levels=h;for(let H=0;H<h.length;H++)if(h[H]===v){var w;this._firstLevel=H;let oe=v.bitrate,Se=this.hls.bandwidthEstimate;if(this.log(`manifest loaded, ${h.length} level(s) found, first bitrate: ${oe}`),((w=this.hls.userConfig)==null?void 0:w.abrEwmaDefaultEstimate)===void 0){let me=Math.min(oe,this.hls.config.abrEwmaDefaultEstimateMax);me>Se&&Se===this.hls.abrEwmaDefaultEstimate&&(this.hls.bandwidthEstimate=me)}break}let P=a&&!i,D=this.hls.config,G=!!(D.audioStreamController&&D.audioTrackController),z={levels:h,audioTracks:n,subtitleTracks:l,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:a,video:i,altAudio:G&&!P&&n.some(H=>!!H.url)};this.hls.trigger(o.MANIFEST_PARSED,z)}get levels(){return this._levels.length===0?null:this._levels}get loadLevelObj(){return this.currentLevel}get level(){return this.currentLevelIndex}set level(e){let t=this._levels;if(t.length===0)return;if(e<0||e>=t.length){let v=Error("invalid level idx"),w=e<0;if(this.hls.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.LEVEL_SWITCH_ERROR,level:e,fatal:w,error:v,reason:v.message}),w)return;e=Math.min(e,t.length-1)}let r=this.currentLevelIndex,i=this.currentLevel,a=i?i.attrs["PATHWAY-ID"]:void 0,n=t[e],l=n.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=n,r===e&&i&&a===l)return;this.log(`Switching to level ${e} (${n.height?n.height+"p ":""}${n.videoRange?n.videoRange+" ":""}${n.codecSet?n.codecSet+" ":""}@${n.bitrate})${l?" with Pathway "+l:""} from level ${r}${a?" with Pathway "+a:""}`);let h={level:e,attrs:n.attrs,details:n.details,bitrate:n.bitrate,averageBitrate:n.averageBitrate,maxBitrate:n.maxBitrate,realBitrate:n.realBitrate,width:n.width,height:n.height,codecSet:n.codecSet,audioCodec:n.audioCodec,videoCodec:n.videoCodec,audioGroups:n.audioGroups,subtitleGroups:n.subtitleGroups,loaded:n.loaded,loadError:n.loadError,fragmentError:n.fragmentError,name:n.name,id:n.id,uri:n.uri,url:n.url,urlId:0,audioGroupIds:n.audioGroupIds,textGroupIds:n.textGroupIds};this.hls.trigger(o.LEVEL_SWITCHING,h);let p=n.details;if(!p||p.live){let v=this.switchParams(n.uri,i?.details,p);this.loadPlaylist(v)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,this._startLevel===void 0&&(this._startLevel=e),e!==-1&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(this._startLevel===void 0){let e=this.hls.config.startLevel;return e!==void 0?e:this.hls.firstAutoLevel}return this._startLevel}set startLevel(e){this._startLevel=e}get pathways(){return this.steering?this.steering.pathways():[]}get pathwayPriority(){return this.steering?this.steering.pathwayPriority:null}set pathwayPriority(e){if(this.steering){let t=this.steering.pathways(),r=e.filter(i=>t.indexOf(i)!==-1);if(e.length<1){this.warn(`pathwayPriority ${e} should contain at least one pathway from list: ${t}`);return}this.steering.pathwayPriority=r}}onError(e,t){!t.fatal&&t.context&&t.context.type===f.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragBuffered(e,{frag:t}){if(t!==void 0&&t.type===m.MAIN){let r=t.elementaryStreams;if(!Object.keys(r).some(a=>!!r[a]))return;let i=this._levels[t.level];i!=null&&i.loadError&&(this.log(`Resetting level error count of ${i.loadError} on frag buffered`),i.loadError=0)}}onLevelLoaded(e,t){var r,i;let{level:a,details:n}=t,l=t.levelInfo;if(!l){this.warn(`Invalid level index ${a}`),(i=t.deliveryDirectives)!=null&&i.skip&&(n.deltaUpdateFailed=!0);return}if(l===this.currentLevel||t.withoutMultiVariant){l.fragmentError===0&&(l.loadError=0);let h=l.details;h===t.details&&h.advanced&&(h=void 0),this.playlistLoaded(a,t,h)}else(r=t.deliveryDirectives)!=null&&r.skip&&(n.deltaUpdateFailed=!0)}loadPlaylist(e){super.loadPlaylist(),this.shouldLoadPlaylist(this.currentLevel)&&this.scheduleLoading(this.currentLevel,e)}loadingPlaylist(e,t){super.loadingPlaylist(e,t);let r=this.getUrlWithDirectives(e.uri,t),i=this.currentLevelIndex,a=e.attrs["PATHWAY-ID"],n=e.details,l=n?.age;this.log(`Loading level index ${i}${t?.msn!==void 0?" at sn "+t.msn+" part "+t.part:""}${a?" Pathway "+a:""}${l&&n.live?" age "+l.toFixed(1)+(n.type?" "+n.type:""):""} ${r}`),this.hls.trigger(o.LEVEL_LOADING,{url:r,level:i,levelInfo:e,pathwayId:e.attrs["PATHWAY-ID"],id:0,deliveryDirectives:t||null})}get nextLoadLevel(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=e)}removeLevel(e){var t;if(this._levels.length===1)return;let r=this._levels.filter((a,n)=>n!==e||(this.steering&&this.steering.removeLevel(a),a===this.currentLevel&&(this.currentLevel=null,this.currentLevelIndex=-1,a.details&&a.details.fragments.forEach(l=>l.level=-1)),!1));We(r),this._levels=r,this.currentLevelIndex>-1&&(t=this.currentLevel)!=null&&t.details&&(this.currentLevelIndex=this.currentLevel.details.fragments[0].level),this.manualLevelIndex>-1&&(this.manualLevelIndex=this.currentLevelIndex);let i=r.length-1;this._firstLevel=Math.min(this._firstLevel,i),this._startLevel&&(this._startLevel=Math.min(this._startLevel,i)),this.hls.trigger(o.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){this._levels=t}checkMaxAutoUpdated(){let{autoLevelCapping:e,maxAutoLevel:t,maxHdcpLevel:r}=this.hls;this._maxAutoLevel!==t&&(this._maxAutoLevel=t,this.hls.trigger(o.MAX_AUTO_LEVEL_UPDATED,{autoLevelCapping:e,levels:this.levels,maxAutoLevel:t,minAutoLevel:this.hls.minAutoLevel,maxHdcpLevel:r}))}}function Do(y){let e={};y.forEach(t=>{let r=t.groupId||"";t.id=e[r]=e[r]||0,e[r]++})}function qs(){return ut.SourceBuffer||ut.WebKitSourceBuffer}function ns(){if(!J())return!1;let y=qs();return!y||y.prototype&&typeof y.prototype.appendBuffer=="function"&&typeof y.prototype.remove=="function"}class Ks extends Bt{constructor(e,t,r){super(e,t,r,"stream-controller",m.MAIN),this.audioCodecSwap=!1,this.level=-1,this._forceStartLoad=!1,this._hasEnoughToStart=!1,this.altAudio=0,this.audioOnly=!1,this.fragPlaying=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this.onMediaPlaying=()=>{this.tick()},this.onMediaSeeked=()=>{let i=this.media,a=i?i.currentTime:null;if(a===null||!x(a)||(this.log(`Media seeked to ${a.toFixed(3)}`),!this.getBufferedFrag(a)))return;let n=this.getFwdBufferInfoAtPos(i,a,m.MAIN,0);if(n===null||n.len===0){this.warn(`Main forward buffer length at ${a} on "seeked" event ${n?n.len:"empty"})`);return}this.tick()},this.registerListeners()}registerListeners(){super.registerListeners();let{hls:e}=this;e.on(o.MANIFEST_PARSED,this.onManifestParsed,this),e.on(o.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.LEVEL_LOADED,this.onLevelLoaded,this),e.on(o.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(o.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(o.BUFFER_CREATED,this.onBufferCreated,this),e.on(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(o.FRAG_BUFFERED,this.onFragBuffered,this)}unregisterListeners(){super.unregisterListeners();let{hls:e}=this;e.off(o.MANIFEST_PARSED,this.onManifestParsed,this),e.off(o.LEVEL_LOADED,this.onLevelLoaded,this),e.off(o.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(o.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(o.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(o.BUFFER_CREATED,this.onBufferCreated,this),e.off(o.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(o.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(o.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this.onMediaPlaying=this.onMediaSeeked=null,this.unregisterListeners(),super.onHandlerDestroying()}startLoad(e,t){if(this.levels){let{lastCurrentTime:r,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let a=i.startLevel;a===-1&&(i.config.testBandwidth&&this.levels.length>1?(a=0,this.bitrateTest=!0):a=i.firstAutoLevel),i.nextLoadLevel=a,this.level=i.loadLevel,this._hasEnoughToStart=!!t}r>0&&e===-1&&!t&&(this.log(`Override startPosition with lastCurrentTime @${r.toFixed(3)}`),e=r),this.state=Ie.IDLE,this.nextLoadPosition=this.lastCurrentTime=e+this.timelineOffset,this.startPosition=t?-1:e,this.tick()}else this._forceStartLoad=!0,this.state=Ie.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){switch(this.state){case Ie.WAITING_LEVEL:{let{levels:e,level:t}=this,r=e?.[t],i=r?.details;if(!i||i.live&&(this.levelLastLoaded!==r||this.waitForLive(r)))this.hls.nextLoadLevel!==this.level&&(this.state=Ie.IDLE);else{if(this.waitForCdnTuneIn(i))break;this.state=Ie.IDLE}break}case Ie.FRAG_LOADING_WAITING_RETRY:this.checkRetryDate()}this.state===Ie.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){var e;super.onTickEnd(),(e=this.media)!=null&&e.readyState&&this.media.seeking===!1&&(this.lastCurrentTime=this.media.currentTime),this.checkFragmentChanged()}doTickIdle(){let{hls:e,levelLastLoaded:t,levels:r,media:i}=this;if(t===null||!i&&!this.primaryPrefetch&&(this.startFragRequested||!e.config.startFragPrefetch)||this.altAudio&&this.audioOnly)return;let a=this.buffering?e.nextLoadLevel:e.loadLevel;if(!(r!=null&&r[a]))return;let n=r[a],l=this.getMainFwdBufferInfo();if(l===null)return;let h=this.getLevelDetails();if(h&&this._streamEnded(l,h)){let z={};this.altAudio===2&&(z.type="video"),this.hls.trigger(o.BUFFER_EOS,z),this.state=Ie.ENDED;return}if(!this.buffering)return;e.loadLevel!==a&&e.manualLevel===-1&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;let p=n.details;if(!p||this.state===Ie.WAITING_LEVEL||this.waitForLive(n)){this.level=a,this.state=Ie.WAITING_LEVEL,this.startFragRequested=!1;return}let v=l.len,w=this.getMaxBufferLength(n.maxBitrate);if(v>=w)return;this.backtrackFragment&&this.backtrackFragment.start>l.end&&(this.backtrackFragment=null);let P=this.backtrackFragment?this.backtrackFragment.start:l.end,D=this.getNextFragment(P,p);if(this.couldBacktrack&&!this.fragPrevious&&D&&ke(D)&&this.fragmentTracker.getState(D)!==Xr.OK){var G;let z=((G=this.backtrackFragment)!=null?G:D).sn-p.startSN,H=p.fragments[z-1];H&&D.cc===H.cc&&(D=H,this.fragmentTracker.removeFragment(H))}else this.backtrackFragment&&l.len&&(this.backtrackFragment=null);if(D&&this.isLoopLoading(D,P)){if(!D.gap){let z=this.audioOnly&&!this.altAudio?K.AUDIO:K.VIDEO,H=(z===K.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;H&&this.afterBufferFlushed(H,z,m.MAIN)}D=this.getNextFragmentLoopLoading(D,p,l,m.MAIN,w)}D&&(!D.initSegment||D.initSegment.data||this.bitrateTest||(D=D.initSegment),this.loadFragment(D,n,P))}loadFragment(e,t,r){let i=this.fragmentTracker.getState(e);i===Xr.NOT_LOADED||i===Xr.PARTIAL?ke(e)?this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):super.loadFragment(e,t,r):this._loadInitSegment(e,t):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,m.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let{levels:e,media:t}=this;if(t!=null&&t.readyState){let r,i=this.getAppendedFrag(t.currentTime);i&&i.start>1&&this.flushMainBuffer(0,i.start-1);let a=this.getLevelDetails();if(a!=null&&a.live){let l=this.getMainFwdBufferInfo();if(!l||l.len<2*a.targetduration)return}if(!t.paused&&e){let l=e[this.hls.nextLoadLevel],h=this.fragLastKbps;r=h&&this.fragCurrent?this.fragCurrent.duration*l.maxBitrate/(1e3*h)+1:0}else r=0;let n=this.getBufferedFrag(t.currentTime+r);if(n){let l=this.followingBufferedFrag(n);if(l){this.abortCurrentFrag();let h=l.maxStartPTS?l.maxStartPTS:l.start,p=l.duration,v=Math.max(n.end,h+Math.min(Math.max(p-this.config.maxFragLookUpTolerance,p*(this.couldBacktrack?.5:.125)),p*(this.couldBacktrack?.75:.25)));this.flushMainBuffer(v,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){let e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case Ie.KEY_LOADING:case Ie.FRAG_LOADING:case Ie.FRAG_LOADING_WAITING_RETRY:case Ie.PARSING:case Ie.PARSED:this.state=Ie.IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio===2?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);let r=t.media;ot(r,"playing",this.onMediaPlaying),ot(r,"seeked",this.onMediaSeeked)}onMediaDetaching(e,t){let{media:r}=this;r&&(Ot(r,"playing",this.onMediaPlaying),Ot(r,"seeked",this.onMediaSeeked)),this.videoBuffer=null,this.fragPlaying=null,super.onMediaDetaching(e,t),t.transferMedia||(this._hasEnoughToStart=!1)}onManifestLoading(){super.onManifestLoading(),this.log("Trigger BUFFER_RESET"),this.hls.trigger(o.BUFFER_RESET,void 0),this.couldBacktrack=!1,this.fragLastKbps=0,this.fragPlaying=this.backtrackFragment=null,this.altAudio=0,this.audioOnly=!1}onManifestParsed(e,t){let r=!1,i=!1;for(let a=0;a<t.levels.length;a++){let n=t.levels[a].audioCodec;n&&(r=r||n.indexOf("mp4a.40.2")!==-1,i=i||n.indexOf("mp4a.40.5")!==-1)}this.audioCodecSwitch=r&&i&&!function(){var a;let n=qs();return typeof(n==null||(a=n.prototype)==null?void 0:a.changeType)=="function"}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){let{levels:r}=this;if(!r||this.state!==Ie.IDLE)return;let i=t.levelInfo;(!i.details||i.details.live&&(this.levelLastLoaded!==i||i.details.expired)||this.waitForCdnTuneIn(i.details))&&(this.state=Ie.WAITING_LEVEL)}onLevelLoaded(e,t){var r,i;let{levels:a,startFragRequested:n}=this,l=t.level,h=t.details,p=h.totalduration;if(!a){this.warn(`Levels were reset while loading level ${l}`);return}this.log(`Level ${l} loaded [${h.startSN},${h.endSN}]${h.lastPartSn?`[part-${h.lastPartSn}-${h.lastPartIndex}]`:""}, cc [${h.startCC}, ${h.endCC}] duration:${p}`);let v=t.levelInfo,w=this.fragCurrent;w&&(this.state===Ie.FRAG_LOADING||this.state===Ie.FRAG_LOADING_WAITING_RETRY)&&w.level!==t.level&&w.loader&&this.abortCurrentFrag();let P=0;if(h.live||(r=v.details)!=null&&r.live){if(this.checkLiveUpdate(h),h.deltaUpdateFailed)return;P=this.alignPlaylists(h,v.details,(i=this.levelLastLoaded)==null?void 0:i.details)}if(v.details=h,this.levelLastLoaded=v,n||this.setStartPosition(h,P),this.hls.trigger(o.LEVEL_UPDATED,{details:h,level:l}),this.state===Ie.WAITING_LEVEL){if(this.waitForCdnTuneIn(h))return;this.state=Ie.IDLE}n&&h.live&&this.synchronizeToLiveEdge(h),this.tick()}synchronizeToLiveEdge(e){let{config:t,media:r}=this;if(!r)return;let i=this.hls.liveSyncPosition,a=this.getLoadPosition(),n=e.fragmentStart,l=e.edge,h=a>=n-t.maxFragLookUpTolerance&&a<=l;if(i!==null&&r.duration>i&&(a<i||!h)){let v=t.liveMaxLatencyDuration!==void 0?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;if((!h&&r.readyState<4||a<l-v)&&(this._hasEnoughToStart||(this.nextLoadPosition=i),r.readyState))if(this.warn(`Playback: ${a.toFixed(3)} is located too far from the end of live sliding playlist: ${l}, reset currentTime to : ${i.toFixed(3)}`),this.config.liveSyncMode==="buffered"){var p;let w=le.bufferInfo(r,i,0);if(!((p=w.buffered)!=null&&p.length)||w.start<=a){r.currentTime=i;return}let{nextStart:P}=le.bufferedInfo(w.buffered,a,0);P&&(r.currentTime=P)}else r.currentTime=i}}_handleFragmentLoadProgress(e){var t;let r=e.frag,{part:i,payload:a}=e,{levels:n}=this;if(!n){this.warn(`Levels were reset while fragment load was in progress. Fragment ${r.sn} of level ${r.level} will not be buffered`);return}let l=n[r.level];if(!l){this.warn(`Level ${r.level} not found on progress`);return}let h=l.details;if(!h){this.warn(`Dropping fragment ${r.sn} of level ${r.level} after level details were reset`),this.fragmentTracker.removeFragment(r);return}let p=l.videoCodec,v=h.PTSKnown||!h.live,w=(t=r.initSegment)==null?void 0:t.data,P=this._getAudioCodec(l),D=this.transmuxer=this.transmuxer||new yo(this.hls,m.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),G=i?i.index:-1,z=new jn(r.level,r.sn,r.stats.chunkCount,a.byteLength,G,G!==-1),H=this.initPTS[r.cc];D.push(a,w,P,p,r,i,h.totalduration,v,z,H)}onAudioTrackSwitching(e,t){let r=this.hls,i=this.altAudio===2;if(_i(t.url,r))this.altAudio=1;else{if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;let a=this.fragCurrent;a&&(this.log("Switching to main audio track, cancel main fragment load"),a.abortRequests(),this.fragmentTracker.removeFragment(a)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();if(i){this.fragmentTracker.removeAllFragments(),r.once(o.BUFFER_FLUSHED,()=>{this.hls&&this.hls.trigger(o.AUDIO_TRACK_SWITCHED,t)}),r.trigger(o.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null});return}r.trigger(o.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){let r=_i(t.url,this.hls);if(r){let i=this.videoBuffer;i&&this.mediaBuffer!==i&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=i)}this.altAudio=r?2:0,this.tick()}onBufferCreated(e,t){let r,i,a=t.tracks,n=!1;for(let l in a){let h=a[l];if(h.id==="main"){if(i=l,r=h,l==="video"){let p=a[l];p&&(this.videoBuffer=p.buffer)}}else n=!0}n&&r?(this.log(`Alternate track found, use ${i}.buffered to schedule main fragment loading`),this.mediaBuffer=r.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){let{frag:r,part:i}=t,a=r.type===m.MAIN;if(a){if(this.fragContextChanged(r)){this.warn(`Fragment ${r.sn}${i?" p: "+i.index:""} of level ${r.level} finished buffering, but was aborted. state: ${this.state}`),this.state===Ie.PARSED&&(this.state=Ie.IDLE);return}let l=i?i.stats:r.stats;this.fragLastKbps=Math.round(8*l.total/(l.buffering.end-l.loading.first)),ke(r)&&(this.fragPrevious=r),this.fragBufferedComplete(r,i)}let n=this.media;n&&(!this._hasEnoughToStart&&le.getBuffered(n).length&&(this._hasEnoughToStart=!0,this.seekToStartPos()),a&&this.tick())}get hasEnoughToStart(){return this._hasEnoughToStart}onError(e,t){var r;if(t.fatal){this.state=Ie.ERROR;return}switch(t.details){case d.FRAG_GAP:case d.FRAG_PARSING_ERROR:case d.FRAG_DECRYPT_ERROR:case d.FRAG_LOAD_ERROR:case d.FRAG_LOAD_TIMEOUT:case d.KEY_LOAD_ERROR:case d.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(m.MAIN,t);break;case d.LEVEL_LOAD_ERROR:case d.LEVEL_LOAD_TIMEOUT:case d.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==Ie.WAITING_LEVEL||((r=t.context)==null?void 0:r.type)!==f.LEVEL||(this.state=Ie.IDLE);break;case d.BUFFER_ADD_CODEC_ERROR:case d.BUFFER_APPEND_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&this.resetLoadingState();break;case d.BUFFER_FULL_ERROR:if(t.parent!=="main")return;this.reduceLengthAndFlushBuffer(t)&&(!this.config.interstitialsController&&this.config.assetPlayerId?this._hasEnoughToStart=!0:this.flushMainBuffer(0,Number.POSITIVE_INFINITY));break;case d.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onFragLoadEmergencyAborted(){this.state=Ie.IDLE,this._hasEnoughToStart||(this.startFragRequested=!1,this.nextLoadPosition=this.lastCurrentTime),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==K.AUDIO||!this.altAudio){let r=(t===K.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;r&&(this.afterBufferFlushed(r,t,m.MAIN),this.tick())}}onLevelsUpdated(e,t){this.level>-1&&this.fragCurrent&&(this.level=this.fragCurrent.level,this.level===-1&&this.resetWhenMissingContext(this.fragCurrent)),this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:e}=this;if(!e)return;let t=e.currentTime,r=this.startPosition;if(r>=0&&t<r){if(e.seeking){this.log(`could not seek to ${r}, already seeking at ${t}`);return}let i=this.timelineOffset;i&&r&&(r+=i);let a=this.getLevelDetails(),n=le.getBuffered(e),l=n.length?n.start(0):0,h=l-r,p=Math.max(this.config.maxBufferHole,this.config.maxFragLookUpTolerance);(this.config.startOnSegmentBoundary||h>0&&(h<p||this.loadingParts&&h<2*(a?.partTarget||0)))&&(this.log(`adjusting start position by ${h} to match buffer start`),r+=h,this.startPosition=r),t<r&&(this.log(`seek to target start position ${r} from current time ${t} buffer start ${l}`),e.currentTime=r)}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=t.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(r=>{let{hls:i}=this,a=r?.frag;if(!a||this.fragContextChanged(a))return;t.fragmentError=0,this.state=Ie.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let n=a.stats;n.parsing.start=n.parsing.end=n.buffering.start=n.buffering.end=ut.performance.now(),i.trigger(o.FRAG_LOADED,r),a.bitrateTest=!1}).catch(r=>{this.state!==Ie.STOPPED&&this.state!==Ie.ERROR&&(this.warn(r),this.resetFragmentLoading(e))})}_handleTransmuxComplete(e){let t=this.playlistType,{hls:r}=this,{remuxResult:i,chunkMeta:a}=e,n=this.getCurrentContext(a);if(!n){this.resetWhenMissingContext(a);return}let{frag:l,part:h,level:p}=n,{video:v,text:w,id3:P,initSegment:D}=i,{details:G}=p,z=this.altAudio?void 0:i.audio;if(this.fragContextChanged(l)){this.fragmentTracker.removeFragment(l);return}if(this.state=Ie.PARSING,D){let H=D.tracks;if(H){let Te=l.initSegment||l;if(this.unhandledEncryptionError(D,l))return;this._bufferInitSegment(p,H,Te,a),r.trigger(o.FRAG_PARSING_INIT_SEGMENT,{frag:Te,id:t,tracks:H})}let oe=D.initPTS,Se=D.timescale,me=this.initPTS[l.cc];if(x(oe)&&(!me||me.baseTime!==oe||me.timescale!==Se)){let Te=D.trackId;this.initPTS[l.cc]={baseTime:oe,timescale:Se,trackId:Te},r.trigger(o.INIT_PTS_FOUND,{frag:l,id:t,initPTS:oe,timescale:Se,trackId:Te})}}if(v&&G){z&&v.type==="audiovideo"&&this.logMuxedErr(l);let H=G.fragments[l.sn-1-G.startSN],oe=l.sn===G.startSN,Se=!H||l.cc>H.cc;if(i.independent!==!1){let{startPTS:me,endPTS:Te,startDTS:Be,endDTS:je}=v;if(h)h.elementaryStreams[v.type]={startPTS:me,endPTS:Te,startDTS:Be,endDTS:je};else if(v.firstKeyFrame&&v.independent&&a.id===1&&!Se&&(this.couldBacktrack=!0),v.dropped&&v.independent){let ge=this.getMainFwdBufferInfo(),ze=(ge?ge.end:this.getLoadPosition())+this.config.maxBufferHole,Fe=v.firstKeyFramePTS?v.firstKeyFramePTS:me;if(oe||!(ze<Fe-this.config.maxBufferHole)||Se)Se&&(l.gap=!0);else{this.backtrack(l);return}l.setElementaryStreamInfo(v.type,l.start,Te,l.start,je,!0)}else oe&&me-(G.appliedTimelineOffset||0)>2&&(l.gap=!0);l.setElementaryStreamInfo(v.type,me,Te,Be,je),this.backtrackFragment&&(this.backtrackFragment=l),this.bufferFragmentData(v,l,h,a,oe||Se)}else if(oe||Se)l.gap=!0;else{this.backtrack(l);return}}if(z){let{startPTS:H,endPTS:oe,startDTS:Se,endDTS:me}=z;h&&(h.elementaryStreams[K.AUDIO]={startPTS:H,endPTS:oe,startDTS:Se,endDTS:me}),l.setElementaryStreamInfo(K.AUDIO,H,oe,Se,me),this.bufferFragmentData(z,l,h,a)}if(G&&P!=null&&P.samples.length){let H={id:t,frag:l,details:G,samples:P.samples};r.trigger(o.FRAG_PARSING_METADATA,H)}if(G&&w){let H={id:t,frag:l,details:G,samples:w.samples};r.trigger(o.FRAG_PARSING_USERDATA,H)}}logMuxedErr(e){this.warn(`${ke(e)?"Media":"Init"} segment with muxed audiovideo where only video expected: ${e.url}`)}_bufferInitSegment(e,t,r,i){if(this.state!==Ie.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&(delete t.audio,t.audiovideo&&this.logMuxedErr(r));let{audio:a,video:n,audiovideo:l}=t;if(a){let p=e.audioCodec,v=gr(a.codec,p);v==="mp4a"&&(v="mp4a.40.5");let w=navigator.userAgent.toLowerCase();if(this.audioCodecSwitch){v&&(v=v.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5");let P=a.metadata;P&&"channelCount"in P&&(P.channelCount||1)!==1&&w.indexOf("firefox")===-1&&(v="mp4a.40.5")}v&&v.indexOf("mp4a.40.5")!==-1&&w.indexOf("android")!==-1&&a.container!=="audio/mpeg"&&(v="mp4a.40.2",this.log(`Android: force audio codec to ${v}`)),p&&p!==v&&this.log(`Swapping manifest audio codec "${p}" for "${v}"`),a.levelCodec=v,a.id=m.MAIN,this.log(`Init audio buffer, container:${a.container}, codecs[selected/level/parsed]=[${v||""}/${p||""}/${a.codec}]`),delete t.audiovideo}if(n){n.levelCodec=e.videoCodec,n.id=m.MAIN;let p=n.codec;if(p?.length===4)switch(p){case"hvc1":case"hev1":n.codec="hvc1.1.6.L120.90";break;case"av01":n.codec="av01.0.04M.08";break;case"avc1":n.codec="avc1.42e01e"}this.log(`Init video buffer, container:${n.container}, codecs[level/parsed]=[${e.videoCodec||""}/${p}]${n.codec!==p?" parsed-corrected="+n.codec:""}${n.supplemental?" supplemental="+n.supplemental:""}`),delete t.audiovideo}l&&(this.log(`Init audiovideo buffer, container:${l.container}, codecs[level/parsed]=[${e.codecs}/${l.codec}]`),delete t.video,delete t.audio);let h=Object.keys(t);if(h.length){if(this.hls.trigger(o.BUFFER_CODECS,t),!this.hls)return;h.forEach(p=>{let v=t[p].initSegment;v!=null&&v.byteLength&&this.hls.trigger(o.BUFFER_APPENDING,{type:p,data:v,frag:r,part:null,chunkMeta:i,parent:r.type})})}this.tickImmediate()}getMainFwdBufferInfo(){let e=this.mediaBuffer&&this.altAudio===2?this.mediaBuffer:this.media;return this.getFwdBufferInfo(e,m.MAIN)}get maxBufferLength(){let{levels:e,level:t}=this,r=e?.[t];return r?this.getMaxBufferLength(r.maxBitrate):this.config.maxBufferLength}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=Ie.IDLE}checkFragmentChanged(){let e=this.media,t=null;if(e&&e.readyState>1&&e.seeking===!1){let r=e.currentTime;if(le.isBuffered(e,r)?t=this.getAppendedFrag(r):le.isBuffered(e,r+.1)&&(t=this.getAppendedFrag(r+.1)),t){this.backtrackFragment=null;let i=this.fragPlaying,a=t.level;i&&t.sn===i.sn&&i.level===a||(this.fragPlaying=t,this.hls.trigger(o.FRAG_CHANGED,{frag:t}),i&&i.level===a||this.hls.trigger(o.LEVEL_SWITCHED,{level:a}))}}}get nextLevel(){let e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){var e;if(this.fragPlaying)return this.fragPlaying;let t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;return x(t)?this.getAppendedFrag(t):null}get currentProgramDateTime(){var e;let t=((e=this.media)==null?void 0:e.currentTime)||this.lastCurrentTime;if(x(t)){let r=this.getLevelDetails(),i=this.currentFrag||(r?gi(null,r.fragments,t):null);if(i){let a=i.programDateTime;if(a!==null)return new Date(a+(t-i.start)*1e3)}}return null}get currentLevel(){let e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){let e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class ks extends L{constructor(e,t){super("key-loader",t),this.config=void 0,this.keyIdToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(let r in this.keyIdToKeyInfo){let i=this.keyIdToKeyInfo[r].loader;if(i){var t;if(e&&e!==((t=i.context)==null?void 0:t.frag.type))return;i.abort()}}}detach(){for(let e in this.keyIdToKeyInfo){let t=this.keyIdToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyIdToKeyInfo[e]}}destroy(){for(let e in this.detach(),this.keyIdToKeyInfo){let t=this.keyIdToKeyInfo[e].loader;t&&t.destroy()}this.keyIdToKeyInfo={}}createKeyLoadError(e,t=d.KEY_LOAD_ERROR,r,i,a){return new Aa({type:S.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:a,error:r,networkDetails:i})}loadClear(e,t,r){if(this.emeController&&this.config.emeEnabled&&!this.emeController.getSelectedKeySystemFormats().length){if(t.length)for(let i=0,a=t.length;i<a;i++){let n=t[i];if(e.cc<=n.cc&&(!ke(e)||!ke(n)||e.sn<n.sn)||!r&&i==a-1)return this.emeController.selectKeySystemFormat(n).then(l=>{if(!this.emeController)return;n.setKeyFormat(l);let h=Tr(l);if(h)return this.emeController.getKeySystemAccess([h])})}if(this.config.requireKeySystemAccessOnStart){let i=wi(this.config);if(i.length)return this.emeController.getKeySystemAccess(i)}}return null}load(e){return!e.decryptdata&&e.encrypted&&this.emeController&&this.config.emeEnabled?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var r,i,a;t&&e.setKeyFormat(t);let n=e.decryptdata;if(!n){let v=Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,d.KEY_LOAD_ERROR,v))}let l=n.uri;if(!l)return Promise.reject(this.createKeyLoadError(e,d.KEY_LOAD_ERROR,Error(`Invalid key URI: "${l}"`)));let h=mo(n),p=this.keyIdToKeyInfo[h];if((r=p)!=null&&r.decryptdata.key)return n.key=p.decryptdata.key,Promise.resolve({frag:e,keyInfo:p});if((i=p)!=null&&i.keyLoadPromise)switch((a=p.mediaKeySessionContext)==null?void 0:a.keyStatus){case"usable":case"usable-in-future":return p.keyLoadPromise.then(v=>{let{keyInfo:w}=v;return n.key=w.decryptdata.key,{frag:e,keyInfo:w}})}switch(this.log(`Loading key ${b(n.keyId||[])} from ${e.type} ${e.level}`),p=this.keyIdToKeyInfo[h]={decryptdata:n,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},n.method){case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return n.keyFormat==="identity"?this.loadKeyHTTP(p,e):this.loadKeyEME(p,e);case"AES-128":case"AES-256":case"AES-256-CTR":return this.loadKeyHTTP(p,e);default:return Promise.reject(this.createKeyLoadError(e,d.KEY_LOAD_ERROR,Error(`Key supplied with unsupported METHOD: "${n.method}"`)))}}loadKeyEME(e,t){let r={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){let i=this.emeController.loadKey(r);return(e.keyLoadPromise=i.then(a=>(e.mediaKeySessionContext=a,r))).catch(a=>{throw e.keyLoadPromise=null,a.data&&(a.data.frag=t),a})}return Promise.resolve(r)}loadKeyHTTP(e,t){let r=this.config,i=new r.loader(r);return t.keyLoader=e.loader=i,e.keyLoadPromise=new Promise((a,n)=>{let l={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},h=r.keyLoadPolicy.default,p={loadPolicy:h,timeout:h.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};i.load(l,p,{onSuccess:(v,w,P,D)=>{let{frag:G,keyInfo:z,url:H}=P,oe=mo(z.decryptdata)||H;if(!G.decryptdata||z!==this.keyIdToKeyInfo[oe])return n(this.createKeyLoadError(G,d.KEY_LOAD_ERROR,Error("after key load, decryptdata unset or changed"),D));z.decryptdata.key=G.decryptdata.key=new Uint8Array(v.data),G.keyLoader=null,z.loader=null,a({frag:G,keyInfo:z})},onError:(v,w,P,D)=>{this.resetLoader(w),n(this.createKeyLoadError(t,d.KEY_LOAD_ERROR,Error(`HTTP Error ${v.code} loading key ${v.text}`),P,F({url:l.url,data:void 0},v)))},onTimeout:(v,w,P)=>{this.resetLoader(w),n(this.createKeyLoadError(t,d.KEY_LOAD_TIMEOUT,Error("key loading timed out"),P))},onAbort:(v,w,P)=>{this.resetLoader(w),n(this.createKeyLoadError(t,d.INTERNAL_ABORTED,Error("key loading aborted"),P))}})})}resetLoader(e){let{frag:t,keyInfo:r,url:i}=e,a=r.loader;t.keyLoader===a&&(t.keyLoader=null,r.loader=null);let n=mo(r.decryptdata)||i;delete this.keyIdToKeyInfo[n],a&&a.destroy()}}function mo(y){let e=y.keyId;return e?b(e):y.uri}function Ws(y){let{type:e}=y;switch(e){case f.AUDIO_TRACK:return m.AUDIO;case f.SUBTITLE_TRACK:return m.SUBTITLE;default:return m.MAIN}}function _s(y,e){let t=y.url;return(t===void 0||t.indexOf("data:")===0)&&(t=e.url),t}class Yo{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.onManifestLoaded=this.checkAutostartLoad,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let{hls:e}=this;e.on(o.MANIFEST_LOADING,this.onManifestLoading,this),e.on(o.LEVEL_LOADING,this.onLevelLoading,this),e.on(o.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(o.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.on(o.LEVELS_UPDATED,this.onLevelsUpdated,this)}unregisterListeners(){let{hls:e}=this;e.off(o.MANIFEST_LOADING,this.onManifestLoading,this),e.off(o.LEVEL_LOADING,this.onLevelLoading,this),e.off(o.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(o.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this),e.off(o.LEVELS_UPDATED,this.onLevelsUpdated,this)}createInternalLoader(e){let t=this.hls.config,r=t.pLoader,i=t.loader,a=new(r||i)(t);return this.loaders[e.type]=a,a}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(let e in this.loaders){let t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){let{url:r}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:f.MANIFEST,url:r,deliveryDirectives:null,levelOrTrack:null})}onLevelLoading(e,t){let{id:r,level:i,pathwayId:a,url:n,deliveryDirectives:l,levelInfo:h}=t;this.load({id:r,level:i,pathwayId:a,responseType:"text",type:f.LEVEL,url:n,deliveryDirectives:l,levelOrTrack:h})}onAudioTrackLoading(e,t){let{id:r,groupId:i,url:a,deliveryDirectives:n,track:l}=t;this.load({id:r,groupId:i,level:null,responseType:"text",type:f.AUDIO_TRACK,url:a,deliveryDirectives:n,levelOrTrack:l})}onSubtitleTrackLoading(e,t){let{id:r,groupId:i,url:a,deliveryDirectives:n,track:l}=t;this.load({id:r,groupId:i,level:null,responseType:"text",type:f.SUBTITLE_TRACK,url:a,deliveryDirectives:n,levelOrTrack:l})}onLevelsUpdated(e,t){let r=this.loaders[f.LEVEL];if(r){let i=r.context;i&&!t.levels.some(a=>a===i.levelOrTrack)&&(r.abort(),delete this.loaders[f.LEVEL])}}load(e){var t;let r,i=this.hls.config,a=this.getInternalLoader(e);if(a){let h=this.hls.logger,p=a.context;if(p&&p.levelOrTrack===e.levelOrTrack&&(p.url===e.url||p.deliveryDirectives&&!e.deliveryDirectives)){p.url===e.url?h.log(`[playlist-loader]: ignore ${e.url} ongoing request`):h.log(`[playlist-loader]: ignore ${e.url} in favor of ${p.url}`);return}h.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),a.abort()}if(r=e.type===f.MANIFEST?i.manifestLoadPolicy.default:_({},i.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),a=this.createInternalLoader(e),x((t=e.deliveryDirectives)==null?void 0:t.part)){let h;if(e.type===f.LEVEL&&e.level!==null?h=this.hls.levels[e.level].details:e.type===f.AUDIO_TRACK&&e.id!==null?h=this.hls.audioTracks[e.id].details:e.type===f.SUBTITLE_TRACK&&e.id!==null&&(h=this.hls.subtitleTracks[e.id].details),h){let p=h.partTarget,v=h.targetduration;if(p&&v){let w=1e3*Math.max(3*p,.8*v);r=_({},r,{maxTimeToFirstByteMs:Math.min(w,r.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(w,r.maxTimeToFirstByteMs)})}}}let n=r.errorRetry||r.timeoutRetry||{},l={loadPolicy:r,timeout:r.maxLoadTimeMs,maxRetry:n.maxNumRetry||0,retryDelay:n.retryDelayMs||0,maxRetryDelay:n.maxRetryDelayMs||0};a.load(e,l,{onSuccess:(h,p,v,w)=>{let P=this.getInternalLoader(v);this.resetInternalLoader(v.type);let D=h.data;if(D.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(h,v,Error("no EXTM3U delimiter"),w||null,p);return}p.parsing.start=performance.now(),jr.isMediaPlaylist(D)||v.type!==f.MANIFEST?this.handleTrackOrLevelPlaylist(h,p,v,w||null,P):this.handleMasterPlaylist(h,p,v,w)},onError:(h,p,v,w)=>{this.handleNetworkError(p,v,!1,h,w)},onTimeout:(h,p,v)=>{this.handleNetworkError(p,v,!0,void 0,h)}})}checkAutostartLoad(){if(!this.hls)return;let{config:{autoStartLoad:e,startPosition:t},forceStartLoad:r}=this.hls;(e||r)&&(this.hls.logger.log(`${e?"auto":"force"} startLoad with configured startPosition ${t}`),this.hls.startLoad(t))}handleMasterPlaylist(e,t,r,i){let a=this.hls,n=e.data,l=_s(e,r),h=jr.parseMasterPlaylist(n,l);if(h.playlistParsingError){this.handleManifestParsingError(e,r,h.playlistParsingError,i,t);return}let{contentSteering:p,levels:v,sessionData:w,sessionKeys:P,startTimeOffset:D,variableList:G}=h;this.variableList=G;let{AUDIO:z=[],SUBTITLES:H,"CLOSED-CAPTIONS":oe}=jr.parseMasterPlaylistMedia(n,l,h);z.length&&!z.some(Se=>!Se.url)&&v[0].audioCodec&&!v[0].attrs.AUDIO&&(this.hls.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),z.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new St({}),bitrate:0,url:""})),a.trigger(o.MANIFEST_LOADED,{levels:v,audioTracks:z,subtitles:H,captions:oe,contentSteering:p,url:l,stats:t,networkDetails:i,sessionData:w,sessionKeys:P,startTimeOffset:D,variableList:G})}handleTrackOrLevelPlaylist(e,t,r,i,a){let n=this.hls,{id:l,level:h,type:p}=r,v=_s(e,r),w=x(h)?h:x(l)?l:0,P=Ws(r),D=jr.parseLevelPlaylist(e.data,v,w,P,0,this.variableList);if(p===f.MANIFEST){let G={attrs:new St({}),bitrate:0,details:D,name:"",url:v};D.requestScheduled=t.loading.start+Ce(D,0),n.trigger(o.MANIFEST_LOADED,{levels:[G],audioTracks:[],url:v,stats:t,networkDetails:i,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),r.levelDetails=D,this.handlePlaylistLoaded(D,e,t,r,i,a)}handleManifestParsingError(e,t,r,i,a){this.hls.trigger(o.ERROR,{type:S.NETWORK_ERROR,details:d.MANIFEST_PARSING_ERROR,fatal:t.type===f.MANIFEST,url:e.url,err:r,error:r,reason:r.message,response:e,context:t,networkDetails:i,stats:a})}handleNetworkError(e,t,r=!1,i,a){let n=`A network ${r?"timeout":"error"+(i?" (status "+i.code+")":"")} occurred while loading ${e.type}`;e.type===f.LEVEL?n+=`: ${e.level} id: ${e.id}`:(e.type===f.AUDIO_TRACK||e.type===f.SUBTITLE_TRACK)&&(n+=` id: ${e.id} group-id: "${e.groupId}"`);let l=Error(n);this.hls.logger.warn(`[playlist-loader]: ${n}`);let h=d.UNKNOWN,p=!1,v=this.getInternalLoader(e);switch(e.type){case f.MANIFEST:h=r?d.MANIFEST_LOAD_TIMEOUT:d.MANIFEST_LOAD_ERROR,p=!0;break;case f.LEVEL:h=r?d.LEVEL_LOAD_TIMEOUT:d.LEVEL_LOAD_ERROR,p=!1;break;case f.AUDIO_TRACK:h=r?d.AUDIO_TRACK_LOAD_TIMEOUT:d.AUDIO_TRACK_LOAD_ERROR,p=!1;break;case f.SUBTITLE_TRACK:h=r?d.SUBTITLE_TRACK_LOAD_TIMEOUT:d.SUBTITLE_LOAD_ERROR,p=!1}v&&this.resetInternalLoader(e.type);let w={type:S.NETWORK_ERROR,details:h,fatal:p,url:e.url,loader:v,context:e,error:l,networkDetails:t,stats:a};if(i){let P=t?.url||e.url;w.response=F({url:P,data:void 0},i)}this.hls.trigger(o.ERROR,w)}handlePlaylistLoaded(e,t,r,i,a,n){let l=this.hls,{type:h,level:p,id:v,groupId:w,deliveryDirectives:P}=i,D=_s(t,i),G=Ws(i),z=typeof i.level=="number"&&G===m.MAIN?p:void 0;if(!e.fragments.length){let oe=e.playlistParsingError=Error("No Segments found in Playlist");l.trigger(o.ERROR,{type:S.NETWORK_ERROR,details:d.LEVEL_EMPTY_ERROR,fatal:!1,url:D,error:oe,reason:oe.message,response:t,context:i,level:z,parent:G,networkDetails:a,stats:r});return}e.targetduration||(e.playlistParsingError=Error("Missing Target Duration"));let H=e.playlistParsingError;if(H){if(this.hls.logger.warn(`${H} ${e.url}`),!l.config.ignorePlaylistParsingErrors){l.trigger(o.ERROR,{type:S.NETWORK_ERROR,details:d.LEVEL_PARSING_ERROR,fatal:!1,url:D,error:H,reason:H.message,response:t,context:i,level:z,parent:G,networkDetails:a,stats:r});return}e.playlistParsingError=null}switch(e.live&&n&&(n.getCacheAge&&(e.ageHeader=n.getCacheAge()||0),(!n.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),h){case f.MANIFEST:case f.LEVEL:l.trigger(o.LEVEL_LOADED,{details:e,levelInfo:i.levelOrTrack||l.levels[0],level:z||0,id:v||0,stats:r,networkDetails:a,deliveryDirectives:P,withoutMultiVariant:h===f.MANIFEST});break;case f.AUDIO_TRACK:l.trigger(o.AUDIO_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:v||0,groupId:w||"",stats:r,networkDetails:a,deliveryDirectives:P});break;case f.SUBTITLE_TRACK:l.trigger(o.SUBTITLE_TRACK_LOADED,{details:e,track:i.levelOrTrack,id:v||0,groupId:w||"",stats:r,networkDetails:a,deliveryDirectives:P})}}}class en{static get version(){return tr}static isMSESupported(){return ns()}static isSupported(){return function(){if(!ns())return!1;let e=J();return typeof e?.isTypeSupported=="function"&&(["avc1.42E01E,mp4a.40.2","av01.0.01M.08","vp09.00.50.08"].some(t=>e.isTypeSupported(fr(t,"video")))||["mp4a.40.2","fLaC"].some(t=>e.isTypeSupported(fr(t,"audio"))))}()}static getMediaSource(){return J()}static get Events(){return o}static get MetadataSchema(){return ra}static get ErrorTypes(){return S}static get ErrorDetails(){return d}static get DefaultConfig(){return en.defaultConfig?en.defaultConfig:fo}static set DefaultConfig(e){en.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.logger=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new or,this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioStreamController=void 0,this.subtititleStreamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.interstitialsController=void 0,this.gapController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this._url=null,this._sessionId=void 0,this.triggeringException=void 0,this.started=!1;let t=this.logger=function(et,dt,bt){let _t=Y();if(typeof console=="object"&&et===!0||typeof et=="object"){let xt=["debug","log","info","warn","error"];xt.forEach(at=>{_t[at]=q(at,et,bt)});try{_t.log(`Debug logs enabled for "${dt}" in hls.js version 1.6.11`)}catch{return Y()}xt.forEach(at=>{se[at]=q(at,et)})}else _(se,_t);return _t}(e.debug||!1,"Hls instance",e.assetPlayerId),r=this.config=function(et,dt,bt){if((dt.liveSyncDurationCount||dt.liveMaxLatencyDurationCount)&&(dt.liveSyncDuration||dt.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(dt.liveMaxLatencyDurationCount!==void 0&&(dt.liveSyncDurationCount===void 0||dt.liveMaxLatencyDurationCount<=dt.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(dt.liveMaxLatencyDuration!==void 0&&(dt.liveSyncDuration===void 0||dt.liveMaxLatencyDuration<=dt.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let _t=function at(nt){return nt&&typeof nt=="object"?Array.isArray(nt)?nt.map(at):Object.keys(nt).reduce((Zt,lr)=>(Zt[lr]=at(nt[lr]),Zt),{}):nt}(et),xt=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(at=>{let nt=`${at==="level"?"playlist":at}LoadPolicy`,Zt=dt[nt]===void 0,lr=[];xt.forEach(ar=>{let Mt=`${at}Loading${ar}`,Pt=dt[Mt];if(Pt!==void 0&&Zt){lr.push(Mt);let nr=_t[nt].default;switch(dt[nt]={default:nr},ar){case"TimeOut":nr.maxLoadTimeMs=Pt,nr.maxTimeToFirstByteMs=Pt;break;case"MaxRetry":nr.errorRetry.maxNumRetry=Pt,nr.timeoutRetry.maxNumRetry=Pt;break;case"RetryDelay":nr.errorRetry.retryDelayMs=Pt,nr.timeoutRetry.retryDelayMs=Pt;break;case"MaxRetryTimeout":nr.errorRetry.maxRetryDelayMs=Pt,nr.timeoutRetry.maxRetryDelayMs=Pt}}}),lr.length&&bt.warn(`hls.js config: "${lr.join('", "')}" setting(s) are deprecated, use "${nt}": ${Xt(dt[nt])}`)}),F(F({},_t),dt)}(en.DefaultConfig,e,t);this.userConfig=e,r.progressive&&function(et,dt){let bt=et.loader;bt!==Kn&&bt!==Gs?(dt.log("[config]: Custom loader detected, cannot enable progressive streaming"),et.progressive=!1):function(){if(ut.fetch&&ut.AbortController&&ut.ReadableStream&&ut.Request)try{return new ut.ReadableStream({}),!0}catch{}return!1}()&&(et.loader=Kn,et.progressive=!0,et.enableSoftwareAES=!0,dt.log("[config]: Progressive streaming enabled, using FetchLoader"))}(r,t);let{abrController:i,bufferController:a,capLevelController:n,errorController:l,fpsController:h}=r,p=new l(this),v=this.abrController=new i(this),w=new Hi(this),P=r.interstitialsController,D=P?this.interstitialsController=new P(this,en):null,G=this.bufferController=new a(this,w),z=this.capLevelController=new n(this),H=new h(this),oe=new Yo(this),Se=r.contentSteeringController,me=Se?new Se(this):null,Te=this.levelController=new zo(this,me),Be=new go(this),je=new ks(this.config,this.logger),ge=this.streamController=new Ks(this,w,je),ze=this.gapController=new Lo(this,w);z.setStreamController(ge),H.setStreamController(ge);let Fe=[oe,Te,ge];D&&Fe.splice(1,0,D),me&&Fe.splice(1,0,me),this.networkControllers=Fe;let rt=[v,G,ze,z,H,Be,w];this.audioTrackController=this.createController(r.audioTrackController,Fe);let st=r.audioStreamController;st&&Fe.push(this.audioStreamController=new st(this,w,je)),this.subtitleTrackController=this.createController(r.subtitleTrackController,Fe);let kt=r.subtitleStreamController;kt&&Fe.push(this.subtititleStreamController=new kt(this,w,je)),this.createController(r.timelineController,rt),je.emeController=this.emeController=this.createController(r.emeController,rt),this.cmcdController=this.createController(r.cmcdController,rt),this.latencyController=this.createController(Wo,rt),this.coreComponents=rt,Fe.push(p);let Ye=p.onErrorOut;typeof Ye=="function"&&this.on(o.ERROR,Ye,p),this.on(o.MANIFEST_LOADED,oe.onManifestLoaded,oe)}createController(e,t){if(e){let r=new e(this);return t&&t.push(r),r}return null}on(e,t,r=this){this._emitter.on(e,t,r)}once(e,t,r=this){this._emitter.once(e,t,r)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,r=this,i){this._emitter.off(e,t,r,i)}listeners(e){return this._emitter.listeners(e)}emit(e,t,r){return this._emitter.emit(e,t,r)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(r){if(this.logger.error("An internal error happened while handling event "+e+'. Error message: "'+r.message+'". Here is a stacktrace:',r),!this.triggeringException){this.triggeringException=!0;let i=e===o.ERROR;this.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.INTERNAL_EXCEPTION,fatal:i,event:e,error:r}),this.triggeringException=!1}}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){this.logger.log("destroy"),this.trigger(o.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this._url=null,this.networkControllers.forEach(t=>t.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(t=>t.destroy()),this.coreComponents.length=0;let e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){if(!e||"media"in e&&!e.media){let a=Error(`attachMedia failed: invalid argument (${e})`);this.trigger(o.ERROR,{type:S.OTHER_ERROR,details:d.ATTACH_MEDIA_ERROR,fatal:!0,error:a});return}this.logger.log("attachMedia"),this._media&&(this.logger.warn("media must be detached before attaching"),this.detachMedia());let t="media"in e,r=t?e.media:e,i=t?e:{media:r};this._media=r,this.trigger(o.MEDIA_ATTACHING,i)}detachMedia(){this.logger.log("detachMedia"),this.trigger(o.MEDIA_DETACHING,{}),this._media=null}transferMedia(){this._media=null;let e=this.bufferController.transferMedia();return this.trigger(o.MEDIA_DETACHING,{transferMedia:e}),e}loadSource(e){this.stopLoad();let t=this.media,r=this._url,i=this._url=X.buildAbsoluteURL(ut.location.href,e,{alwaysNormalize:!0});this._autoLevelCapping=-1,this._maxHdcpLevel=null,this.logger.log(`loadSource:${i}`),t&&r&&(r!==i||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(o.MANIFEST_LOADING,{url:e})}get url(){return this._url}get hasEnoughToStart(){return this.streamController.hasEnoughToStart}get startPosition(){return this.streamController.startPositionValue}startLoad(e=-1,t){this.logger.log(`startLoad(${e+(t?", <skip seek to start>":"")})`),this.started=!0,this.resumeBuffering();for(let r=0;r<this.networkControllers.length&&(this.networkControllers[r].startLoad(e,t),this.started&&this.networkControllers);r++);}stopLoad(){this.logger.log("stopLoad"),this.started=!1;for(let e=0;e<this.networkControllers.length&&(this.networkControllers[e].stopLoad(),!this.started&&this.networkControllers);e++);}get loadingEnabled(){return this.started}get bufferingEnabled(){return this.streamController.bufferingEnabled}resumeBuffering(){this.bufferingEnabled||(this.logger.log("resume buffering"),this.networkControllers.forEach(e=>{e.resumeBuffering&&e.resumeBuffering()}))}pauseBuffering(){this.bufferingEnabled&&(this.logger.log("pause buffering"),this.networkControllers.forEach(e=>{e.pauseBuffering&&e.pauseBuffering()}))}get inFlightFragments(){let e={[m.MAIN]:this.streamController.inFlightFrag};return this.audioStreamController&&(e[m.AUDIO]=this.audioStreamController.inFlightFrag),this.subtititleStreamController&&(e[m.SUBTITLE]=this.subtititleStreamController.inFlightFrag),e}swapAudioCodec(){this.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){this.logger.log("recoverMediaError");let e=this._media,t=e?.currentTime;this.detachMedia(),e&&(this.attachMedia(e),t&&this.startLoad(t))}removeLevel(e){this.levelController.removeLevel(e)}get sessionId(){let e=this._sessionId;return e||(e=this._sessionId=function(){try{return crypto.randomUUID()}catch{try{let r=URL.createObjectURL(new Blob),i=r.toString();return URL.revokeObjectURL(r),i.slice(i.lastIndexOf("/")+1)}catch{let i=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,a=>{let n=(i+16*Math.random())%16|0;return i=Math.floor(i/16),(a=="x"?n:3&n|8).toString(16)})}}}()),e}get levels(){return this.levelController.levels||[]}get latestLevelDetails(){return this.streamController.getLevelDetails()||null}get loadLevelObj(){return this.levelController.loadLevelObj}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){this.logger.log(`set currentLevel:${e}`),this.levelController.manualLevel=e,this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){this.logger.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){this.logger.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){this.logger.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){let e=this.levelController.startLevel;return e===-1&&this.abrController.forcedAutoLevel>-1?this.abrController.forcedAutoLevel:e}set startLevel(e){this.logger.log(`set startLevel:${e}`),e!==-1&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){let t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}set bandwidthEstimate(e){this.abrController.resetEstimator(e)}get abrEwmaDefaultEstimate(){let{bwEstimator:e}=this.abrController;return e?e.defaultEstimate:NaN}get ttfbEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(this.logger.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e,this.levelController.checkMaxAutoUpdated())}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){Er.indexOf(e)>-1&&this._maxHdcpLevel!==e&&(this._maxHdcpLevel=e,this.levelController.checkMaxAutoUpdated())}get autoLevelEnabled(){return this.levelController.manualLevel===-1}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;let r=e.length;for(let i=0;i<r;i++)if(e[i].maxBitrate>=t)return i;return 0}get maxAutoLevel(){let e,{levels:t,autoLevelCapping:r,maxHdcpLevel:i}=this;if(e=r===-1&&t!=null&&t.length?t.length-1:r,i)for(let a=e;a--;){let n=t[a].attrs["HDCP-LEVEL"];if(n&&n<=i)return a}return e}get firstAutoLevel(){return this.abrController.firstAutoLevel}get nextAutoLevel(){return this.abrController.nextAutoLevel}set nextAutoLevel(e){this.abrController.nextAutoLevel=e}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get maxBufferLength(){return this.streamController.maxBufferLength}setAudioOption(e){var t;return((t=this.audioTrackController)==null?void 0:t.setAudioOption(e))||null}setSubtitleOption(e){var t;return((t=this.subtitleTrackController)==null?void 0:t.setSubtitleOption(e))||null}get allAudioTracks(){let e=this.audioTrackController;return e?e.allAudioTracks:[]}get audioTracks(){let e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){let e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){let t=this.audioTrackController;t&&(t.audioTrack=e)}get allSubtitleTracks(){let e=this.subtitleTrackController;return e?e.allSubtitleTracks:[]}get subtitleTracks(){let e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){let e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){let t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){let e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){let t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}set targetLatency(e){this.latencyController.targetLatency=e}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}get pathways(){return this.levelController.pathways}get pathwayPriority(){return this.levelController.pathwayPriority}set pathwayPriority(e){this.levelController.pathwayPriority=e}get bufferedToEnd(){var e;return!!((e=this.bufferController)!=null&&e.bufferedToEnd)}get interstitialsManager(){var e;return((e=this.interstitialsController)==null?void 0:e.interstitialsManager)||null}getMediaDecodingInfo(e,t=this.allAudioTracks){return Ni(e,Pa(t),navigator.mediaCapabilities)}}en.defaultConfig=void 0},we.__chunk_3758=ce=>{(()=>{typeof __nccwpck_require__<"u"&&(__nccwpck_require__.ab="//");var O={};({318:function(u,s){(function(x){"use strict";class k extends TypeError{constructor(b,N){let $,{message:X,explanation:ae,...K}=b,{path:ve}=b,ke=ve.length===0?X:`At path: ${ve.join(".")} -- ${X}`;super(ae??ke),ae!=null&&(this.cause=ke),Object.assign(this,K),this.name=this.constructor.name,this.failures=()=>$??($=[b,...N()])}}function E(M){return typeof M=="object"&&M!=null}function S(M){if(Object.prototype.toString.call(M)!=="[object Object]")return!1;let b=Object.getPrototypeOf(M);return b===null||b===Object.prototype}function d(M){return typeof M=="symbol"?M.toString():typeof M=="string"?JSON.stringify(M):`${M}`}function*o(M,b,N,$){var X;for(let ae of(E(X=M)&&typeof X[Symbol.iterator]=="function"||(M=[M]),M)){let K=function(ve,ke,fe,Ae){if(ve===!0)return;ve===!1?ve={}:typeof ve=="string"&&(ve={message:ve});let{path:_e,branch:Z}=ke,{type:ne}=fe,{refinement:W,message:Q=`Expected a value of type \`${ne}\`${W?` with refinement \`${W}\``:""}, but received: \`${d(Ae)}\``}=ve;return{value:Ae,type:ne,refinement:W,key:_e[_e.length-1],path:_e,branch:Z,...ve,message:Q}}(ae,b,N,$);K&&(yield K)}}function*g(M,b,N={}){let{path:$=[],branch:X=[M],coerce:ae=!1,mask:K=!1}=N,ve={path:$,branch:X};if(ae&&(M=b.coercer(M,ve),K&&b.type!=="type"&&E(b.schema)&&E(M)&&!Array.isArray(M)))for(let fe in M)b.schema[fe]===void 0&&delete M[fe];let ke="valid";for(let fe of b.validator(M,ve))fe.explanation=N.message,ke="not_valid",yield[fe,void 0];for(let[fe,Ae,_e]of b.entries(M,ve))for(let Z of g(Ae,_e,{path:fe===void 0?$:[...$,fe],branch:fe===void 0?X:[...X,Ae],coerce:ae,mask:K,message:N.message}))Z[0]?(ke=Z[0].refinement!=null?"not_refined":"not_valid",yield[Z[0],void 0]):ae&&(Ae=Z[1],fe===void 0?M=Ae:M instanceof Map?M.set(fe,Ae):M instanceof Set?M.add(Ae):E(M)&&(Ae!==void 0||fe in M)&&(M[fe]=Ae));if(ke!=="not_valid")for(let fe of b.refiner(M,ve))fe.explanation=N.message,ke="not_refined",yield[fe,void 0];ke==="valid"&&(yield[void 0,M])}class c{constructor(b){let{type:N,schema:$,validator:X,refiner:ae,coercer:K=ke=>ke,entries:ve=function*(){}}=b;this.type=N,this.schema=$,this.entries=ve,this.coercer=K,X?this.validator=(ke,fe)=>o(X(ke,fe),fe,this,ke):this.validator=()=>[],ae?this.refiner=(ke,fe)=>o(ae(ke,fe),fe,this,ke):this.refiner=()=>[]}assert(b,N){return f(b,this,N)}create(b,N){return m(b,this,N)}is(b){return I(b,this)}mask(b,N){return C(b,this,N)}validate(b,N={}){return _(b,this,N)}}function f(M,b,N){let $=_(M,b,{message:N});if($[0])throw $[0]}function m(M,b,N){let $=_(M,b,{coerce:!0,message:N});if(!$[0])return $[1];throw $[0]}function C(M,b,N){let $=_(M,b,{coerce:!0,mask:!0,message:N});if(!$[0])return $[1];throw $[0]}function I(M,b){return!_(M,b)[0]}function _(M,b,N={}){let $=g(M,b,N),X=function(ae){let{done:K,value:ve}=ae.next();return K?void 0:ve}($);return X[0]?[new k(X[0],function*(){for(let ae of $)ae[0]&&(yield ae[0])}),void 0]:[void 0,X[1]]}function R(M,b){return new c({type:M,schema:null,validator:b})}function F(){return R("never",()=>!1)}function L(M){let b=M?Object.keys(M):[],N=F();return new c({type:"object",schema:M||null,*entries($){if(M&&E($)){let X=new Set(Object.keys($));for(let ae of b)X.delete(ae),yield[ae,$[ae],M[ae]];for(let ae of X)yield[ae,$[ae],N]}},validator:$=>E($)||`Expected an object, but received: ${d($)}`,coercer:$=>E($)?{...$}:$})}function U(M){return new c({...M,validator:(b,N)=>b===void 0||M.validator(b,N),refiner:(b,N)=>b===void 0||M.refiner(b,N)})}function te(){return R("string",M=>typeof M=="string"||`Expected a string, but received: ${d(M)}`)}function Y(M){let b=Object.keys(M);return new c({type:"type",schema:M,*entries(N){if(E(N))for(let $ of b)yield[$,N[$],M[$]]},validator:N=>E(N)||`Expected an object, but received: ${d(N)}`,coercer:N=>E(N)?{...N}:N})}function q(){return R("unknown",()=>!0)}function se(M,b,N){return new c({...M,coercer:($,X)=>I($,b)?M.coercer(N($,X),X):M.coercer($,X)})}function J(M){return M instanceof Map||M instanceof Set?M.size:M.length}function j(M,b,N){return new c({...M,*refiner($,X){for(let ae of(yield*M.refiner($,X),o(N($,X),X,M,$)))yield{...ae,refinement:b}}})}x.Struct=c,x.StructError=k,x.any=function(){return R("any",()=>!0)},x.array=function(M){return new c({type:"array",schema:M,*entries(b){if(M&&Array.isArray(b))for(let[N,$]of b.entries())yield[N,$,M]},coercer:b=>Array.isArray(b)?b.slice():b,validator:b=>Array.isArray(b)||`Expected an array value, but received: ${d(b)}`})},x.assert=f,x.assign=function(...M){let b=M[0].type==="type",N=Object.assign({},...M.map($=>$.schema));return b?Y(N):L(N)},x.bigint=function(){return R("bigint",M=>typeof M=="bigint")},x.boolean=function(){return R("boolean",M=>typeof M=="boolean")},x.coerce=se,x.create=m,x.date=function(){return R("date",M=>M instanceof Date&&!isNaN(M.getTime())||`Expected a valid \`Date\` object, but received: ${d(M)}`)},x.defaulted=function(M,b,N={}){return se(M,q(),$=>{let X=typeof b=="function"?b():b;if($===void 0)return X;if(!N.strict&&S($)&&S(X)){let ae={...$},K=!1;for(let ve in X)ae[ve]===void 0&&(ae[ve]=X[ve],K=!0);if(K)return ae}return $})},x.define=R,x.deprecated=function(M,b){return new c({...M,refiner:(N,$)=>N===void 0||M.refiner(N,$),validator:(N,$)=>N===void 0||(b(N,$),M.validator(N,$))})},x.dynamic=function(M){return new c({type:"dynamic",schema:null,*entries(b,N){yield*M(b,N).entries(b,N)},validator:(b,N)=>M(b,N).validator(b,N),coercer:(b,N)=>M(b,N).coercer(b,N),refiner:(b,N)=>M(b,N).refiner(b,N)})},x.empty=function(M){return j(M,"empty",b=>{let N=J(b);return N===0||`Expected an empty ${M.type} but received one with a size of \`${N}\``})},x.enums=function(M){let b={},N=M.map($=>d($)).join();for(let $ of M)b[$]=$;return new c({type:"enums",schema:b,validator:$=>M.includes($)||`Expected one of \`${N}\`, but received: ${d($)}`})},x.func=function(){return R("func",M=>typeof M=="function"||`Expected a function, but received: ${d(M)}`)},x.instance=function(M){return R("instance",b=>b instanceof M||`Expected a \`${M.name}\` instance, but received: ${d(b)}`)},x.integer=function(){return R("integer",M=>typeof M=="number"&&!isNaN(M)&&Number.isInteger(M)||`Expected an integer, but received: ${d(M)}`)},x.intersection=function(M){return new c({type:"intersection",schema:null,*entries(b,N){for(let $ of M)yield*$.entries(b,N)},*validator(b,N){for(let $ of M)yield*$.validator(b,N)},*refiner(b,N){for(let $ of M)yield*$.refiner(b,N)}})},x.is=I,x.lazy=function(M){let b;return new c({type:"lazy",schema:null,*entries(N,$){b??(b=M()),yield*b.entries(N,$)},validator:(N,$)=>(b??(b=M()),b.validator(N,$)),coercer:(N,$)=>(b??(b=M()),b.coercer(N,$)),refiner:(N,$)=>(b??(b=M()),b.refiner(N,$))})},x.literal=function(M){let b=d(M),N=typeof M;return new c({type:"literal",schema:N==="string"||N==="number"||N==="boolean"?M:null,validator:$=>$===M||`Expected the literal \`${b}\`, but received: ${d($)}`})},x.map=function(M,b){return new c({type:"map",schema:null,*entries(N){if(M&&b&&N instanceof Map)for(let[$,X]of N.entries())yield[$,$,M],yield[$,X,b]},coercer:N=>N instanceof Map?new Map(N):N,validator:N=>N instanceof Map||`Expected a \`Map\` object, but received: ${d(N)}`})},x.mask=C,x.max=function(M,b,N={}){let{exclusive:$}=N;return j(M,"max",X=>$?X<b:X<=b||`Expected a ${M.type} less than ${$?"":"or equal to "}${b} but received \`${X}\``)},x.min=function(M,b,N={}){let{exclusive:$}=N;return j(M,"min",X=>$?X>b:X>=b||`Expected a ${M.type} greater than ${$?"":"or equal to "}${b} but received \`${X}\``)},x.never=F,x.nonempty=function(M){return j(M,"nonempty",b=>J(b)>0||`Expected a nonempty ${M.type} but received an empty one`)},x.nullable=function(M){return new c({...M,validator:(b,N)=>b===null||M.validator(b,N),refiner:(b,N)=>b===null||M.refiner(b,N)})},x.number=function(){return R("number",M=>typeof M=="number"&&!isNaN(M)||`Expected a number, but received: ${d(M)}`)},x.object=L,x.omit=function(M,b){let{schema:N}=M,$={...N};for(let X of b)delete $[X];return M.type==="type"?Y($):L($)},x.optional=U,x.partial=function(M){let b=M instanceof c?{...M.schema}:{...M};for(let N in b)b[N]=U(b[N]);return L(b)},x.pattern=function(M,b){return j(M,"pattern",N=>b.test(N)||`Expected a ${M.type} matching \`/${b.source}/\` but received "${N}"`)},x.pick=function(M,b){let{schema:N}=M,$={};for(let X of b)$[X]=N[X];return L($)},x.record=function(M,b){return new c({type:"record",schema:null,*entries(N){if(E(N))for(let $ in N){let X=N[$];yield[$,$,M],yield[$,X,b]}},validator:N=>E(N)||`Expected an object, but received: ${d(N)}`})},x.refine=j,x.regexp=function(){return R("regexp",M=>M instanceof RegExp)},x.set=function(M){return new c({type:"set",schema:null,*entries(b){if(M&&b instanceof Set)for(let N of b)yield[N,N,M]},coercer:b=>b instanceof Set?new Set(b):b,validator:b=>b instanceof Set||`Expected a \`Set\` object, but received: ${d(b)}`})},x.size=function(M,b,N=b){let $=`Expected a ${M.type}`,X=b===N?`of \`${b}\``:`between \`${b}\` and \`${N}\``;return j(M,"size",ae=>{if(typeof ae=="number"||ae instanceof Date)return b<=ae&&ae<=N||`${$} ${X} but received \`${ae}\``;if(ae instanceof Map||ae instanceof Set){let{size:K}=ae;return b<=K&&K<=N||`${$} with a size ${X} but received one with a size of \`${K}\``}{let{length:K}=ae;return b<=K&&K<=N||`${$} with a length ${X} but received one with a length of \`${K}\``}})},x.string=te,x.struct=function(M,b){return console.warn("superstruct@0.11 - The `struct` helper has been renamed to `define`."),R(M,b)},x.trimmed=function(M){return se(M,te(),b=>b.trim())},x.tuple=function(M){let b=F();return new c({type:"tuple",schema:null,*entries(N){if(Array.isArray(N)){let $=Math.max(M.length,N.length);for(let X=0;X<$;X++)yield[X,N[X],M[X]||b]}},validator:N=>Array.isArray(N)||`Expected an array, but received: ${d(N)}`})},x.type=Y,x.union=function(M){let b=M.map(N=>N.type).join(" | ");return new c({type:"union",schema:null,coercer(N){for(let $ of M){let[X,ae]=$.validate(N,{coerce:!0});if(!X)return ae}return N},validator(N,$){let X=[];for(let ae of M){let[...K]=g(N,ae,$),[ve]=K;if(!ve[0])return[];for(let[ke]of K)ke&&X.push(ke)}return[`Expected the value to satisfy a union of \`${b}\`, but received: ${d(N)}`,...X]}})},x.unknown=q,x.validate=_})(s)}})[318](0,O),ce.exports=O})()},we.__chunk_30451=()=>{},we.__chunk_5785=(ce,O,u)=>{ce.exports=u(42095)},we.__chunk_16218=(ce,O,u)=>{"use strict";u.d(O,{WY:()=>k,b1:()=>c,yO:()=>E,O4:()=>R,hQ:()=>f.hQ,b5:()=>S,Wz:()=>g.W,rL:()=>I,S5:()=>C,Hs:()=>s.decodeAction,dH:()=>s.decodeFormState,kf:()=>s.decodeReply,XH:()=>se,$P:()=>Y,C5:()=>te,oH:()=>U,aW:()=>s.renderToReadableStream,Fg:()=>o.O,GP:()=>_,AT:()=>d.A,nr:()=>q});var s=u(4962),x=u(23460);(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/app-router.js#getServerActionDispatcher`),(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/app-router.js#urlToUrlWithoutFlightMarker`),(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/app-router.js#createEmptyCacheNode`);let k=(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/app-router.js#default`),E=(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/layout-router.js#default`),S=(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/render-from-template-context.js#default`);var d=u(81778),o=u(24173),g=u(25715);let c=(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/client-page.js#ClientPageRoot`);var f=u(15449),m=u(59760);function C(J){let j=d.A.getStore();return j&&j.forceStatic?{}:J}function I(J){let j=d.A.getStore();return j?j.forceStatic?{}:j.isStaticGeneration||j.dynamicShouldError?new Proxy({},{get:(M,b,N)=>(typeof b=="string"&&(0,f.TP)(j,"searchParams."+b),m.g.get(M,b,N)),has:(M,b)=>(typeof b=="string"&&(0,f.TP)(j,"searchParams."+b),Reflect.has(M,b)),ownKeys:M=>((0,f.TP)(j,"searchParams"),Reflect.ownKeys(M))}):J:J}var _=u(14896);let R=(0,x.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/not-found-boundary.js#NotFoundBoundary`);var F=u(32981);u(25392);var L=u(39520);function U(J,j){let M={as:"style"};typeof j=="string"&&(M.crossOrigin=j),L.preload(J,M)}function te(J,j,M){let b={as:"font",type:j};typeof M=="string"&&(b.crossOrigin=M),L.preload(J,b)}function Y(J,j){L.preconnect(J,typeof j=="string"?{crossOrigin:j}:void 0)}u(58010);let q=function(){throw Error("Taint can only be used with the taint flag.")};function se(){return(0,F.XH)({serverHooks:_,staticGenerationAsyncStorage:d.A})}},we.__chunk_25392=(ce,O,u)=>{"use strict";u.d(O,{ZP:()=>x});var s=u(23460);(0,s.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/error-boundary.js#ErrorBoundaryHandler`),(0,s.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/error-boundary.js#GlobalError`);let x=(0,s.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/error-boundary.js#default`);(0,s.D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/components/error-boundary.js#ErrorBoundary`)},we.__chunk_50801=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(23460).D)(String.raw`/Volumes/OS/Users/wangbengang/Documents/moontv/MoonTV/node_modules/.pnpm/next@14.2.30_@babel+core@7.28.4_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/next/dist/esm/client/link.js#default`)},we.__chunk_73992=(ce,O,u)=>{"use strict";ce.exports=u(16086)},we.__chunk_12162=(ce,O,u)=>{"use strict";ce.exports=u(20035)},we.__chunk_20035=(ce,O)=>{"use strict";var u=Symbol.for("react.element"),s=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),d=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator,C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,_={};function R(Z,ne,W){this.props=Z,this.context=ne,this.refs=_,this.updater=W||C}function F(){}function L(Z,ne,W){this.props=Z,this.context=ne,this.refs=_,this.updater=W||C}R.prototype.isReactComponent={},R.prototype.setState=function(Z,ne){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,ne,"setState")},R.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")},F.prototype=R.prototype;var U=L.prototype=new F;U.constructor=L,I(U,R.prototype),U.isPureReactComponent=!0;var te=Array.isArray,Y={current:null},q={current:null},se={transition:null},J={ReactCurrentDispatcher:Y,ReactCurrentCache:q,ReactCurrentBatchConfig:se,ReactCurrentOwner:{current:null}},j=Object.prototype.hasOwnProperty,M=J.ReactCurrentOwner;function b(Z,ne,W){var Q,de={},ue=null,ye=null;if(ne!=null)for(Q in ne.ref!==void 0&&(ye=ne.ref),ne.key!==void 0&&(ue=""+ne.key),ne)j.call(ne,Q)&&Q!=="key"&&Q!=="ref"&&Q!=="__self"&&Q!=="__source"&&(de[Q]=ne[Q]);var Ge=arguments.length-2;if(Ge===1)de.children=W;else if(1<Ge){for(var Oe=Array(Ge),Qe=0;Qe<Ge;Qe++)Oe[Qe]=arguments[Qe+2];de.children=Oe}if(Z&&Z.defaultProps)for(Q in Ge=Z.defaultProps)de[Q]===void 0&&(de[Q]=Ge[Q]);return{$$typeof:u,type:Z,key:ue,ref:ye,props:de,_owner:M.current}}function N(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===u}var $=/\/+/g;function X(Z,ne){var W,Q;return typeof Z=="object"&&Z!==null&&Z.key!=null?(W=""+Z.key,Q={"=":"=0",":":"=2"},"$"+W.replace(/[=:]/g,function(de){return Q[de]})):ne.toString(36)}function ae(){}function K(Z,ne,W){if(Z==null)return Z;var Q=[],de=0;return function ue(ye,Ge,Oe,Qe,be){var De,Xe,tt,Ct=typeof ye;(Ct==="undefined"||Ct==="boolean")&&(ye=null);var ct=!1;if(ye===null)ct=!0;else switch(Ct){case"string":case"number":ct=!0;break;case"object":switch(ye.$$typeof){case u:case s:ct=!0;break;case f:return ue((ct=ye._init)(ye._payload),Ge,Oe,Qe,be)}}if(ct)return be=be(ye),ct=Qe===""?"."+X(ye,0):Qe,te(be)?(Oe="",ct!=null&&(Oe=ct.replace($,"$&/")+"/"),ue(be,Ge,Oe,"",function(mt){return mt})):be!=null&&(N(be)&&(De=be,Xe=Oe+(!be.key||ye&&ye.key===be.key?"":(""+be.key).replace($,"$&/")+"/")+ct,be={$$typeof:u,type:De.type,key:Xe,ref:De.ref,props:De.props,_owner:De._owner}),Ge.push(be)),1;ct=0;var Tt=Qe===""?".":Qe+":";if(te(ye))for(var Dt=0;Dt<ye.length;Dt++)Ct=Tt+X(Qe=ye[Dt],Dt),ct+=ue(Qe,Ge,Oe,Ct,be);else if(typeof(Dt=(tt=ye)===null||typeof tt!="object"?null:typeof(tt=m&&tt[m]||tt["@@iterator"])=="function"?tt:null)=="function")for(ye=Dt.call(ye),Dt=0;!(Qe=ye.next()).done;)Ct=Tt+X(Qe=Qe.value,Dt++),ct+=ue(Qe,Ge,Oe,Ct,be);else if(Ct==="object"){if(typeof ye.then=="function")return ue(function(mt){switch(mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason;default:switch(typeof mt.status=="string"?mt.then(ae,ae):(mt.status="pending",mt.then(function(cr){mt.status==="pending"&&(mt.status="fulfilled",mt.value=cr)},function(cr){mt.status==="pending"&&(mt.status="rejected",mt.reason=cr)})),mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason}}throw mt}(ye),Ge,Oe,Qe,be);throw Error("Objects are not valid as a React child (found: "+((Ge=String(ye))==="[object Object]"?"object with keys {"+Object.keys(ye).join(", ")+"}":Ge)+"). If you meant to render a collection of children, use an array instead.")}return ct}(Z,Q,"","",function(ue){return ne.call(W,ue,de++)}),Q}function ve(Z){if(Z._status===-1){var ne=Z._result;(ne=ne()).then(function(W){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=W)},function(W){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=W)}),Z._status===-1&&(Z._status=0,Z._result=ne)}if(Z._status===1)return Z._result.default;throw Z._result}function ke(){return new WeakMap}function fe(){return{s:0,v:void 0,o:null,p:null}}function Ae(){}var _e=typeof reportError=="function"?reportError:function(Z){console.error(Z)};O.Children={map:K,forEach:function(Z,ne,W){K(Z,function(){ne.apply(this,arguments)},W)},count:function(Z){var ne=0;return K(Z,function(){ne++}),ne},toArray:function(Z){return K(Z,function(ne){return ne})||[]},only:function(Z){if(!N(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},O.Component=R,O.Fragment=x,O.Profiler=E,O.PureComponent=L,O.StrictMode=k,O.Suspense=g,O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,O.act=function(){throw Error("act(...) is not supported in production builds of React.")},O.cache=function(Z){return function(){var ne=q.current;if(!ne)return Z.apply(null,arguments);var W=ne.getCacheForType(ke);(ne=W.get(Z))===void 0&&(ne=fe(),W.set(Z,ne)),W=0;for(var Q=arguments.length;W<Q;W++){var de=arguments[W];if(typeof de=="function"||typeof de=="object"&&de!==null){var ue=ne.o;ue===null&&(ne.o=ue=new WeakMap),(ne=ue.get(de))===void 0&&(ne=fe(),ue.set(de,ne))}else(ue=ne.p)===null&&(ne.p=ue=new Map),(ne=ue.get(de))===void 0&&(ne=fe(),ue.set(de,ne))}if(ne.s===1)return ne.v;if(ne.s===2)throw ne.v;try{var ye=Z.apply(null,arguments);return(W=ne).s=1,W.v=ye}catch(Ge){throw(ye=ne).s=2,ye.v=Ge,Ge}}},O.cloneElement=function(Z,ne,W){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var Q=I({},Z.props),de=Z.key,ue=Z.ref,ye=Z._owner;if(ne!=null){if(ne.ref!==void 0&&(ue=ne.ref,ye=M.current),ne.key!==void 0&&(de=""+ne.key),Z.type&&Z.type.defaultProps)var Ge=Z.type.defaultProps;for(Oe in ne)j.call(ne,Oe)&&Oe!=="key"&&Oe!=="ref"&&Oe!=="__self"&&Oe!=="__source"&&(Q[Oe]=ne[Oe]===void 0&&Ge!==void 0?Ge[Oe]:ne[Oe])}var Oe=arguments.length-2;if(Oe===1)Q.children=W;else if(1<Oe){Ge=Array(Oe);for(var Qe=0;Qe<Oe;Qe++)Ge[Qe]=arguments[Qe+2];Q.children=Ge}return{$$typeof:u,type:Z.type,key:de,ref:ue,props:Q,_owner:ye}},O.createContext=function(Z){return(Z={$$typeof:d,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:S,_context:Z},Z.Consumer=Z},O.createElement=b,O.createFactory=function(Z){var ne=b.bind(null,Z);return ne.type=Z,ne},O.createRef=function(){return{current:null}},O.forwardRef=function(Z){return{$$typeof:o,render:Z}},O.isValidElement=N,O.lazy=function(Z){return{$$typeof:f,_payload:{_status:-1,_result:Z},_init:ve}},O.memo=function(Z,ne){return{$$typeof:c,type:Z,compare:ne===void 0?null:ne}},O.startTransition=function(Z){var ne=se.transition,W=new Set;se.transition={_callbacks:W};var Q=se.transition;try{var de=Z();typeof de=="object"&&de!==null&&typeof de.then=="function"&&(W.forEach(function(ue){return ue(Q,de)}),de.then(Ae,_e))}catch(ue){_e(ue)}finally{se.transition=ne}},O.unstable_useCacheRefresh=function(){return Y.current.useCacheRefresh()},O.use=function(Z){return Y.current.use(Z)},O.useCallback=function(Z,ne){return Y.current.useCallback(Z,ne)},O.useContext=function(Z){return Y.current.useContext(Z)},O.useDebugValue=function(){},O.useDeferredValue=function(Z,ne){return Y.current.useDeferredValue(Z,ne)},O.useEffect=function(Z,ne){return Y.current.useEffect(Z,ne)},O.useId=function(){return Y.current.useId()},O.useImperativeHandle=function(Z,ne,W){return Y.current.useImperativeHandle(Z,ne,W)},O.useInsertionEffect=function(Z,ne){return Y.current.useInsertionEffect(Z,ne)},O.useLayoutEffect=function(Z,ne){return Y.current.useLayoutEffect(Z,ne)},O.useMemo=function(Z,ne){return Y.current.useMemo(Z,ne)},O.useOptimistic=function(Z,ne){return Y.current.useOptimistic(Z,ne)},O.useReducer=function(Z,ne,W){return Y.current.useReducer(Z,ne,W)},O.useRef=function(Z){return Y.current.useRef(Z)},O.useState=function(Z){return Y.current.useState(Z)},O.useSyncExternalStore=function(Z,ne,W){return Y.current.useSyncExternalStore(Z,ne,W)},O.useTransition=function(){return Y.current.useTransition()},O.version="18.3.0-canary-178c267a4e-20241218"},we.__chunk_16086=(ce,O,u)=>{"use strict";var s=u(12162),x=Symbol.for("react.element"),k=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),E=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner;function S(d,o,g){var c,f={},m=null,C=null;for(c in g!==void 0&&(m=""+g),o.key!==void 0&&(m=""+o.key),o.ref!==void 0&&(C=o.ref),o)k.call(o,c)&&c!=="key"&&c!=="ref"&&(f[c]=o[c]);if(d&&d.defaultProps)for(c in o=d.defaultProps)f[c]===void 0&&(f[c]=o[c]);return{$$typeof:x,type:d,key:m,ref:C,props:f,_owner:E.current}}O.jsx=S,O.jsxs=S},we.__chunk_66757=(ce,O,u)=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0}),function(S,d){for(var o in d)Object.defineProperty(S,o,{enumerable:!0,get:d[o]})}(O,{interceptTestApis:function(){return k},wrapRequestHandler:function(){return E}});let s=u(17666),x=u(94532);function k(){return(0,x.interceptFetch)(u.g.fetch)}function E(S){return(d,o)=>(0,s.withRequest)(d,x.reader,()=>S(d,o))}},we.__chunk_94532=(ce,O,u)=>{"use strict";var s=u(26195).Buffer;Object.defineProperty(O,"__esModule",{value:!0}),function(o,g){for(var c in g)Object.defineProperty(o,c,{enumerable:!0,get:g[c]})}(O,{handleFetch:function(){return S},interceptFetch:function(){return d},reader:function(){return k}});let x=u(17666),k={url:o=>o.url,header:(o,g)=>o.headers.get(g)};async function E(o,g){let{url:c,method:f,headers:m,body:C,cache:I,credentials:_,integrity:R,mode:F,redirect:L,referrer:U,referrerPolicy:te}=g;return{testData:o,api:"fetch",request:{url:c,method:f,headers:[...Array.from(m),["next-test-stack",function(){let Y=(Error().stack??"").split(`
`);for(let q=1;q<Y.length;q++)if(Y[q].length>0){Y=Y.slice(q);break}return(Y=(Y=(Y=Y.filter(q=>!q.includes("/next/dist/"))).slice(0,5)).map(q=>q.replace("webpack-internal:///(rsc)/","").trim())).join("    ")}()]],body:C?s.from(await g.arrayBuffer()).toString("base64"):null,cache:I,credentials:_,integrity:R,mode:F,redirect:L,referrer:U,referrerPolicy:te}}}async function S(o,g){let c=(0,x.getTestReqInfo)(g,k);if(!c)return o(g);let{testData:f,proxyPort:m}=c,C=await E(f,g),I=await o(`http://localhost:${m}`,{method:"POST",body:JSON.stringify(C),next:{internal:!0}});if(!I.ok)throw Error(`Proxy request failed: ${I.status}`);let _=await I.json(),{api:R}=_;switch(R){case"continue":return o(g);case"abort":case"unhandled":throw Error(`Proxy request aborted [${g.method} ${g.url}]`)}return function(F){let{status:L,headers:U,body:te}=F.response;return new Response(te?s.from(te,"base64"):null,{status:L,headers:new Headers(U)})}(_)}function d(o){return u.g.fetch=function(g,c){var f;return!(c==null||(f=c.next)==null)&&f.internal?o(g,c):S(o,new Request(g,c))},()=>{u.g.fetch=o}}},we.__chunk_17666=(ce,O,u)=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0}),function(S,d){for(var o in d)Object.defineProperty(S,o,{enumerable:!0,get:d[o]})}(O,{getTestReqInfo:function(){return E},withRequest:function(){return k}});let s=new(u(2067)).AsyncLocalStorage;function x(S,d){let o=d.header(S,"next-test-proxy-port");if(o)return{url:d.url(S),proxyPort:Number(o),testData:d.header(S,"next-test-data")||""}}function k(S,d,o){let g=x(S,d);return g?s.run(g,o):o()}function E(S,d){return s.getStore()||(S&&d?x(S,d):void 0)}},we.__chunk_67577=(ce,O,u)=>{"use strict";function s(c){let f,m=!1;return function(){for(var C=arguments.length,I=Array(C),_=0;_<C;_++)I[_]=arguments[_];return m||(m=!0,f=c(...I)),f}}u.d(O,{At:()=>g,Dp:()=>E,KM:()=>o,U3:()=>S,_9:()=>d,gf:()=>s,sD:()=>k});let x=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,k=c=>x.test(c);function E(){let{protocol:c,hostname:f,port:m}=window.location;return c+"//"+f+(m?":"+m:"")}function S(c){let f=c.split("?");return f[0].replace(/\\/g,"/").replace(/\/\/+/g,"/")+(f[1]?"?"+f.slice(1).join("?"):"")}typeof performance<"u"&&["mark","measure","getEntriesByName"].every(c=>typeof performance[c]=="function");class d extends Error{}class o extends Error{}class g extends Error{constructor(f,m){super(),this.message="Failed to load static file for page: "+f+" "+m}}},we.__chunk_74917=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{ServerInsertedHTMLContext:()=>x,useServerInsertedHTML:()=>k});var s=u(24528);let x=s.createContext(null);function k(E){let S=(0,s.useContext)(x);S&&S(E)}},we.__chunk_69720=(ce,O,u)=>{"use strict";function s(E){return E[0]==="("&&E.endsWith(")")}u.d(O,{GC:()=>x,av:()=>k,lv:()=>s});let x="__PAGE__",k="__DEFAULT__"},we.__chunk_76891=(ce,O,u)=>{"use strict";u.d(O,{JV:()=>g,b8:()=>S,vG:()=>d});var s=u(78045),x=u(78342),k=u(13544),E=u(19762);function S(c){let f=c.startsWith("[")&&c.endsWith("]");f&&(c=c.slice(1,-1));let m=c.startsWith("...");return m&&(c=c.slice(3)),{key:c,repeat:m,optional:f}}function d(c){let{parameterizedRoute:f,groups:m}=function(C){let I=(0,E.Q)(C).slice(1).split("/"),_={},R=1;return{parameterizedRoute:I.map(F=>{let L=x.Wz.find(te=>F.startsWith(te)),U=F.match(/\[((?:\[.*\])|.+)\]/);if(L&&U){let{key:te,optional:Y,repeat:q}=S(U[1]);return _[te]={pos:R++,repeat:q,optional:Y},"/"+(0,k.f)(L)+"([^/]+?)"}if(!U)return"/"+(0,k.f)(F);{let{key:te,repeat:Y,optional:q}=S(U[1]);return _[te]={pos:R++,repeat:Y,optional:q},Y?q?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:_}}(c);return{re:RegExp("^"+f+"(?:/)?$"),groups:m}}function o(c){let{interceptionMarker:f,getSafeRouteKey:m,segment:C,routeKeys:I,keyPrefix:_}=c,{key:R,optional:F,repeat:L}=S(C),U=R.replace(/\W/g,"");_&&(U=""+_+U);let te=!1;(U.length===0||U.length>30)&&(te=!0),isNaN(parseInt(U.slice(0,1)))||(te=!0),te&&(U=m()),_?I[U]=""+_+R:I[U]=R;let Y=f?(0,k.f)(f):"";return L?F?"(?:/"+Y+"(?<"+U+">.+?))?":"/"+Y+"(?<"+U+">.+?)":"/"+Y+"(?<"+U+">[^/]+?)"}function g(c,f){let m=function(C,I){let _,R=(0,E.Q)(C).slice(1).split("/"),F=(_=0,()=>{let U="",te=++_;for(;te>0;)U+=String.fromCharCode(97+(te-1)%26),te=Math.floor((te-1)/26);return U}),L={};return{namedParameterizedRoute:R.map(U=>{let te=x.Wz.some(q=>U.startsWith(q)),Y=U.match(/\[((?:\[.*\])|.+)\]/);if(te&&Y){let[q]=U.split(Y[0]);return o({getSafeRouteKey:F,interceptionMarker:q,segment:Y[1],routeKeys:L,keyPrefix:I?s.u7:void 0})}return Y?o({getSafeRouteKey:F,segment:Y[1],routeKeys:L,keyPrefix:I?s.dN:void 0}):"/"+(0,k.f)(U)}).join(""),routeKeys:L}}(c,f);return{...d(c),namedRegex:"^"+m.namedParameterizedRoute+"(?:/)?$",routeKeys:m.routeKeys}}},we.__chunk_15076=(ce,O,u)=>{"use strict";u.d(O,{t:()=>x});var s=u(67577);function x(k){let{re:E,groups:S}=k;return d=>{let o=E.exec(d);if(!o)return!1;let g=f=>{try{return decodeURIComponent(f)}catch{throw new s._9("failed to decode param")}},c={};return Object.keys(S).forEach(f=>{let m=S[f],C=o[m.pos];C!==void 0&&(c[f]=~C.indexOf("/")?C.split("/").map(I=>g(I)):m.repeat?[g(C)]:g(C))}),c}}},we.__chunk_19762=(ce,O,u)=>{"use strict";function s(x){return x.replace(/\/$/,"")||"/"}u.d(O,{Q:()=>s})},we.__chunk_53584=(ce,O,u)=>{"use strict";u.d(O,{n:()=>x});var s=u(39338);function x(k,E){if(!(0,s.Y)(k,E))return k;let S=k.slice(E.length);return S.startsWith("/")?S:"/"+S}},we.__chunk_28160=(ce,O,u)=>{"use strict";function s(E){let S={};return E.forEach((d,o)=>{S[o]===void 0?S[o]=d:Array.isArray(S[o])?S[o].push(d):S[o]=[S[o],d]}),S}function x(E){return typeof E!="string"&&(typeof E!="number"||isNaN(E))&&typeof E!="boolean"?"":String(E)}function k(E){let S=new URLSearchParams;return Object.entries(E).forEach(d=>{let[o,g]=d;Array.isArray(g)?g.forEach(c=>S.append(o,x(c))):S.set(o,x(g))}),S}u.d(O,{Nn:()=>k,u5:()=>s})},we.__chunk_39338=(ce,O,u)=>{"use strict";u.d(O,{Y:()=>x});var s=u(69285);function x(k,E){if(typeof k!="string")return!1;let{pathname:S}=(0,s.c)(k);return S===E||S.startsWith(E+"/")}},we.__chunk_69285=(ce,O,u)=>{"use strict";function s(x){let k=x.indexOf("#"),E=x.indexOf("?"),S=E>-1&&(k<0||E<k);return S||k>-1?{pathname:x.substring(0,S?E:k),query:S?x.substring(E,k>-1?k:void 0):"",hash:k>-1?x.slice(k):""}:{pathname:x,query:"",hash:""}}u.d(O,{c:()=>s})},we.__chunk_26845=(ce,O,u)=>{"use strict";u.d(O,{$:()=>k});var s=u(78342);let x=/\/\[[^/]+?\](?=\/|$)/;function k(E){return(0,s.Ag)(E)&&(E=(0,s.CK)(E).interceptedRoute),x.test(E)}},we.__chunk_28275=(ce,O,u)=>{"use strict";function s(x){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(x)}u.d(O,{Q:()=>s})},we.__chunk_6141=(ce,O,u)=>{"use strict";u.d(O,{a:()=>E});var s=u(55744),x=u(53584),k=u(39338);function E(S,d){var o,g;let{basePath:c,i18n:f,trailingSlash:m}=(o=d.nextConfig)!=null?o:{},C={pathname:S,trailingSlash:S!=="/"?S.endsWith("/"):m};c&&(0,k.Y)(C.pathname,c)&&(C.pathname=(0,x.n)(C.pathname,c),C.basePath=c);let I=C.pathname;if(C.pathname.startsWith("/_next/data/")&&C.pathname.endsWith(".json")){let _=C.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/"),R=_[0];C.buildId=R,I=_[1]!=="index"?"/"+_.slice(1).join("/"):"/",d.parseData===!0&&(C.pathname=I)}if(f){let _=d.i18nProvider?d.i18nProvider.analyze(C.pathname):(0,s.h)(C.pathname,f.locales);C.locale=_.detectedLocale,C.pathname=(g=_.pathname)!=null?g:C.pathname,!_.detectedLocale&&C.buildId&&(_=d.i18nProvider?d.i18nProvider.analyze(I):(0,s.h)(I,f.locales)).detectedLocale&&(C.locale=_.detectedLocale)}return C}},we.__chunk_46737=(ce,O,u)=>{"use strict";u.d(O,{b:()=>E,w:()=>k});var s=u(30537),x=u(69720);function k(S){return(0,s.e)(S.split("/").reduce((d,o,g,c)=>!o||(0,x.lv)(o)||o[0]==="@"||(o==="page"||o==="route")&&g===c.length-1?d:d+"/"+o,""))}function E(S){return S.replace(/\.rsc($|\?)/,"$1")}},we.__chunk_15109=(ce,O,u)=>{"use strict";u.d(O,{V:()=>x});var s=u(69285);function x(k,E){if(!k.startsWith("/")||!E)return k;let{pathname:S,query:d,hash:o}=(0,s.c)(k);return""+E+S+d+o}},we.__chunk_99189=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{RouterContext:()=>s});let s=u(24528).createContext(null)},we.__chunk_72584=(ce,O,u)=>{"use strict";u.d(O,{y:()=>k});var s=u(30537),x=u(26845);function k(E){return/^\/index(\/|$)/.test(E)&&!(0,x.$)(E)?"/index"+E:E==="/"?"/index":(0,s.e)(E)}u(67577)},we.__chunk_30537=(ce,O,u)=>{"use strict";function s(x){return x.startsWith("/")?x:"/"+x}u.d(O,{e:()=>s})},we.__chunk_49426=ce=>{"use strict";ce.exports=["chrome 64","edge 79","firefox 67","opera 51","safari 12"]},we.__chunk_33262=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{LoadableContext:()=>s});let s=u(24528).createContext(null)},we.__chunk_4248=(ce,O,u)=>{"use strict";u.d(O,{D:()=>k,Z:()=>x});let s="BAILOUT_TO_CLIENT_SIDE_RENDERING";class x extends Error{constructor(S){super("Bail out to client-side rendering: "+S),this.reason=S,this.digest=s}}function k(E){return typeof E=="object"&&E!==null&&"digest"in E&&E.digest===s}},we.__chunk_44813=(ce,O,u)=>{"use strict";let s;s=u(75665),ce.exports=s},we.__chunk_84667=(ce,O,u)=>{"use strict";u.d(O,{z:()=>s});let s={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",localPatterns:void 0,remotePatterns:[],qualities:void 0,unoptimized:!1}},we.__chunk_58350=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{ImageConfigContext:()=>k});var s=u(24528),x=u(84667);let k=s.createContext(x.z)},we.__chunk_55744=(ce,O,u)=>{"use strict";function s(x,k){let E,S=x.split("/");return(k||[]).some(d=>!!S[1]&&S[1].toLowerCase()===d.toLowerCase()&&(E=d,S.splice(1,1),x=S.join("/")||"/",!0)),{pathname:x,detectedLocale:E}}u.d(O,{h:()=>s})},we.__chunk_86270=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{PathParamsContext:()=>E,PathnameContext:()=>k,SearchParamsContext:()=>x});var s=u(24528);let x=(0,s.createContext)(null),k=(0,s.createContext)(null),E=(0,s.createContext)(null)},we.__chunk_8429=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{HeadManagerContext:()=>s});let s=u(24528).createContext({})},we.__chunk_58784=(ce,O,u)=>{"use strict";function s(k){let E=5381;for(let S=0;S<k.length;S++)E=(E<<5)+E+k.charCodeAt(S)&4294967295;return E>>>0}function x(k){return s(k).toString(36).slice(0,5)}u.d(O,{a:()=>x,p:()=>s})},we.__chunk_431=(ce,O,u)=>{"use strict";function s(x,k){let E;if(k?.host&&!Array.isArray(k.host))E=k.host.toString().split(":",1)[0];else{if(!x.hostname)return;E=x.hostname}return E.toLowerCase()}u.d(O,{F:()=>s})},we.__chunk_13544=(ce,O,u)=>{"use strict";u.d(O,{f:()=>k});let s=/[|\\{}()[\]^$+*?.-]/,x=/[|\\{}()[\]^$+*?.-]/g;function k(E){return s.test(E)?E.replace(x,"\\$&"):E}},we.__chunk_24351=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{AppRouterContext:()=>x,GlobalLayoutRouterContext:()=>E,LayoutRouterContext:()=>k,MissingSlotContext:()=>d,TemplateContext:()=>S});var s=u(24528);let x=s.createContext(null),k=s.createContext(null),E=s.createContext(null),S=s.createContext(null),d=s.createContext(new Set)},we.__chunk_440=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{AmpStateContext:()=>s});let s=u(24528).createContext({})},we.__chunk_43150=(ce,O,u)=>{"use strict";u.d(O,{EK:()=>x,LI:()=>d,l$:()=>k,lb:()=>E,r4:()=>S});var s=u(78045);function x(o){let g=new Headers;for(let[c,f]of Object.entries(o))for(let m of Array.isArray(f)?f:[f])m!==void 0&&(typeof m=="number"&&(m=m.toString()),g.append(c,m));return g}function k(o){var g,c,f,m,C,I=[],_=0;function R(){for(;_<o.length&&/\s/.test(o.charAt(_));)_+=1;return _<o.length}for(;_<o.length;){for(g=_,C=!1;R();)if((c=o.charAt(_))===","){for(f=_,_+=1,R(),m=_;_<o.length&&(c=o.charAt(_))!=="="&&c!==";"&&c!==",";)_+=1;_<o.length&&o.charAt(_)==="="?(C=!0,_=m,I.push(o.substring(g,f)),g=_):_=f+1}else _+=1;(!C||_>=o.length)&&I.push(o.substring(g,o.length))}return I}function E(o){let g={},c=[];if(o)for(let[f,m]of o.entries())f.toLowerCase()==="set-cookie"?(c.push(...k(m)),g[f]=c.length===1?c[0]:c):g[f]=m;return g}function S(o){try{return String(new URL(String(o)))}catch(g){throw Error(`URL is malformed "${String(o)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:g})}}function d(o,g){for(let c of[s.dN,s.u7])o!==c&&o.startsWith(c)&&g(o.substring(c.length))}},we.__chunk_17349=(ce,O,u)=>{"use strict";u.d(O,{I:()=>d});var s=u(70650),x=u(43150),k=u(37152),E=u(1434);let S=Symbol("internal request");class d extends Request{constructor(g,c={}){let f=typeof g!="string"&&"url"in g?g.url:String(g);(0,x.r4)(f),g instanceof Request?super(g,c):super(f,c);let m=new s.c(f,{headers:(0,x.lb)(this.headers),nextConfig:c.nextConfig});this[S]={cookies:new E.qC(this.headers),geo:c.geo||{},ip:c.ip,nextUrl:m,url:m.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,geo:this.geo,ip:this.ip,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[S].cookies}get geo(){return this[S].geo}get ip(){return this[S].ip}get nextUrl(){return this[S].nextUrl}get page(){throw new k.cR}get ua(){throw new k.Y5}get url(){return this[S].url}}},we.__chunk_1434=(ce,O,u)=>{"use strict";u.d(O,{Q7:()=>s.stringifyCookie,nV:()=>s.ResponseCookies,qC:()=>s.RequestCookies});var s=u(73850)},we.__chunk_73343=(ce,O,u)=>{"use strict";u.d(O,{Qb:()=>S,_5:()=>g,fB:()=>o,vr:()=>c});var s=u(1434),x=u(58056),k=u(81778);class E extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#cookiessetname-value-options")}static callable(){throw new E}}class S{static seal(m){return new Proxy(m,{get(C,I,_){switch(I){case"clear":case"delete":case"set":return E.callable;default:return x.g.get(C,I,_)}}})}}let d=Symbol.for("next.mutated.cookies");function o(f){let m=f[d];return m&&Array.isArray(m)&&m.length!==0?m:[]}function g(f,m){let C=o(m);if(C.length===0)return!1;let I=new s.nV(f),_=I.getAll();for(let R of C)I.set(R);for(let R of _)I.set(R);return!0}class c{static wrap(m,C){let I=new s.nV(new Headers);for(let L of m.getAll())I.set(L);let _=[],R=new Set,F=()=>{let L=k.A.getStore();if(L&&(L.pathWasRevalidated=!0),_=I.getAll().filter(U=>R.has(U.name)),C){let U=[];for(let te of _){let Y=new s.nV(new Headers);Y.set(te),U.push(Y.toString())}C(U)}};return new Proxy(I,{get(L,U,te){switch(U){case d:return _;case"delete":return function(...Y){R.add(typeof Y[0]=="string"?Y[0]:Y[0].name);try{L.delete(...Y)}finally{F()}};case"set":return function(...Y){R.add(typeof Y[0]=="string"?Y[0]:Y[0].name);try{return L.set(...Y)}finally{F()}};default:return x.g.get(L,U,te)}}})}}},we.__chunk_58056=(ce,O,u)=>{"use strict";u.d(O,{g:()=>s});class s{static get(k,E,S){let d=Reflect.get(k,E,S);return typeof d=="function"?d.bind(k):d}static set(k,E,S,d){return Reflect.set(k,E,S,d)}static has(k,E){return Reflect.has(k,E)}static deleteProperty(k,E){return Reflect.deleteProperty(k,E)}}},we.__chunk_58301=(ce,O,u)=>{"use strict";u.d(O,{Og:()=>g,Ub:()=>o,WK:()=>E,yi:()=>d});var s=u(75698),x=u(43150),k=u(17349);let E="ResponseAborted";class S extends Error{constructor(...f){super(...f),this.name=E}}function d(c){let f=new AbortController;return c.once("close",()=>{c.writableFinished||f.abort(new S)}),f}function o(c){let{errored:f,destroyed:m}=c;if(f||m)return AbortSignal.abort(f??new S);let{signal:C}=d(c);return C}class g{static fromBaseNextRequest(f,m){return"request"in f&&f.request?g.fromWebNextRequest(f):g.fromNodeNextRequest(f,m)}static fromNodeNextRequest(f,m){let C,I=null;if(f.method!=="GET"&&f.method!=="HEAD"&&f.body&&(I=f.body),f.url.startsWith("http"))C=new URL(f.url);else{let _=(0,s.OX)(f,"initURL");C=_&&_.startsWith("http")?new URL(f.url,_):new URL(f.url,"http://n")}return new k.I(C,{method:f.method,headers:(0,x.EK)(f.headers),duplex:"half",signal:m,...m.aborted?{}:{body:I}})}static fromWebNextRequest(f){let m=null;return f.method!=="GET"&&f.method!=="HEAD"&&(m=f.body),new k.I(f.url,{method:f.method,headers:(0,x.EK)(f.headers),duplex:"half",signal:f.request.signal,...f.request.signal.aborted?{}:{body:m}})}}},we.__chunk_37842=(ce,O,u)=>{"use strict";u.d(O,{h:()=>k});var s=u(58056);class x extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new x}}class k extends Headers{constructor(S){super(),this.headers=new Proxy(S,{get(d,o,g){if(typeof o=="symbol")return s.g.get(d,o,g);let c=o.toLowerCase(),f=Object.keys(S).find(m=>m.toLowerCase()===c);if(f!==void 0)return s.g.get(d,f,g)},set(d,o,g,c){if(typeof o=="symbol")return s.g.set(d,o,g,c);let f=o.toLowerCase(),m=Object.keys(S).find(C=>C.toLowerCase()===f);return s.g.set(d,m??o,g,c)},has(d,o){if(typeof o=="symbol")return s.g.has(d,o);let g=o.toLowerCase(),c=Object.keys(S).find(f=>f.toLowerCase()===g);return c!==void 0&&s.g.has(d,c)},deleteProperty(d,o){if(typeof o=="symbol")return s.g.deleteProperty(d,o);let g=o.toLowerCase(),c=Object.keys(S).find(f=>f.toLowerCase()===g);return c===void 0||s.g.deleteProperty(d,c)}})}static seal(S){return new Proxy(S,{get(d,o,g){switch(o){case"append":case"delete":case"set":return x.callable;default:return s.g.get(d,o,g)}}})}merge(S){return Array.isArray(S)?S.join(", "):S}static from(S){return S instanceof Headers?S:new k(S)}append(S,d){let o=this.headers[S];typeof o=="string"?this.headers[S]=[o,d]:Array.isArray(o)?o.push(d):this.headers[S]=d}delete(S){delete this.headers[S]}get(S){let d=this.headers[S];return d!==void 0?this.merge(d):null}has(S){return this.headers[S]!==void 0}set(S,d){this.headers[S]=d}forEach(S,d){for(let[o,g]of this.entries())S.call(d,g,o,this)}*entries(){for(let S of Object.keys(this.headers)){let d=S.toLowerCase(),o=this.get(d);yield[d,o]}}*keys(){for(let S of Object.keys(this.headers))yield S.toLowerCase()}*values(){for(let S of Object.keys(this.headers))yield this.get(S)}[Symbol.iterator](){return this.entries()}}},we.__chunk_70650=(ce,O,u)=>{"use strict";u.d(O,{c:()=>m});var s=u(19762),x=u(15109),k=u(69285);function E(C,I){if(!C.startsWith("/")||!I)return C;let{pathname:_,query:R,hash:F}=(0,k.c)(C);return""+_+I+R+F}var S=u(39338),d=u(431),o=u(6141);let g=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function c(C,I){return new URL(String(C).replace(g,"localhost"),I&&String(I).replace(g,"localhost"))}let f=Symbol("NextURLInternal");class m{constructor(I,_,R){let F,L;typeof _=="object"&&"pathname"in _||typeof _=="string"?(F=_,L=R||{}):L=R||_||{},this[f]={url:c(I,F??L.base),options:L,basePath:""},this.analyze()}analyze(){var I,_,R,F,L;let U=(0,o.a)(this[f].url.pathname,{nextConfig:this[f].options.nextConfig,parseData:!0,i18nProvider:this[f].options.i18nProvider}),te=(0,d.F)(this[f].url,this[f].options.headers);this[f].domainLocale=this[f].options.i18nProvider?this[f].options.i18nProvider.detectDomainLocale(te):function(q,se,J){if(q)for(let b of(J&&(J=J.toLowerCase()),q)){var j,M;if(se===((j=b.domain)==null?void 0:j.split(":",1)[0].toLowerCase())||J===b.defaultLocale.toLowerCase()||((M=b.locales)==null?void 0:M.some(N=>N.toLowerCase()===J)))return b}}((_=this[f].options.nextConfig)==null||(I=_.i18n)==null?void 0:I.domains,te);let Y=((R=this[f].domainLocale)==null?void 0:R.defaultLocale)||((L=this[f].options.nextConfig)==null||(F=L.i18n)==null?void 0:F.defaultLocale);this[f].url.pathname=U.pathname,this[f].defaultLocale=Y,this[f].basePath=U.basePath??"",this[f].buildId=U.buildId,this[f].locale=U.locale??Y,this[f].trailingSlash=U.trailingSlash}formatPathname(){var I;let _;return _=function(R,F,L,U){if(!F||F===L)return R;let te=R.toLowerCase();return!U&&((0,S.Y)(te,"/api")||(0,S.Y)(te,"/"+F.toLowerCase()))?R:(0,x.V)(R,"/"+F)}((I={basePath:this[f].basePath,buildId:this[f].buildId,defaultLocale:this[f].options.forceLocale?void 0:this[f].defaultLocale,locale:this[f].locale,pathname:this[f].url.pathname,trailingSlash:this[f].trailingSlash}).pathname,I.locale,I.buildId?void 0:I.defaultLocale,I.ignorePrefix),(I.buildId||!I.trailingSlash)&&(_=(0,s.Q)(_)),I.buildId&&(_=E((0,x.V)(_,"/_next/data/"+I.buildId),I.pathname==="/"?"index.json":".json")),_=(0,x.V)(_,I.basePath),!I.buildId&&I.trailingSlash?_.endsWith("/")?_:E(_,"/"):(0,s.Q)(_)}formatSearch(){return this[f].url.search}get buildId(){return this[f].buildId}set buildId(I){this[f].buildId=I}get locale(){return this[f].locale??""}set locale(I){var _,R;if(!this[f].locale||!(!((R=this[f].options.nextConfig)==null||(_=R.i18n)==null)&&_.locales.includes(I)))throw TypeError(`The NextURL configuration includes no locale "${I}"`);this[f].locale=I}get defaultLocale(){return this[f].defaultLocale}get domainLocale(){return this[f].domainLocale}get searchParams(){return this[f].url.searchParams}get host(){return this[f].url.host}set host(I){this[f].url.host=I}get hostname(){return this[f].url.hostname}set hostname(I){this[f].url.hostname=I}get port(){return this[f].url.port}set port(I){this[f].url.port=I}get protocol(){return this[f].url.protocol}set protocol(I){this[f].url.protocol=I}get href(){let I=this.formatPathname(),_=this.formatSearch();return`${this.protocol}//${this.host}${I}${_}${this.hash}`}set href(I){this[f].url=c(I),this.analyze()}get origin(){return this[f].url.origin}get pathname(){return this[f].url.pathname}set pathname(I){this[f].url.pathname=I}get hash(){return this[f].url.hash}set hash(I){this[f].url.hash=I}get search(){return this[f].url.search}set search(I){this[f].url.search=I}get password(){return this[f].url.password}set password(I){this[f].url.password=I}get username(){return this[f].url.username}set username(I){this[f].url.username=I}get basePath(){return this[f].basePath}set basePath(I){this[f].basePath=I.startsWith("/")?I:`/${I}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new m(String(this),this[f].options)}}},we.__chunk_15672=(ce,O,u)=>{"use strict";async function s(){let S="_ENTRIES"in aa&&_ENTRIES.middleware_instrumentation&&(await _ENTRIES.middleware_instrumentation).register;if(S)try{await S()}catch(d){throw d.message=`An error occurred while loading instrumentation hook: ${d.message}`,d}}u.d(O,{H:()=>k});let x=null;function k(){return x||(x=s()),x}function E(S){return`The edge runtime does not support Node.js '${S}' module.
Learn More: https://nextjs.org/docs/messages/node-module-in-edge-runtime`}process!==u.g.process&&(process.env=u.g.process.env,u.g.process=process),Object.defineProperty(aa,"__import_unsupported",{value:function(S){let d=new Proxy(function(){},{get(o,g){if(g==="then")return{};throw Error(E(S))},construct(){throw Error(E(S))},apply(o,g,c){if(typeof c[0]=="function")return c[0](d);throw Error(E(S))}});return new Proxy({},{get:()=>d})},enumerable:!1,configurable:!0}),k()},we.__chunk_75471=(ce,O,u)=>{"use strict";function s(){return{previewModeId:process.env.__NEXT_PREVIEW_MODE_ID,previewModeSigningKey:process.env.__NEXT_PREVIEW_MODE_SIGNING_KEY||"",previewModeEncryptionKey:process.env.__NEXT_PREVIEW_MODE_ENCRYPTION_KEY||""}}u.d(O,{X:()=>s})},we.__chunk_37152=(ce,O,u)=>{"use strict";u.d(O,{Y5:()=>k,cR:()=>x,qJ:()=>s});class s extends Error{constructor({page:S}){super(`The middleware "${S}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class x extends Error{constructor(){super("The request.page has been deprecated in favour of `URLPattern`.\n  Read more: https://nextjs.org/docs/messages/middleware-request-page\n  ")}}class k extends Error{constructor(){super("The request.ua has been removed in favour of `userAgent` function.\n  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent\n  ")}}},we.__chunk_59672=(ce,O,u)=>{"use strict";u.d(O,{C:()=>ae});var s=u(37152),x=u(43150);let k=Symbol("response"),E=Symbol("passThrough"),S=Symbol("waitUntil");class d{constructor(ve){this[S]=[],this[E]=!1}respondWith(ve){this[k]||(this[k]=Promise.resolve(ve))}passThroughOnException(){this[E]=!0}waitUntil(ve){this[S].push(ve)}}class o extends d{constructor(ve){super(ve.request),this.sourcePage=ve.page}get request(){throw new s.qJ({page:this.sourcePage})}respondWith(){throw new s.qJ({page:this.sourcePage})}}var g=u(17349),c=u(1434),f=u(70650),m=u(58056);let C=Symbol("internal response"),I=new Set([301,302,303,307,308]);function _(K,ve){var ke;if(!(K==null||(ke=K.request)==null)&&ke.headers){if(!(K.request.headers instanceof Headers))throw Error("request.headers must be an instance of Headers");let fe=[];for(let[Ae,_e]of K.request.headers)ve.set("x-middleware-request-"+Ae,_e),fe.push(Ae);ve.set("x-middleware-override-headers",fe.join(","))}}class R extends Response{constructor(ve,ke={}){super(ve,ke);let fe=this.headers,Ae=new Proxy(new c.nV(fe),{get(_e,Z,ne){switch(Z){case"delete":case"set":return(...W)=>{let Q=Reflect.apply(_e[Z],_e,W),de=new Headers(fe);return Q instanceof c.nV&&fe.set("x-middleware-set-cookie",Q.getAll().map(ue=>(0,c.Q7)(ue)).join(",")),_(ke,de),Q};default:return m.g.get(_e,Z,ne)}}});this[C]={cookies:Ae,url:ke.url?new f.c(ke.url,{headers:(0,x.lb)(fe),nextConfig:ke.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[C].cookies}static json(ve,ke){let fe=Response.json(ve,ke);return new R(fe.body,fe)}static redirect(ve,ke){let fe=typeof ke=="number"?ke:ke?.status??307;if(!I.has(fe))throw RangeError('Failed to execute "redirect" on "response": Invalid status code');let Ae=typeof ke=="object"?ke:{},_e=new Headers(Ae?.headers);return _e.set("Location",(0,x.r4)(ve)),new R(null,{...Ae,headers:_e,status:fe})}static rewrite(ve,ke){let fe=new Headers(ke?.headers);return fe.set("x-middleware-rewrite",(0,x.r4)(ve)),_(ke,fe),new R(null,{...ke,headers:fe})}static next(ve){let ke=new Headers(ve?.headers);return ke.set("x-middleware-next","1"),_(ve,ke),new R(null,{...ve,headers:ke})}}function F(K,ve){let ke=typeof ve=="string"?new URL(ve):ve,fe=new URL(K,ve),Ae=ke.protocol+"//"+ke.host;return fe.protocol+"//"+fe.host===Ae?fe.toString().replace(Ae,""):fe.toString()}var L=u(37041),U=u(46737),te=u(48210),Y=u(15672),q=u(1533),se=u(24173),J=u(2147),j=u(61583),M=u(75471);class b extends g.I{constructor(ve){super(ve.input,ve.init),this.sourcePage=ve.page}get request(){throw new s.qJ({page:this.sourcePage})}respondWith(){throw new s.qJ({page:this.sourcePage})}waitUntil(){throw new s.qJ({page:this.sourcePage})}}let N={keys:K=>Array.from(K.keys()),get:(K,ve)=>K.get(ve)??void 0},$=(K,ve)=>(0,J.Yz)().withPropagatedContext(K.headers,ve,N),X=!1;async function ae(K){let ve,ke;(function(){if(!X&&(X=!0,process.env.NEXT_PRIVATE_TEST_PROXY==="true")){let{interceptTestApis:be,wrapRequestHandler:De}=u(66757);be(),$=De($)}})(),await(0,Y.H)();let fe=ut.__BUILD_MANIFEST!==void 0;K.request.url=(0,U.b)(K.request.url);let Ae=new f.c(K.request.url,{headers:K.request.headers,nextConfig:K.request.nextConfig});for(let be of[...Ae.searchParams.keys()]){let De=Ae.searchParams.getAll(be);(0,x.LI)(be,Xe=>{for(let tt of(Ae.searchParams.delete(Xe),De))Ae.searchParams.append(Xe,tt);Ae.searchParams.delete(be)})}let _e=Ae.buildId;Ae.buildId="";let Z=K.request.headers["x-nextjs-data"];Z&&Ae.pathname==="/index"&&(Ae.pathname="/");let ne=(0,x.EK)(K.request.headers),W=new Map;if(!fe)for(let be of te.vu){let De=be.toString().toLowerCase();ne.get(De)&&(W.set(De,ne.get(De)),ne.delete(De))}let Q=new b({page:K.page,input:(0,L.T)(Ae,!0).toString(),init:{body:K.request.body,geo:K.request.geo,headers:ne,ip:K.request.ip,method:K.request.method,nextConfig:K.request.nextConfig,signal:K.request.signal}});Z&&Object.defineProperty(Q,"__isData",{enumerable:!1,value:!0}),!aa.__incrementalCacheShared&&K.IncrementalCache&&(aa.__incrementalCache=new K.IncrementalCache({appDir:!0,fetchCache:!0,minimalMode:!0,fetchCacheKeyPrefix:"",dev:!1,requestHeaders:K.request.headers,requestProtocol:"https",getPrerenderManifest:()=>({version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:(0,M.X)()})}));let de=new o({request:Q,page:K.page});if((ve=await $(Q,()=>K.page==="/middleware"||K.page==="/src/middleware"?(0,J.Yz)().trace(j.dI.execute,{spanName:`middleware ${Q.method} ${Q.nextUrl.pathname}`,attributes:{"http.target":Q.nextUrl.pathname,"http.method":Q.method}},()=>q.B.wrap(se.O,{req:Q,renderOpts:{onUpdateCookies:be=>{ke=be},previewProps:(0,M.X)()}},()=>K.handler(Q,de))):K.handler(Q,de)))&&!(ve instanceof Response))throw TypeError("Expected an instance of Response to be returned");ve&&ke&&ve.headers.set("set-cookie",ke);let ue=ve?.headers.get("x-middleware-rewrite");if(ve&&ue&&!fe){let be=new f.c(ue,{forceLocale:!0,headers:K.request.headers,nextConfig:K.request.nextConfig});be.host===Q.nextUrl.host&&(be.buildId=_e||be.buildId,ve.headers.set("x-middleware-rewrite",String(be)));let De=F(String(be),String(Ae));Z&&ve.headers.set("x-nextjs-rewrite",De)}let ye=ve?.headers.get("Location");if(ve&&ye&&!fe){let be=new f.c(ye,{forceLocale:!1,headers:K.request.headers,nextConfig:K.request.nextConfig});ve=new Response(ve.body,ve),be.host===Q.nextUrl.host&&(be.buildId=_e||be.buildId,ve.headers.set("Location",String(be))),Z&&(ve.headers.delete("Location"),ve.headers.set("x-nextjs-redirect",F(String(be),String(Ae))))}let Ge=ve||R.next(),Oe=Ge.headers.get("x-middleware-override-headers"),Qe=[];if(Oe){for(let[be,De]of W)Ge.headers.set(`x-middleware-request-${be}`,De),Qe.push(be);Qe.length>0&&Ge.headers.set("x-middleware-override-headers",Oe+","+Qe.join(","))}return{response:Ge,waitUntil:Promise.all(de[S]),fetchMetrics:Q.fetchMetrics}}},we.__chunk_94299=(ce,O,u)=>{"use strict";u.d(O,{QW:()=>m,J$:()=>J,Bb:()=>se,_W:()=>Y,eN:()=>te,Jm:()=>q,MY:()=>R,lU:()=>C,PN:()=>I});var s=u(2147),x=u(61583),k=u(92398);let E=j=>{setTimeout(j,0)},S={OPENING:{HTML:new Uint8Array([60,104,116,109,108]),BODY:new Uint8Array([60,98,111,100,121])},CLOSED:{HEAD:new Uint8Array([60,47,104,101,97,100,62]),BODY:new Uint8Array([60,47,98,111,100,121,62]),HTML:new Uint8Array([60,47,104,116,109,108,62]),BODY_AND_HTML:new Uint8Array([60,47,98,111,100,121,62,60,47,104,116,109,108,62])}};function d(j,M){if(M.length===0)return 0;if(j.length===0||M.length>j.length)return-1;for(let b=0;b<=j.length-M.length;b++){let N=!0;for(let $=0;$<M.length;$++)if(j[b+$]!==M[$]){N=!1;break}if(N)return b}return-1}function o(j,M){if(j.length!==M.length)return!1;for(let b=0;b<j.length;b++)if(j[b]!==M[b])return!1;return!0}function g(j,M){let b=d(j,M);if(b===0)return j.subarray(M.length);if(!(b>-1))return j;{let N=new Uint8Array(j.length-M.length);return N.set(j.slice(0,b)),N.set(j.slice(b+M.length),b),N}}function c(){}let f=new TextEncoder;function m(...j){if(j.length===0)throw Error("Invariant: chainStreams requires at least one stream");if(j.length===1)return j[0];let{readable:M,writable:b}=new TransformStream,N=j[0].pipeTo(b,{preventClose:!0}),$=1;for(;$<j.length-1;$++){let ae=j[$];N=N.then(()=>ae.pipeTo(b,{preventClose:!0}))}let X=j[$];return(N=N.then(()=>X.pipeTo(b))).catch(c),M}function C(j){return new ReadableStream({start(M){M.enqueue(f.encode(j)),M.close()}})}async function I(j){let M=new TextDecoder("utf-8",{fatal:!0}),b="";for await(let N of j)b+=M.decode(N,{stream:!0});return b+M.decode()}function _(){let j,M=[],b=0,N=$=>{if(j)return;let X=new k.Y;j=X,E(()=>{try{let ae=new Uint8Array(b),K=0;for(let ve=0;ve<M.length;ve++){let ke=M[ve];ae.set(ke,K),K+=ke.byteLength}M.length=0,b=0,$.enqueue(ae)}catch{}finally{j=void 0,X.resolve()}})};return new TransformStream({transform($,X){M.push($),b+=$.byteLength,N(X)},flush(){if(j)return j.promise}})}function R({ReactDOMServer:j,element:M,streamOptions:b}){return(0,s.Yz)().trace(x.k0.renderToReadableStream,async()=>j.renderToReadableStream(M,b))}function F(j){let M=!1,b=!1,N=!1;return new TransformStream({async transform($,X){if(N=!0,b){X.enqueue($);return}let ae=await j();if(M){if(ae){let K=f.encode(ae);X.enqueue(K)}X.enqueue($),b=!0}else{let K=d($,S.CLOSED.HEAD);if(K!==-1){if(ae){let ve=f.encode(ae),ke=new Uint8Array($.length+ve.length);ke.set($.slice(0,K)),ke.set(ve,K),ke.set($.slice(K),K+ve.length),X.enqueue(ke)}else X.enqueue($);b=!0,M=!0}}M?E(()=>{b=!1}):X.enqueue($)},async flush($){if(N){let X=await j();X&&$.enqueue(f.encode(X))}}})}function L(j){let M=null,b=!1;async function N($){if(M)return;let X=j.getReader();await new Promise(ae=>E(ae));try{for(;;){let{done:ae,value:K}=await X.read();if(ae){b=!0;return}$.enqueue(K)}}catch(ae){$.error(ae)}}return new TransformStream({transform($,X){X.enqueue($),M||(M=N(X))},flush($){if(!b)return M||N($)}})}function U(j){let M=!1,b=f.encode(j);return new TransformStream({transform(N,$){if(M)return $.enqueue(N);let X=d(N,b);if(X>-1){if(M=!0,N.length===j.length)return;let ae=N.slice(0,X);if($.enqueue(ae),N.length>j.length+X){let K=N.slice(X+j.length);$.enqueue(K)}}else $.enqueue(N)},flush(N){N.enqueue(b)}})}async function te(j,{suffix:M,inlinedDataStream:b,isStaticGeneration:N,getServerInsertedHTML:$,serverInsertedHTMLToHead:X,validateRootLayout:ae}){let K,ve,ke="</body></html>",fe=M?M.split(ke,1)[0]:null;return N&&"allReady"in j&&await j.allReady,function(Ae,_e){let Z=Ae;for(let ne of _e)ne&&(Z=Z.pipeThrough(ne));return Z}(j,[_(),$&&!X?new TransformStream({transform:async(Ae,_e)=>{let Z=await $();Z&&_e.enqueue(f.encode(Z)),_e.enqueue(Ae)}}):null,fe!=null&&fe.length>0?function(Ae){let _e,Z=!1,ne=W=>{let Q=new k.Y;_e=Q,E(()=>{try{W.enqueue(f.encode(Ae))}catch{}finally{_e=void 0,Q.resolve()}})};return new TransformStream({transform(W,Q){Q.enqueue(W),Z||(Z=!0,ne(Q))},flush(W){if(_e)return _e.promise;Z||W.enqueue(f.encode(Ae))}})}(fe):null,b?L(b):null,ae?(K=!1,ve=!1,new TransformStream({async transform(Ae,_e){!K&&d(Ae,S.OPENING.HTML)>-1&&(K=!0),!ve&&d(Ae,S.OPENING.BODY)>-1&&(ve=!0),_e.enqueue(Ae)},flush(Ae){let _e=[];K||_e.push("html"),ve||_e.push("body"),_e.length&&Ae.enqueue(f.encode(`<script>self.__next_root_layout_missing_tags=${JSON.stringify(_e)}<\/script>`))}})):null,U(ke),$&&X?F($):null])}async function Y(j,{getServerInsertedHTML:M}){return j.pipeThrough(_()).pipeThrough(new TransformStream({transform(b,N){o(b,S.CLOSED.BODY_AND_HTML)||o(b,S.CLOSED.BODY)||o(b,S.CLOSED.HTML)||(b=g(b,S.CLOSED.BODY),b=g(b,S.CLOSED.HTML),N.enqueue(b))}})).pipeThrough(F(M))}async function q(j,{inlinedDataStream:M,getServerInsertedHTML:b}){return j.pipeThrough(_()).pipeThrough(F(b)).pipeThrough(L(M)).pipeThrough(U("</body></html>"))}async function se(j,{inlinedDataStream:M,getServerInsertedHTML:b}){return j.pipeThrough(_()).pipeThrough(F(b)).pipeThrough(L(M)).pipeThrough(U("</body></html>"))}async function J(j,{inlinedDataStream:M}){return j.pipeThrough(L(M)).pipeThrough(U("</body></html>"))}},we.__chunk_75698=(ce,O,u)=>{"use strict";u.d(O,{OX:()=>x,d0:()=>S,kL:()=>E,lx:()=>k});let s=Symbol.for("NextInternalRequestMeta");function x(d,o){let g=d[s]||{};return typeof o=="string"?g[o]:g}function k(d,o){return d[s]=o,o}function E(d,o,g){let c=x(d);return c[o]=g,k(d,c)}function S(d,o){let g=x(d);return delete g[o],k(d,g)}},we.__chunk_62919=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>k});var s=u(94299),x=u(29744);class k{static fromStatic(S){return new k(S,{metadata:{}})}constructor(S,{contentType:d,waitUntil:o,metadata:g}){this.response=S,this.contentType=d,this.metadata=g,this.waitUntil=o}assignMetadata(S){Object.assign(this.metadata,S)}get isNull(){return this.response===null}get isDynamic(){return typeof this.response!="string"}toUnchunkedString(S=!1){if(this.response===null)throw Error("Invariant: null responses cannot be unchunked");if(typeof this.response!="string"){if(!S)throw Error("Invariant: dynamic responses cannot be unchunked. This is a bug in Next.js");return(0,s.PN)(this.readable)}return this.response}get readable(){if(this.response===null)throw Error("Invariant: null responses cannot be streamed");if(typeof this.response=="string")throw Error("Invariant: static responses cannot be streamed");return Array.isArray(this.response)?(0,s.QW)(...this.response):this.response}chain(S){let d;if(this.response===null)throw Error("Invariant: response is null. This is a bug in Next.js");(d=typeof this.response=="string"?[(0,s.lU)(this.response)]:Array.isArray(this.response)?this.response:[this.response]).push(S),this.response=d}async pipeTo(S){try{await this.readable.pipeTo(S,{preventClose:!0}),this.waitUntil&&await this.waitUntil,await S.close()}catch(d){if((0,x.D)(d)){await S.abort(d);return}throw d}}async pipeToNodeResponse(S){await(0,x.P)(this.readable,S,this.waitUntil)}}},we.__chunk_29744=(ce,O,u)=>{"use strict";u.d(O,{D:()=>d,P:()=>o});var s=u(58301),x=u(92398),k=u(2147),E=u(61583),S=u(79320);function d(g){return g?.name==="AbortError"||g?.name===s.WK}async function o(g,c,f){try{let{errored:m,destroyed:C}=c;if(m||C)return;let I=(0,s.yi)(c),_=function(R,F){let L=!1,U=new x.Y;function te(){U.resolve()}R.on("drain",te),R.once("close",()=>{R.off("drain",te),U.resolve()});let Y=new x.Y;return R.once("finish",()=>{Y.resolve()}),new WritableStream({write:async q=>{if(!L){if(L=!0,"performance"in aa&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX){let se=(0,S.R)();se&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-client-component-loading`,{start:se.clientComponentLoadStart,end:se.clientComponentLoadStart+se.clientComponentLoadTimes})}R.flushHeaders(),(0,k.Yz)().trace(E.Xy.startResponse,{spanName:"start response"},()=>{})}try{let se=R.write(q);"flush"in R&&typeof R.flush=="function"&&R.flush(),se||(await U.promise,U=new x.Y)}catch(se){throw R.end(),Error("failed to write chunk to response",{cause:se})}},abort:q=>{R.writableFinished||R.destroy(q)},close:async()=>{if(F&&await F,!R.writableFinished)return R.end(),Y.promise}})}(c,f);await g.pipeTo(_,{signal:I.signal})}catch(m){if(d(m))return;throw Error("failed to pipe response",{cause:m})}}},we.__chunk_2147=(ce,O,u)=>{"use strict";let s;u.d(O,{MU:()=>o,Qn:()=>d,Yz:()=>F});var x=u(61583);let{context:k,propagation:E,trace:S,SpanStatusCode:d,SpanKind:o,ROOT_CONTEXT:g}=s=u(41874),c=L=>L!==null&&typeof L=="object"&&typeof L.then=="function",f=(L,U)=>{U?.bubble===!0?L.setAttribute("next.bubble",!0):(U&&L.recordException(U),L.setStatus({code:d.ERROR,message:U?.message})),L.end()},m=new Map,C=s.createContextKey("next.rootSpanId"),I=0,_=()=>I++;class R{getTracerInstance(){return S.getTracer("next.js","0.0.1")}getContext(){return k}getActiveScopeSpan(){return S.getSpan(k?.active())}withPropagatedContext(U,te,Y){let q=k.active();if(S.getSpanContext(q))return te();let se=E.extract(q,U,Y);return k.with(se,te)}trace(...U){var te;let[Y,q,se]=U,{fn:J,options:j}=typeof q=="function"?{fn:q,options:{}}:{fn:se,options:{...q}},M=j.spanName??Y;if(!x.lw.includes(Y)&&process.env.NEXT_OTEL_VERBOSE!=="1"||j.hideSpan)return J();let b=this.getSpanContext(j?.parentSpan??this.getActiveScopeSpan()),N=!1;b?(te=S.getSpanContext(b))!=null&&te.isRemote&&(N=!0):(b=k?.active()??g,N=!0);let $=_();return j.attributes={"next.span_name":M,"next.span_type":Y,...j.attributes},k.with(b.setValue(C,$),()=>this.getTracerInstance().startActiveSpan(M,j,X=>{let ae="performance"in aa?aa.performance.now():void 0,K=()=>{m.delete($),ae&&process.env.NEXT_OTEL_PERFORMANCE_PREFIX&&x.hT.includes(Y||"")&&performance.measure(`${process.env.NEXT_OTEL_PERFORMANCE_PREFIX}:next-${(Y.split(".").pop()||"").replace(/[A-Z]/g,ve=>"-"+ve.toLowerCase())}`,{start:ae,end:performance.now()})};N&&m.set($,new Map(Object.entries(j.attributes??{})));try{if(J.length>1)return J(X,ke=>f(X,ke));let ve=J(X);return c(ve)?ve.then(ke=>(X.end(),ke)).catch(ke=>{throw f(X,ke),ke}).finally(K):(X.end(),K(),ve)}catch(ve){throw f(X,ve),K(),ve}}))}wrap(...U){let te=this,[Y,q,se]=U.length===3?U:[U[0],{},U[1]];return x.lw.includes(Y)||process.env.NEXT_OTEL_VERBOSE==="1"?function(){let J=q;typeof J=="function"&&typeof se=="function"&&(J=J.apply(this,arguments));let j=arguments.length-1,M=arguments[j];if(typeof M!="function")return te.trace(Y,J,()=>se.apply(this,arguments));{let b=te.getContext().bind(k.active(),M);return te.trace(Y,J,(N,$)=>(arguments[j]=function(X){return $?.(X),b.apply(this,arguments)},se.apply(this,arguments)))}}:se}startSpan(...U){let[te,Y]=U,q=this.getSpanContext(Y?.parentSpan??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(te,Y,q)}getSpanContext(U){return U?S.setSpan(k.active(),U):void 0}getRootSpanAttributes(){let U=k.active().getValue(C);return m.get(U)}}let F=(()=>{let L=new R;return()=>L})()},we.__chunk_61583=(ce,O,u)=>{"use strict";var s,x,k,E,S,d,o,g,c,f,m,C;u.d(O,{Xy:()=>E,_J:()=>s,_s:()=>m,dI:()=>C,hT:()=>_,k0:()=>o,lw:()=>I}),function(R){R.handleRequest="BaseServer.handleRequest",R.run="BaseServer.run",R.pipe="BaseServer.pipe",R.getStaticHTML="BaseServer.getStaticHTML",R.render="BaseServer.render",R.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",R.renderToResponse="BaseServer.renderToResponse",R.renderToHTML="BaseServer.renderToHTML",R.renderError="BaseServer.renderError",R.renderErrorToResponse="BaseServer.renderErrorToResponse",R.renderErrorToHTML="BaseServer.renderErrorToHTML",R.render404="BaseServer.render404"}(s||(s={})),function(R){R.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",R.loadComponents="LoadComponents.loadComponents"}(x||(x={})),function(R){R.getRequestHandler="NextServer.getRequestHandler",R.getServer="NextServer.getServer",R.getServerRequestHandler="NextServer.getServerRequestHandler",R.createServer="createServer.createServer"}(k||(k={})),function(R){R.compression="NextNodeServer.compression",R.getBuildId="NextNodeServer.getBuildId",R.createComponentTree="NextNodeServer.createComponentTree",R.clientComponentLoading="NextNodeServer.clientComponentLoading",R.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",R.generateStaticRoutes="NextNodeServer.generateStaticRoutes",R.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",R.generatePublicRoutes="NextNodeServer.generatePublicRoutes",R.generateImageRoutes="NextNodeServer.generateImageRoutes.route",R.sendRenderResult="NextNodeServer.sendRenderResult",R.proxyRequest="NextNodeServer.proxyRequest",R.runApi="NextNodeServer.runApi",R.render="NextNodeServer.render",R.renderHTML="NextNodeServer.renderHTML",R.imageOptimizer="NextNodeServer.imageOptimizer",R.getPagePath="NextNodeServer.getPagePath",R.getRoutesManifest="NextNodeServer.getRoutesManifest",R.findPageComponents="NextNodeServer.findPageComponents",R.getFontManifest="NextNodeServer.getFontManifest",R.getServerComponentManifest="NextNodeServer.getServerComponentManifest",R.getRequestHandler="NextNodeServer.getRequestHandler",R.renderToHTML="NextNodeServer.renderToHTML",R.renderError="NextNodeServer.renderError",R.renderErrorToHTML="NextNodeServer.renderErrorToHTML",R.render404="NextNodeServer.render404",R.startResponse="NextNodeServer.startResponse",R.route="route",R.onProxyReq="onProxyReq",R.apiResolver="apiResolver",R.internalFetch="internalFetch"}(E||(E={})),(S||(S={})).startServer="startServer.startServer",function(R){R.getServerSideProps="Render.getServerSideProps",R.getStaticProps="Render.getStaticProps",R.renderToString="Render.renderToString",R.renderDocument="Render.renderDocument",R.createBodyResult="Render.createBodyResult"}(d||(d={})),function(R){R.renderToString="AppRender.renderToString",R.renderToReadableStream="AppRender.renderToReadableStream",R.getBodyResult="AppRender.getBodyResult",R.fetch="AppRender.fetch"}(o||(o={})),(g||(g={})).executeRoute="Router.executeRoute",(c||(c={})).runHandler="Node.runHandler",(f||(f={})).runHandler="AppRouteRouteHandlers.runHandler",function(R){R.generateMetadata="ResolveMetadata.generateMetadata",R.generateViewport="ResolveMetadata.generateViewport"}(m||(m={})),(C||(C={})).execute="Middleware.execute";let I=["Middleware.execute","BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.createComponentTree","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule","NextNodeServer.startResponse","NextNodeServer.clientComponentLoading"],_=["NextNodeServer.findPageComponents","NextNodeServer.createComponentTree","NextNodeServer.clientComponentLoading"]},we.__chunk_51422=(ce,O,u)=>{"use strict";function s(x){return x.replace(/(?:\/index)?\/?$/,"")||"/"}u.d(O,{w:()=>s})},we.__chunk_1663=(ce,O,u)=>{"use strict";u.d(O,{G:()=>x,x:()=>k});var s=u(48210);function x(E){let S,d;E.headers instanceof Headers?(S=E.headers.get(s.om.toLowerCase())??null,d=E.headers.get("content-type")):(S=E.headers[s.om.toLowerCase()]??null,d=E.headers["content-type"]??null);let o=E.method==="POST"&&d==="application/x-www-form-urlencoded",g=!!(E.method==="POST"&&d?.startsWith("multipart/form-data")),c=S!==void 0&&typeof S=="string"&&E.method==="POST";return{actionId:S,isURLEncodedAction:o,isMultipartAction:g,isFetchAction:c,isServerAction:!!(c||o||g)}}function k(E){return x(E).isServerAction}},we.__chunk_95586=(ce,O,u)=>{"use strict";let s,x,k;u.d(O,{k:()=>q});var E=u(65530),S=u.n(E),d=u(78045);let o=0,g="x-vercel-cache-tags",c="x-vercel-sc-headers",f="x-vercel-revalidate",m="x-vercel-cache-item-name",C=!!process.env.NEXT_PRIVATE_DEBUG_CACHE;async function I(se,J,j=0){let M=new AbortController,b=setTimeout(()=>{M.abort()},500);return fetch(se,{...J||{},signal:M.signal}).catch(N=>{if(j!==3)return C&&console.log(`Fetch failed for ${se} retry ${j}`),I(se,J,j+1);throw N}).finally(()=>{clearTimeout(b)})}class _{hasMatchingTags(J,j){if(J.length!==j.length)return!1;let M=new Set(J),b=new Set(j);if(M.size!==b.size)return!1;for(let N of M)if(!b.has(N))return!1;return!0}static isAvailable(J){return!!(J._requestHeaders["x-vercel-sc-host"]||process.env.SUSPENSE_CACHE_URL)}constructor(J){if(this.headers={},this.headers["Content-Type"]="application/json",c in J._requestHeaders){let b=JSON.parse(J._requestHeaders[c]);for(let N in b)this.headers[N]=b[N];delete J._requestHeaders[c]}let j=J._requestHeaders["x-vercel-sc-host"]||process.env.SUSPENSE_CACHE_URL,M=J._requestHeaders["x-vercel-sc-basepath"]||process.env.SUSPENSE_CACHE_BASEPATH;if(process.env.SUSPENSE_CACHE_AUTH_TOKEN&&(this.headers.Authorization=`Bearer ${process.env.SUSPENSE_CACHE_AUTH_TOKEN}`),j){let b=process.env.SUSPENSE_CACHE_PROTO||"https";this.cacheEndpoint=`${b}://${j}${M||""}`,C&&console.log("using cache endpoint",this.cacheEndpoint)}else C&&console.log("no cache endpoint available");J.maxMemoryCacheSize?s||(C&&console.log("using memory store for fetch cache"),s=new(S())({max:J.maxMemoryCacheSize,length({value:b}){var N;if(!b)return 25;if(b.kind==="REDIRECT")return JSON.stringify(b.props).length;if(b.kind==="IMAGE")throw Error("invariant image should not be incremental-cache");return b.kind==="FETCH"?JSON.stringify(b.data||"").length:b.kind==="ROUTE"?b.body.length:b.html.length+(((N=JSON.stringify(b.kind==="PAGE"&&b.pageData))==null?void 0:N.length)||0)}})):C&&console.log("not using memory store for fetch cache")}resetRequestCache(){s?.reset()}async revalidateTag(...J){let[j]=J;if(j=typeof j=="string"?[j]:j,C&&console.log("revalidateTag",j),j.length){if(Date.now()<o){C&&console.log("rate limited ",o);return}for(let M=0;M<Math.ceil(j.length/64);M++){let b=j.slice(64*M,64*M+64);try{let N=await I(`${this.cacheEndpoint}/v1/suspense-cache/revalidate?tags=${b.map($=>encodeURIComponent($)).join(",")}`,{method:"POST",headers:this.headers,next:{internal:!0}});if(N.status===429){let $=N.headers.get("retry-after")||"60000";o=Date.now()+parseInt($)}if(!N.ok)throw Error(`Request failed with status ${N.status}.`)}catch(N){console.warn("Failed to revalidate tag",b,N)}}}}async get(...J){var j;let[M,b={}]=J,{tags:N,softTags:$,kindHint:X,fetchIdx:ae,fetchUrl:K}=b;if(X!=="fetch")return null;if(Date.now()<o)return C&&console.log("rate limited"),null;let ve=s?.get(M),ke=(ve==null||(j=ve.value)==null?void 0:j.kind)==="FETCH"&&this.hasMatchingTags(N??[],ve.value.tags??[]);if(this.cacheEndpoint&&(!ve||!ke))try{let fe=Date.now(),Ae=await fetch(`${this.cacheEndpoint}/v1/suspense-cache/${M}`,{method:"GET",headers:{...this.headers,[m]:K,[g]:N?.join(",")||"",[d.Ar]:$?.join(",")||""},next:{internal:!0,fetchType:"cache-get",fetchUrl:K,fetchIdx:ae}});if(Ae.status===429){let W=Ae.headers.get("retry-after")||"60000";o=Date.now()+parseInt(W)}if(Ae.status===404)return C&&console.log(`no fetch cache entry for ${M}, duration: ${Date.now()-fe}ms`),null;if(!Ae.ok)throw console.error(await Ae.text()),Error(`invalid response from cache ${Ae.status}`);let _e=await Ae.json();if(!_e||_e.kind!=="FETCH")throw C&&console.log({cached:_e}),Error("invalid cache value");if(_e.kind==="FETCH")for(let W of(_e.tags??=[],N??[]))_e.tags.includes(W)||_e.tags.push(W);let Z=Ae.headers.get("x-vercel-cache-state"),ne=Ae.headers.get("age");ve={value:_e,lastModified:Z!=="fresh"?Date.now()-d.BR:Date.now()-1e3*parseInt(ne||"0",10)},C&&console.log(`got fetch cache entry for ${M}, duration: ${Date.now()-fe}ms, size: ${Object.keys(_e).length}, cache-state: ${Z} tags: ${N?.join(",")} softTags: ${$?.join(",")}`),ve&&s?.set(M,ve)}catch(fe){C&&console.error("Failed to get from fetch-cache",fe)}return ve||null}async set(...J){let[j,M,b]=J,{fetchCache:N,fetchIdx:$,fetchUrl:X,tags:ae}=b;if(N){if(Date.now()<o){C&&console.log("rate limited");return}if(s?.set(j,{value:M,lastModified:Date.now()}),this.cacheEndpoint)try{let K=Date.now();M!==null&&"revalidate"in M&&(this.headers[f]=M.revalidate.toString()),!this.headers[f]&&M!==null&&"data"in M&&(this.headers["x-vercel-cache-control"]=M.data.headers["cache-control"]);let ve=JSON.stringify({...M,tags:void 0});C&&console.log("set cache",j);let ke=await fetch(`${this.cacheEndpoint}/v1/suspense-cache/${j}`,{method:"POST",headers:{...this.headers,[m]:X||"",[g]:ae?.join(",")||""},body:ve,next:{internal:!0,fetchType:"cache-set",fetchUrl:X,fetchIdx:$}});if(ke.status===429){let fe=ke.headers.get("retry-after")||"60000";o=Date.now()+parseInt(fe)}if(!ke.ok)throw C&&console.log(await ke.text()),Error(`invalid response ${ke.status}`);C&&console.log(`successfully set to fetch-cache for ${j}, duration: ${Date.now()-K}ms, size: ${ve.length}`)}catch(K){C&&console.error("Failed to update fetch cache",K)}}}}var R=u(44813),F=u.n(R);class L{constructor(J){this.fs=J.fs,this.flushToDisk=J.flushToDisk,this.serverDistDir=J.serverDistDir,this.appDir=!!J._appDir,this.pagesDir=!!J._pagesDir,this.revalidatedTags=J.revalidatedTags,this.experimental=J.experimental,this.debug=!!process.env.NEXT_PRIVATE_DEBUG_CACHE,J.maxMemoryCacheSize&&!x?(this.debug&&console.log("using memory store for fetch cache"),x=new(S())({max:J.maxMemoryCacheSize,length({value:j}){var M;if(!j)return 25;if(j.kind==="REDIRECT")return JSON.stringify(j.props).length;if(j.kind==="IMAGE")throw Error("invariant image should not be incremental-cache");return j.kind==="FETCH"?JSON.stringify(j.data||"").length:j.kind==="ROUTE"?j.body.length:j.html.length+(((M=JSON.stringify(j.pageData))==null?void 0:M.length)||0)}})):this.debug&&console.log("not using memory store for fetch cache"),this.serverDistDir&&this.fs&&(this.tagsManifestPath=F().join(this.serverDistDir,"..","cache","fetch-cache","tags-manifest.json"),this.loadTagsManifest())}resetRequestCache(){}loadTagsManifest(){if(this.tagsManifestPath&&this.fs&&!k){try{k=JSON.parse(this.fs.readFileSync(this.tagsManifestPath,"utf8"))}catch{k={version:1,items:{}}}this.debug&&console.log("loadTagsManifest",k)}}async revalidateTag(...J){let[j]=J;if(j=typeof j=="string"?[j]:j,this.debug&&console.log("revalidateTag",j),j.length!==0&&(await this.loadTagsManifest(),k&&this.tagsManifestPath)){for(let M of j){let b=k.items[M]||{};b.revalidatedAt=Date.now(),k.items[M]=b}try{await this.fs.mkdir(F().dirname(this.tagsManifestPath)),await this.fs.writeFile(this.tagsManifestPath,JSON.stringify(k||{})),this.debug&&console.log("Updated tags manifest",k)}catch(M){console.warn("Failed to update tags manifest.",M)}}}async get(...J){var j,M,b;let[N,$={}]=J,{tags:X,softTags:ae,kindHint:K}=$,ve=x?.get(N);if(this.debug&&console.log("get",N,X,K,!!ve),(ve==null||(j=ve.value)==null?void 0:j.kind)==="PAGE"){let ke,fe=(b=ve.value.headers)==null?void 0:b[d.Et];typeof fe=="string"&&(ke=fe.split(",")),ke?.length&&(this.loadTagsManifest(),ke.some(Ae=>{var _e;return(k==null||(_e=k.items[Ae])==null?void 0:_e.revalidatedAt)&&k?.items[Ae].revalidatedAt>=(ve?.lastModified||Date.now())})&&(ve=void 0))}return ve&&(ve==null||(M=ve.value)==null?void 0:M.kind)==="FETCH"&&(this.loadTagsManifest(),[...X||[],...ae||[]].some(ke=>{var fe;return!!this.revalidatedTags.includes(ke)||(k==null||(fe=k.items[ke])==null?void 0:fe.revalidatedAt)&&k?.items[ke].revalidatedAt>=(ve?.lastModified||Date.now())})&&(ve=void 0)),ve??null}async set(...J){let[j,M,b]=J;if(x?.set(j,{value:M,lastModified:Date.now()}),this.debug&&console.log("set",j),this.flushToDisk){if(M?.kind==="ROUTE"){let N=this.getFilePath(`${j}.body`,"app");await this.fs.mkdir(F().dirname(N)),await this.fs.writeFile(N,M.body);let $={headers:M.headers,status:M.status,postponed:void 0};await this.fs.writeFile(N.replace(/\.body$/,d.EX),JSON.stringify($,null,2));return}if(M?.kind==="PAGE"){let N=typeof M.pageData=="string",$=this.getFilePath(`${j}.html`,N?"app":"pages");if(await this.fs.mkdir(F().dirname($)),await this.fs.writeFile($,M.html),await this.fs.writeFile(this.getFilePath(`${j}${N?this.experimental.ppr?d.Sx:d.hd:d.JT}`,N?"app":"pages"),N?M.pageData:JSON.stringify(M.pageData)),M.headers||M.status){let X={headers:M.headers,status:M.status,postponed:M.postponed};await this.fs.writeFile($.replace(/\.html$/,d.EX),JSON.stringify(X))}}else if(M?.kind==="FETCH"){let N=this.getFilePath(j,"fetch");await this.fs.mkdir(F().dirname(N)),await this.fs.writeFile(N,JSON.stringify({...M,tags:b.tags}))}}}detectFileKind(J){if(!this.appDir&&!this.pagesDir)throw Error("Invariant: Can't determine file path kind, no page directory enabled");if(!this.appDir&&this.pagesDir)return"pages";if(this.appDir&&!this.pagesDir)return"app";let j=this.getFilePath(J,"pages");if(this.fs.existsSync(j))return"pages";if(j=this.getFilePath(J,"app"),this.fs.existsSync(j))return"app";throw Error(`Invariant: Unable to determine file path kind for ${J}`)}getFilePath(J,j){switch(j){case"fetch":return F().join(this.serverDistDir,"..","cache","fetch-cache",J);case"pages":return F().join(this.serverDistDir,"pages",J);case"app":return F().join(this.serverDistDir,"app",J);default:throw Error("Invariant: Can't determine file path kind")}}}var U=u(72584),te=u(51422);class Y{static#e=this.timings=new Map;constructor(J){this.prerenderManifest=J}get(J){var j;let M=Y.timings.get(J);if(M!==void 0||(M=(j=this.prerenderManifest.routes[J])==null?void 0:j.initialRevalidateSeconds)!==void 0)return M}set(J,j){Y.timings.set(J,j)}clear(){Y.timings.clear()}}class q{constructor({fs:J,dev:j,appDir:M,pagesDir:b,flushToDisk:N,fetchCache:$,minimalMode:X,serverDistDir:ae,requestHeaders:K,requestProtocol:ve,maxMemoryCacheSize:ke,getPrerenderManifest:fe,fetchCacheKeyPrefix:Ae,CurCacheHandler:_e,allowedRevalidateHeaderKeys:Z,experimental:ne}){var W,Q,de,ue;this.locks=new Map,this.unlocks=new Map;let ye=!!process.env.NEXT_PRIVATE_DEBUG_CACHE;this.hasCustomCacheHandler=!!_e,_e?ye&&console.log("using custom cache handler",_e.name):(J&&ae&&(ye&&console.log("using filesystem cache handler"),_e=L),_.isAvailable({_requestHeaders:K})&&X&&$&&(ye&&console.log("using fetch cache handler"),_e=_)),process.env.__NEXT_TEST_MAX_ISR_CACHE&&(ke=parseInt(process.env.__NEXT_TEST_MAX_ISR_CACHE,10)),this.dev=j,this.disableForTestmode=process.env.NEXT_PRIVATE_TEST_PROXY==="true",this.minimalMode=X,this.requestHeaders=K,this.requestProtocol=ve,this.allowedRevalidateHeaderKeys=Z,this.prerenderManifest=fe(),this.revalidateTimings=new Y(this.prerenderManifest),this.fetchCacheKeyPrefix=Ae;let Ge=[];K[d.y3]===((Q=this.prerenderManifest)==null||(W=Q.preview)==null?void 0:W.previewModeId)&&(this.isOnDemandRevalidate=!0),X&&typeof K[d.of]=="string"&&K[d.X_]===((ue=this.prerenderManifest)==null||(de=ue.preview)==null?void 0:de.previewModeId)&&(Ge=K[d.of].split(",")),_e&&(this.cacheHandler=new _e({dev:j,fs:J,flushToDisk:N,serverDistDir:ae,revalidatedTags:Ge,maxMemoryCacheSize:ke,_pagesDir:!!b,_appDir:!!M,_requestHeaders:K,fetchCacheKeyPrefix:Ae,experimental:ne}))}calculateRevalidate(J,j,M){if(M)return new Date().getTime()-1e3;let b=this.revalidateTimings.get((0,te.w)(J))??1;return typeof b=="number"?1e3*b+j:b}_getPathname(J,j){return j?J:(0,U.y)(J)}resetRequestCache(){var J,j;(j=this.cacheHandler)==null||(J=j.resetRequestCache)==null||J.call(j)}async unlock(J){let j=this.unlocks.get(J);j&&(j(),this.locks.delete(J),this.unlocks.delete(J))}async lock(J){process.env.__NEXT_INCREMENTAL_CACHE_IPC_PORT&&process.env.__NEXT_INCREMENTAL_CACHE_IPC_KEY;let j=()=>Promise.resolve(),M=this.locks.get(J);if(M)await M;else{let b=new Promise(N=>{j=async()=>{N()}});this.locks.set(J,b),this.unlocks.set(J,j)}return j}async revalidateTag(J){var j,M;return process.env.__NEXT_INCREMENTAL_CACHE_IPC_PORT&&process.env.__NEXT_INCREMENTAL_CACHE_IPC_KEY,(M=this.cacheHandler)==null||(j=M.revalidateTag)==null?void 0:j.call(M,J)}async fetchCacheKey(J,j={}){let M=[],b=new TextEncoder,N=new TextDecoder;if(j.body)if(typeof j.body.getReader=="function"){let K=j.body,ve=[];try{await K.pipeTo(new WritableStream({write(_e){typeof _e=="string"?(ve.push(b.encode(_e)),M.push(_e)):(ve.push(_e),M.push(N.decode(_e,{stream:!0})))}})),M.push(N.decode());let ke=ve.reduce((_e,Z)=>_e+Z.length,0),fe=new Uint8Array(ke),Ae=0;for(let _e of ve)fe.set(_e,Ae),Ae+=_e.length;j._ogBody=fe}catch(ke){console.error("Problem reading body",ke)}}else if(typeof j.body.keys=="function"){let K=j.body;for(let ve of(j._ogBody=j.body,new Set([...K.keys()]))){let ke=K.getAll(ve);M.push(`${ve}=${(await Promise.all(ke.map(async fe=>typeof fe=="string"?fe:await fe.text()))).join(",")}`)}}else if(typeof j.body.arrayBuffer=="function"){let K=j.body,ve=await K.arrayBuffer();M.push(await K.text()),j._ogBody=new Blob([ve],{type:K.type})}else typeof j.body=="string"&&(M.push(j.body),j._ogBody=j.body);let $=typeof(j.headers||{}).keys=="function"?Object.fromEntries(j.headers):Object.assign({},j.headers);"traceparent"in $&&delete $.traceparent;let X=JSON.stringify(["v3",this.fetchCacheKeyPrefix||"",J,j.method,$,j.mode,j.redirect,j.credentials,j.referrer,j.referrerPolicy,j.integrity,j.cache,M]);{var ae;let K=b.encode(X);return ae=await crypto.subtle.digest("SHA-256",K),Array.prototype.map.call(new Uint8Array(ae),ve=>ve.toString(16).padStart(2,"0")).join("")}}async get(J,j={}){var M,b;let N,$;if(process.env.__NEXT_INCREMENTAL_CACHE_IPC_PORT&&process.env.__NEXT_INCREMENTAL_CACHE_IPC_KEY,this.disableForTestmode||this.dev&&(j.kindHint!=="fetch"||this.requestHeaders["cache-control"]==="no-cache"))return null;J=this._getPathname(J,j.kindHint==="fetch");let X=null,ae=j.revalidate,K=await((M=this.cacheHandler)==null?void 0:M.get(J,j));if((K==null||(b=K.value)==null?void 0:b.kind)==="FETCH")return[...j.tags||[],...j.softTags||[]].some(ke=>{var fe;return(fe=this.revalidatedTags)==null?void 0:fe.includes(ke)})?null:(ae=ae||K.value.revalidate,{isStale:(Date.now()-(K.lastModified||0))/1e3>ae,value:{kind:"FETCH",data:K.value.data,revalidate:ae},revalidateAfter:Date.now()+1e3*ae});let ve=this.revalidateTimings.get((0,te.w)(J));return K?.lastModified===-1?(N=-1,$=-1*d.BR):N=($=this.calculateRevalidate(J,K?.lastModified||Date.now(),this.dev&&j.kindHint!=="fetch"))!==!1&&$<Date.now()||void 0,K&&(X={isStale:N,curRevalidate:ve,revalidateAfter:$,value:K.value}),!K&&this.prerenderManifest.notFoundRoutes.includes(J)&&(X={isStale:N,value:null,curRevalidate:ve,revalidateAfter:$},this.set(J,X.value,j)),X}async set(J,j,M){if(process.env.__NEXT_INCREMENTAL_CACHE_IPC_PORT&&process.env.__NEXT_INCREMENTAL_CACHE_IPC_KEY,this.disableForTestmode||this.dev&&!M.fetchCache)return;let b=JSON.stringify(j).length;if(M.fetchCache&&!this.hasCustomCacheHandler&&b>2097152){if(this.dev)throw Error(`Failed to set Next.js data cache, items over 2MB can not be cached (${b} bytes)`);return}J=this._getPathname(J,M.fetchCache);try{var N;M.revalidate===void 0||M.fetchCache||this.revalidateTimings.set(J,M.revalidate),await((N=this.cacheHandler)==null?void 0:N.set(J,j,M))}catch($){console.warn("Failed to update prerender cache for",J,$)}}}},we.__chunk_37041=(ce,O,u)=>{"use strict";u.d(O,{Q:()=>k,T:()=>E});let s=["__nextFallback","__nextLocale","__nextInferredLocaleFromDefault","__nextDefaultLocale","__nextIsNotFound",u(48210).H4],x=["__nextDataReq"];function k(S){for(let d of s)delete S[d]}function E(S,d){let o=typeof S=="string",g=o?new URL(S):S;for(let c of s)g.searchParams.delete(c);if(d)for(let c of x)g.searchParams.delete(c);return o?g.toString():g}},we.__chunk_42095=(ce,O,u)=>{"use strict";u.d(O,{AppPageRouteModule:()=>j});var s={};u.r(s),u.d(s,{HtmlContext:()=>C,useHtmlContext:()=>I});var x={};u.r(x),u.d(x,{default:()=>J});var k={};u.r(k),u.d(k,{AmpContext:()=>_,AppRouterContext:()=>g,HeadManagerContext:()=>d,HooksClientContext:()=>c,HtmlContext:()=>s,ImageConfigContext:()=>F,Loadable:()=>x,LoadableContext:()=>R,RouterContext:()=>f,ServerInsertedHtml:()=>o});var E=u(69182);class S{constructor({userland:b,definition:N}){this.userland=b,this.definition=N}}var d=u(8429),o=u(74917),g=u(24351),c=u(86270),f=u(99189),m=u(24528);let C=(0,m.createContext)(void 0);function I(){let M=(0,m.useContext)(C);if(!M)throw Error(`<Html> should not be imported outside of pages/_document.
Read more: https://nextjs.org/docs/messages/no-document-import-in-page`);return M}var _=u(440),R=u(33262),F=u(58350);let L=[],U=[];function te(M){let b=M(),N={loading:!0,loaded:null,error:null};return N.promise=b.then($=>(N.loading=!1,N.loaded=$,$)).catch($=>{throw N.loading=!1,N.error=$,$}),N}class Y{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:b,_opts:N}=this;b.loading&&(typeof N.delay=="number"&&(N.delay===0?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},N.delay)),typeof N.timeout=="number"&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},N.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch($=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(b){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...b},this._callbacks.forEach(N=>N())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(b){return this._callbacks.add(b),()=>{this._callbacks.delete(b)}}constructor(b,N){this._loadFn=b,this._opts=N,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function q(M){return function(b,N){let $=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},N),X=null;function ae(){if(!X){let ve=new Y(b,$);X={getCurrentValue:ve.getCurrentValue.bind(ve),subscribe:ve.subscribe.bind(ve),retry:ve.retry.bind(ve),promise:ve.promise.bind(ve)}}return X.promise()}function K(ve,ke){(function(){ae();let Ae=m.useContext(R.LoadableContext);Ae&&Array.isArray($.modules)&&$.modules.forEach(_e=>{Ae(_e)})})();let fe=m.useSyncExternalStore(X.subscribe,X.getCurrentValue,X.getCurrentValue);return m.useImperativeHandle(ke,()=>({retry:X.retry}),[]),m.useMemo(()=>{var Ae;return fe.loading||fe.error?m.createElement($.loading,{isLoading:fe.loading,pastDelay:fe.pastDelay,timedOut:fe.timedOut,error:fe.error,retry:X.retry}):fe.loaded?m.createElement((Ae=fe.loaded)&&Ae.default?Ae.default:Ae,ve):null},[ve,fe])}return L.push(ae),K.preload=()=>ae(),K.displayName="LoadableComponent",m.forwardRef(K)}(te,M)}function se(M,b){let N=[];for(;M.length;){let $=M.pop();N.push($(b))}return Promise.all(N).then(()=>{if(M.length)return se(M,b)})}q.preloadAll=()=>new Promise((M,b)=>{se(L).then(M,b)}),q.preloadReady=M=>(M===void 0&&(M=[]),new Promise(b=>{let N=()=>b();se(U,M).then(N,N)}));let J=q;class j extends S{render(b,N,$){return(0,E.f)(b,N,$.page,$.query,$.renderOpts)}}},we.__chunk_78342=(ce,O,u)=>{"use strict";u.d(O,{Ag:()=>k,CK:()=>E,Wz:()=>x});var s=u(46737);let x=["(..)(..)","(.)","(..)","(...)"];function k(S){return S.split("/").find(d=>x.find(o=>d.startsWith(o)))!==void 0}function E(S){let d,o,g;for(let c of S.split("/"))if(o=x.find(f=>c.startsWith(f))){[d,g]=S.split(o,2);break}if(!d||!o||!g)throw Error(`Invalid interception route: ${S}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(d=(0,s.w)(d),o){case"(.)":g=d==="/"?`/${g}`:d+"/"+g;break;case"(..)":if(d==="/")throw Error(`Invalid interception route: ${S}. Cannot use (..) marker at the root level, use (.) instead.`);g=d.split("/").slice(0,-1).concat(g).join("/");break;case"(...)":g="/"+g;break;case"(..)(..)":let c=d.split("/");if(c.length<=2)throw Error(`Invalid interception route: ${S}. Cannot use (..)(..) marker at the root level or one level up.`);g=c.slice(0,-2).concat(g).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:d,interceptedRoute:g}}},we.__chunk_79320=(ce,O,u)=>{"use strict";u.d(O,{B:()=>E,R:()=>S});let s=0,x=0,k=0;function E(d){return"performance"in aa?{require:(...o)=>{s===0&&(s=performance.now());let g=performance.now();try{return k+=1,d.__next_app__.require(...o)}finally{x+=performance.now()-g}},loadChunk:(...o)=>{let g=performance.now();try{return k+=1,d.__next_app__.loadChunk(...o)}finally{x+=performance.now()-g}}}:d.__next_app__}function S(d={}){let o=s===0?void 0:{clientComponentLoadStart:s,clientComponentLoadTimes:x,clientComponentLoadCount:k};return d.reset&&(s=0,x=0,k=0),o}},we.__chunk_1533=(ce,O,u)=>{"use strict";u.d(O,{B:()=>c});var s=u(48210),x=u(37842),k=u(73343),E=u(1434),S=u(80842);class d{constructor(m,C,I,_){var R;let F=m&&(0,S.Iq)(C,m).isOnDemandRevalidate,L=(R=I.get(S.dS))==null?void 0:R.value;this.isEnabled=!!(!F&&L&&m&&L===m.previewModeId),this._previewModeId=m?.previewModeId,this._mutableCookies=_}enable(){if(!this._previewModeId)throw Error("Invariant: previewProps missing previewModeId this should never happen");this._mutableCookies.set({name:S.dS,value:this._previewModeId,httpOnly:!0,sameSite:"none",secure:!0,path:"/"})}disable(){this._mutableCookies.set({name:S.dS,value:"",httpOnly:!0,sameSite:"none",secure:!0,path:"/",expires:new Date(0)})}}var o=u(43150);function g(f,m){if("x-middleware-set-cookie"in f.headers&&typeof f.headers["x-middleware-set-cookie"]=="string"){let C=f.headers["x-middleware-set-cookie"],I=new Headers;for(let _ of(0,o.l$)(C))I.append("set-cookie",_);for(let _ of new E.nV(I).getAll())m.set(_)}}let c={wrap(f,{req:m,res:C,renderOpts:I},_){let R;function F(te){C&&C.setHeader("Set-Cookie",te)}I&&"previewProps"in I&&(R=I.previewProps);let L={},U={get headers(){return L.headers||(L.headers=function(te){let Y=x.h.from(te);for(let q of s.vu)Y.delete(q.toString().toLowerCase());return x.h.seal(Y)}(m.headers)),L.headers},get cookies(){if(!L.cookies){let te=new E.qC(x.h.from(m.headers));g(m,te),L.cookies=k.Qb.seal(te)}return L.cookies},get mutableCookies(){if(!L.mutableCookies){let te=function(Y,q){let se=new E.qC(x.h.from(Y));return k.vr.wrap(se,q)}(m.headers,I?.onUpdateCookies||(C?F:void 0));g(m,te),L.mutableCookies=te}return L.mutableCookies},get draftMode(){return L.draftMode||(L.draftMode=new d(R,m,this.cookies,this.mutableCookies)),L.draftMode},reactLoadableManifest:I?.reactLoadableManifest||{},assetPrefix:I?.assetPrefix||""};return f.run(U,_,U)}}},we.__chunk_75368=(ce,O,u)=>{"use strict";u.d(O,{R:()=>x});var s=u(78342);function x(k){let E=s.Wz.find(S=>k.startsWith(S));return E&&(k=k.slice(E.length)),k.startsWith("[[...")&&k.endsWith("]]")?{type:"optional-catchall",param:k.slice(5,-2)}:k.startsWith("[...")&&k.endsWith("]")?{type:E?"catchall-intercepted":"catchall",param:k.slice(4,-1)}:k.startsWith("[")&&k.endsWith("]")?{type:E?"dynamic-intercepted":"dynamic",param:k.slice(1,-1)}:null}},we.__chunk_67881=(ce,O,u)=>{"use strict";u.d(O,{Mo:()=>x});let s=Symbol.for("next.server.action-manifests");function x({clientReferenceManifest:k,serverActionsManifest:E,serverModuleMap:S}){aa[s]={clientReferenceManifest:k,serverActionsManifest:E,serverModuleMap:S}}},we.__chunk_84223=(ce,O,u)=>{"use strict";u.d(O,{FI:()=>d,Su:()=>m,TP:()=>o,gS:()=>c,tK:()=>g});var s=u(24528),x=u(403),k=u(76513),E=u(68009);let S=typeof s.unstable_postpone=="function";function d(C){return{isDebugSkeleton:C,dynamicAccesses:[]}}function o(C,I){let _=(0,E.RO)(C.urlPathname);if(C.isUnstableCacheCallback)throw Error(`Route ${_} used "${I}" inside a function cached with "unstable_cache(...)". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use "${I}" outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`);if(C.dynamicShouldError)throw new k.G(`Route ${_} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${I}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`);if(C.prerenderState)(function(R,F,L){f();let U=`Route ${L} needs to bail out of prerendering at this point because it used ${F}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`;R.dynamicAccesses.push({stack:R.isDebugSkeleton?Error().stack:void 0,expression:F}),s.unstable_postpone(U)})(C.prerenderState,I,_);else if(C.revalidate=0,C.isStaticGeneration){let R=new x.$(`Route ${_} couldn't be rendered statically because it used \`${I}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`);throw C.dynamicUsageDescription=I,C.dynamicUsageStack=R.stack,R}}function g(C){return C.dynamicAccesses.length>0}function c(C){return C.dynamicAccesses.filter(I=>typeof I.stack=="string"&&I.stack.length>0).map(({expression:I,stack:_})=>(_=_.split(`
`).slice(4).filter(R=>!(R.includes("node_modules/next/")||R.includes(" (<anonymous>)")||R.includes(" (node:"))).join(`
`),`Dynamic API Usage Debug - ${I}:
${_}`))}function f(){if(!S)throw Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js")}function m(C){f();let I=new AbortController;try{s.unstable_postpone(C)}catch(_){I.abort(_)}return I.signal}},we.__chunk_69182=(ce,O,u)=>{"use strict";u.d(O,{f:()=>Sn});var s=u(20519),x=u(24528),k=u(62919),E=u(94299),S=u(84197),d=u(37041),o=u(48210);function g(re){return re!=null}function c({name:re,property:he,content:xe,media:Le}){return xe!=null&&xe!==""?(0,s.jsx)("meta",{...re?{name:re}:{property:he},...Le?{media:Le}:void 0,content:typeof xe=="string"?xe:xe.toString()}):null}function f(re){let he=[];for(let xe of re)Array.isArray(xe)?he.push(...xe.filter(g)):g(xe)&&he.push(xe);return he}let m=new Set(["og:image","twitter:image","og:video","og:audio"]);function C(re,he){return m.has(re)&&he==="url"?re:((re.startsWith("og:")||re.startsWith("twitter:"))&&(he=he.replace(/([A-Z])/g,function(xe){return"_"+xe.toLowerCase()})),re+":"+he)}function I({propertyPrefix:re,namePrefix:he,contents:xe}){return xe==null?null:f(xe.map(Le=>typeof Le=="string"||typeof Le=="number"||Le instanceof URL?c({...re?{property:re}:{name:he},content:Le}):function({content:Ce,namePrefix:Ve,propertyPrefix:Ue}){return Ce?f(Object.entries(Ce).map(([qe,We])=>We===void 0?null:c({...Ue&&{property:C(Ue,qe)},...Ve&&{name:C(Ve,qe)},content:typeof We=="string"?We:We?.toString()}))):null}({namePrefix:he,propertyPrefix:re,content:Le})))}let _={width:"width",height:"height",initialScale:"initial-scale",minimumScale:"minimum-scale",maximumScale:"maximum-scale",viewportFit:"viewport-fit",userScalable:"user-scalable",interactiveWidget:"interactive-widget"},R=["icon","shortcut","apple","other"],F=["telephone","date","address","email","url"];function L({descriptor:re,...he}){return re.url?(0,s.jsx)("link",{...he,...re.title&&{title:re.title},href:re.url.toString()}):null}function U({app:re,type:he}){var xe,Le;return[c({name:`twitter:app:name:${he}`,content:re.name}),c({name:`twitter:app:id:${he}`,content:re.id[he]}),c({name:`twitter:app:url:${he}`,content:(Le=re.url)==null||(xe=Le[he])==null?void 0:xe.toString()})]}function te({icon:re}){let{url:he,rel:xe="icon",...Le}=re;return(0,s.jsx)("link",{rel:xe,href:he.toString(),...Le})}function Y({rel:re,icon:he}){if(typeof he=="object"&&!(he instanceof URL))return!he.rel&&re&&(he.rel=re),te({icon:he});{let xe=he.toString();return(0,s.jsx)("link",{rel:re,href:xe})}}function q(){return{width:"device-width",initialScale:1,themeColor:null,colorScheme:null}}function se(){return{viewport:null,themeColor:null,colorScheme:null,metadataBase:null,title:null,description:null,applicationName:null,authors:null,generator:null,keywords:null,referrer:null,creator:null,publisher:null,robots:null,manifest:null,alternates:{canonical:null,languages:null,media:null,types:null},icons:null,openGraph:null,twitter:null,verification:{},appleWebApp:null,formatDetection:null,itunes:null,facebook:null,abstract:null,appLinks:null,archives:null,assets:null,bookmarks:null,category:null,classification:null,other:{}}}function J(re){if(re!=null)return Array.isArray(re)?re:[re]}var j=u(44813),M=u.n(j);function b(re){return typeof re=="string"||re instanceof URL}function N(){return new URL(`http://localhost:${process.env.PORT||3e3}`)}function $(re,he){if(re instanceof URL)return re;if(!re)return null;try{return new URL(re)}catch{}he||(he=N());let xe=he.pathname||"";return new URL(M().posix.join(xe,re),he)}let X=/^(?:\/((?!\.well-known(?:\/.*)?)(?:[^/]+\/)*[^/]+\.\w+))(\/?|$)/i;function ae(re,he,{trailingSlash:xe,pathname:Le}){var Ce,Ve;re=typeof(Ce=re)=="string"&&Ce.startsWith("./")?M().posix.resolve(Le,Ce):Ce;let Ue="",qe=he?$(re,he):re;if(Ue=typeof qe=="string"?qe:qe.pathname==="/"?qe.origin:qe.href,xe&&!Ue.endsWith("/")){let We=Ue.startsWith("/"),Ke=Ue.includes("?"),Je=!1,vt=!1;if(!We){try{let ft=new URL(Ue);Je=he!=null&&ft.origin!==he.origin,Ve=ft.pathname,vt=X.test(Ve)}catch{Je=!0}if(!vt&&!Je&&!Ke)return`${Ue}/`}}return Ue}function K(re,he){return re?re.replace(/%s/g,he):he}function ve(re,he){let xe,Le=typeof re!="string"&&re&&"template"in re?re.template:null;return typeof re=="string"?xe=K(he,re):re&&("default"in re&&(xe=K(he,re.default)),"absolute"in re&&re.absolute&&(xe=re.absolute)),re&&typeof re!="string"?{template:Le,absolute:xe||""}:{absolute:xe||re||"",template:Le}}var ke=u(68009),fe=u(67234);let Ae={article:["authors","tags"],song:["albums","musicians"],playlist:["albums","musicians"],radio:["creators"],video:["actors","directors","writers","tags"],basic:["emails","phoneNumbers","faxNumbers","alternateLocale","audio","videos"]};function _e(re,he,xe){let Le=J(re);if(!Le)return Le;let{isMetadataBaseMissing:Ce,fallbackMetadataBase:Ve}=function(qe){let We=N(),Ke=function(){let vt=process.env.VERCEL_BRANCH_URL||process.env.VERCEL_URL;return vt?new URL(`https://${vt}`):void 0}(),Je=function(){let vt=process.env.VERCEL_PROJECT_PRODUCTION_URL;return vt?new URL(`https://${vt}`):void 0}();return{fallbackMetadataBase:Ke&&process.env.VERCEL_ENV==="preview"?Ke:qe||Je||We,isMetadataBaseMissing:!qe}}(he),Ue=[];for(let qe of Le){let We=function(Ke,Je,vt,ft){if(!Ke)return;let Lt=b(Ke),Rt=Lt?Ke:Ke.url;if(!Rt)return;let ot=!process.env.VERCEL;return(ft||ot)&&typeof Rt=="string"&&!(0,ke.N0)(Rt)&&vt&&(0,fe.O4)(`metadataBase property in metadata export is not set for resolving social open graph or twitter images, using "${Je.origin}". See https://nextjs.org/docs/app/api-reference/functions/generate-metadata#metadatabase`),Lt?{url:$(Rt,Je)}:{...Ke,url:$(Rt,Je)}}(qe,Ve,Ce,xe);We&&Ue.push(We)}return Ue}let Z={article:Ae.article,book:Ae.article,"music.song":Ae.song,"music.album":Ae.song,"music.playlist":Ae.playlist,"music.radio_station":Ae.radio,"video.movie":Ae.video,"video.episode":Ae.video},ne=(re,he,xe,Le)=>{if(!re)return null;let Ce={...re,title:ve(re.title,Le)};return function(Ve,Ue){var qe;for(let We of(qe=Ue&&"type"in Ue?Ue.type:void 0)&&qe in Z?Z[qe].concat(Ae.basic):Ae.basic)if(We in Ue&&We!=="url"){let Ke=Ue[We];if(Ke){let Je=J(Ke);Ve[We]=Je}}Ve.images=_e(Ue.images,he,xe.isStandaloneMode)}(Ce,re),Ce.url=re.url?ae(re.url,he,xe):null,Ce},W=["site","siteId","creator","creatorId","description"],Q=(re,he,xe,Le)=>{var Ce;if(!re)return null;let Ve="card"in re?re.card:void 0,Ue={...re,title:ve(re.title,Le)};for(let qe of W)Ue[qe]=re[qe]||null;if(Ue.images=_e(re.images,he,xe.isStandaloneMode),Ve=Ve||((Ce=Ue.images)!=null&&Ce.length?"summary_large_image":"summary"),Ue.card=Ve,"card"in Ue)switch(Ue.card){case"player":Ue.players=J(Ue.players)||[];break;case"app":Ue.app=Ue.app||{}}return Ue};var de=u(69720);async function ue(re){let he,xe,{layout:Le,page:Ce,defaultPage:Ve}=re[2],Ue=Ve!==void 0&&re[0]===de.av;return Le!==void 0?(he=await Le[0](),xe="layout"):Ce!==void 0?(he=await Ce[0](),xe="page"):Ue&&(he=await Ve[0](),xe="page"),[he,xe]}async function ye(re,he){let{[he]:xe}=re[2];if(xe!==void 0)return await xe[0]()}function Ge(re,he,xe){return re instanceof URL&&(re=new URL(xe.pathname,re)),ae(re,he,xe)}let Oe=re=>{var he;if(!re)return null;let xe=[];return(he=J(re))==null||he.forEach(Le=>{typeof Le=="string"?xe.push({color:Le}):typeof Le=="object"&&xe.push({color:Le.color,media:Le.media})}),xe};function Qe(re,he,xe){if(!re)return null;let Le={};for(let[Ce,Ve]of Object.entries(re))typeof Ve=="string"||Ve instanceof URL?Le[Ce]=[{url:Ge(Ve,he,xe)}]:(Le[Ce]=[],Ve?.forEach((Ue,qe)=>{let We=Ge(Ue.url,he,xe);Le[Ce][qe]={url:We,title:Ue.title}}));return Le}let be=(re,he,xe)=>{if(!re)return null;let Le=function(Ve,Ue,qe){return Ve?{url:Ge(typeof Ve=="string"||Ve instanceof URL?Ve:Ve.url,Ue,qe)}:null}(re.canonical,he,xe),Ce=Qe(re.languages,he,xe);return{canonical:Le,languages:Ce,media:Qe(re.media,he,xe),types:Qe(re.types,he,xe)}},De=["noarchive","nosnippet","noimageindex","nocache","notranslate","indexifembedded","nositelinkssearchbox","unavailable_after","max-video-preview","max-image-preview","max-snippet"],Xe=re=>{if(!re)return null;if(typeof re=="string")return re;let he=[];for(let xe of(re.index?he.push("index"):typeof re.index=="boolean"&&he.push("noindex"),re.follow?he.push("follow"):typeof re.follow=="boolean"&&he.push("nofollow"),De)){let Le=re[xe];Le!==void 0&&Le!==!1&&he.push(typeof Le=="boolean"?xe:`${xe}:${Le}`)}return he.join(", ")},tt=re=>re?{basic:Xe(re),googleBot:typeof re!="string"?Xe(re.googleBot):null}:null,Ct=["google","yahoo","yandex","me","other"],ct=re=>{if(!re)return null;let he={};for(let xe of Ct){let Le=re[xe];if(Le)if(xe==="other")for(let Ce in he.other={},re.other){let Ve=J(re.other[Ce]);Ve&&(he.other[Ce]=Ve)}else he[xe]=J(Le)}return he},Tt=re=>{var he;if(!re)return null;if(re===!0)return{capable:!0};let xe=re.startupImage?(he=J(re.startupImage))==null?void 0:he.map(Le=>typeof Le=="string"?{url:Le}:Le):null;return{capable:!("capable"in re)||!!re.capable,title:re.title||null,startupImage:xe,statusBarStyle:re.statusBarStyle||"default"}},Dt=re=>{if(!re)return null;for(let he in re)re[he]=J(re[he]);return re},mt=(re,he,xe)=>re?{appId:re.appId,appArgument:re.appArgument?Ge(re.appArgument,he,xe):void 0}:null,cr=re=>re?{appId:re.appId,admins:J(re.admins)}:null;function kr(re){return b(re)?{url:re}:(Array.isArray(re),re)}let Ht=re=>{if(!re)return null;let he={icon:[],apple:[]};if(Array.isArray(re))he.icon=re.map(kr).filter(Boolean);else if(b(re))he.icon=[kr(re)];else for(let xe of R){let Le=J(re[xe]);Le&&(he[xe]=Le.map(kr))}return he};var Or=u(2147),fr=u(61583);async function Oi(re,he,xe){if(typeof re.generateViewport=="function"){let{route:Le}=xe;return Ce=>(0,Or.Yz)().trace(fr._s.generateViewport,{spanName:`generateViewport ${Le}`,attributes:{"next.page":Le}},()=>re.generateViewport(he,Ce))}return re.viewport||null}async function li(re,he,xe){if(typeof re.generateMetadata=="function"){let{route:Le}=xe;return Ce=>(0,Or.Yz)().trace(fr._s.generateMetadata,{spanName:`generateMetadata ${Le}`,attributes:{"next.page":Le}},()=>re.generateMetadata(he,Ce))}return re.metadata||null}async function At(re,he,xe){var Le;if(!re?.[xe])return;let Ce=re[xe].map(async Ve=>{var Ue;return(Ue=await Ve(he)).default||Ue});return Ce?.length>0?(Le=await Promise.all(Ce))==null?void 0:Le.flat():void 0}async function Pr(re,he){let{metadata:xe}=re;if(!xe)return null;let[Le,Ce,Ve,Ue]=await Promise.all([At(xe,he,"icon"),At(xe,he,"apple"),At(xe,he,"openGraph"),At(xe,he,"twitter")]);return{icon:Le,apple:Ce,openGraph:Ve,twitter:Ue,manifest:xe.manifest}}async function hr({tree:re,metadataItems:he,errorMetadataItem:xe,props:Le,route:Ce,errorConvention:Ve}){let Ue,qe,We=!!(Ve&&re[2][Ve]);Ve?(Ue=await ye(re,"layout"),qe=Ve):[Ue,qe]=await ue(re),qe&&(Ce+=`/${qe}`);let Ke=await Pr(re[2],Le),Je=Ue?await li(Ue,Le,{route:Ce}):null,vt=Ue?await Oi(Ue,Le,{route:Ce}):null;if(he.push([Je,Ke,vt]),We&&Ve){let ft=await ye(re,Ve),Lt=ft?await Oi(ft,Le,{route:Ce}):null,Rt=ft?await li(ft,Le,{route:Ce}):null;xe[0]=Rt,xe[1]=Ke,xe[2]=Lt}}async function gr({tree:re,parentParams:he,metadataItems:xe,errorMetadataItem:Le,treePrefix:Ce=[],getDynamicParamFromSegment:Ve,searchParams:Ue,errorConvention:qe}){let We,[Ke,Je,{page:vt}]=re,ft=[...Ce,Ke],Lt=Ve(Ke),Rt=Lt&&Lt.value!==null?{...he,[Lt.param]:Lt.value}:he;for(let ot in We=vt!==void 0?{params:Rt,searchParams:Ue}:{params:Rt},await hr({tree:re,metadataItems:xe,errorMetadataItem:Le,errorConvention:qe,props:We,route:ft.filter(Ot=>Ot!==de.GC).join("/")}),Je){let Ot=Je[ot];await gr({tree:Ot,metadataItems:xe,errorMetadataItem:Le,parentParams:Rt,treePrefix:ft,searchParams:Ue,getDynamicParamFromSegment:Ve,errorConvention:qe})}return Object.keys(Je).length===0&&qe&&xe.push(Le),xe}let Jt=re=>!!re?.absolute,Ir=re=>Jt(re?.title);function ea(re,he){re&&(!Ir(re)&&Ir(he)&&(re.title=he.title),!re.description&&he.description&&(re.description=he.description))}async function ki(re,he,xe,Le,Ce,Ve){let Ue=re(xe[Le]),qe=he.resolvers,We=null;if(typeof Ue=="function"){if(!qe.length)for(let vt=Le;vt<xe.length;vt++){let ft=re(xe[vt]);typeof ft=="function"&&function(Lt,Rt,ot){let Ot=Rt(new Promise(yr=>{ot.push(yr)}));Ot instanceof Promise&&Ot.catch(yr=>({__nextError:yr})),Lt.push(Ot)}(Ve,ft,qe)}let Ke=qe[he.resolvingIndex],Je=Ve[he.resolvingIndex++];if(Ke(Ce),(We=Je instanceof Promise?await Je:Je)&&typeof We=="object"&&"__nextError"in We)throw We.__nextError}else Ue!==null&&typeof Ue=="object"&&(We=Ue);return We}async function na(re,he){let xe,Le=se(),Ce=[],Ve={title:null,twitter:null,openGraph:null},Ue={resolvers:[],resolvingIndex:0},qe={warnings:new Set},We={icon:[],apple:[]};for(let ot=0;ot<re.length;ot++){var Ke,Je,vt,ft,Lt,Rt;let Ot=re[ot][1];if(ot<=1&&(Rt=Ot==null||(Ke=Ot.icon)==null?void 0:Ke[0])&&(Rt.url==="/favicon.ico"||Rt.url.toString().startsWith("/favicon.ico?"))&&Rt.type==="image/x-icon"){let Ie=Ot==null||(Je=Ot.icon)==null?void 0:Je.shift();ot===0&&(xe=Ie)}let yr=await ki(Ie=>Ie[0],Ue,re,ot,Le,Ce);(function({source:Ie,target:Bt,staticFilesMetadata:$e,titleTemplates:Nt,metadataContext:Ft,buildState:or,leafSegmentStaticIcons:tr}){let rr=Ie?.metadataBase!==void 0?Ie.metadataBase:Bt.metadataBase;for(let zt in Ie)switch(zt){case"title":Bt.title=ve(Ie.title,Nt.title);break;case"alternates":Bt.alternates=be(Ie.alternates,rr,Ft);break;case"openGraph":Bt.openGraph=ne(Ie.openGraph,rr,Ft,Nt.openGraph);break;case"twitter":Bt.twitter=Q(Ie.twitter,rr,Ft,Nt.twitter);break;case"facebook":Bt.facebook=cr(Ie.facebook);break;case"verification":Bt.verification=ct(Ie.verification);break;case"icons":Bt.icons=Ht(Ie.icons);break;case"appleWebApp":Bt.appleWebApp=Tt(Ie.appleWebApp);break;case"appLinks":Bt.appLinks=Dt(Ie.appLinks);break;case"robots":Bt.robots=tt(Ie.robots);break;case"archives":case"assets":case"bookmarks":case"keywords":Bt[zt]=J(Ie[zt]);break;case"authors":Bt[zt]=J(Ie.authors);break;case"itunes":Bt[zt]=mt(Ie.itunes,rr,Ft);break;case"applicationName":case"description":case"generator":case"creator":case"publisher":case"category":case"classification":case"referrer":case"formatDetection":case"manifest":Bt[zt]=Ie[zt]||null;break;case"other":Bt.other=Object.assign({},Bt.other,Ie.other);break;case"metadataBase":Bt.metadataBase=rr;break;default:(zt==="viewport"||zt==="themeColor"||zt==="colorScheme")&&Ie[zt]!=null&&or.warnings.add(`Unsupported metadata ${zt} is configured in metadata export in ${Ft.pathname}. Please move it to viewport export instead.
Read more: https://nextjs.org/docs/app/api-reference/functions/generate-viewport`)}(function(zt,ir,wr,_r,Qr,ga){var Vi,Ur;if(!wr)return;let{icon:ta,apple:Ii,openGraph:ni,twitter:qi,manifest:wa}=wr;if(ta&&(ga.icon=ta),Ii&&(ga.apple=Ii),qi&&!(!(zt==null||(Vi=zt.twitter)==null)&&Vi.hasOwnProperty("images"))){let Ki=Q({...ir.twitter,images:qi},ir.metadataBase,_r,Qr.twitter);ir.twitter=Ki}if(ni&&!(!(zt==null||(Ur=zt.openGraph)==null)&&Ur.hasOwnProperty("images"))){let Ki=ne({...ir.openGraph,images:ni},ir.metadataBase,_r,Qr.openGraph);ir.openGraph=Ki}wa&&(ir.manifest=wa)})(Ie,Bt,$e,Ft,Nt,tr)})({target:Le,source:yr,metadataContext:he,staticFilesMetadata:Ot,titleTemplates:Ve,buildState:qe,leafSegmentStaticIcons:We}),ot<re.length-2&&(Ve={title:((vt=Le.title)==null?void 0:vt.template)||null,openGraph:((ft=Le.openGraph)==null?void 0:ft.title.template)||null,twitter:((Lt=Le.twitter)==null?void 0:Lt.title.template)||null})}if((We.icon.length>0||We.apple.length>0)&&!Le.icons&&(Le.icons={icon:[],apple:[]},We.icon.length>0&&Le.icons.icon.unshift(...We.icon),We.apple.length>0&&Le.icons.apple.unshift(...We.apple)),qe.warnings.size>0)for(let ot of qe.warnings)fe.ZK(ot);return function(ot,Ot,yr,Ie){let{openGraph:Bt,twitter:$e}=ot;if(Bt){let Nt={},Ft=Ir($e),or=$e?.description,tr=!!($e?.hasOwnProperty("images")&&$e.images);if(!Ft&&(Jt(Bt.title)?Nt.title=Bt.title:ot.title&&Jt(ot.title)&&(Nt.title=ot.title)),or||(Nt.description=Bt.description||ot.description||void 0),tr||(Nt.images=Bt.images),Object.keys(Nt).length>0){let rr=Q(Nt,ot.metadataBase,Ie,yr.twitter);ot.twitter?ot.twitter=Object.assign({},ot.twitter,{...!Ft&&{title:rr?.title},...!or&&{description:rr?.description},...!tr&&{images:rr?.images}}):ot.twitter=rr}}return ea(Bt,ot),ea($e,ot),Ot&&(ot.icons||(ot.icons={icon:[],apple:[]}),ot.icons.icon.unshift(Ot)),ot}(Le,xe,Ve,he)}async function Kr(re){let he=q(),xe=[],Le={resolvers:[],resolvingIndex:0};for(let Ce=0;Ce<re.length;Ce++){let Ve=await ki(Ue=>Ue[2],Le,re,Ce,he,xe);(function({target:Ue,source:qe}){if(qe)for(let We in qe)switch(We){case"themeColor":Ue.themeColor=Oe(qe.themeColor);break;case"colorScheme":Ue.colorScheme=qe.colorScheme||null;break;default:qe[We]!==void 0&&(Ue[We]=qe[We])}})({target:he,source:Ve})}return he}async function Ni({tree:re,parentParams:he,metadataItems:xe,errorMetadataItem:Le,getDynamicParamFromSegment:Ce,searchParams:Ve,errorConvention:Ue,metadataContext:qe}){let We,Ke=await gr({tree:re,parentParams:he,metadataItems:xe,errorMetadataItem:Le,getDynamicParamFromSegment:Ce,searchParams:Ve,errorConvention:Ue}),Je=se(),vt=q();try{vt=await Kr(Ke),Je=await na(Ke,qe)}catch(ft){We=ft}return[We,Je,vt]}var mr=u(39556);function Er(re,he){return{pathname:re.split("?")[0],trailingSlash:he.trailingSlash,isStandaloneMode:he.nextConfigOutput==="standalone"}}function Dr({tree:re,query:he,metadataContext:xe,getDynamicParamFromSegment:Le,appUsingSizeAdjustment:Ce,errorType:Ve,createDynamicallyTrackedSearchParams:Ue}){let qe,We=new Promise(Ke=>{qe=Ke});return[async function(){let Ke,Je=se(),vt=q(),ft=Je,Lt=vt,Rt=[null,null,null],ot=Ue(he),[Ot,yr,Ie]=await Ni({tree:re,parentParams:{},metadataItems:[],errorMetadataItem:Rt,searchParams:ot,getDynamicParamFromSegment:Le,errorConvention:Ve==="redirect"?void 0:Ve,metadataContext:xe});if(Ot){if(Ke=Ot,!Ve&&(0,mr.X)(Ot)){let[$e,Nt,Ft]=await Ni({tree:re,parentParams:{},metadataItems:[],errorMetadataItem:Rt,searchParams:ot,getDynamicParamFromSegment:Le,errorConvention:"not-found",metadataContext:xe});Lt=Ft,ft=Nt,Ke=$e||Ke}qe(Ke)}else Lt=Ie,ft=yr,qe(void 0);let Bt=f([function({viewport:$e}){return f([c({name:"viewport",content:function(Nt){let Ft=null;if(Nt&&typeof Nt=="object"){for(let or in Ft="",_)if(or in Nt){let tr=Nt[or];typeof tr=="boolean"&&(tr=tr?"yes":"no"),Ft&&(Ft+=", "),Ft+=`${_[or]}=${tr}`}}return Ft}($e)}),...$e.themeColor?$e.themeColor.map(Nt=>c({name:"theme-color",content:Nt.color,media:Nt.media})):[],c({name:"color-scheme",content:$e.colorScheme})])}({viewport:Lt}),function({metadata:$e}){var Nt,Ft,or;return f([(0,s.jsx)("meta",{charSet:"utf-8"}),$e.title!==null&&$e.title.absolute?(0,s.jsx)("title",{children:$e.title.absolute}):null,c({name:"description",content:$e.description}),c({name:"application-name",content:$e.applicationName}),...$e.authors?$e.authors.map(tr=>[tr.url?(0,s.jsx)("link",{rel:"author",href:tr.url.toString()}):null,c({name:"author",content:tr.name})]):[],$e.manifest?(0,s.jsx)("link",{rel:"manifest",href:$e.manifest.toString(),crossOrigin:"use-credentials"}):null,c({name:"generator",content:$e.generator}),c({name:"keywords",content:(Nt=$e.keywords)==null?void 0:Nt.join(",")}),c({name:"referrer",content:$e.referrer}),c({name:"creator",content:$e.creator}),c({name:"publisher",content:$e.publisher}),c({name:"robots",content:(Ft=$e.robots)==null?void 0:Ft.basic}),c({name:"googlebot",content:(or=$e.robots)==null?void 0:or.googleBot}),c({name:"abstract",content:$e.abstract}),...$e.archives?$e.archives.map(tr=>(0,s.jsx)("link",{rel:"archives",href:tr})):[],...$e.assets?$e.assets.map(tr=>(0,s.jsx)("link",{rel:"assets",href:tr})):[],...$e.bookmarks?$e.bookmarks.map(tr=>(0,s.jsx)("link",{rel:"bookmarks",href:tr})):[],c({name:"category",content:$e.category}),c({name:"classification",content:$e.classification}),...$e.other?Object.entries($e.other).map(([tr,rr])=>Array.isArray(rr)?rr.map(zt=>c({name:tr,content:zt})):c({name:tr,content:rr})):[]])}({metadata:ft}),function({alternates:$e}){if(!$e)return null;let{canonical:Nt,languages:Ft,media:or,types:tr}=$e;return f([Nt?L({rel:"canonical",descriptor:Nt}):null,Ft?Object.entries(Ft).flatMap(([rr,zt])=>zt?.map(ir=>L({rel:"alternate",hrefLang:rr,descriptor:ir}))):null,or?Object.entries(or).flatMap(([rr,zt])=>zt?.map(ir=>L({rel:"alternate",media:rr,descriptor:ir}))):null,tr?Object.entries(tr).flatMap(([rr,zt])=>zt?.map(ir=>L({rel:"alternate",type:rr,descriptor:ir}))):null])}({alternates:ft.alternates}),function({itunes:$e}){if(!$e)return null;let{appId:Nt,appArgument:Ft}=$e,or=`app-id=${Nt}`;return Ft&&(or+=`, app-argument=${Ft}`),(0,s.jsx)("meta",{name:"apple-itunes-app",content:or})}({itunes:ft.itunes}),function({facebook:$e}){if(!$e)return null;let{appId:Nt,admins:Ft}=$e;return f([Nt?(0,s.jsx)("meta",{property:"fb:app_id",content:Nt}):null,...Ft?Ft.map(or=>(0,s.jsx)("meta",{property:"fb:admins",content:or})):[]])}({facebook:ft.facebook}),function({formatDetection:$e}){if(!$e)return null;let Nt="";for(let Ft of F)Ft in $e&&(Nt&&(Nt+=", "),Nt+=`${Ft}=no`);return(0,s.jsx)("meta",{name:"format-detection",content:Nt})}({formatDetection:ft.formatDetection}),function({verification:$e}){return $e?f([I({namePrefix:"google-site-verification",contents:$e.google}),I({namePrefix:"y_key",contents:$e.yahoo}),I({namePrefix:"yandex-verification",contents:$e.yandex}),I({namePrefix:"me",contents:$e.me}),...$e.other?Object.entries($e.other).map(([Nt,Ft])=>I({namePrefix:Nt,contents:Ft})):[]]):null}({verification:ft.verification}),function({appleWebApp:$e}){if(!$e)return null;let{capable:Nt,title:Ft,startupImage:or,statusBarStyle:tr}=$e;return f([Nt?c({name:"apple-mobile-web-app-capable",content:"yes"}):null,c({name:"apple-mobile-web-app-title",content:Ft}),or?or.map(rr=>(0,s.jsx)("link",{href:rr.url,media:rr.media,rel:"apple-touch-startup-image"})):null,tr?c({name:"apple-mobile-web-app-status-bar-style",content:tr}):null])}({appleWebApp:ft.appleWebApp}),function({openGraph:$e}){var Nt,Ft,or,tr,rr,zt,ir;let wr;if(!$e)return null;if("type"in $e){let _r=$e.type;switch(_r){case"website":wr=[c({property:"og:type",content:"website"})];break;case"article":wr=[c({property:"og:type",content:"article"}),c({property:"article:published_time",content:(tr=$e.publishedTime)==null?void 0:tr.toString()}),c({property:"article:modified_time",content:(rr=$e.modifiedTime)==null?void 0:rr.toString()}),c({property:"article:expiration_time",content:(zt=$e.expirationTime)==null?void 0:zt.toString()}),I({propertyPrefix:"article:author",contents:$e.authors}),c({property:"article:section",content:$e.section}),I({propertyPrefix:"article:tag",contents:$e.tags})];break;case"book":wr=[c({property:"og:type",content:"book"}),c({property:"book:isbn",content:$e.isbn}),c({property:"book:release_date",content:$e.releaseDate}),I({propertyPrefix:"book:author",contents:$e.authors}),I({propertyPrefix:"book:tag",contents:$e.tags})];break;case"profile":wr=[c({property:"og:type",content:"profile"}),c({property:"profile:first_name",content:$e.firstName}),c({property:"profile:last_name",content:$e.lastName}),c({property:"profile:username",content:$e.username}),c({property:"profile:gender",content:$e.gender})];break;case"music.song":wr=[c({property:"og:type",content:"music.song"}),c({property:"music:duration",content:(ir=$e.duration)==null?void 0:ir.toString()}),I({propertyPrefix:"music:album",contents:$e.albums}),I({propertyPrefix:"music:musician",contents:$e.musicians})];break;case"music.album":wr=[c({property:"og:type",content:"music.album"}),I({propertyPrefix:"music:song",contents:$e.songs}),I({propertyPrefix:"music:musician",contents:$e.musicians}),c({property:"music:release_date",content:$e.releaseDate})];break;case"music.playlist":wr=[c({property:"og:type",content:"music.playlist"}),I({propertyPrefix:"music:song",contents:$e.songs}),I({propertyPrefix:"music:creator",contents:$e.creators})];break;case"music.radio_station":wr=[c({property:"og:type",content:"music.radio_station"}),I({propertyPrefix:"music:creator",contents:$e.creators})];break;case"video.movie":wr=[c({property:"og:type",content:"video.movie"}),I({propertyPrefix:"video:actor",contents:$e.actors}),I({propertyPrefix:"video:director",contents:$e.directors}),I({propertyPrefix:"video:writer",contents:$e.writers}),c({property:"video:duration",content:$e.duration}),c({property:"video:release_date",content:$e.releaseDate}),I({propertyPrefix:"video:tag",contents:$e.tags})];break;case"video.episode":wr=[c({property:"og:type",content:"video.episode"}),I({propertyPrefix:"video:actor",contents:$e.actors}),I({propertyPrefix:"video:director",contents:$e.directors}),I({propertyPrefix:"video:writer",contents:$e.writers}),c({property:"video:duration",content:$e.duration}),c({property:"video:release_date",content:$e.releaseDate}),I({propertyPrefix:"video:tag",contents:$e.tags}),c({property:"video:series",content:$e.series})];break;case"video.tv_show":wr=[c({property:"og:type",content:"video.tv_show"})];break;case"video.other":wr=[c({property:"og:type",content:"video.other"})];break;default:throw Error(`Invalid OpenGraph type: ${_r}`)}}return f([c({property:"og:determiner",content:$e.determiner}),c({property:"og:title",content:(Nt=$e.title)==null?void 0:Nt.absolute}),c({property:"og:description",content:$e.description}),c({property:"og:url",content:(Ft=$e.url)==null?void 0:Ft.toString()}),c({property:"og:site_name",content:$e.siteName}),c({property:"og:locale",content:$e.locale}),c({property:"og:country_name",content:$e.countryName}),c({property:"og:ttl",content:(or=$e.ttl)==null?void 0:or.toString()}),I({propertyPrefix:"og:image",contents:$e.images}),I({propertyPrefix:"og:video",contents:$e.videos}),I({propertyPrefix:"og:audio",contents:$e.audio}),I({propertyPrefix:"og:email",contents:$e.emails}),I({propertyPrefix:"og:phone_number",contents:$e.phoneNumbers}),I({propertyPrefix:"og:fax_number",contents:$e.faxNumbers}),I({propertyPrefix:"og:locale:alternate",contents:$e.alternateLocale}),...wr||[]])}({openGraph:ft.openGraph}),function({twitter:$e}){var Nt;if(!$e)return null;let{card:Ft}=$e;return f([c({name:"twitter:card",content:Ft}),c({name:"twitter:site",content:$e.site}),c({name:"twitter:site:id",content:$e.siteId}),c({name:"twitter:creator",content:$e.creator}),c({name:"twitter:creator:id",content:$e.creatorId}),c({name:"twitter:title",content:(Nt=$e.title)==null?void 0:Nt.absolute}),c({name:"twitter:description",content:$e.description}),I({namePrefix:"twitter:image",contents:$e.images}),...Ft==="player"?$e.players.flatMap(or=>[c({name:"twitter:player",content:or.playerUrl.toString()}),c({name:"twitter:player:stream",content:or.streamUrl.toString()}),c({name:"twitter:player:width",content:or.width}),c({name:"twitter:player:height",content:or.height})]):[],...Ft==="app"?[U({app:$e.app,type:"iphone"}),U({app:$e.app,type:"ipad"}),U({app:$e.app,type:"googleplay"})]:[]])}({twitter:ft.twitter}),function({appLinks:$e}){return $e?f([I({propertyPrefix:"al:ios",contents:$e.ios}),I({propertyPrefix:"al:iphone",contents:$e.iphone}),I({propertyPrefix:"al:ipad",contents:$e.ipad}),I({propertyPrefix:"al:android",contents:$e.android}),I({propertyPrefix:"al:windows_phone",contents:$e.windows_phone}),I({propertyPrefix:"al:windows",contents:$e.windows}),I({propertyPrefix:"al:windows_universal",contents:$e.windows_universal}),I({propertyPrefix:"al:web",contents:$e.web})]):null}({appLinks:ft.appLinks}),function({icons:$e}){if(!$e)return null;let Nt=$e.shortcut,Ft=$e.icon,or=$e.apple,tr=$e.other;return f([Nt?Nt.map(rr=>Y({rel:"shortcut icon",icon:rr})):null,Ft?Ft.map(rr=>Y({rel:"icon",icon:rr})):null,or?or.map(rr=>Y({rel:"apple-touch-icon",icon:rr})):null,tr?tr.map(rr=>te({icon:rr})):null])}({icons:ft.icons})]);return Ce&&Bt.push((0,s.jsx)("meta",{name:"next-size-adjust"})),(0,s.jsx)(s.Fragment,{children:Bt.map(($e,Nt)=>x.cloneElement($e,{key:Nt}))})},async function(){let Ke=await We;if(Ke)throw Ke;return null}]}var Ar=u(1533),Br=u(84223);let ba={wrap(re,{urlPathname:he,renderOpts:xe,requestEndedState:Le},Ce){let Ve=!xe.supportsDynamicResponse&&!xe.isDraftMode&&!xe.isServerAction,Ue=Ve&&xe.experimental.ppr?(0,Br.FI)(xe.isDebugPPRSkeleton):null,qe={isStaticGeneration:Ve,urlPathname:he,pagePath:xe.originalPathname,incrementalCache:xe.incrementalCache||aa.__incrementalCache,isRevalidate:xe.isRevalidate,isPrerendering:xe.nextExport,fetchCache:xe.fetchCache,isOnDemandRevalidate:xe.isOnDemandRevalidate,isDraftMode:xe.isDraftMode,prerenderState:Ue,requestEndedState:Le};return xe.store=qe,re.run(qe,Ce,qe)}};var Wr=u(29560),pi=u(78045);u(26195).Buffer;let Ba=re=>{let he=["/layout"];if(re.startsWith("/")){let xe=re.split("/");for(let Le=1;Le<xe.length+1;Le++){let Ce=xe.slice(0,Le).join("/");Ce&&(Ce.endsWith("/page")||Ce.endsWith("/route")||(Ce=`${Ce}${Ce.endsWith("/")?"":"/"}layout`),he.push(Ce))}}return he};class Xt extends k.Z{constructor(he,xe){super(he,{contentType:o.eY,waitUntil:xe?.waitUntil,metadata:xe?.metadata??{}})}}var ti=u(68827),Pa=u.n(ti);let $t=["useDeferredValue","useEffect","useImperativeHandle","useInsertionEffect","useLayoutEffect","useReducer","useRef","useState","useSyncExternalStore","useTransition","experimental_useOptimistic","useOptimistic"];function Qt(re,he){if(re.message=he,re.stack){let xe=re.stack.split(`
`);xe[0]=he,re.stack=xe.join(`
`)}}var Mi=u(29744),Fi=u(403),ji=u(4248);let _i=re=>(0,mr.X)(re)||(0,Wr.eo)(re),ai=re=>(0,Fi.j)(re)||(0,ji.D)(re)||_i(re),di={serverComponents:"serverComponents",flightData:"flightData",html:"html"};function gi({source:re,dev:he,isNextExport:xe,errorLogger:Le,digestErrorsMap:Ce,allCapturedErrors:Ve,silenceLogger:Ue}){return(qe,We)=>{var Ke;qe.digest||(qe.digest=Pa()(qe.message+(We?.stack||qe.stack||"")).toString());let Je=qe.digest;if(Ve&&Ve.push(qe),ai(qe))return qe.digest;if(!(0,Mi.D)(qe)){if(Ce.has(Je)?re===di.html&&(qe=Ce.get(Je)):Ce.set(Je,qe),he&&function(vt){if(typeof vt?.message=="string"){if(vt.message.includes("Class extends value undefined is not a constructor or null")){let ft="This might be caused by a React Class Component being rendered in a Server Component, React Class Components only works in Client Components. Read more: https://nextjs.org/docs/messages/class-component-in-server-component";if(vt.message.includes(ft))return;Qt(vt,`${vt.message}

${ft}`);return}if(vt.message.includes("createContext is not a function")){Qt(vt,'createContext only works in Client Components. Add the "use client" directive at the top of the file to use it. Read more: https://nextjs.org/docs/messages/context-in-server-component');return}for(let ft of $t)if(RegExp(`\\b${ft}\\b.*is not a function`).test(vt.message)){Qt(vt,`${ft} only works in Client Components. Add the "use client" directive at the top of the file to use it. Read more: https://nextjs.org/docs/messages/react-client-hook-in-server-component`);return}}}(qe),!(xe&&(qe==null||(Ke=qe.message)==null?void 0:Ke.includes("The specific message is omitted in production builds to avoid leaking sensitive details.")))){let vt=(0,Or.Yz)().getActiveScopeSpan();vt&&(vt.recordException(qe),vt.setStatus({code:Or.Qn.ERROR,message:qe.message})),Ue||(Le?Le(qe).catch(()=>{}):typeof __next_log_error__=="function"?__next_log_error__(qe):console.error(qe))}return qe.digest}}}let hi={catchall:"c","catchall-intercepted":"ci","optional-catchall":"oc",dynamic:"d","dynamic-intercepted":"di"};var Ri=u(75368);let fi={"&":"\\u0026",">":"\\u003e","<":"\\u003c","\u2028":"\\u2028","\u2029":"\\u2029"},Ai=/[&><\u2028\u2029]/g;function Bi(re){return re.replace(Ai,he=>fi[he])}var mi=u(3758),zr=u.n(mi);let Gi=zr().enums(["c","ci","oc","d","di"]),Yr=zr().union([zr().string(),zr().tuple([zr().string(),zr().string(),Gi])]),yi=zr().tuple([Yr,zr().record(zr().string(),zr().lazy(()=>yi)),zr().optional(zr().nullable(zr().string())),zr().optional(zr().nullable(zr().union([zr().literal("refetch"),zr().literal("refresh")]))),zr().optional(zr().boolean())]),Na="http://n",Fa="Invalid request URL";function Xr(re,he){if(re===de.GC){let xe=JSON.stringify(he);return xe!=="{}"?re+"?"+xe:re}return re}function Hi([re,he,{layout:xe}],Le,Ce,Ve=!1){let Ue=Le(re),qe=[Xr(Ue?Ue.treeSegment:re,Ce),{}];return Ve||xe===void 0||(Ve=!0,qe[4]=!0),qe[1]=Object.keys(he).reduce((We,Ke)=>(We[Ke]=Hi(he[Ke],Le,Ce,Ve),We),{}),qe}let ln=["accept-encoding","keepalive","keep-alive","content-encoding","transfer-encoding","connection","expect","content-length","set-cookie"],dn=(re,he)=>{for(let[xe,Le]of(re["content-length"]&&re["content-length"]==="0"&&delete re["content-length"],Object.entries(re)))(he.includes(xe)||!(Array.isArray(Le)||typeof Le=="string"))&&delete re[xe];return re};var un=u(73343),tn=u(1663);let ss=(re,he=[])=>he.some(xe=>xe&&(xe===re||function(Le,Ce){let Ve=Le.split("."),Ue=Ce.split(".");if(Ue.length<1||Ve.length<Ue.length)return!1;let qe=0;for(;Ue.length&&qe++<2;){let We=Ue.pop(),Ke=Ve.pop();switch(We){case"":case"*":case"**":return!1;default:if(Ke!==We)return!1}}for(;Ue.length;){let We=Ue.pop(),Ke=Ve.pop();switch(We){case"":return!1;case"*":if(Ke)continue;return!1;case"**":return Ue.length>0?!1:Ke!==void 0;default:if(Ke!==We)return!1}}return Ve.length===0}(re,xe)));var Wn=u(1434),zn=u(37842),vn=u(43150),In=u(43096);function $n(re){let he={};for(let[xe,Le]of Object.entries(re))Le!==void 0&&(he[xe]=Array.isArray(Le)?Le.join(", "):`${Le}`);return he}function Ln(re,he){let xe=re.headers,Le=new Wn.qC(zn.h.from(xe)),Ce=he.getHeaders(),Ve=new Wn.nV((0,vn.EK)(Ce)),Ue=dn({...$n(xe),...$n(Ce)},ln);return Ve.getAll().forEach(qe=>{qe.value===void 0?Le.delete(qe.name):Le.set(qe)}),Ue.cookie=Le.toString(),delete Ue["transfer-encoding"],new Headers(Ue)}async function Aa(re,{staticGenerationStore:he,requestStore:xe}){var Le,Ce;await Promise.all([(Le=he.incrementalCache)==null?void 0:Le.revalidateTag(he.revalidatedTags||[]),...Object.values(he.pendingRevalidates||{})]);let Ve=(Ce=he.revalidatedTags)!=null&&Ce.length?1:0,Ue=(0,un.fB)(xe.mutableCookies).length?1:0;re.setHeader("x-action-revalidated",JSON.stringify([[],Ve,Ue]))}async function Yn(re,he,xe,Le,Ce,Ve){var Ue,qe;if(!xe)throw Error("Invariant: Missing `host` header from a forwarded Server Actions request.");let We=Ln(re,he);We.set("x-action-forwarded","1");let Ke=((Ue=Ve.incrementalCache)==null?void 0:Ue.requestProtocol)||"https",Je=process.env.__NEXT_PRIVATE_ORIGIN||`${Ke}://${xe.value}`,vt=new URL(`${Je}${Ce}${Le}`);try{let ft;if(!re.body)throw Error("invariant: Missing request body.");ft=re.body;let Lt=await fetch(vt,{method:"POST",body:ft,duplex:"half",headers:We,next:{internal:1}});if(Lt.headers.get("content-type")===o.eY){for(let[Rt,ot]of Lt.headers)ln.includes(Rt)||he.setHeader(Rt,ot);return new Xt(Lt.body)}(qe=Lt.body)==null||qe.cancel()}catch(ft){console.error("failed to forward action response",ft)}}async function jn(re,he,xe,Le,Ce,Ve){he.setHeader("x-action-redirect",Le);let Ue=new URL(Le,"http://n");if(Le.startsWith("/")||xe&&xe.value===Ue.host){var qe,We,Ke,Je,vt;if(!xe)throw Error("Invariant: Missing `host` header from a forwarded Server Actions request.");let ft=Ln(re,he);ft.set(o.A,"1");let Lt=((qe=Ve.incrementalCache)==null?void 0:qe.requestProtocol)||"https",Rt=process.env.__NEXT_PRIVATE_ORIGIN||`${Lt}://${xe.value}`,ot=new URL(`${Rt}${Ce}${Ue.pathname}${Ue.search}`);Ve.revalidatedTags&&(ft.set(pi.of,Ve.revalidatedTags.join(",")),ft.set(pi.X_,((Je=Ve.incrementalCache)==null||(Ke=Je.prerenderManifest)==null||(We=Ke.preview)==null?void 0:We.previewModeId)||"")),ft.delete("next-router-state-tree");try{let Ot=await fetch(ot,{method:"GET",headers:ft,next:{internal:1}});if(Ot.headers.get("content-type")===o.eY){for(let[yr,Ie]of Ot.headers)ln.includes(yr)||he.setHeader(yr,Ie);return new Xt(Ot.body)}(vt=Ot.body)==null||vt.cancel()}catch(Ot){console.error("failed to get redirect response",Ot)}}return k.Z.fromStatic("{}")}function lt(re){return re.length>100?re.slice(0,100)+"...":re}async function B({req:re,res:he,ComponentMod:xe,serverModuleMap:Le,generateFlight:Ce,staticGenerationStore:Ve,requestStore:Ue,serverActions:qe,ctx:We}){var Ke,Je;let vt,ft,Lt,Rt;re.headers["content-type"];let{serverActionsManifest:ot,page:Ot}=We.renderOpts,{actionId:yr,isURLEncodedAction:Ie,isMultipartAction:Bt,isFetchAction:$e,isServerAction:Nt}=(0,tn.G)(re);if(!Nt)return;if(Ve.isStaticGeneration)throw Error("Invariant: server actions can't be handled during static rendering");Ve.fetchCache="default-no-store";let Ft=typeof re.headers.origin=="string"?new URL(re.headers.origin).host:void 0,or=re.headers["x-forwarded-host"],tr=re.headers.host,rr=or?{type:"x-forwarded-host",value:or}:tr?{type:"host",value:tr}:void 0;if(Ft){if((!rr||Ft!==rr.value)&&!ss(Ft,qe?.allowedOrigins)){console.error(rr?`\`${rr.type}\` header with value \`${lt(rr.value)}\` does not match \`origin\` header with value \`${lt(Ft)}\` from a forwarded Server Actions request. Aborting the action.`:"`x-forwarded-host` or `host` headers are not provided. One of these is needed to compare the `origin` header from a forwarded Server Actions request. Aborting the action.");let _r=Error("Invalid Server Actions request.");if($e){he.statusCode=500,await Promise.all([(Ke=Ve.incrementalCache)==null?void 0:Ke.revalidateTag(Ve.revalidatedTags||[]),...Object.values(Ve.pendingRevalidates||{})]);let Qr=Promise.reject(_r);try{await Qr}catch{}return{type:"done",result:await Ce(We,{actionResult:Qr,skipFlight:!Ve.pathWasRevalidated})}}throw _r}}else Rt="Missing `origin` header from a forwarded Server Actions request.";he.setHeader("Cache-Control","no-cache, no-store, max-age=0, must-revalidate");let zt=[],{actionAsyncStorage:ir}=xe,wr=!!re.headers["x-action-forwarded"];if(yr){let _r=(0,In.k)(yr,Ot,ot);if(_r)return{type:"done",result:await Yn(re,he,rr,_r,We.renderOpts.basePath,Ve)}}try{return await ir.run({isAction:!0},async()=>{{let{decodeReply:ga,decodeAction:Vi,decodeFormState:Ur}=xe;if(!re.body)throw Error("invariant: Missing request body.");if(Bt){let ta=await re.request.formData();if($e)zt=await ga(ta,Le);else{let Ii=await Vi(ta,Le);if(typeof Ii=="function"){Rt&&(0,fe.ZK)(Rt);let ni=await Ii();ft=Ur(ni,ta)}return}}else{try{Lt=le(yr,Le)}catch(ni){return yr!==null&&console.error(ni),{type:"not-found"}}let ta="",Ii=re.body.getReader();for(;;){let{done:ni,value:qi}=await Ii.read();if(ni)break;ta+=new TextDecoder().decode(qi)}if(Ie){let ni=function(qi){let wa=new URLSearchParams(qi),Ki=new FormData;for(let[ra,la]of wa)Ki.append(ra,la);return Ki}(ta);zt=await ga(ni,Le)}else zt=await ga(ta,Le)}}try{Lt=Lt??le(yr,Le)}catch(ga){return yr!==null&&console.error(ga),{type:"not-found"}}let _r=(await xe.__next_app__.require(Lt))[yr],Qr=await _r.apply(null,zt);$e&&(await Aa(he,{staticGenerationStore:Ve,requestStore:Ue}),vt=await Ce(We,{actionResult:Promise.resolve(Qr),skipFlight:!Ve.pathWasRevalidated||wr}))}),{type:"done",result:vt,formState:ft}}catch(_r){if((0,Wr.eo)(_r)){let Qr=(0,Wr.M6)(_r),ga=(0,Wr.j2)(_r);if(await Aa(he,{staticGenerationStore:Ve,requestStore:Ue}),he.statusCode=ga,$e)return{type:"done",result:await jn(re,he,rr,Qr,We.renderOpts.basePath,Ve)};if(_r.mutableCookies){let Vi=new Headers;(0,un._5)(Vi,_r.mutableCookies)&&he.setHeader("set-cookie",Array.from(Vi.values()))}return he.setHeader("Location",Qr),{type:"done",result:k.Z.fromStatic("")}}if((0,mr.X)(_r)){if(he.statusCode=404,await Aa(he,{staticGenerationStore:Ve,requestStore:Ue}),$e){let Qr=Promise.reject(_r);try{await Qr}catch{}return{type:"done",result:await Ce(We,{skipFlight:!1,actionResult:Qr,asNotFound:!0})}}return{type:"not-found"}}if($e){he.statusCode=500,await Promise.all([(Je=Ve.incrementalCache)==null?void 0:Je.revalidateTag(Ve.revalidatedTags||[]),...Object.values(Ve.pendingRevalidates||{})]);let Qr=Promise.reject(_r);try{await Qr}catch{}return{type:"done",result:await Ce(We,{actionResult:Qr,skipFlight:!Ve.pathWasRevalidated||wr})}}throw _r}}function le(re,he){try{var xe;if(!re)throw Error("Invariant: Missing 'next-action' header.");let Le=he==null||(xe=he[re])==null?void 0:xe.id;if(!Le)throw Error("Invariant: Couldn't find action module ID from module map.");return Le}catch(Le){throw Error(`Failed to find Server Action "${re}". This request might be from an older or newer deployment. ${Le instanceof Error?`Original error: ${Le.message}`:""}`)}}var pe=u(74917);function Re(re){return re.split("/").map(he=>encodeURIComponent(he)).join("/")}var Pe=u(85192);function it(re,he,xe,Le,Ce,Ve){let Ue,qe=[],We={src:"",crossOrigin:xe},Ke=re.rootMainFiles.map(Re);if(Ke.length===0)throw Error("Invariant: missing bootstrap script. This is a bug in Next.js");if(Le){We.src=`${he}/_next/`+Ke[0]+Ce,We.integrity=Le[Ke[0]];for(let Je=1;Je<Ke.length;Je++){let vt=`${he}/_next/`+Ke[Je]+Ce,ft=Le[Ke[Je]];qe.push(vt,ft)}Ue=()=>{for(let Je=0;Je<qe.length;Je+=2)Pe.preinit(qe[Je],{as:"script",integrity:qe[Je+1],crossOrigin:xe,nonce:Ve})}}else{We.src=`${he}/_next/`+Ke[0]+Ce;for(let Je=1;Je<Ke.length;Je++){let vt=`${he}/_next/`+Ke[Je]+Ce;qe.push(vt)}Ue=()=>{for(let Je=0;Je<qe.length;Je++)Pe.preinit(qe[Je],{as:"script",nonce:Ve,crossOrigin:xe})}}return[Ue,We]}var yt=u(15109),St=u(3973),It=u(65140);function er({polyfills:re,renderServerInsertedHTML:he,serverCapturedErrors:xe,basePath:Le}){let Ce=0,Ve=re.length!==0;return async function(){let Ue=[];for(;Ce<xe.length;){let Ke=xe[Ce];if(Ce++,(0,mr.X)(Ke))Ue.push((0,s.jsx)("meta",{name:"robots",content:"noindex"},Ke.digest),null);else if((0,Wr.eo)(Ke)){let Je=(0,yt.V)((0,Wr.M6)(Ke),Le),vt=(0,Wr.j2)(Ke)===It.X.PermanentRedirect;Je&&Ue.push((0,s.jsx)("meta",{id:"__next-page-redirect",httpEquiv:"refresh",content:`${vt?0:1};url=${Je}`},Ke.digest))}}let qe=he();if(!Ve&&Ue.length===0&&Array.isArray(qe)&&qe.length===0)return"";let We=await(0,St.renderToReadableStream)((0,s.jsxs)(s.Fragment,{children:[Ve&&re.map(Ke=>(0,s.jsx)("script",{...Ke},Ke.src)),qe,Ue]}),{progressiveChunkSize:1048576});return Ve=!1,(0,E.PN)(We)}}function qr(re,he,xe,Le,Ce){var Ve;let Ue=he.replace(/\.[^.]+$/,""),qe=new Set,We=new Set,Ke=re.entryCSSFiles[Ue],Je=((Ve=re.entryJSFiles)==null?void 0:Ve[Ue])??[];if(Ke)for(let vt of Ke)xe.has(vt)||(Ce&&xe.add(vt),qe.add(vt));if(Je)for(let vt of Je)Le.has(vt)||(Ce&&Le.add(vt),We.add(vt));return{styles:[...qe],scripts:[...We]}}function Zr(re,he,xe){if(!re||!he)return null;let Le=he.replace(/\.[^.]+$/,""),Ce=new Set,Ve=!1,Ue=re.app[Le];if(Ue)for(let qe of(Ve=!0,Ue))xe.has(qe)||(Ce.add(qe),xe.add(qe));return Ce.size?[...Ce].sort():Ve&&xe.size===0?[]:null}function vi(re){let[,he,{loading:xe}]=re;return!!xe||Object.values(he).some(Le=>vi(Le))}function Ze(re){return re.default||re}function Kt(re,he){let xe="";return re.renderOpts.deploymentId&&(xe+=`?dpl=${re.renderOpts.deploymentId}`),xe}async function Gr({filePath:re,getComponent:he,injectedCSS:xe,injectedJS:Le,ctx:Ce}){let{styles:Ve,scripts:Ue}=qr(Ce.clientReferenceManifest,re,xe,Le),qe=Ve?Ve.map((Ke,Je)=>{let vt=`${Ce.assetPrefix}/_next/${Re(Ke)}${Kt(Ce,!0)}`;return(0,s.jsx)("link",{rel:"stylesheet",href:vt,precedence:"next",crossOrigin:Ce.renderOpts.crossOrigin},Je)}):null,We=Ue?Ue.map(Ke=>(0,s.jsx)("script",{src:`${Ce.assetPrefix}/_next/${Re(Ke)}${Kt(Ce,!0)}`,async:!0})):null;return[Ze(await he()),qe,We]}var bi=u(76513);function Wt(re){return(0,Or.Yz)().trace(fr.Xy.createComponentTree,{spanName:"build component tree"},()=>Fr(re))}async function Fr({createSegmentPath:re,loaderTree:he,parentParams:xe,firstItem:Le,rootLayoutIncluded:Ce,injectedCSS:Ve,injectedJS:Ue,injectedFontPreloadTags:qe,asNotFound:We,metadataOutlet:Ke,ctx:Je,missingSlots:vt}){let ft,{renderOpts:{nextConfigOutput:Lt,experimental:Rt},staticGenerationStore:ot,componentMod:{NotFoundBoundary:Ot,LayoutRouter:yr,RenderFromTemplateContext:Ie,ClientPageRoot:Bt,createUntrackedSearchParams:$e,createDynamicallyTrackedSearchParams:Nt,serverHooks:{DynamicServerError:Ft},Postpone:or},pagePath:tr,getDynamicParamFromSegment:rr,isPrefetch:zt,query:ir}=Je,{page:wr,layoutOrPagePath:_r,segment:Qr,components:ga,parallelRoutes:Vi}=function(Gt){let[ri,Jr,zi]=Gt,{layout:Ne}=zi,{page:Sa}=zi;Sa=ri===de.av?zi.defaultPage:Sa;let br=Ne?.[1]||Sa?.[1];return{page:Sa,segment:ri,components:zi,layoutOrPagePath:br,parallelRoutes:Jr}}(he),{layout:Ur,template:ta,error:Ii,loading:ni,"not-found":qi}=ga,wa=new Set(Ve),Ki=new Set(Ue),ra=new Set(qe),la=function({ctx:Gt,layoutOrPagePath:ri,injectedCSS:Jr,injectedJS:zi,injectedFontPreloadTags:Ne}){let{styles:Sa,scripts:br}=ri?qr(Gt.clientReferenceManifest,ri,Jr,zi,!0):{styles:[],scripts:[]},Pi=ri?Zr(Gt.renderOpts.nextFontManifest,ri,Ne):null;if(Pi)if(Pi.length)for(let da=0;da<Pi.length;da++){let ia=Pi[da],Ya=/\.(woff|woff2|eot|ttf|otf)$/.exec(ia)[1],Jn=`font/${Ya}`,Xa=`${Gt.assetPrefix}/_next/${Re(ia)}`;Gt.componentMod.preloadFont(Xa,Jn,Gt.renderOpts.crossOrigin)}else try{let da=new URL(Gt.assetPrefix);Gt.componentMod.preconnect(da.origin,"anonymous")}catch{Gt.componentMod.preconnect("/","anonymous")}let ka=Sa?Sa.map((da,ia)=>{let Ya=`${Gt.assetPrefix}/_next/${Re(da)}${Kt(Gt,!0)}`;return Gt.componentMod.preloadStyle(Ya,Gt.renderOpts.crossOrigin),(0,s.jsx)("link",{rel:"stylesheet",href:Ya,precedence:"next",crossOrigin:Gt.renderOpts.crossOrigin},ia)}):[],nn=br?br.map((da,ia)=>{let Ya=`${Gt.assetPrefix}/_next/${Re(da)}${Kt(Gt,!0)}`;return(0,s.jsx)("script",{src:Ya,async:!0},`script-${ia}`)}):[];return ka.length||nn.length?[...ka,...nn]:null}({ctx:Je,layoutOrPagePath:_r,injectedCSS:wa,injectedJS:Ki,injectedFontPreloadTags:ra}),[Xn,an,cn]=ta?await Gr({ctx:Je,filePath:ta[1],getComponent:ta[0],injectedCSS:wa,injectedJS:Ki}):[x.Fragment],[Dn,os,ps]=Ii?await Gr({ctx:Je,filePath:Ii[1],getComponent:Ii[0],injectedCSS:wa,injectedJS:Ki}):[],[$a,Bn,xn]=ni?await Gr({ctx:Je,filePath:ni[1],getComponent:ni[0],injectedCSS:wa,injectedJS:Ki}):[],Gn=Ur!==void 0,Zn=wr!==void 0,[Li]=await(0,Or.Yz)().trace(fr.Xy.getLayoutOrPageModule,{hideSpan:!(Gn||Zn),spanName:"resolve segment modules",attributes:{"next.segment":Qr}},()=>ue(he)),Qn=Gn&&!Ce,ja=Ce||Qn,[Ha,On]=qi?await Gr({ctx:Je,filePath:qi[1],getComponent:qi[0],injectedCSS:wa,injectedJS:Ki}):[],ma=Li?.dynamic;if(Lt==="export")if(ma&&ma!=="auto"){if(ma==="force-dynamic")throw new bi.G('Page with `dynamic = "force-dynamic"` couldn\'t be exported. `output: "export"` requires all pages be renderable statically because there is not runtime server to dynamic render routes in this output format. Learn more: https://nextjs.org/docs/app/building-your-application/deploying/static-exports')}else ma="error";if(typeof ma=="string")if(ma==="error")ot.dynamicShouldError=!0;else if(ma==="force-dynamic"){if(ot.forceDynamic=!0,ot.isStaticGeneration&&!ot.prerenderState){let Gt=new Ft('Page with `dynamic = "force-dynamic"` won\'t be rendered statically.');throw ot.dynamicUsageDescription=Gt.message,ot.dynamicUsageStack=Gt.stack,Gt}}else ot.dynamicShouldError=!1,ot.forceStatic=ma==="force-static";if(typeof Li?.fetchCache=="string"&&(ot.fetchCache=Li?.fetchCache),Li?.revalidate!==void 0&&function(Gt,ri){try{let Jr;if(Gt!==!1){if(!(typeof Gt=="number"&&!isNaN(Gt)&&Gt>-1)){if(Gt!==void 0)throw Error(`Invalid revalidate value "${Gt}" on "${ri}", must be a non-negative number or "false"`)}}}catch(Jr){if(Jr instanceof Error&&Jr.message.includes("Invalid revalidate"))throw Jr;return}}(Li?.revalidate,ot.urlPathname),typeof Li?.revalidate=="number"&&(Je.defaultRevalidate=Li.revalidate,(ot.revalidate===void 0||typeof ot.revalidate=="number"&&ot.revalidate>Je.defaultRevalidate)&&(ot.revalidate=Je.defaultRevalidate),!ot.forceStatic&&ot.isStaticGeneration&&Je.defaultRevalidate===0&&!ot.prerenderState)){let Gt=`revalidate: 0 configured ${Qr}`;throw ot.dynamicUsageDescription=Gt,new Ft(Gt)}if(ot.dynamicUsageErr)throw ot.dynamicUsageErr;let Tn=Li?await Ze(Li):void 0,hn=Tn;Object.keys(Vi).length>1&&Qn&&Tn&&(hn=Gt=>(0,s.jsx)(Ot,{notFound:Ha?(0,s.jsxs)(s.Fragment,{children:[la,(0,s.jsxs)(Tn,{params:Gt.params,children:[On,(0,s.jsx)(Ha,{})]})]}):void 0,children:(0,s.jsx)(Tn,{...Gt})}));let za=rr(Qr),Rr=za&&za.value!==null?{...xe,[za.param]:za.value}:xe,pr=za?za.treeSegment:Qr,Cr=await Promise.all(Object.keys(Vi).map(async Gt=>{let ri=Gt==="children",Jr=Le?[Gt]:[pr,Gt],zi=Vi[Gt],Ne=Ha&&ri?(0,s.jsx)(Ha,{}):void 0,Sa=null;return zt&&($a||!vi(zi))&&!Rt.ppr||(Sa=await Fr({createSegmentPath:br=>re([...Jr,...br]),loaderTree:zi,parentParams:Rr,rootLayoutIncluded:ja,injectedCSS:wa,injectedJS:Ki,injectedFontPreloadTags:ra,asNotFound:We,metadataOutlet:ri?Ke:void 0,ctx:Je,missingSlots:vt})),[Gt,(0,s.jsx)(yr,{parallelRouterKey:Gt,segmentPath:re(Jr),error:Dn,errorStyles:os,errorScripts:ps,template:(0,s.jsx)(Xn,{children:(0,s.jsx)(Ie,{})}),templateStyles:an,templateScripts:cn,notFound:Ne,notFoundStyles:On}),Sa]})),$r={},ya={};for(let Gt of Cr){let[ri,Jr,zi]=Gt;$r[ri]=Jr,ya[ri]=zi}let Vr=$a?[(0,s.jsx)($a,{}),Bn,xn]:null;if(!hn)return[pr,ya,(0,s.jsxs)(s.Fragment,{children:[la,$r.children]}),Vr];if(ot.forceDynamic&&ot.prerenderState)return[pr,ya,(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(or,{prerenderState:ot.prerenderState,reason:'dynamic = "force-dynamic" was used',pathname:ot.urlPathname}),la]}),Vr];let Wi=function(Gt){let ri=Gt?.default||Gt;return ri?.$$typeof===Symbol.for("react.client.reference")}(Li);return Ha&&We&&!Cr.length&&($r.children=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("meta",{name:"robots",content:"noindex"}),!1,On,(0,s.jsx)(Ha,{})]})),$r.params=Rr,Zn?Wi?($r.searchParams=$e(ir),ft=(0,s.jsxs)(s.Fragment,{children:[Ke,(0,s.jsx)(Bt,{props:$r,Component:hn}),la]})):($r.searchParams=Nt(ir),ft=(0,s.jsxs)(s.Fragment,{children:[Ke,(0,s.jsx)(hn,{...$r}),la]})):ft=(0,s.jsxs)(s.Fragment,{children:[la,(0,s.jsx)(hn,{...$r})]}),[pr,ya,(0,s.jsxs)(s.Fragment,{children:[ft,null]}),Vr]}async function Tr({createSegmentPath:re,loaderTreeToFilter:he,parentParams:xe,isFirst:Le,flightRouterState:Ce,parentRendered:Ve,rscPayloadHead:Ue,injectedCSS:qe,injectedJS:We,injectedFontPreloadTags:Ke,rootLayoutIncluded:Je,asNotFound:vt,metadataOutlet:ft,ctx:Lt}){let{renderOpts:{nextFontManifest:Rt,experimental:ot},query:Ot,isPrefetch:yr,getDynamicParamFromSegment:Ie,componentMod:{tree:Bt}}=Lt,[$e,Nt,Ft]=he,or=Object.keys(Nt),{layout:tr}=Ft,rr=tr!==void 0&&!Je,zt=Je||rr,ir=Ie($e),wr=ir&&ir.value!==null?{...xe,[ir.param]:ir.value}:xe,_r=Xr(ir?ir.treeSegment:$e,Ot),Qr=!Ce||!(0,S.j)(_r,Ce[0])||or.length===0||Ce[3]==="refetch",ga=!ot.ppr&&yr&&!Ft.loading&&!vi(Bt);if(!Ve&&Qr){let ni=Ce&&(0,S.W)(_r,Ce[0])?Ce[0]:_r,qi=Hi(he,Ie,Ot);return ga?[[ni,qi,null,null]]:[[ni,qi,await Wt({ctx:Lt,createSegmentPath:re,loaderTree:he,parentParams:wr,firstItem:Le,injectedCSS:qe,injectedJS:We,injectedFontPreloadTags:Ke,rootLayoutIncluded:Je,asNotFound:vt,metadataOutlet:ft}),Ue]]}let Vi=tr?.[1],Ur=new Set(qe),ta=new Set(We),Ii=new Set(Ke);return Vi&&(qr(Lt.clientReferenceManifest,Vi,Ur,ta,!0),Zr(Rt,Vi,Ii)),(await Promise.all(or.map(async ni=>{let qi=Nt[ni],wa=Le?[ni]:[_r,ni];return(await Tr({ctx:Lt,createSegmentPath:Ki=>re([...wa,...Ki]),loaderTreeToFilter:qi,parentParams:wr,flightRouterState:Ce&&Ce[1][ni],parentRendered:Ve||Qr,isFirst:!1,rscPayloadHead:Ue,injectedCSS:Ur,injectedJS:ta,injectedFontPreloadTags:Ii,rootLayoutIncluded:zt,asNotFound:vt,metadataOutlet:ft})).map(Ki=>Ki[0]===de.av&&Ce&&Ce[1][ni][0]&&Ce[1][ni][3]!=="refetch"?null:[_r,ni,...Ki]).filter(Boolean)}))).flat()}var Ei=u(67881);class wi{constructor(he){this.options=he,this.prerender=null}async render(he){let{prelude:xe,postponed:Le}=await this.prerender(he,this.options);return{stream:xe,postponed:Le}}}class ci{constructor(he,xe){this.postponed=he,this.options=xe,this.resume=u(3973).resume}async render(he){return{stream:await this.resume(he,this.postponed,this.options),resumed:!0}}}class Ci{constructor(he){this.options=he,this.renderToReadableStream=u(3973).renderToReadableStream}async render(he){return{stream:await this.renderToReadableStream(he,this.options)}}}class sr{async render(he){return{stream:new ReadableStream({start(xe){xe.close()}}),resumed:!1}}}function vr({ppr:re,isStaticGeneration:he,postponed:xe,streamOptions:{signal:Le,onError:Ce,onPostpone:Ve,onHeaders:Ue,maxHeadersLength:qe,nonce:We,bootstrapScripts:Ke,formState:Je}}){if(re){if(he)return new wi({signal:Le,onError:Ce,onPostpone:Ve,onHeaders:Ue,maxHeadersLength:qe,bootstrapScripts:Ke});if(xe===1)return new sr;if(xe)return new ci(xe[1],{signal:Le,onError:Ce,onPostpone:Ve,nonce:We})}return new Ci(he?{signal:Le,onError:Ce,nonce:We,bootstrapScripts:Ke,formState:Je}:{signal:Le,onError:Ce,onHeaders:Ue,maxHeadersLength:qe,nonce:We,bootstrapScripts:Ke,formState:Je})}let Hr=new WeakMap,sa=new TextEncoder;async function pa(re){let he=re.getReader();for(;;){let{done:xe}=await he.read();if(xe)return}}function Da(re,he,xe){let Le=he?`<script nonce=${JSON.stringify(he)}>`:"<script>",Ce=new TextDecoder("utf-8",{fatal:!0}),Ve={stream:!0},Ue=re.getReader();return new ReadableStream({type:"bytes",start(qe){try{(function(We,Ke,Je){We.enqueue(sa.encode(`${Ke}(self.__next_f=self.__next_f||[]).push(${Bi(JSON.stringify([0]))});self.__next_f.push(${Bi(JSON.stringify([2,Je]))})<\/script>`))})(qe,Le,xe)}catch(We){qe.error(We)}},async pull(qe){try{let{done:We,value:Ke}=await Ue.read();if(We){let Je=Ce.decode(Ke,{stream:!1});Je.length&&jr(qe,Le,Je),qe.close()}else{let Je=Ce.decode(Ke,Ve);jr(qe,Le,Je)}}catch(We){qe.error(We)}}})}function jr(re,he,xe){re.enqueue(sa.encode(`${he}self.__next_f.push(${Bi(JSON.stringify([1,xe]))})<\/script>`))}var Pn=u(78342),Ga=u(79320),rn=u(76891);function Ua({ctx:re}){let he=re.pagePath==="/404",xe=typeof re.res.statusCode=="number"&&re.res.statusCode>400;return he||xe?(0,s.jsx)("meta",{name:"robots",content:"noindex"}):null}async function bn(re,he){let xe=null,{componentMod:{tree:Le,renderToReadableStream:Ce,createDynamicallyTrackedSearchParams:Ve},getDynamicParamFromSegment:Ue,appUsingSizeAdjustment:qe,staticGenerationStore:{urlPathname:We},query:Ke,requestId:Je,flightRouterState:vt}=re;if(!he?.skipFlight){let[Ot,yr]=Dr({tree:Le,query:Ke,metadataContext:Er(We,re.renderOpts),getDynamicParamFromSegment:Ue,appUsingSizeAdjustment:qe,createDynamicallyTrackedSearchParams:Ve});xe=(await Tr({ctx:re,createSegmentPath:Ie=>Ie,loaderTreeToFilter:Le,parentParams:{},flightRouterState:vt,isFirst:!0,rscPayloadHead:[(0,s.jsx)(Ot,{},Je),(0,s.jsx)(Ua,{ctx:re},"noindex")],injectedCSS:new Set,injectedJS:new Set,injectedFontPreloadTags:new Set,rootLayoutIncluded:!1,asNotFound:re.isNotFoundPath||he?.asNotFound,metadataOutlet:(0,s.jsx)(yr,{})})).map(Ie=>Ie.slice(1))}let ft=[re.renderOpts.buildId,xe],Lt=Ce(he?[he.actionResult,ft]:ft,re.clientReferenceManifest.clientModules,{onError:re.flightDataRendererErrorHandler}),Rt={metadata:{}};if(re.staticGenerationStore.pendingRevalidates||re.staticGenerationStore.revalidatedTags){var ot;let Ot=Promise.all([(ot=re.staticGenerationStore.incrementalCache)==null?void 0:ot.revalidateTag(re.staticGenerationStore.revalidatedTags||[]),...Object.values(re.staticGenerationStore.pendingRevalidates||{})]).finally(()=>{process.env.NEXT_PRIVATE_DEBUG_CACHE&&console.log("pending revalidates promise finished for:",We)});re.builtInWaitUntil?re.builtInWaitUntil(Ot):Rt.waitUntil=Ot}return new Xt(Lt,Rt)}function Mr(re){return re.split("/")}async function Ui({tree:re,ctx:he,asNotFound:xe}){let Le=new Set,Ce=new Set,Ve=new Set,Ue=new Set,{getDynamicParamFromSegment:qe,query:We,appUsingSizeAdjustment:Ke,componentMod:{AppRouter:Je,GlobalError:vt,createDynamicallyTrackedSearchParams:ft},staticGenerationStore:{urlPathname:Lt}}=he,Rt=Hi(re,qe,We),[ot,Ot]=Dr({tree:re,errorType:xe?"not-found":void 0,query:We,metadataContext:Er(Lt,he.renderOpts),getDynamicParamFromSegment:qe,appUsingSizeAdjustment:Ke,createDynamicallyTrackedSearchParams:ft}),yr=await Wt({ctx:he,createSegmentPath:$e=>$e,loaderTree:re,parentParams:{},firstItem:!0,injectedCSS:Le,injectedJS:Ce,injectedFontPreloadTags:Ve,rootLayoutIncluded:!1,asNotFound:xe,metadataOutlet:(0,s.jsx)(Ot,{}),missingSlots:Ue}),Ie=he.res.getHeader("vary"),Bt=typeof Ie=="string"&&Ie.includes(o.TP);return(0,s.jsx)(Je,{buildId:he.renderOpts.buildId,assetPrefix:he.assetPrefix,urlParts:Mr(Lt),initialTree:Rt,initialSeedData:yr,couldBeIntercepted:Bt,initialHead:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Ua,{ctx:he}),(0,s.jsx)(ot,{},he.requestId)]}),globalErrorComponent:vt,missingSlots:Ue})}async function Si({tree:re,ctx:he,errorType:xe}){let{getDynamicParamFromSegment:Le,query:Ce,appUsingSizeAdjustment:Ve,componentMod:{AppRouter:Ue,GlobalError:qe,createDynamicallyTrackedSearchParams:We},staticGenerationStore:{urlPathname:Ke},requestId:Je}=he,[vt]=Dr({tree:re,metadataContext:Er(Ke,he.renderOpts),errorType:xe,query:Ce,getDynamicParamFromSegment:Le,appUsingSizeAdjustment:Ve,createDynamicallyTrackedSearchParams:We}),ft=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(vt,{},Je),!1,(0,s.jsx)(Ua,{ctx:he})]}),Lt=Hi(re,Le,Ce),Rt=[Lt[0],{},(0,s.jsxs)("html",{id:"__next_error__",children:[(0,s.jsx)("head",{}),(0,s.jsx)("body",{})]}),null];return(0,s.jsx)(Ue,{buildId:he.renderOpts.buildId,assetPrefix:he.assetPrefix,urlParts:Mr(Ke),initialTree:Lt,initialHead:ft,globalErrorComponent:qe,initialSeedData:Rt,missingSlots:new Set})}function oa({reactServerStream:re,preinitScripts:he,clientReferenceManifest:xe,nonce:Le}){he();let Ce=function(Ve,Ue,qe){let We=Hr.get(Ve);if(We)return We;let Ke=(0,u(52719).createFromReadableStream)(Ve,{ssrManifest:{moduleLoading:Ue.moduleLoading,moduleMap:Ue.edgeSSRModuleMapping},nonce:qe});return Hr.set(Ve,Ke),Ke}(re,xe,Le);return x.use(Ce)}async function _a(re,he,xe,Le,Ce,Ve,Ue){var qe,We,Ke,Je;let vt,ft,Lt=xe==="/404",Rt=Date.now(),{buildManifest:ot,subresourceIntegrityManifest:Ot,serverActionsManifest:yr,ComponentMod:Ie,dev:Bt,nextFontManifest:$e,supportsDynamicResponse:Nt,serverActions:Ft,appDirDevErrorLogger:or,assetPrefix:tr="",enableTainting:rr}=Ce;if(Ie.__next_app__){let Rr=(0,Ga.B)(Ie);aa.__next_require__=Rr.require,aa.__next_chunk_load__=Rr.loadChunk}typeof re.on=="function"&&re.on("end",()=>{if(Ue.ended=!0,"performance"in aa){let Rr=(0,Ga.R)({reset:!0});Rr&&(0,Or.Yz)().startSpan(fr.Xy.clientComponentLoading,{startTime:Rr.clientComponentLoadStart,attributes:{"next.clientComponentLoadCount":Rr.clientComponentLoadCount}}).end(Rr.clientComponentLoadStart+Rr.clientComponentLoadTimes)}});let zt={},ir=!!$e?.appUsingSizeAdjust,wr=Ce.clientReferenceManifest,_r=(0,In.w)({serverActionsManifest:yr,pageName:Ce.page});(0,Ei.Mo)({clientReferenceManifest:wr,serverActionsManifest:yr,serverModuleMap:_r});let Qr=new Map,ga=[],Vi=!!Ce.nextExport,{staticGenerationStore:Ur,requestStore:ta}=Ve,{isStaticGeneration:Ii}=Ur,ni=Ce.experimental.ppr&&Ii,qi=gi({source:di.serverComponents,dev:Bt,isNextExport:Vi,errorLogger:or,digestErrorsMap:Qr,silenceLogger:ni}),wa=gi({source:di.flightData,dev:Bt,isNextExport:Vi,errorLogger:or,digestErrorsMap:Qr,silenceLogger:ni}),Ki=gi({source:di.html,dev:Bt,isNextExport:Vi,errorLogger:or,digestErrorsMap:Qr,allCapturedErrors:ga,silenceLogger:ni});Ie.patchFetch();let ra=Nt!==!0,{tree:la,taintObjectReference:Xn}=Ie;rr&&Xn("Do not pass process.env to client components since it will leak sensitive data",process.env),Ur.fetchMetrics=[],zt.fetchMetrics=Ur.fetchMetrics,Le={...Le},(0,d.Q)(Le);let an=re.headers[o.A.toLowerCase()]!==void 0,cn=an&&re.headers[o.qw.toLowerCase()]!==void 0,Dn=an&&(!cn||!Ce.experimental.ppr||(0,Pn.Ag)(xe)),os=function(Rr){if(Rr!==void 0){if(Array.isArray(Rr))throw Error("Multiple router state headers were sent. This is not allowed.");if(Rr.length>4e4)throw Error("The router state header was too large.");try{let pr=JSON.parse(decodeURIComponent(Rr));return(0,mi.assert)(pr,yi),pr}catch{throw Error("The router state header was sent but could not be parsed.")}}}(re.headers[o.ph.toLowerCase()]);vt=crypto.randomUUID();let ps=(Je=Ce.params??{},function(Rr){let pr=(0,Ri.R)(Rr);if(!pr)return null;let Cr=pr.param,$r=Je[Cr];if($r==="__NEXT_EMPTY_PARAM__"&&($r=void 0),Array.isArray($r)?$r=$r.map(Vr=>encodeURIComponent(Vr)):typeof $r=="string"&&($r=encodeURIComponent($r)),!$r){let Vr=pr.type==="catchall",Wi=pr.type==="optional-catchall";if(Vr||Wi){let Gt=hi[pr.type];return Wi?{param:Cr,value:null,type:Gt,treeSegment:[Cr,"",Gt]}:{param:Cr,value:$r=xe.split("/").slice(1).map(ri=>{let Jr=(0,rn.b8)(ri);return Je[Jr.key]??Jr.key}),type:Gt,treeSegment:[Cr,$r.join("/"),Gt]}}return function Gt(ri,Jr){if(!ri)return null;let zi=ri[0];if((0,S.W)(Jr,zi))return!Array.isArray(zi)||Array.isArray(Jr)?null:{param:zi[0],value:zi[1],treeSegment:zi,type:zi[2]};for(let Ne of Object.values(ri[1])){let Sa=Gt(Ne,Jr);if(Sa)return Sa}return null}(os,Rr)}let ya=function(Vr){let Wi=hi[Vr];if(!Wi)throw Error("Unknown dynamic param type");return Wi}(pr.type);return{param:Cr,value:$r,treeSegment:[Cr,Array.isArray($r)?$r.join("/"):$r,ya],type:ya}}),$a={...Ve,builtInWaitUntil:Ce.builtInWaitUntil,getDynamicParamFromSegment:ps,query:Le,isPrefetch:cn,requestTimestamp:Rt,appUsingSizeAdjustment:ir,flightRouterState:Dn?os:void 0,requestId:vt,defaultRevalidate:!1,pagePath:xe,clientReferenceManifest:wr,assetPrefix:tr,flightDataRendererErrorHandler:wa,serverComponentsErrorHandler:qi,isNotFoundPath:Lt,res:he};if(an&&!Ii)return bn($a);let Bn=Ii?function(Rr){let pr=bn(Rr).then(async Cr=>({flightData:await Cr.toUnchunkedString(!0)})).catch(Cr=>({err:Cr}));return async()=>{let Cr=await pr;if("err"in Cr)throw Cr.err;return Cr.flightData}}($a):null,xn=re.headers["content-security-policy"]||re.headers["content-security-policy-report-only"];xn&&typeof xn=="string"&&(ft=function(Rr){var pr;let Cr=Rr.split(";").map(Vr=>Vr.trim()),$r=Cr.find(Vr=>Vr.startsWith("script-src"))||Cr.find(Vr=>Vr.startsWith("default-src"));if(!$r)return;let ya=(pr=$r.split(" ").slice(1).map(Vr=>Vr.trim()).find(Vr=>Vr.startsWith("'nonce-")&&Vr.length>8&&Vr.endsWith("'")))==null?void 0:pr.slice(7,-1);if(ya){if(Ai.test(ya))throw Error(`Nonce value from Content-Security-Policy contained HTML escape characters.
Learn more: https://nextjs.org/docs/messages/nonce-contained-invalid-characters`);return ya}}(xn));let{HeadManagerContext:Gn}=u(8429),{ServerInsertedHTMLProvider:Zn,renderServerInsertedHTML:Li}=function(){let Rr=[],pr=Cr=>{Rr.push(Cr)};return{ServerInsertedHTMLProvider:({children:Cr})=>(0,s.jsx)(pe.ServerInsertedHTMLContext.Provider,{value:pr,children:Cr}),renderServerInsertedHTML:()=>Rr.map((Cr,$r)=>(0,s.jsx)(x.Fragment,{children:Cr()},"__next_server_inserted__"+$r))}}();(qe=(0,Or.Yz)().getRootSpanAttributes())==null||qe.set("next.route",xe);let Qn=(0,Or.Yz)().wrap(fr.k0.getBodyResult,{spanName:`render route (app) ${xe}`,attributes:{"next.route":xe}},async({asNotFound:Rr,tree:pr,formState:Cr})=>{let $r=ot.polyfillFiles.filter(br=>br.endsWith(".js")&&!br.endsWith(".module.js")).map(br=>({src:`${tr}/_next/${br}${Kt($a,!1)}`,integrity:Ot?.[br],crossOrigin:Ce.crossOrigin,noModule:!0,nonce:ft})),[ya,Vr]=it(ot,tr,Ce.crossOrigin,Ot,Kt($a,!0),ft),[Wi,Gt]=Ie.renderToReadableStream((0,s.jsx)(Ui,{tree:pr,ctx:$a,asNotFound:Rr}),wr.clientModules,{onError:qi}).tee(),ri=(0,s.jsx)(Gn.Provider,{value:{appDir:!0,nonce:ft},children:(0,s.jsx)(Zn,{children:(0,s.jsx)(oa,{reactServerStream:Wi,preinitScripts:ya,clientReferenceManifest:wr,nonce:ft})})}),Jr=!!Ce.postponed,zi=Ur.prerenderState?br=>{br.forEach((Pi,ka)=>{zt.headers??={},zt.headers[ka]=Pi})}:Ii||Jr?void 0:br=>{br.forEach((Pi,ka)=>{he.appendHeader(ka,Pi)})},Ne=er({polyfills:$r,renderServerInsertedHTML:Li,serverCapturedErrors:ga,basePath:Ce.basePath}),Sa=vr({ppr:Ce.experimental.ppr,isStaticGeneration:Ii,postponed:typeof Ce.postponed=="string"?JSON.parse(Ce.postponed):null,streamOptions:{onError:Ki,onHeaders:zi,maxHeadersLength:600,nonce:ft,bootstrapScripts:[Vr],formState:Cr}});try{let{stream:br,postponed:Pi,resumed:ka}=await Sa.render(ri),nn=Ur.prerenderState;if(nn){if((0,Br.tK)(nn))return Pi!=null?zt.postponed=JSON.stringify([2,Pi]):zt.postponed=JSON.stringify(1),{stream:await(0,E._W)(br,{getServerInsertedHTML:Ne})};{let[da,ia]=Gt.tee();if(Gt=da,await pa(ia),(0,Br.tK)(nn))return Pi!=null?zt.postponed=JSON.stringify([2,Pi]):zt.postponed=JSON.stringify(1),{stream:await(0,E._W)(br,{getServerInsertedHTML:Ne})};{let Ya=br;if(Ur.forceDynamic)throw new bi.G('Invariant: a Page with `dynamic = "force-dynamic"` did not trigger the dynamic pathway. This is a bug in Next.js');if(Pi!=null){let Jn=vr({ppr:!0,isStaticGeneration:!1,postponed:[2,Pi],streamOptions:{signal:(0,Br.Su)("static prerender resume"),onError:Ki,nonce:ft}}),Xa=new ReadableStream,fn=(0,s.jsx)(Gn.Provider,{value:{appDir:!0,nonce:ft},children:(0,s.jsx)(Zn,{children:(0,s.jsx)(oa,{reactServerStream:Xa,preinitScripts:()=>{},clientReferenceManifest:wr,nonce:ft})})}),{stream:ls}=await Jn.render(fn);Ya=(0,E.QW)(br,ls)}return{stream:await(0,E.Jm)(Ya,{inlinedDataStream:Da(Gt,ft,Cr),getServerInsertedHTML:Ne})}}}}if(!Ce.postponed)return{stream:await(0,E.eN)(br,{inlinedDataStream:Da(Gt,ft,Cr),isStaticGeneration:Ii||ra,getServerInsertedHTML:Ne,serverInsertedHTMLToHead:!0,validateRootLayout:Bt})};{let da=Da(Gt,ft,Cr);return ka?{stream:await(0,E.Bb)(br,{inlinedDataStream:da,getServerInsertedHTML:Ne})}:{stream:await(0,E.J$)(br,{inlinedDataStream:da})}}}catch(br){if((0,bi.q)(br)||typeof br=="object"&&br!==null&&"message"in br&&typeof br.message=="string"&&br.message.includes("https://nextjs.org/docs/advanced-features/static-html-export")||Ii&&(0,Fi.j)(br))throw br;let Pi=(0,ji.D)(br);if(Pi){let Xa=function(fn){let ls=fn.stack;return ls?ls.replace(/^[^\n]*\n/,""):""}(br);if(Ce.experimental.missingSuspenseWithCSRBailout)throw(0,fe.vU)(`${br.reason} should be wrapped in a suspense boundary at page "${xe}". Read more: https://nextjs.org/docs/messages/missing-suspense-with-csr-bailout
${Xa}`),br;(0,fe.ZK)(`Entire page "${xe}" deopted into client-side rendering due to "${br.reason}". Read more: https://nextjs.org/docs/messages/deopted-into-client-rendering
${Xa}`)}(0,mr.X)(br)&&(he.statusCode=404);let ka=!1;if((0,Wr.eo)(br)){if(ka=!0,he.statusCode=(0,Wr.j2)(br),br.mutableCookies){let fn=new Headers;(0,un._5)(fn,br.mutableCookies)&&he.setHeader("set-cookie",Array.from(fn.values()))}let Xa=(0,yt.V)((0,Wr.M6)(br),Ce.basePath);he.setHeader("Location",Xa)}let nn=$a.res.statusCode===404;nn||ka||Pi||(he.statusCode=500);let da=nn?"not-found":ka?"redirect":void 0,[ia,Ya]=it(ot,tr,Ce.crossOrigin,Ot,Kt($a,!1),ft),Jn=Ie.renderToReadableStream((0,s.jsx)(Si,{tree:pr,ctx:$a,errorType:da}),wr.clientModules,{onError:qi});try{let Xa=await(0,E.MY)({ReactDOMServer:u(3973),element:(0,s.jsx)(oa,{reactServerStream:Jn,preinitScripts:ia,clientReferenceManifest:wr,nonce:ft}),streamOptions:{nonce:ft,bootstrapScripts:[Ya],formState:Cr}});return{err:br,stream:await(0,E.eN)(Xa,{inlinedDataStream:Da(Gt,ft,Cr),isStaticGeneration:Ii,getServerInsertedHTML:er({polyfills:$r,renderServerInsertedHTML:Li,serverCapturedErrors:[],basePath:Ce.basePath}),serverInsertedHTMLToHead:!0,validateRootLayout:Bt})}}catch(Xa){throw Xa}}}),ja=await B({req:re,res:he,ComponentMod:Ie,serverModuleMap:_r,generateFlight:bn,staticGenerationStore:Ur,requestStore:ta,serverActions:Ft,ctx:$a}),Ha=null;if(ja){if(ja.type==="not-found"){let Rr=["",{},la[2]],pr=await Qn({asNotFound:!0,tree:Rr,formState:Ha});return new k.Z(pr.stream,{metadata:zt})}if(ja.type==="done"){if(ja.result)return ja.result.assignMetadata(zt),ja.result;ja.formState&&(Ha=ja.formState)}}let On={metadata:zt},ma=await Qn({asNotFound:Lt,tree:la,formState:Ha});if(Ur.pendingRevalidates||Ur.revalidatedTags){let Rr=Promise.all([(Ke=Ur.incrementalCache)==null?void 0:Ke.revalidateTag(Ur.revalidatedTags||[]),...Object.values(Ur.pendingRevalidates||{})]).finally(()=>{process.env.NEXT_PRIVATE_DEBUG_CACHE&&console.log("pending revalidates promise finished for:",re.url)});Ce.builtInWaitUntil?Ce.builtInWaitUntil(Rr):On.waitUntil=Rr}(function(Rr){var pr,Cr;let $r=[],{pagePath:ya,urlPathname:Vr}=Rr;if(Array.isArray(Rr.tags)||(Rr.tags=[]),ya)for(let Wi of Ba(ya))Wi=`${pi.zt}${Wi}`,(pr=Rr.tags)!=null&&pr.includes(Wi)||Rr.tags.push(Wi),$r.push(Wi);if(Vr){let Wi=new URL(Vr,"http://n").pathname,Gt=`${pi.zt}${Wi}`;(Cr=Rr.tags)!=null&&Cr.includes(Gt)||Rr.tags.push(Gt),$r.push(Gt)}})(Ur),Ur.tags&&(zt.fetchTags=Ur.tags.join(","));let Tn=new k.Z(ma.stream,On);if(!Ii)return Tn;ma.stream=await Tn.toUnchunkedString(!0);let hn=Qr.size>0?Qr.values().next().value:null;if(Ur.prerenderState&&(0,Br.tK)(Ur.prerenderState)&&((We=Ur.prerenderState)==null?void 0:We.isDebugSkeleton))for(let Rr of((0,fe.ZK)("The following dynamic usage was detected:"),(0,Br.gS)(Ur.prerenderState)))(0,fe.ZK)(Rr);if(!Bn)throw Error("Invariant: Flight data resolver is missing when generating static HTML");if(hn)throw hn;let za=await Bn();return za&&(zt.flightData=za),Ur.forceStatic===!1&&(Ur.revalidate=0),zt.revalidate=Ur.revalidate??$a.defaultRevalidate,zt.revalidate===0&&(zt.staticBailoutInfo={description:Ur.dynamicUsageDescription,stack:Ur.dynamicUsageStack}),new k.Z(ma.stream,On)}let Sn=(re,he,xe,Le,Ce)=>{let Ve=function(Ue){if(!Ue)throw Error(Fa);try{if(new URL(Ue,Na).origin!==Na)throw Error(Fa);return Ue}catch{throw Error(Fa)}}(re.url);return Ar.B.wrap(Ce.ComponentMod.requestAsyncStorage,{req:re,res:he,renderOpts:Ce},Ue=>ba.wrap(Ce.ComponentMod.staticGenerationAsyncStorage,{urlPathname:Ve,renderOpts:Ce,requestEndedState:{ended:!1}},qe=>_a(re,he,xe,Le,Ce,{requestStore:Ue,staticGenerationStore:qe,componentMod:Ce.ComponentMod,renderOpts:Ce},qe.requestEndedState||{})))}},we.__chunk_43096=(ce,O,u)=>{"use strict";u.d(O,{k:()=>S,w:()=>E});var s=u(46737),x=u(39338),k=u(53584);function E({serverActionsManifest:o,pageName:g}){return new Proxy({},{get:(c,f)=>({id:o.edge[f].workers[d(g)],name:f,chunks:[]})})}function S(o,g,c){var f,m;let C=(f=c.edge[o])==null?void 0:f.workers,I=d(g);if(C)return C[I]?void 0:(m=Object.keys(C)[0],(0,s.w)((0,k.n)(m,"app")))}function d(o){return(0,x.Y)(o,"app")?o:"app"+o}},we.__chunk_80842=(ce,O,u)=>{"use strict";u.d(O,{Iq:()=>k,dS:()=>E});var s=u(37842),x=u(78045);function k(S,d){let o=s.h.from(S.headers);return{isOnDemandRevalidate:o.get(x.y3)===d.previewModeId,revalidateOnlyGenerated:o.has(x.Qq)}}u(2147),u(61583);let E="__prerender_bypass";Symbol("__next_preview_data"),Symbol(E)},we.__chunk_68009=(ce,O,u)=>{"use strict";function s(k){return new URL(k,"http://n").pathname}function x(k){return/https?:\/\//.test(k)}u.d(O,{N0:()=>x,RO:()=>s})},we.__chunk_45158=(ce,O,u)=>{"use strict";var s;u.d(O,{Ce:()=>m,Q6:()=>g,Se:()=>o,ek:()=>c,er:()=>f,ix:()=>C});let{env:x,stdout:k}=((s=aa)==null?void 0:s.process)??{},E=x&&!x.NO_COLOR&&(x.FORCE_COLOR||k?.isTTY&&!x.CI&&x.TERM!=="dumb"),S=(I,_,R,F)=>{let L=I.substring(0,F)+R,U=I.substring(F+_.length),te=U.indexOf(_);return~te?L+S(U,_,R,te):L+U},d=(I,_,R=I)=>E?F=>{let L=""+F,U=L.indexOf(_,I.length);return~U?I+S(L,_,R,U)+_:I+L+_}:String,o=d("\x1B[1m","\x1B[22m","\x1B[22m\x1B[1m");d("\x1B[2m","\x1B[22m","\x1B[22m\x1B[2m"),d("\x1B[3m","\x1B[23m"),d("\x1B[4m","\x1B[24m"),d("\x1B[7m","\x1B[27m"),d("\x1B[8m","\x1B[28m"),d("\x1B[9m","\x1B[29m"),d("\x1B[30m","\x1B[39m");let g=d("\x1B[31m","\x1B[39m"),c=d("\x1B[32m","\x1B[39m"),f=d("\x1B[33m","\x1B[39m");d("\x1B[34m","\x1B[39m");let m=d("\x1B[35m","\x1B[39m");d("\x1B[38;2;173;127;168m","\x1B[39m"),d("\x1B[36m","\x1B[39m");let C=d("\x1B[37m","\x1B[39m");d("\x1B[90m","\x1B[39m"),d("\x1B[40m","\x1B[49m"),d("\x1B[41m","\x1B[49m"),d("\x1B[42m","\x1B[49m"),d("\x1B[43m","\x1B[49m"),d("\x1B[44m","\x1B[49m"),d("\x1B[45m","\x1B[49m"),d("\x1B[46m","\x1B[49m"),d("\x1B[47m","\x1B[49m")},we.__chunk_37927=(ce,O,u)=>{"use strict";var s;u.d(O,{s:()=>s}),function(x){x.PAGES="pages",x.ROOT="root",x.APP="app"}(s||(s={}))},we.__chunk_92398=(ce,O,u)=>{"use strict";u.d(O,{Y:()=>s});class s{constructor(){let k,E;this.promise=new Promise((S,d)=>{k=S,E=d}),this.resolve=k,this.reject=E}}},we.__chunk_78045=(ce,O,u)=>{"use strict";u.d(O,{Ar:()=>m,BR:()=>R,EX:()=>c,Et:()=>f,JT:()=>g,Jp:()=>F,Qq:()=>E,Sx:()=>S,Vz:()=>o,X_:()=>I,dN:()=>s,hd:()=>d,of:()=>C,u7:()=>x,y3:()=>k,zt:()=>_});let s="nxtP",x="nxtI",k="x-prerender-revalidate",E="x-prerender-revalidate-if-generated",S=".prefetch.rsc",d=".rsc",o=".action",g=".json",c=".meta",f="x-next-cache-tags",m="x-next-cache-soft-tags",C="x-next-revalidated-tags",I="x-next-revalidate-tag-token",_="_N_T_",R=31536e3,F={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},L={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"};({...L,GROUP:(L.reactServerComponents,L.actionBrowser,L.appMetadataRoute,L.appRouteHandler,L.instrument,L.serverSideRendering,L.appPagesBrowser,L.middleware,L.api,L.reactServerComponents,L.actionBrowser,L.appMetadataRoute,L.appRouteHandler,L.serverSideRendering,L.appPagesBrowser,L.shared,L.instrument)})},we.__chunk_4455=(ce,O,u)=>{"use strict";u.d(O,{R:()=>k});var s=u(19762),x=u(69285);let k=E=>{if(!E.startsWith("/"))return E;let{pathname:S,query:d,hash:o}=(0,x.c)(E);return""+(0,s.Q)(S)+d+o}},we.__chunk_84074=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{default:()=>Y});var s=u(20519),x=u(24528),k=u(28160);let E=/https?|ftp|gopher|file/;function S(q){let{auth:se,hostname:J}=q,j=q.protocol||"",M=q.pathname||"",b=q.hash||"",N=q.query||"",$=!1;se=se?encodeURIComponent(se).replace(/%3A/i,":")+"@":"",q.host?$=se+q.host:J&&($=se+(~J.indexOf(":")?"["+J+"]":J),q.port&&($+=":"+q.port)),N&&typeof N=="object"&&(N=String(k.Nn(N)));let X=q.search||N&&"?"+N||"";return j&&!j.endsWith(":")&&(j+=":"),q.slashes||(!j||E.test(j))&&$!==!1?($="//"+($||""),M&&M[0]!=="/"&&(M="/"+M)):$||($=""),b&&b[0]!=="#"&&(b="#"+b),X&&X[0]!=="?"&&(X="?"+X),""+j+$+(M=M.replace(/[?#]/g,encodeURIComponent))+(X=X.replace("#","%23"))+b}var d=u(67577),o=u(4455),g=u(28138);function c(q){if(!(0,d.sD)(q))return!0;try{let se=(0,d.Dp)(),J=new URL(q,se);return J.origin===se&&(0,g.e)(J.pathname)}catch{return!1}}var f=u(26845),m=u(15076),C=u(76891);function I(q,se,J){let j,M=typeof se=="string"?se:S(se),b=M.match(/^[a-zA-Z]{1,}:\/\//),N=b?M.slice(b[0].length):M;if((N.split("?",1)[0]||"").match(/(\/\/|\\)/)){console.error("Invalid href '"+M+"' passed to next/router in page: '"+q.pathname+"'. Repeated forward-slashes (//) or backslashes \\ are not valid in the href.");let X=(0,d.U3)(N);M=(b?b[0]:"")+X}if(!c(M))return J?[M]:M;try{j=new URL(M.startsWith("#")?q.asPath:q.pathname,"http://n")}catch{j=new URL("/","http://n")}try{let X=new URL(M,j);X.pathname=(0,o.R)(X.pathname);let ae="";if((0,f.$)(X.pathname)&&X.searchParams&&J){let ve=(0,k.u5)(X.searchParams),{result:ke,params:fe}=function(Ae,_e,Z){let ne="",W=(0,C.vG)(Ae),Q=W.groups,de=(_e!==Ae?(0,m.t)(W)(_e):"")||Z;ne=Ae;let ue=Object.keys(Q);return ue.every(ye=>{let Ge=de[ye]||"",{repeat:Oe,optional:Qe}=Q[ye],be="["+(Oe?"...":"")+ye+"]";return Qe&&(be=(Ge?"":"/")+"["+be+"]"),Oe&&!Array.isArray(Ge)&&(Ge=[Ge]),(Qe||ye in de)&&(ne=ne.replace(be,Oe?Ge.map(De=>encodeURIComponent(De)).join("/"):encodeURIComponent(Ge))||"/")})||(ne=""),{params:ue,result:ne}}(X.pathname,X.pathname,ve);if(ke){var $;$={pathname:ke,hash:X.hash,query:function(Ae,_e){let Z={};return Object.keys(Ae).forEach(ne=>{_e.includes(ne)||(Z[ne]=Ae[ne])}),Z}(ve,fe)},ae=S($)}}let K=X.origin===j.origin?X.href.slice(X.origin.length):X.href;return J?[K,ae||K]:K}catch{return J?[M]:M}}let _=function(q){for(var se=arguments.length,J=Array(se>1?se-1:0),j=1;j<se;j++)J[j-1]=arguments[j];return q};var R=u(99189),F=u(24351);typeof ut<"u"&&ut.requestIdleCallback&&ut.requestIdleCallback.bind(window),typeof ut<"u"&&ut.cancelIdleCallback&&ut.cancelIdleCallback.bind(window);var L=u(59815),U=u(24272);function te(q){return typeof q=="string"?q:S(q)}let Y=x.forwardRef(function(q,se){let J,j,{href:M,as:b,children:N,prefetch:$=null,passHref:X,replace:ae,shallow:K,scroll:ve,locale:ke,onClick:fe,onMouseEnter:Ae,onTouchStart:_e,legacyBehavior:Z=!1,...ne}=q;J=N,Z&&(typeof J=="string"||typeof J=="number")&&(J=(0,s.jsx)("a",{children:J}));let W=x.useContext(R.RouterContext),Q=x.useContext(F.AppRouterContext),de=W??Q,ue=!W,ye=$!==!1,Ge=$===null?U.Ke.AUTO:U.Ke.FULL,{href:Oe,as:Qe}=x.useMemo(()=>{if(!W){let kr=te(M);return{href:kr,as:b?te(b):kr}}let[mt,cr]=I(W,M,!0);return{href:mt,as:b?I(W,b):cr||mt}},[W,M,b]),be=x.useRef(Oe),De=x.useRef(Qe);Z&&(j=x.Children.only(J));let Xe=Z?j&&typeof j=="object"&&j.ref:se,[tt,Ct,ct]=function(mt){let{rootRef:cr,rootMargin:kr,disabled:Ht}=mt,[Or,fr]=(0,x.useState)(!1),Oi=(0,x.useRef)(null);return[(0,x.useCallback)(li=>{Oi.current=li},[]),Or,(0,x.useCallback)(()=>{fr(!1)},[])]}({rootMargin:"200px"}),Tt=x.useCallback(mt=>{(De.current!==Qe||be.current!==Oe)&&(ct(),De.current=Qe,be.current=Oe),tt(mt),Xe&&(typeof Xe=="function"?Xe(mt):typeof Xe=="object"&&(Xe.current=mt))},[Qe,Xe,Oe,ct,tt]);x.useEffect(()=>{},[Qe,Oe,Ct,ke,ye,W?.locale,de,ue,Ge]);let Dt={ref:Tt,onClick(mt){Z||typeof fe!="function"||fe(mt),Z&&j.props&&typeof j.props.onClick=="function"&&j.props.onClick(mt),de&&!mt.defaultPrevented&&function(cr,kr,Ht,Or,fr,Oi,li,At,Pr){let{nodeName:hr}=cr.currentTarget;if(hr.toUpperCase()==="A"&&(function(Jt){let Ir=Jt.currentTarget.getAttribute("target");return Ir&&Ir!=="_self"||Jt.metaKey||Jt.ctrlKey||Jt.shiftKey||Jt.altKey||Jt.nativeEvent&&Jt.nativeEvent.which===2}(cr)||!Pr&&!c(Ht)))return;cr.preventDefault();let gr=()=>{let Jt=li==null||li;"beforePopState"in kr?kr[fr?"replace":"push"](Ht,Or,{shallow:Oi,locale:At,scroll:Jt}):kr[fr?"replace":"push"](Or||Ht,{scroll:Jt})};Pr?x.startTransition(gr):gr()}(mt,de,Oe,Qe,ae,K,ve,ke,ue)},onMouseEnter(mt){Z||typeof Ae!="function"||Ae(mt),Z&&j.props&&typeof j.props.onMouseEnter=="function"&&j.props.onMouseEnter(mt)},onTouchStart:function(mt){Z||typeof _e!="function"||_e(mt),Z&&j.props&&typeof j.props.onTouchStart=="function"&&j.props.onTouchStart(mt)}};if((0,d.sD)(Qe))Dt.href=Qe;else if(!Z||X||j.type==="a"&&!("href"in j.props)){let mt=ke!==void 0?ke:W?.locale,cr=W?.isLocaleDomain&&(W?.locales,W?.domainLocales,!1);Dt.href=cr||(0,L.n)(_(Qe,mt,W?.defaultLocale))}return Z?x.cloneElement(j,Dt):(0,s.jsx)("a",{...ne,...Dt,children:J})})},we.__chunk_28138=(ce,O,u)=>{"use strict";u.d(O,{e:()=>x});var s=u(39338);function x(k){return(0,s.Y)(k,"")}},we.__chunk_72315=(ce,O,u)=>{"use strict";u.d(O,{c:()=>s});let s={then:()=>{}}},we.__chunk_76513=(ce,O,u)=>{"use strict";u.d(O,{G:()=>x,q:()=>k});let s="NEXT_STATIC_GEN_BAILOUT";class x extends Error{constructor(...S){super(...S),this.code=s}}function k(E){return typeof E=="object"&&E!==null&&"code"in E&&E.code===s}},we.__chunk_24272=(ce,O,u)=>{"use strict";var s,x;u.d(O,{HD:()=>k,J8:()=>g,Ke:()=>s,Pm:()=>d,T7:()=>x,WA:()=>o,bO:()=>E,n0:()=>S});let k="refresh",E="navigate",S="server-patch",d="prefetch",o="server-action";function g(c){return c&&(typeof c=="object"||typeof c=="function")&&typeof c.then=="function"}(function(c){c.AUTO="auto",c.FULL="full",c.TEMPORARY="temporary"})(s||(s={})),function(c){c.fresh="fresh",c.reusable="reusable",c.expired="expired",c.stale="stale"}(x||(x={}))},we.__chunk_70262=(ce,O,u)=>{"use strict";u.d(O,{Y:()=>g});var s=u(48210),x=u(34744),k=u(26336),E=u(24272),S=u(58784);let{createFromFetch:d}=u(52719);function o(c){return[(0,x.urlToUrlWithoutFlightMarker)(c).toString(),void 0,!1,!1]}async function g(c,f,m,C,I){let _={[s.A]:"1",[s.ph]:encodeURIComponent(JSON.stringify(f))};I===E.Ke.AUTO&&(_[s.qw]="1"),m&&(_[s.TP]=m);let R=(0,S.a)([_[s.qw]||"0",_[s.ph],_[s.TP]].join(","));try{var F;let L=new URL(c);L.searchParams.set(s.H4,R);let U=await fetch(L,{credentials:"same-origin",headers:_}),te=(0,x.urlToUrlWithoutFlightMarker)(U.url),Y=U.redirected?te:void 0,q=U.headers.get("content-type")||"",se=!!U.headers.get(s.VT),J=!!((F=U.headers.get("vary"))!=null&&F.includes(s.TP));if(q!==s.eY||!U.ok)return c.hash&&(te.hash=c.hash),o(te.toString());let[j,M]=await d(Promise.resolve(U),{callServer:k.g});return C!==j?o(U.url):[M,Y,se,J]}catch(L){return console.error("Failed to fetch RSC payload for "+c+". Falling back to browser navigation.",L),[c.toString(),void 0,!1,!1]}}},we.__chunk_1521=(ce,O,u)=>{"use strict";u.d(O,{d:()=>x});var s=u(69720);function x(k,E){return E===void 0&&(E=!1),Array.isArray(k)?k[0]+"|"+k[1]+"|"+k[2]:E&&k.startsWith(s.GC)?s.GC:k}},we.__chunk_23068=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{default:()=>E});var s=u(20519),x=u(24528),k=u(24351);function E(){let S=(0,x.useContext)(k.TemplateContext);return(0,s.jsx)(s.Fragment,{children:S})}},we.__chunk_29560=(ce,O,u)=>{"use strict";u.d(O,{M6:()=>E,eo:()=>k,j2:()=>d,kM:()=>S}),u(24173),u(25715);var s,x=u(65140);function k(o){if(typeof o!="object"||o===null||!("digest"in o)||typeof o.digest!="string")return!1;let[g,c,f,m]=o.digest.split(";",4),C=Number(m);return g==="NEXT_REDIRECT"&&(c==="replace"||c==="push")&&typeof f=="string"&&!isNaN(C)&&C in x.X}function E(o){return k(o)?o.digest.split(";",3)[2]:null}function S(o){if(!k(o))throw Error("Not a redirect error");return o.digest.split(";",2)[1]}function d(o){if(!k(o))throw Error("Not a redirect error");return Number(o.digest.split(";",4)[3])}(function(o){o.push="push",o.replace="replace"})(s||(s={}))},we.__chunk_65140=(ce,O,u)=>{"use strict";var s;u.d(O,{X:()=>s}),function(x){x[x.SeeOther=303]="SeeOther",x[x.TemporaryRedirect=307]="TemporaryRedirect",x[x.PermanentRedirect=308]="PermanentRedirect"}(s||(s={}))},we.__chunk_7450=(ce,O,u)=>{"use strict";u.d(O,{I:()=>o});var s=u(20519),x=u(24528),k=u(10079),E=u(29560);function S(g){let{redirect:c,reset:f,redirectType:m}=g;return(0,k.tv)(),null}class d extends x.Component{static getDerivedStateFromError(c){if((0,E.eo)(c))return{redirect:(0,E.M6)(c),redirectType:(0,E.kM)(c)};throw c}render(){let{redirect:c,redirectType:f}=this.state;return c!==null&&f!==null?(0,s.jsx)(S,{redirect:c,redirectType:f,reset:()=>this.setState({redirect:null})}):this.props.children}constructor(c){super(c),this.state={redirect:null,redirectType:null}}}function o(g){let{children:c}=g,f=(0,k.tv)();return(0,s.jsx)(d,{router:f,children:c})}},we.__chunk_39556=(ce,O,u)=>{"use strict";function s(x){return typeof x=="object"&&x!==null&&"digest"in x&&x.digest==="NEXT_NOT_FOUND"}u.d(O,{X:()=>s})},we.__chunk_96825=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{NotFoundBoundary:()=>o});var s=u(20519),x=u(24528),k=u(10079),E=u(39556),S=u(24351);class d extends x.Component{componentDidCatch(){}static getDerivedStateFromError(c){if((0,E.X)(c))return{notFoundTriggered:!0};throw c}static getDerivedStateFromProps(c,f){return c.pathname!==f.previousPathname&&f.notFoundTriggered?{notFoundTriggered:!1,previousPathname:c.pathname}:{notFoundTriggered:f.notFoundTriggered,previousPathname:c.pathname}}render(){return this.state.notFoundTriggered?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("meta",{name:"robots",content:"noindex"}),!1,this.props.notFoundStyles,this.props.notFound]}):this.props.children}constructor(c){super(c),this.state={notFoundTriggered:!!c.asNotFound,previousPathname:c.pathname}}}function o(g){let{notFound:c,notFoundStyles:f,asNotFound:m,children:C}=g,I=(0,k.jD)(),_=(0,x.useContext)(S.MissingSlotContext);return c?(0,s.jsx)(d,{pathname:I,notFound:c,notFoundStyles:f,asNotFound:m,missingSlots:_,children:C}):(0,s.jsx)(s.Fragment,{children:C})}},we.__chunk_10079=(ce,O,u)=>{"use strict";u.d(O,{UO:()=>c,jD:()=>o,tv:()=>g,lr:()=>d});var s=u(24528),x=u(24351),k=u(86270);u(29560);class E extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class S extends URLSearchParams{append(){throw new E}delete(){throw new E}set(){throw new E}sort(){throw new E}}function d(){let f=(0,s.useContext)(k.SearchParamsContext),m=(0,s.useMemo)(()=>f?new S(f):null,[f]);{let{bailoutToClientRendering:C}=u(81116);C("useSearchParams()")}return m}function o(){return(0,s.useContext)(k.PathnameContext)}function g(){let f=(0,s.useContext)(x.AppRouterContext);if(f===null)throw Error("invariant expected app router to be mounted");return f}function c(){return(0,s.useContext)(k.PathParamsContext)}u(74917)},we.__chunk_84197=(ce,O,u)=>{"use strict";u.d(O,{W:()=>k,j:()=>x});var s=u(75368);let x=(E,S)=>typeof E=="string"?typeof S=="string"&&E===S:typeof S!="string"&&E[0]===S[0]&&E[1]===S[1],k=(E,S)=>{var d;return!Array.isArray(E)&&!!Array.isArray(S)&&((d=(0,s.R)(E))==null?void 0:d.param)===S[0]}},we.__chunk_39927=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{default:()=>te});var s=u(20519),x=u(24528);u(85192);var k=u(24351),E=u(70262),S=u(72315),d=u(70373),o=u(84197),g=u(7450),c=u(96825);function f(Y){return Array.isArray(Y)?Y[1]:Y}var m=u(1521),C=u(78342);let I=["bottom","height","left","right","top","width","x","y"];function _(Y,q){let se=Y.getBoundingClientRect();return se.top>=0&&se.top<=q}class R extends x.Component{componentDidMount(){this.handlePotentialScroll()}componentDidUpdate(){this.props.focusAndScrollRef.apply&&this.handlePotentialScroll()}render(){return this.props.children}constructor(...q){super(...q),this.handlePotentialScroll=()=>{let{focusAndScrollRef:se,segmentPath:J}=this.props;if(se.apply){if(se.segmentPaths.length!==0&&!se.segmentPaths.some(b=>J.every((N,$)=>(0,o.j)(N,b[$]))))return;let j=null,M=se.hashFragment;if(M&&(j=function(b){var N;return b==="top"?document.body:(N=document.getElementById(b))!=null?N:document.getElementsByName(b)[0]}(M)),!j&&(j=null),!(j instanceof Element))return;for(;!(j instanceof HTMLElement)||function(b){if(["sticky","fixed"].includes(getComputedStyle(b).position))return!0;let N=b.getBoundingClientRect();return I.every($=>N[$]===0)}(j);){if(j.nextElementSibling===null)return;j=j.nextElementSibling}se.apply=!1,se.hashFragment=null,se.segmentPaths=[],function(b,N){if(N===void 0&&(N={}),N.onlyHashChange){b();return}let $=document.documentElement,X=$.style.scrollBehavior;$.style.scrollBehavior="auto",N.dontForceLayout||$.getClientRects(),b(),$.style.scrollBehavior=X}(()=>{if(M){j.scrollIntoView();return}let b=document.documentElement,N=b.clientHeight;!_(j,N)&&(b.scrollTop=0,_(j,N)||j.scrollIntoView())},{dontForceLayout:!0,onlyHashChange:se.onlyHashChange}),se.onlyHashChange=!1,j.focus()}}}}function F(Y){let{segmentPath:q,children:se}=Y,J=(0,x.useContext)(k.GlobalLayoutRouterContext);if(!J)throw Error("invariant global layout router not mounted");return(0,s.jsx)(R,{segmentPath:q,focusAndScrollRef:J.focusAndScrollRef,children:se})}function L(Y){let{parallelRouterKey:q,url:se,childNodes:J,segmentPath:j,tree:M,cacheKey:b}=Y,N=(0,x.useContext)(k.GlobalLayoutRouterContext);if(!N)throw Error("invariant global layout router not mounted");let{buildId:$,changeByServerResponse:X,tree:ae}=N,K=J.get(b);if(K===void 0){let Ae={lazyData:null,rsc:null,prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:new Map,lazyDataResolved:!1,loading:null};K=Ae,J.set(b,Ae)}let ve=K.prefetchRsc!==null?K.prefetchRsc:K.rsc,ke=(0,x.useDeferredValue)(K.rsc,ve),fe=typeof ke=="object"&&ke!==null&&typeof ke.then=="function"?(0,x.use)(ke):ke;if(!fe){let Ae=K.lazyData;if(Ae===null){let Z=function W(Q,de){if(Q){let[ue,ye]=Q,Ge=Q.length===2;if((0,o.j)(de[0],ue)&&de[1].hasOwnProperty(ye)){if(Ge){let Oe=W(void 0,de[1][ye]);return[de[0],{...de[1],[ye]:[Oe[0],Oe[1],Oe[2],"refetch"]}]}return[de[0],{...de[1],[ye]:W(Q.slice(2),de[1][ye])}]}}return de}(["",...j],ae),ne=function W(Q){let[de,ue]=Q;if(Array.isArray(de)&&(de[2]==="di"||de[2]==="ci")||typeof de=="string"&&(0,C.Ag)(de))return!0;if(ue){for(let ye in ue)if(W(ue[ye]))return!0}return!1}(ae);K.lazyData=Ae=(0,E.Y)(new URL(se,location.origin),Z,ne?N.nextUrl:null,$),K.lazyDataResolved=!1}let _e=(0,x.use)(Ae);K.lazyDataResolved||(setTimeout(()=>{(0,x.startTransition)(()=>{X({previousTree:ae,serverResponse:_e})})}),K.lazyDataResolved=!0),(0,x.use)(S.c)}return(0,s.jsx)(k.LayoutRouterContext.Provider,{value:{tree:M[1][q],childNodes:K.parallelRoutes,url:se,loading:K.loading},children:fe})}function U(Y){let{children:q,hasLoading:se,loading:J,loadingStyles:j,loadingScripts:M}=Y;return se?(0,s.jsx)(x.Suspense,{fallback:(0,s.jsxs)(s.Fragment,{children:[j,M,J]}),children:q}):(0,s.jsx)(s.Fragment,{children:q})}function te(Y){let{parallelRouterKey:q,segmentPath:se,error:J,errorStyles:j,errorScripts:M,templateStyles:b,templateScripts:N,template:$,notFound:X,notFoundStyles:ae}=Y,K=(0,x.useContext)(k.LayoutRouterContext);if(!K)throw Error("invariant expected layout router to be mounted");let{childNodes:ve,tree:ke,url:fe,loading:Ae}=K,_e=ve.get(q);_e||(_e=new Map,ve.set(q,_e));let Z=ke[1][q][0],ne=f(Z),W=[Z];return(0,s.jsx)(s.Fragment,{children:W.map(Q=>{let de=f(Q),ue=(0,m.d)(Q);return(0,s.jsxs)(k.TemplateContext.Provider,{value:(0,s.jsx)(F,{segmentPath:se,children:(0,s.jsx)(d.ErrorBoundary,{errorComponent:J,errorStyles:j,errorScripts:M,children:(0,s.jsx)(U,{hasLoading:!!Ae,loading:Ae?.[0],loadingStyles:Ae?.[1],loadingScripts:Ae?.[2],children:(0,s.jsx)(c.NotFoundBoundary,{notFound:X,notFoundStyles:ae,children:(0,s.jsx)(g.I,{children:(0,s.jsx)(L,{parallelRouterKey:q,url:fe,tree:ke,childNodes:_e,segmentPath:se,cacheKey:ue,isActive:ne===de})})})})})}),children:[b,N,$]},(0,m.d)(Q,!0))})})}},we.__chunk_403=(ce,O,u)=>{"use strict";u.d(O,{$:()=>x,j:()=>k});let s="DYNAMIC_SERVER_USAGE";class x extends Error{constructor(S){super("Dynamic server usage: "+S),this.description=S,this.digest=s}}function k(E){return typeof E=="object"&&E!==null&&"digest"in E&&typeof E.digest=="string"&&E.digest===s}},we.__chunk_70373=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{ErrorBoundary:()=>C,ErrorBoundaryHandler:()=>c,GlobalError:()=>f,default:()=>m});var s=u(20519),x=u(24528),k=u(10079),E=u(39556),S=u(29560),d=u(81778);let o={error:{fontFamily:'system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji"',height:"100vh",textAlign:"center",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},text:{fontSize:"14px",fontWeight:400,lineHeight:"28px",margin:"0 8px"}};function g(I){let{error:_}=I,R=d.A.getStore();if(R?.isRevalidate||R?.isStaticGeneration)throw console.error(_),_;return null}class c extends x.Component{static getDerivedStateFromError(_){if(_&&_.digest&&((0,S.eo)(_)||(0,E.X)(_)))throw _;return{error:_}}static getDerivedStateFromProps(_,R){return _.pathname!==R.previousPathname&&R.error?{error:null,previousPathname:_.pathname}:{error:R.error,previousPathname:_.pathname}}render(){return this.state.error?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g,{error:this.state.error}),this.props.errorStyles,this.props.errorScripts,(0,s.jsx)(this.props.errorComponent,{error:this.state.error,reset:this.reset})]}):this.props.children}constructor(_){super(_),this.reset=()=>{this.setState({error:null})},this.state={error:null,previousPathname:this.props.pathname}}}function f(I){let{error:_}=I,R=_?.digest;return(0,s.jsxs)("html",{id:"__next_error__",children:[(0,s.jsx)("head",{}),(0,s.jsxs)("body",{children:[(0,s.jsx)(g,{error:_}),(0,s.jsx)("div",{style:o.error,children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{style:o.text,children:"Application error: a "+(R?"server":"client")+"-side exception has occurred (see the "+(R?"server logs":"browser console")+" for more information)."}),R?(0,s.jsx)("p",{style:o.text,children:"Digest: "+R}):null]})})]})]})}let m=f;function C(I){let{errorComponent:_,errorStyles:R,errorScripts:F,children:L}=I,U=(0,k.jD)();return _?(0,s.jsx)(c,{pathname:U,errorComponent:_,errorStyles:R,errorScripts:F,children:L}):(0,s.jsx)(s.Fragment,{children:L})}},we.__chunk_68549=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{ClientPageRoot:()=>S});var s=u(20519),x=u(81778),k=u(84223),E=u(58056);function S(d){let{Component:o,props:g}=d;return g.searchParams=function(c){let f=x.A.getStore();return f?f.forceStatic?{}:f.isStaticGeneration||f.dynamicShouldError?new Proxy({},{get:(m,C,I)=>(typeof C=="string"&&(0,k.TP)(f,"searchParams."+C),E.g.get(m,C,I)),has:(m,C)=>(typeof C=="string"&&(0,k.TP)(f,"searchParams."+C),Reflect.has(m,C)),ownKeys:m=>((0,k.TP)(f,"searchParams"),Reflect.ownKeys(m))}):c:c}(g.searchParams||{}),(0,s.jsx)(o,{...g})}},we.__chunk_81116=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{bailoutToClientRendering:()=>k});var s=u(4248),x=u(81778);function k(E){let S=x.A.getStore();if((S==null||!S.forceStatic)&&S?.isStaticGeneration)throw new s.Z(E)}},we.__chunk_34744=(ce,O,u)=>{"use strict";u.r(O),u.d(O,{createEmptyCacheNode:()=>ye,default:()=>Qe,getServerActionDispatcher:()=>ne,urlToUrlWithoutFlightMarker:()=>Q});var s=u(20519),x=u(24528),k=u(24351),E=u(24272);function S(be,De){return De===void 0&&(De=!0),be.pathname+be.search+(De?be.hash:"")}var d=u(86270);u(70262);var o=u(1521),g=u(69720),c=u(48210);function f(be,De){if(!Object.prototype.hasOwnProperty.call(be,De))throw TypeError("attempted to use private field on non-instance");return be}var m=0;function C(be){return"__private_"+m+++"_"+be}var I=C("_maxConcurrency"),_=C("_runningCount"),R=C("_queue"),F=C("_processNext");class L{enqueue(De){let Xe,tt,Ct=new Promise((Tt,Dt)=>{Xe=Tt,tt=Dt}),ct=async()=>{try{f(this,_)[_]++;let Tt=await De();Xe(Tt)}catch(Tt){tt(Tt)}finally{f(this,_)[_]--,f(this,F)[F]()}};return f(this,R)[R].push({promiseFn:Ct,task:ct}),f(this,F)[F](),Ct}bump(De){let Xe=f(this,R)[R].findIndex(tt=>tt.promiseFn===De);if(Xe>-1){let tt=f(this,R)[R].splice(Xe,1)[0];f(this,R)[R].unshift(tt),f(this,F)[F](!0)}}constructor(De=5){Object.defineProperty(this,F,{value:U}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,_,{writable:!0,value:void 0}),Object.defineProperty(this,R,{writable:!0,value:void 0}),f(this,I)[I]=De,f(this,_)[_]=0,f(this,R)[R]=[]}}function U(be){if(be===void 0&&(be=!1),(f(this,_)[_]<f(this,I)[I]||be)&&f(this,R)[R].length>0){var De;(De=f(this,R)[R].shift())==null||De.task()}}function te(be,De){let Xe=S(be,!1);return De?De+"%"+Xe:Xe}new L(5);let Y=Symbol();u(26336);let{createFromFetch:q,encodeReply:se}=u(52719);function J(be,De){be.pending!==null&&(be.pending=be.pending.next,be.pending!==null?j({actionQueue:be,action:be.pending,setState:De}):be.needsRefresh&&(be.needsRefresh=!1,be.dispatch({type:ACTION_REFRESH,origin:window.location.origin},De)))}async function j(be){let{actionQueue:De,action:Xe,setState:tt}=be,Ct=De.state;if(!Ct)throw Error("Invariant: Router state not initialized");De.pending=Xe;let ct=Xe.payload,Tt=De.action(Ct,ct);function Dt(mt){Xe.discarded||(De.state=mt,De.devToolsInstance&&De.devToolsInstance.send(ct,mt),J(De,tt),Xe.resolve(mt))}isThenable(Tt)?Tt.then(Dt,mt=>{J(De,tt),Xe.reject(mt)}):Dt(Tt)}function M(be){return(0,E.J8)(be)?(0,x.use)(be):be}var b=u(70373),N=u(78342);let $=be=>be[0]==="/"?be.slice(1):be,X=be=>typeof be=="string"?be==="children"?"":be:be[1];var ae=u(28275),K=u(59815),ve=u(85192);function ke(be){let{tree:De}=be,[Xe,tt]=(0,x.useState)(null),[Ct,ct]=(0,x.useState)("");return(0,x.useRef)(),Xe?(0,ve.createPortal)(Ct,Xe):null}var fe=u(7450),Ae=u(72315),_e=u(28138);let Z=null;function ne(){return Z}let W={};function Q(be){let De=new URL(be,location.origin);return De.searchParams.delete(c.H4),De}function de(be){return be.origin!==window.location.origin}function ue(be){let{appRouterState:De,sync:Xe}=be;return(0,x.useInsertionEffect)(()=>{let{tree:tt,pushRef:Ct,canonicalUrl:ct}=De,Tt={...Ct.preserveCustomHistoryState?window.history.state:{},__NA:!0,__PRIVATE_NEXTJS_INTERNALS_TREE:tt};Ct.pendingPush&&S(new URL(window.location.href))!==ct?(Ct.pendingPush=!1,window.history.pushState(Tt,"",ct)):window.history.replaceState(Tt,"",ct),Xe(De)},[De,Xe]),null}function ye(){return{lazyData:null,rsc:null,prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:new Map,lazyDataResolved:!1,loading:null}}function Ge(be){let{headCacheNode:De}=be,Xe=De!==null?De.head:null,tt=De!==null?De.prefetchHead:null,Ct=tt!==null?tt:Xe;return(0,x.useDeferredValue)(Xe,Ct)}function Oe(be){let De,{buildId:Xe,initialHead:tt,initialTree:Ct,urlParts:ct,initialSeedData:Tt,couldBeIntercepted:Dt,assetPrefix:mt,missingSlots:cr}=be,[kr,Ht,Or]=[(0,x.useMemo)(()=>function(mr){var Er;let{buildId:Dr,initialTree:Ar,initialSeedData:Br,urlParts:ba,initialParallelRoutes:Wr,location:pi,initialHead:Ba,couldBeIntercepted:Xt}=mr,ti=ba.join("/"),Pa=!pi,$t={lazyData:null,rsc:Br[2],prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:Pa?new Map:Wr,lazyDataResolved:!1,loading:Br[3]},Qt=pi?S(pi):ti;(function ji(_i,ai){let[di,gi,,hi]=_i;for(let Ri in di.includes(g.GC)&&hi!=="refresh"&&(_i[2]=ai,_i[3]="refresh"),gi)ji(gi[Ri],ai)})(Ar,Qt);let Mi=new Map;(Wr===null||Wr.size===0)&&function ji(_i,ai,di,gi,hi,Ri){if(Object.keys(di[1]).length===0){_i.head=hi;return}for(let fi in di[1]){let Ai,Bi=di[1][fi],mi=Bi[0],zr=(0,o.d)(mi),Gi=gi!==null&&gi[1][fi]!==void 0?gi[1][fi]:null;if(ai){let yi=ai.parallelRoutes.get(fi);if(yi){let Na,Fa=Ri?.kind==="auto"&&Ri.status===E.T7.reusable,Xr=new Map(yi),Hi=Xr.get(zr);Na=Gi!==null?{lazyData:null,rsc:Gi[2],prefetchRsc:null,head:null,prefetchHead:null,loading:Gi[3],parallelRoutes:new Map(Hi?.parallelRoutes),lazyDataResolved:!1}:Fa&&Hi?{lazyData:Hi.lazyData,rsc:Hi.rsc,prefetchRsc:Hi.prefetchRsc,head:Hi.head,prefetchHead:Hi.prefetchHead,parallelRoutes:new Map(Hi.parallelRoutes),lazyDataResolved:Hi.lazyDataResolved,loading:Hi.loading}:{lazyData:null,rsc:null,prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:new Map(Hi?.parallelRoutes),lazyDataResolved:!1,loading:null},Xr.set(zr,Na),ji(Na,Hi,Bi,Gi||null,hi,Ri),_i.parallelRoutes.set(fi,Xr);continue}}if(Gi!==null){let yi=Gi[2],Na=Gi[3];Ai={lazyData:null,rsc:yi,prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:new Map,lazyDataResolved:!1,loading:Na}}else Ai={lazyData:null,rsc:null,prefetchRsc:null,head:null,prefetchHead:null,parallelRoutes:new Map,lazyDataResolved:!1,loading:null};let Yr=_i.parallelRoutes.get(fi);Yr?Yr.set(zr,Ai):_i.parallelRoutes.set(fi,new Map([[zr,Ai]])),ji(Ai,void 0,Bi,Gi,hi,Ri)}}($t,void 0,Ar,Br,Ba);let Fi={buildId:Dr,tree:Ar,cache:$t,prefetchCache:Mi,pushRef:{pendingPush:!1,mpaNavigation:!1,preserveCustomHistoryState:!0},focusAndScrollRef:{apply:!1,onlyHashChange:!1,hashFragment:null,segmentPaths:[]},canonicalUrl:Qt,nextUrl:(Er=function ji(_i){var ai;let di=Array.isArray(_i[0])?_i[0][1]:_i[0];if(di===g.av||N.Wz.some(fi=>di.startsWith(fi)))return;if(di.startsWith(g.GC))return"";let gi=[X(di)],hi=(ai=_i[1])!=null?ai:{},Ri=hi.children?ji(hi.children):void 0;if(Ri!==void 0)gi.push(Ri);else for(let[fi,Ai]of Object.entries(hi)){if(fi==="children")continue;let Bi=ji(Ai);Bi!==void 0&&gi.push(Bi)}return gi.reduce((fi,Ai)=>(Ai=$(Ai))===""||(0,g.lv)(Ai)?fi:fi+"/"+Ai,"")||"/"}(Ar)||pi?.pathname)!=null?Er:null};if(pi){let ji=new URL(""+pi.pathname+pi.search,pi.origin),_i=[["",Ar,null,null]];(function(ai){let{nextUrl:di,tree:gi,prefetchCache:hi,url:Ri,kind:fi,data:Ai}=ai,[,,,Bi]=Ai,mi=Bi?te(Ri,di):te(Ri),zr={treeAtTimeOfPrefetch:gi,data:Promise.resolve(Ai),kind:fi,prefetchTime:Date.now(),lastUsedTime:Date.now(),key:mi,status:E.T7.fresh};hi.set(mi,zr)})({url:ji,kind:E.Ke.AUTO,data:[_i,void 0,!1,Xt],tree:Fi.tree,prefetchCache:Fi.prefetchCache,nextUrl:Fi.nextUrl})}return Fi}({buildId:Xe,initialSeedData:Tt,urlParts:ct,initialTree:Ct,initialParallelRoutes:null,location:null,initialHead:tt,couldBeIntercepted:Dt}),[Xe,Tt,ct,Ct,tt,Dt]),()=>{},()=>{}],{canonicalUrl:fr}=M(kr),{searchParams:Oi,pathname:li}=(0,x.useMemo)(()=>{var mr;let Er=new URL(fr,"http://n");return{searchParams:Er.searchParams,pathname:((0,_e.e)(Er.pathname),Er.pathname)}},[fr]),At=(0,x.useCallback)(mr=>{let{previousTree:Er,serverResponse:Dr}=mr;(0,x.startTransition)(()=>{Ht({type:E.n0,previousTree:Er,serverResponse:Dr})})},[Ht]),Pr=(0,x.useCallback)((mr,Er,Dr)=>{let Ar=new URL((0,K.n)(mr),location.href);return Ht({type:E.bO,url:Ar,isExternalUrl:de(Ar),locationSearch:location.search,shouldScroll:Dr==null||Dr,navigateType:Er})},[Ht]);Z=(0,x.useCallback)(mr=>{(0,x.startTransition)(()=>{Ht({...mr,type:E.WA})})},[Ht]);let hr=(0,x.useMemo)(()=>({back:()=>window.history.back(),forward:()=>window.history.forward(),prefetch:(mr,Er)=>{let Dr;if(!(0,ae.Q)(window.navigator.userAgent)){try{Dr=new URL((0,K.n)(mr),window.location.href)}catch{throw Error("Cannot prefetch '"+mr+"' because it cannot be converted to a URL.")}de(Dr)||(0,x.startTransition)(()=>{var Ar;Ht({type:E.Pm,url:Dr,kind:(Ar=Er?.kind)!=null?Ar:E.Ke.FULL})})}},replace:(mr,Er)=>{Er===void 0&&(Er={}),(0,x.startTransition)(()=>{var Dr;Pr(mr,"replace",(Dr=Er.scroll)==null||Dr)})},push:(mr,Er)=>{Er===void 0&&(Er={}),(0,x.startTransition)(()=>{var Dr;Pr(mr,"push",(Dr=Er.scroll)==null||Dr)})},refresh:()=>{(0,x.startTransition)(()=>{Ht({type:E.HD,origin:window.location.origin})})},fastRefresh:()=>{throw Error("fastRefresh can only be used in development mode. Please use refresh instead.")}}),[Ht,Pr]),{pushRef:gr}=M(kr);if(gr.mpaNavigation){if(W.pendingMpaPath!==fr){let mr=window.location;gr.pendingPush?mr.assign(fr):mr.replace(fr),W.pendingMpaPath=fr}(0,x.use)(Ae.c)}let{cache:Jt,tree:Ir,nextUrl:ea,focusAndScrollRef:ki}=M(kr),na=(0,x.useMemo)(()=>function mr(Er,Dr,Ar){if(Object.keys(Dr).length===0)return[Er,Ar];for(let Br in Dr){let[ba,Wr]=Dr[Br],pi=Er.parallelRoutes.get(Br);if(!pi)continue;let Ba=(0,o.d)(ba),Xt=pi.get(Ba);if(!Xt)continue;let ti=mr(Xt,Wr,Ar+"/"+Ba);if(ti)return ti}return null}(Jt,Ir[1],""),[Jt,Ir]),Kr=(0,x.useMemo)(()=>function mr(Er,Dr){for(let Ar of(Dr===void 0&&(Dr={}),Object.values(Er[1]))){let Br=Ar[0],ba=Array.isArray(Br),Wr=ba?Br[1]:Br;!Wr||Wr.startsWith(g.GC)||(ba&&(Br[2]==="c"||Br[2]==="oc")?Dr[Br[0]]=Br[1].split("/"):ba&&(Dr[Br[0]]=Br[1]),Dr=mr(Ar,Dr))}return Dr}(Ir),[Ir]);if(na!==null){let[mr,Er]=na;De=(0,s.jsx)(Ge,{headCacheNode:mr},Er)}else De=null;let Ni=(0,s.jsxs)(fe.I,{children:[De,Jt.rsc,(0,s.jsx)(ke,{tree:Ir})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ue,{appRouterState:M(kr),sync:Or}),(0,s.jsx)(d.PathParamsContext.Provider,{value:Kr,children:(0,s.jsx)(d.PathnameContext.Provider,{value:li,children:(0,s.jsx)(d.SearchParamsContext.Provider,{value:Oi,children:(0,s.jsx)(k.GlobalLayoutRouterContext.Provider,{value:{buildId:Xe,changeByServerResponse:At,tree:Ir,focusAndScrollRef:ki,nextUrl:ea},children:(0,s.jsx)(k.AppRouterContext.Provider,{value:hr,children:(0,s.jsx)(k.LayoutRouterContext.Provider,{value:{childNodes:Jt.parallelRoutes,tree:Ir,url:fr,loading:Jt.loading},children:Ni})})})})})})]})}function Qe(be){let{globalErrorComponent:De,...Xe}=be;return(0,s.jsx)(b.ErrorBoundary,{errorComponent:De,children:(0,s.jsx)(Oe,{...Xe})})}},we.__chunk_48210=(ce,O,u)=>{"use strict";u.d(O,{A:()=>s,H4:()=>g,TP:()=>S,VT:()=>c,eY:()=>d,om:()=>x,ph:()=>k,qw:()=>E,vu:()=>o});let s="RSC",x="Next-Action",k="Next-Router-State-Tree",E="Next-Router-Prefetch",S="Next-Url",d="text/x-component",o=[[s],[k],[E]],g="_rsc",c="x-nextjs-postponed"},we.__chunk_26336=(ce,O,u)=>{"use strict";u.d(O,{g:()=>x});var s=u(34744);async function x(k,E){let S=(0,s.getServerActionDispatcher)();if(!S)throw Error("Invariant: missing action dispatcher.");return new Promise((d,o)=>{S({actionId:k,actionArgs:E,resolve:d,reject:o})})}},we.__chunk_59815=(ce,O,u)=>{"use strict";u.d(O,{n:()=>k});var s=u(15109),x=u(4455);function k(E,S){return(0,x.R)((0,s.V)(E,""))}},we.__chunk_2036=(ce,O,u)=>{"use strict";u.d(O,{d:()=>jn});var s,x=u(67577);Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),aa.AsyncLocalStorage;let k=Symbol.for("@next/request-context");var E=u(28668);let S="(?:[0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",d=`(${S}[.]){3}${S}`,o="(?:[0-9a-fA-F]{1,4})",g=RegExp(`^((?:${o}:){7}(?:${o}|:)|(?:${o}:){6}(?:${d}|:${o}|:)|(?:${o}:){5}(?::${d}|(:${o}){1,2}|:)|(?:${o}:){4}(?:(:${o}){0,1}:${d}|(:${o}){1,3}|:)|(?:${o}:){3}(?:(:${o}){0,2}:${d}|(:${o}){1,4}|:)|(?:${o}:){2}(?:(:${o}){0,3}:${d}|(:${o}){1,5}|:)|(?:${o}:){1}(?:(:${o}){0,4}:${d}|(:${o}){1,6}|:)|(?::((?::${o}){0,5}:${d}|(?::${o}){1,7}|:)))(%[0-9a-zA-Z-.:]{1,})?$`);var c=u(65140);function f(lt){return lt.statusCode||(lt.permanent?c.X.PermanentRedirect:c.X.TemporaryRedirect)}var m=u(78045);u(49426);let C={client:"client",server:"server",edgeServer:"edge-server"};C.client,C.server,C.edgeServer;let I="/_not-found",_=""+I+"/page",R="pages-manifest.json",F="app-paths-manifest.json",L="server",U=["/_document","/_app","/_error"];Symbol("polyfills");let te=["/500"];var Y=u(26845),q=u(80842);function se({revalidate:lt,swrDelta:B}){let le=B?`stale-while-revalidate=${B}`:"stale-while-revalidate";return lt===0?"private, no-cache, no-store, max-age=0, must-revalidate":typeof lt=="number"?`s-maxage=${lt}, ${le}`:`s-maxage=${m.BR}, ${le}`}var J=u(28275),j=u(62919),M=u(19762);function b(lt){let B=lt.replace(/\\/g,"/");return B.startsWith("/index/")&&!(0,Y.$)(B)?B.slice(6):B!=="/index"?B:"/"}var N=u(67234),$=u(55744),X=u(37529);function ae(lt,B){let le=[],pe=(0,X.Bo)(lt,le,{delimiter:"/",sensitive:typeof B?.sensitive=="boolean"&&B.sensitive,strict:B?.strict}),Re=(0,X.WS)(B?.regexModifier?new RegExp(B.regexModifier(pe.source),pe.flags):pe,le);return(Pe,it)=>{if(typeof Pe!="string")return!1;let yt=Re(Pe);if(!yt)return!1;if(B?.removeUnnamedParams)for(let St of le)typeof St.name=="number"&&delete yt.params[St.name];return{...it,...yt.params}}}var K=u(76891),ve=u(15076),ke=u(13544),fe=u(28160);function Ae(lt){if(lt.startsWith("/"))return function(le,pe){let Re=new URL("http://n"),Pe=le.startsWith(".")?new URL("http://n"):Re,{pathname:it,searchParams:yt,search:St,hash:It,href:er,origin:qr}=new URL(le,Pe);if(qr!==Re.origin)throw Error("invariant: invalid relative URL, router received "+le);return{pathname:it,query:(0,fe.u5)(yt),search:St,hash:It,href:er.slice(Re.origin.length)}}(lt);let B=new URL(lt);return{hash:B.hash,hostname:B.hostname,href:B.href,pathname:B.pathname,port:B.port,protocol:B.protocol,query:(0,fe.u5)(B.searchParams),search:B.search}}var _e=u(78342),Z=u(48210);function ne(lt){return function(){let{cookie:B}=lt;if(!B)return{};let{parse:le}=u(33627);return le(Array.isArray(B)?B.join("; "):B)}}function W(lt){return lt.replace(/__ESC_COLON_/gi,":")}function Q(lt,B){if(!lt.includes(":"))return lt;for(let le of Object.keys(B))lt.includes(":"+le)&&(lt=lt.replace(RegExp(":"+le+"\\*","g"),":"+le+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+le+"\\?","g"),":"+le+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+le+"\\+","g"),":"+le+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+le+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+le));return lt=lt.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,X.MY)("/"+lt,{validate:!1})(B).slice(1)}var de=u(46737);function ue(lt,B,le,pe,Re){if(pe&&B&&Re){let Pe=(0,E.parse)(lt.url,!0);for(let it of(delete Pe.search,Object.keys(Pe.query))){let yt=it!==m.dN&&it.startsWith(m.dN),St=it!==m.u7&&it.startsWith(m.u7);(yt||St||(le||Object.keys(Re.groups)).includes(it))&&delete Pe.query[it]}lt.url=(0,E.format)(Pe)}}function ye(lt,B,le){if(!le)return lt;for(let pe of Object.keys(le.groups)){let{optional:Re,repeat:Pe}=le.groups[pe],it=`[${Pe?"...":""}${pe}]`;Re&&(it=`[${it}]`);let yt=lt.indexOf(it);if(yt>-1){let St,It=B[pe];St=Array.isArray(It)?It.map(er=>er&&encodeURIComponent(er)).join("/"):It?encodeURIComponent(It):"",lt=lt.slice(0,yt)+St+lt.slice(yt+it.length)}}return lt}function Ge(lt,B,le,pe){let Re=!0;return le?{params:lt=Object.keys(le.groups).reduce((Pe,it)=>{let yt=lt[it];typeof yt=="string"&&(yt=(0,de.b)(yt)),Array.isArray(yt)&&(yt=yt.map(er=>(typeof er=="string"&&(er=(0,de.b)(er)),er)));let St=pe[it],It=le.groups[it].optional;return((Array.isArray(St)?St.some(er=>Array.isArray(yt)?yt.some(qr=>qr.includes(er)):yt?.includes(er)):yt?.includes(St))||yt===void 0&&!(It&&B))&&(Re=!1),It&&(!yt||Array.isArray(yt)&&yt.length===1&&(yt[0]==="index"||yt[0]===`[[...${it}]]`))&&(yt=void 0,delete lt[it]),yt&&typeof yt=="string"&&le.groups[it].repeat&&(yt=yt.split("/")),yt&&(Pe[it]=yt),Pe},{}),hasValidParams:Re}:{params:lt,hasValidParams:!1}}function Oe(lt){return typeof lt=="object"&&lt!==null&&"name"in lt&&"message"in lt}function Qe(lt){return Oe(lt)?lt:Error(function(B){if(Object.prototype.toString.call(B)!=="[object Object]")return!1;let le=Object.getPrototypeOf(B);return le===null||le.hasOwnProperty("isPrototypeOf")}(lt)?JSON.stringify(lt):lt+"")}var be=u(75698),De=u(53584),Xe=u(431),tt=u(6141);class Ct{constructor(B){this.provider=B}normalize(B){return this.provider.analyze(B).pathname}}class ct{insert(B){this._insert(B.split("/").filter(Boolean),[],!1)}smoosh(){return this._smoosh()}_smoosh(B){B===void 0&&(B="/");let le=[...this.children.keys()].sort();this.slugName!==null&&le.splice(le.indexOf("[]"),1),this.restSlugName!==null&&le.splice(le.indexOf("[...]"),1),this.optionalRestSlugName!==null&&le.splice(le.indexOf("[[...]]"),1);let pe=le.map(Re=>this.children.get(Re)._smoosh(""+B+Re+"/")).reduce((Re,Pe)=>[...Re,...Pe],[]);if(this.slugName!==null&&pe.push(...this.children.get("[]")._smoosh(B+"["+this.slugName+"]/")),!this.placeholder){let Re=B==="/"?"/":B.slice(0,-1);if(this.optionalRestSlugName!=null)throw Error('You cannot define a route with the same specificity as a optional catch-all route ("'+Re+'" and "'+Re+"[[..."+this.optionalRestSlugName+']]").');pe.unshift(Re)}return this.restSlugName!==null&&pe.push(...this.children.get("[...]")._smoosh(B+"[..."+this.restSlugName+"]/")),this.optionalRestSlugName!==null&&pe.push(...this.children.get("[[...]]")._smoosh(B+"[[..."+this.optionalRestSlugName+"]]/")),pe}_insert(B,le,pe){if(B.length===0){this.placeholder=!1;return}if(pe)throw Error("Catch-all must be the last part of the URL.");let Re=B[0];if(Re.startsWith("[")&&Re.endsWith("]")){let yt=function(St,It){if(St!==null&&St!==It)throw Error("You cannot use different slug names for the same dynamic path ('"+St+"' !== '"+It+"').");le.forEach(er=>{if(er===It)throw Error('You cannot have the same slug name "'+It+'" repeat within a single dynamic path');if(er.replace(/\W/g,"")===Re.replace(/\W/g,""))throw Error('You cannot have the slug names "'+er+'" and "'+It+'" differ only by non-word symbols within a single dynamic path')}),le.push(It)},Pe=Re.slice(1,-1),it=!1;if(Pe.startsWith("[")&&Pe.endsWith("]")&&(Pe=Pe.slice(1,-1),it=!0),Pe.startsWith("...")&&(Pe=Pe.substring(3),pe=!0),Pe.startsWith("[")||Pe.endsWith("]"))throw Error("Segment names may not start or end with extra brackets ('"+Pe+"').");if(Pe.startsWith("."))throw Error("Segment names may not start with erroneous periods ('"+Pe+"').");if(pe)if(it){if(this.restSlugName!=null)throw Error('You cannot use both an required and optional catch-all route at the same level ("[...'+this.restSlugName+']" and "'+B[0]+'" ).');yt(this.optionalRestSlugName,Pe),this.optionalRestSlugName=Pe,Re="[[...]]"}else{if(this.optionalRestSlugName!=null)throw Error('You cannot use both an optional and required catch-all route at the same level ("[[...'+this.optionalRestSlugName+']]" and "'+B[0]+'").');yt(this.restSlugName,Pe),this.restSlugName=Pe,Re="[...]"}else{if(it)throw Error('Optional route parameters are not yet supported ("'+B[0]+'").');yt(this.slugName,Pe),this.slugName=Pe,Re="[]"}}this.children.has(Re)||this.children.set(Re,new ct),this.children.get(Re)._insert(B.slice(1),le,pe)}constructor(){this.placeholder=!0,this.children=new Map,this.slugName=null,this.restSlugName=null,this.optionalRestSlugName=null}}class Tt{constructor(B){this.definition=B,(0,Y.$)(B.pathname)&&(this.dynamic=(0,ve.t)((0,K.vG)(B.pathname)))}get identity(){return this.definition.pathname}get isDynamic(){return this.dynamic!==void 0}match(B){let le=this.test(B);return le?{definition:this.definition,params:le.params}:null}test(B){if(this.dynamic){let le=this.dynamic(B);return le?{params:le}:null}return B===this.definition.pathname?{}:null}}class Dt extends Tt{get identity(){var B;return`${this.definition.pathname}?__nextLocale=${(B=this.definition.i18n)==null?void 0:B.locale}`}match(B,le){var pe,Re;let Pe=this.test(B,le);return Pe?{definition:this.definition,params:Pe.params,detectedLocale:(le==null||(pe=le.i18n)==null?void 0:pe.detectedLocale)??((Re=this.definition.i18n)==null?void 0:Re.locale)}:null}test(B,le){return this.definition.i18n&&le?.i18n?this.definition.i18n.locale&&le.i18n.detectedLocale&&this.definition.i18n.locale!==le.i18n.detectedLocale?null:super.test(le.i18n.pathname):super.test(B)}}var mt=u(30537),cr=u(92398);class kr{get compilationID(){return this.providers.length}async waitTillReady(){this.waitTillReadyPromise&&(await this.waitTillReadyPromise,delete this.waitTillReadyPromise)}async reload(){let{promise:B,resolve:le,reject:pe}=new cr.Y;this.waitTillReadyPromise=B;let Re=this.compilationID;try{let Pe=[],it=await Promise.all(this.providers.map(Ze=>Ze.matchers())),yt=new Map,St={};for(let Ze of it)for(let Kt of Ze){Kt.duplicated&&delete Kt.duplicated;let Gr=yt.get(Kt.definition.pathname);if(Gr){let bi=St[Kt.definition.pathname]??[Gr];bi.push(Kt),St[Kt.definition.pathname]=bi,Gr.duplicated=bi,Kt.duplicated=bi}Pe.push(Kt),yt.set(Kt.definition.pathname,Kt)}if(this.matchers.duplicates=St,this.previousMatchers.length===Pe.length&&this.previousMatchers.every((Ze,Kt)=>Ze===Pe[Kt]))return;this.previousMatchers=Pe,this.matchers.static=Pe.filter(Ze=>!Ze.isDynamic);let It=Pe.filter(Ze=>Ze.isDynamic),er=new Map,qr=[];for(let Ze=0;Ze<It.length;Ze++){let Kt=It[Ze].definition.pathname,Gr=er.get(Kt)??[];Gr.push(Ze),Gr.length===1&&(er.set(Kt,Gr),qr.push(Kt))}let Zr=function(Ze){let Kt=new ct;return Ze.forEach(Gr=>Kt.insert(Gr)),Kt.smoosh()}(qr),vi=[];for(let Ze of Zr){let Kt=er.get(Ze);if(!Array.isArray(Kt))throw Error("Invariant: expected to find identity in indexes map");let Gr=Kt.map(bi=>It[bi]);vi.push(...Gr)}if(this.matchers.dynamic=vi,this.compilationID!==Re)throw Error("Invariant: expected compilation to finish before new matchers were added, possible missing await")}catch(Pe){pe(Pe)}finally{this.lastCompilationID=Re,le()}}push(B){this.providers.push(B)}async test(B,le){return await this.match(B,le)!==null}async match(B,le){for await(let pe of this.matchAll(B,le))return pe;return null}validate(B,le,pe){var Re;return le instanceof Dt?le.match(B,pe):(Re=pe.i18n)!=null&&Re.inferredFromDefault?le.match(pe.i18n.pathname):le.match(B)}async*matchAll(B,le){if(this.lastCompilationID!==this.compilationID)throw Error("Invariant: expected routes to have been loaded before match");if(B=(0,mt.e)(B),!(0,Y.$)(B))for(let pe of this.matchers.static){let Re=this.validate(B,pe,le);Re&&(yield Re)}if(le?.skipDynamic)return null;for(let pe of this.matchers.dynamic){let Re=this.validate(B,pe,le);Re&&(yield Re)}return null}constructor(){this.providers=[],this.matchers={static:[],dynamic:[],duplicates:{}},this.lastCompilationID=this.compilationID,this.previousMatchers=[]}}class Ht{constructor(B=[]){this.normalizers=B}push(B){this.normalizers.push(B)}normalize(B){return this.normalizers.reduce((le,pe)=>pe.normalize(le),B)}}var Or=u(44813),fr=u.n(Or);class Oi{constructor(...B){this.prefix=fr().posix.join(...B)}normalize(B){return fr().posix.join(this.prefix,B)}}var li=u(72584);class At extends Oi{constructor(){super("app")}normalize(B){return super.normalize((0,li.y)(B))}}class Pr extends Oi{constructor(B){super(B,L)}normalize(B){return super.normalize(B)}}u(37927);function hr(lt){return{normalize:lt}}u(58784);class gr{normalize(B){return B.replace(/%5F/g,"_")}}class Jt extends Ht{constructor(){super([hr(de.w),new gr])}normalize(B){return super.normalize(B)}}class Ir{constructor(B){this.filename=new Pr(B),this.pathname=new Jt,this.bundlePath=new At}}(function(lt){lt.PAGES="PAGES",lt.PAGES_API="PAGES_API",lt.APP_PAGE="APP_PAGE",lt.APP_ROUTE="APP_ROUTE"})(s||(s={}));class ea extends Tt{get identity(){return`${this.definition.pathname}?__nextPage=${this.definition.page}`}}class ki{constructor(B){this.loader=B,this.cached=[]}async matchers(){let B=await this.loader.load();if(!B)return[];if(this.data&&this.loader.compare(this.data,B))return this.cached;this.data=B;let le=await this.transform(B);return this.cached=le,le}}class na extends ki{constructor(B,le){super({load:async()=>le.load(B),compare:(pe,Re)=>pe===Re})}}class Kr extends na{constructor(B,le){super(F,le),this.normalizers=new Ir(B)}async transform(B){let le=Object.keys(B).filter(Pe=>Pe.endsWith("/page")),pe={};for(let Pe of le){let it=this.normalizers.pathname.normalize(Pe);it in pe?pe[it].push(Pe):pe[it]=[Pe]}let Re=[];for(let[Pe,it]of Object.entries(pe)){let yt=it[0],St=this.normalizers.filename.normalize(B[yt]),It=this.normalizers.bundlePath.normalize(yt);Re.push(new ea({kind:s.APP_PAGE,pathname:Pe,page:yt,bundlePath:It,filename:St,appPaths:it}))}return Re}}class Ni extends Tt{}class mr extends na{constructor(B,le){super(F,le),this.normalizers=new Ir(B)}async transform(B){let le=Object.keys(B).filter(Re=>Re.endsWith("/route")),pe=[];for(let Re of le){let Pe=this.normalizers.filename.normalize(B[Re]),it=this.normalizers.pathname.normalize(Re),yt=this.normalizers.bundlePath.normalize(Re);pe.push(new Ni({kind:s.APP_ROUTE,pathname:it,page:Re,bundlePath:yt,filename:Pe}))}return pe}}function Er(lt){return lt==="/api"||!!lt?.startsWith("/api/")}class Dr extends Tt{}class Ar extends Dt{}class Br extends Ht{constructor(){super([hr(li.y),new Oi("pages")])}normalize(B){return super.normalize(B)}}class ba extends Oi{constructor(B){super(B,L)}normalize(B){return super.normalize(B)}}class Wr{constructor(B){this.filename=new ba(B),this.bundlePath=new Br}}class pi extends na{constructor(B,le,pe){super(R,le),this.i18nProvider=pe,this.normalizers=new Wr(B)}async transform(B){let le=Object.keys(B).filter(Re=>Er(Re)),pe=[];for(let Re of le)if(this.i18nProvider){let{detectedLocale:Pe,pathname:it}=this.i18nProvider.analyze(Re);pe.push(new Ar({kind:s.PAGES_API,pathname:it,page:Re,bundlePath:this.normalizers.bundlePath.normalize(Re),filename:this.normalizers.filename.normalize(B[Re]),i18n:{locale:Pe}}))}else pe.push(new Dr({kind:s.PAGES_API,pathname:Re,page:Re,bundlePath:this.normalizers.bundlePath.normalize(Re),filename:this.normalizers.filename.normalize(B[Re])}));return pe}}class Ba extends Tt{}class Xt extends Dt{}class ti extends na{constructor(B,le,pe){super(R,le),this.i18nProvider=pe,this.normalizers=new Wr(B)}async transform(B){let le=Object.keys(B).filter(Re=>!Er(Re)).filter(Re=>{var Pe;let it=((Pe=this.i18nProvider)==null?void 0:Pe.analyze(Re).pathname)??Re;return!U.includes(it)}),pe=[];for(let Re of le)if(this.i18nProvider){let{detectedLocale:Pe,pathname:it}=this.i18nProvider.analyze(Re);pe.push(new Xt({kind:s.PAGES,pathname:it,page:Re,bundlePath:this.normalizers.bundlePath.normalize(Re),filename:this.normalizers.filename.normalize(B[Re]),i18n:{locale:Pe}}))}else pe.push(new Ba({kind:s.PAGES,pathname:Re,page:Re,bundlePath:this.normalizers.bundlePath.normalize(Re),filename:this.normalizers.filename.normalize(B[Re])}));return pe}}class Pa{constructor(B){this.getter=B}load(B){return this.getter(B)}}var $t=u(2147),Qt=u(61583);class Mi{constructor(B){var le;if(this.config=B,!B.locales.length)throw Error("Invariant: No locales provided");this.lowerCaseLocales=B.locales.map(pe=>pe.toLowerCase()),this.lowerCaseDomains=(le=B.domains)==null?void 0:le.map(pe=>{var Re;let Pe=pe.domain.toLowerCase();return{defaultLocale:pe.defaultLocale.toLowerCase(),hostname:Pe.split(":",1)[0],domain:Pe,locales:(Re=pe.locales)==null?void 0:Re.map(it=>it.toLowerCase()),http:pe.http}})}detectDomainLocale(B,le){if(B&&this.lowerCaseDomains&&this.config.domains){le&&(le=le.toLowerCase());for(let Re=0;Re<this.lowerCaseDomains.length;Re++){var pe;let Pe=this.lowerCaseDomains[Re];if(Pe.hostname===B||((pe=Pe.locales)==null?void 0:pe.some(it=>it===le)))return this.config.domains[Re]}}}fromQuery(B,le){let pe=le.__nextLocale;if(pe){let Re=this.analyze(B);if(Re.detectedLocale){if(Re.detectedLocale!==pe)throw Error(`Invariant: The detected locale does not match the locale in the query. Expected to find '${pe}' in '${B}' but found '${Re.detectedLocale}'}`);B=Re.pathname}}return{pathname:B,detectedLocale:pe,inferredFromDefault:le.__nextInferredLocaleFromDefault==="1"}}validate(B){return this.lowerCaseLocales.includes(B.toLowerCase())}validateQuery(B){return(!B.__nextLocale||!!this.validate(B.__nextLocale))&&(!B.__nextDefaultLocale||!!this.validate(B.__nextDefaultLocale))}analyze(B,le={}){let pe=le.defaultLocale,Re=typeof pe=="string",Pe=B.split("/",2);if(!Pe[1])return{detectedLocale:pe,pathname:B,inferredFromDefault:Re};let it=Pe[1].toLowerCase(),yt=this.lowerCaseLocales.indexOf(it);return yt<0||(pe=this.config.locales[yt],Re=!1,B=B.slice(pe.length+1)||"/"),{detectedLocale:pe,pathname:B,inferredFromDefault:Re}}}u(29744);var Fi=u(43150);async function ji(lt,B,le,pe){}u(73343);var _i=u(58301);let ai=ae("/_next/data/:path*");class di{constructor(B){this.suffix=B}match(B){return!!B.endsWith(this.suffix)}normalize(B,le){return le||this.match(B)?B.substring(0,B.length-this.suffix.length):B}}class gi extends di{constructor(){super(m.hd)}}class hi{constructor(B){if(this.prefix=B,B.endsWith("/"))throw Error(`PrefixPathnameNormalizer: prefix "${B}" should not end with a slash`)}match(B){return!!(B===this.prefix||B.startsWith(this.prefix+"/"))}normalize(B,le){return le||this.match(B)?B.length===this.prefix.length?"/":B.substring(this.prefix.length):B}}class Ri extends hi{constructor(){super("/_next/postponed/resume")}normalize(B,le){return le||this.match(B)?b(B=super.normalize(B,!0)):B}}class fi extends di{constructor(){super(m.Vz)}}function Ai(lt){for(let[B]of Z.vu)delete lt[B.toLowerCase()]}class Bi extends di{constructor(){super(m.Sx)}}class mi{constructor(B){if(this.suffix=new di(".json"),!B)throw Error("Invariant: buildID is required");this.prefix=new hi(`/_next/data/${B}`)}match(B){return this.prefix.match(B)&&this.suffix.match(B)}normalize(B,le){return le||this.match(B)?(B=this.prefix.normalize(B,!0),b(B=this.suffix.normalize(B,!0))):B}}var zr=u(1663),Gi=u(51422),Yr=u(26195).Buffer;class yi extends Error{}class Na extends Error{constructor(B){super(),this.innerError=B}}class Fa{constructor(B){var le,pe,Re;this.handleRSCRequest=(Wt,Fr,Tr)=>{var Ei,wi;if(!Tr.pathname)return!1;if((Ei=this.normalizers.prefetchRSC)!=null&&Ei.match(Tr.pathname))Tr.pathname=this.normalizers.prefetchRSC.normalize(Tr.pathname,!0),Wt.headers[Z.A.toLowerCase()]="1",Wt.headers[Z.qw.toLowerCase()]="1",(0,be.kL)(Wt,"isRSCRequest",!0),(0,be.kL)(Wt,"isPrefetchRSCRequest",!0);else if((wi=this.normalizers.rsc)!=null&&wi.match(Tr.pathname))Tr.pathname=this.normalizers.rsc.normalize(Tr.pathname,!0),Wt.headers[Z.A.toLowerCase()]="1",(0,be.kL)(Wt,"isRSCRequest",!0);else return Wt.headers["x-now-route-matches"]&&Ai(Wt.headers),!1;if(Wt.url){let ci=(0,E.parse)(Wt.url);ci.pathname=Tr.pathname,Wt.url=(0,E.format)(ci)}return!1},this.handleNextDataRequest=async(Wt,Fr,Tr)=>{let Ei=this.getMiddleware(),wi=function(vr){return typeof vr=="string"&&ai(vr)}(Tr.pathname);if(!wi||!wi.path)return!1;if(wi.path[0]!==this.buildId)return await this.render404(Wt,Fr,Tr),!0;wi.path.shift();let ci=wi.path[wi.path.length-1];if(typeof ci!="string"||!ci.endsWith(".json"))return await this.render404(Wt,Fr,Tr),!0;let Ci=`/${wi.path.join("/")}`;if(Ci=function(vr,Hr){return Hr===void 0&&(Hr=""),vr=vr.replace(/\\/g,"/"),(vr=Hr&&vr.endsWith(Hr)?vr.slice(0,-Hr.length):vr).startsWith("/index/")&&!(0,Y.$)(vr)?vr=vr.slice(6):vr==="/index"&&(vr="/"),vr}(Ci,".json"),Ei&&(this.nextConfig.trailingSlash&&!Ci.endsWith("/")&&(Ci+="/"),!this.nextConfig.trailingSlash&&Ci.length>1&&Ci.endsWith("/")&&(Ci=Ci.substring(0,Ci.length-1))),this.i18nProvider){var sr;let vr=Wt==null||(sr=Wt.headers.host)==null?void 0:sr.split(":",1)[0].toLowerCase(),Hr=this.i18nProvider.detectDomainLocale(vr),sa=Hr?.defaultLocale??this.i18nProvider.config.defaultLocale,pa=this.i18nProvider.analyze(Ci);if(pa.detectedLocale&&(Ci=pa.pathname),Tr.query.__nextLocale=pa.detectedLocale,Tr.query.__nextDefaultLocale=sa,pa.detectedLocale||delete Tr.query.__nextInferredLocaleFromDefault,!pa.detectedLocale&&!Ei)return Tr.query.__nextLocale=sa,await this.render404(Wt,Fr,Tr),!0}return Tr.pathname=Ci,Tr.query.__nextDataReq="1",!1},this.handleNextImageRequest=()=>!1,this.handleCatchallRenderRequest=()=>!1,this.handleCatchallMiddlewareRequest=()=>!1,this.normalize=Wt=>{let Fr=[];for(let Tr of(this.normalizers.data&&Fr.push(this.normalizers.data),this.normalizers.postponed&&Fr.push(this.normalizers.postponed),this.normalizers.prefetchRSC&&Fr.push(this.normalizers.prefetchRSC),this.normalizers.rsc&&Fr.push(this.normalizers.rsc),this.normalizers.action&&Fr.push(this.normalizers.action),Fr))if(Tr.match(Wt))return Tr.normalize(Wt,!0);return Wt},this.normalizeAndAttachMetadata=async(Wt,Fr,Tr)=>{let Ei=await this.handleNextImageRequest(Wt,Fr,Tr);return!!(Ei||this.enabledDirectories.pages&&(Ei=await this.handleNextDataRequest(Wt,Fr,Tr)))},this.prepared=!1,this.preparedPromise=null,this.customErrorNo404Warn=(0,x.gf)(()=>{N.ZK(`You have added a custom /_error page without a custom /404 page. This prevents the 404 page from being auto statically optimized.
See here for info: https://nextjs.org/docs/messages/custom-error-no-custom-404`)});let{dir:Pe=".",quiet:it=!1,conf:yt,dev:St=!1,minimalMode:It=!1,customServer:er=!0,hostname:qr,port:Zr,experimentalTestProxy:vi}=B;this.experimentalTestProxy=vi,this.serverOptions=B,this.dir=Pe,this.quiet=it,this.loadEnvConfig({dev:St}),this.nextConfig=yt,this.hostname=qr,this.hostname&&(this.fetchHostname=function(Wt){return g.test(Wt)?`[${Wt}]`:Wt}(this.hostname)),this.port=Zr,this.distDir=this.nextConfig.distDir,this.publicDir=this.getPublicDir(),this.hasStaticDir=!It&&this.getHasStaticDir(),this.i18nProvider=(le=this.nextConfig.i18n)!=null&&le.locales?new Mi(this.nextConfig.i18n):void 0,this.localeNormalizer=this.i18nProvider?new Ct(this.i18nProvider):void 0;let{serverRuntimeConfig:Ze={},publicRuntimeConfig:Kt,assetPrefix:Gr,generateEtags:bi}=this.nextConfig;this.buildId=this.getBuildId(),this.minimalMode=It||!!process.env.NEXT_PRIVATE_MINIMAL_MODE,this.enabledDirectories=this.getEnabledDirectories(St),this.normalizers={postponed:this.enabledDirectories.app&&this.nextConfig.experimental.ppr&&this.minimalMode?new Ri:void 0,rsc:this.enabledDirectories.app&&this.minimalMode?new gi:void 0,prefetchRSC:this.enabledDirectories.app&&this.nextConfig.experimental.ppr&&this.minimalMode?new Bi:void 0,data:this.enabledDirectories.pages?new mi(this.buildId):void 0,action:this.enabledDirectories.app&&this.minimalMode?new fi:void 0},this.nextFontManifest=this.getNextFontManifest(),this.renderOpts={supportsDynamicResponse:!0,trailingSlash:this.nextConfig.trailingSlash,deploymentId:this.nextConfig.deploymentId,strictNextHead:!!this.nextConfig.experimental.strictNextHead,poweredByHeader:this.nextConfig.poweredByHeader,canonicalBase:this.nextConfig.amp.canonicalBase||"",buildId:this.buildId,generateEtags:bi,previewProps:this.getPrerenderManifest().preview,customServer:er===!0||void 0,ampOptimizerConfig:(pe=this.nextConfig.experimental.amp)==null?void 0:pe.optimizer,basePath:this.nextConfig.basePath,images:this.nextConfig.images,optimizeFonts:this.nextConfig.optimizeFonts,fontManifest:this.nextConfig.optimizeFonts&&!St?this.getFontManifest():void 0,optimizeCss:this.nextConfig.experimental.optimizeCss,nextConfigOutput:this.nextConfig.output,nextScriptWorkers:this.nextConfig.experimental.nextScriptWorkers,disableOptimizedLoading:this.nextConfig.experimental.disableOptimizedLoading,domainLocales:(Re=this.nextConfig.i18n)==null?void 0:Re.domains,distDir:this.distDir,serverComponents:this.enabledDirectories.app,enableTainting:this.nextConfig.experimental.taint,crossOrigin:this.nextConfig.crossOrigin?this.nextConfig.crossOrigin:void 0,largePageDataBytes:this.nextConfig.experimental.largePageDataBytes,runtimeConfig:Object.keys(Kt).length>0?Kt:void 0,isExperimentalCompile:this.nextConfig.experimental.isExperimentalCompile,experimental:{ppr:this.enabledDirectories.app&&this.nextConfig.experimental.ppr===!0,missingSuspenseWithCSRBailout:this.nextConfig.experimental.missingSuspenseWithCSRBailout===!0,swrDelta:this.nextConfig.experimental.swrDelta}},this.pagesManifest=this.getPagesManifest(),this.appPathsManifest=this.getAppPathsManifest(),this.appPathRoutes=this.getAppPathRoutes(),this.interceptionRoutePatterns=this.getinterceptionRoutePatterns(),this.matchers=this.getRouteMatchers(),this.matchers.reload(),this.setAssetPrefix(Gr),this.responseCache=this.getResponseCache({dev:St})}reloadMatchers(){return this.matchers.reload()}getRouteMatchers(){let B=new Pa(pe=>{switch(pe){case R:return this.getPagesManifest()??null;case F:return this.getAppPathsManifest()??null;default:return null}}),le=new kr;return le.push(new ti(this.distDir,B,this.i18nProvider)),le.push(new pi(this.distDir,B,this.i18nProvider)),this.enabledDirectories.app&&(le.push(new Kr(this.distDir,B)),le.push(new mr(this.distDir,B))),le}logError(B){this.quiet||N.vU(B)}async handleRequest(B,le,pe){await this.prepare();let Re=B.method.toUpperCase(),Pe=Xr(B)?"RSC ":"",it=(0,$t.Yz)();return it.withPropagatedContext(B.headers,()=>it.trace(Qt._J.handleRequest,{spanName:`${Pe}${Re} ${B.url}`,kind:$t.MU.SERVER,attributes:{"http.method":Re,"http.target":B.url,"next.rsc":!!Pe}},async yt=>this.handleRequestImpl(B,le,pe).finally(()=>{if(!yt)return;yt.setAttributes({"http.status_code":le.statusCode});let St=it.getRootSpanAttributes();if(!St)return;if(St.get("next.span_type")!==Qt._J.handleRequest){console.warn(`Unexpected root span type '${St.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);return}let It=St.get("next.route");if(It){let er=`${Pe}${Re} ${It}`;yt.setAttributes({"next.route":It,"http.route":It,"next.span_name":er}),yt.updateName(er)}})))}async handleRequestImpl(B,le,pe){try{var Re,Pe,it,yt,St,It,er,qr,Zr,vi;await this.matchers.waitTillReady();let Ze=le.originalResponse||le,Kt=Ze.setHeader.bind(Ze);Ze.setHeader=(sr,vr)=>{if(!Ze.headersSent){if(sr.toLowerCase()==="set-cookie"){let Hr=(0,be.OX)(B,"middlewareCookie");Hr&&Array.isArray(vr)&&vr.every((sa,pa)=>sa===Hr[pa])||(vr=[...new Set([...Hr||[],...typeof vr=="string"?[vr]:Array.isArray(vr)?vr:[]])])}return Kt(sr,vr)}};let Gr=(B.url||"").split("?",1)[0];if(Gr?.match(/(\\|\/\/)/)){let sr=(0,x.U3)(B.url);le.redirect(sr,308).body(sr).send();return}if(!pe||typeof pe!="object"){if(!B.url)throw Error("Invariant: url can not be undefined");pe=(0,E.parse)(B.url,!0)}if(!pe.pathname)throw Error("Invariant: pathname can't be empty");typeof pe.query=="string"&&(pe.query=Object.fromEntries(new URLSearchParams(pe.query)));let{originalRequest:bi=B}=B,Wt=bi?.headers["x-forwarded-proto"],Fr=Wt?Wt==="https":!!(!(bi==null||(Re=bi.socket)==null)&&Re.encrypted);if(B.headers["x-forwarded-host"]??=B.headers.host??this.hostname,B.headers["x-forwarded-port"]??=this.port?this.port.toString():Fr?"443":"80",B.headers["x-forwarded-proto"]??=Fr?"https":"http",B.headers["x-forwarded-for"]??=(Pe=bi.socket)==null?void 0:Pe.remoteAddress,(it=this.i18nProvider)!=null&&it.validateQuery(pe.query)||(delete pe.query.__nextLocale,delete pe.query.__nextDefaultLocale,delete pe.query.__nextInferredLocaleFromDefault),this.attachRequestMeta(B,pe),this.minimalMode&&this.enabledDirectories.app&&await this.handleRSCRequest(B,le,pe))return;let Tr=(yt=this.i18nProvider)==null?void 0:yt.detectDomainLocale((0,Xe.F)(pe,B.headers)),Ei=Tr?.defaultLocale||((St=this.nextConfig.i18n)==null?void 0:St.defaultLocale);pe.query.__nextDefaultLocale=Ei;let wi=Ae(B.url.replace(/^\/+/,"/")),ci=(0,tt.a)(wi.pathname,{nextConfig:this.nextConfig,i18nProvider:this.i18nProvider});wi.pathname=ci.pathname,ci.basePath&&(B.url=(0,De.n)(B.url,this.nextConfig.basePath));let Ci=this.minimalMode&&typeof B.headers["x-matched-path"]=="string";if(Ci)try{this.enabledDirectories.app&&(B.url.match(/^\/index($|\?)/)&&(B.url=B.url.replace(/^\/index/,"/")),pe.pathname=pe.pathname==="/index"?"/":pe.pathname);let{pathname:sr}=new URL(B.headers["x-matched-path"],"http://localhost"),{pathname:vr}=new URL(B.url,"http://localhost");if((It=this.normalizers.data)!=null&&It.match(vr))pe.query.__nextDataReq="1";else if(((er=this.normalizers.postponed)==null?void 0:er.match(sr))&&B.method==="POST"){let Mr=[];for await(let Si of B.body)Mr.push(Si);let Ui=Yr.concat(Mr).toString("utf8");(0,be.kL)(B,"postponed",Ui),B.headers["x-now-route-matches"]||(vr=this.normalizers.postponed.normalize(sr,!0))}sr=this.normalize(sr);let Hr=this.stripNextDataPath(vr),sa=(qr=this.i18nProvider)==null?void 0:qr.analyze(sr,{defaultLocale:Ei});sa&&(pe.query.__nextLocale=sa.detectedLocale,sa.inferredFromDefault?pe.query.__nextInferredLocaleFromDefault="1":delete pe.query.__nextInferredLocaleFromDefault);let pa=sr=b(sr),Da=(0,Y.$)(pa);if(!Da){let Mr=await this.matchers.match(pa,{i18n:sa});Mr&&(pa=Mr.definition.pathname,Da=Mr.params!==void 0)}sa&&(sr=sa.pathname);let jr=function({page:Mr,i18n:Ui,basePath:Si,rewrites:oa,pageIsDynamic:_a,trailingSlash:Sn,caseSensitive:re}){let he,xe,Le;return _a&&(he=(0,K.JV)(Mr,!1),Le=(xe=(0,ve.t)(he))(Mr)),{handleRewrites:function(Ce,Ve){let Ue={},qe=Ve.pathname,We=Ke=>{let Je=ae(Ke.source+(Sn?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!re})(Ve.pathname);if((Ke.has||Ke.missing)&&Je){let vt=function(ft,Lt,Rt,ot){Rt===void 0&&(Rt=[]),ot===void 0&&(ot=[]);let Ot={},yr=Ie=>{let Bt,$e=Ie.key;switch(Ie.type){case"header":$e=$e.toLowerCase(),Bt=ft.headers[$e];break;case"cookie":Bt="cookies"in ft?ft.cookies[Ie.key]:ne(ft.headers)()[Ie.key];break;case"query":Bt=Lt[$e];break;case"host":{let{host:Nt}=ft?.headers||{};Bt=Nt?.split(":",1)[0].toLowerCase()}}if(!Ie.value&&Bt)return Ot[function(Nt){let Ft="";for(let or=0;or<Nt.length;or++){let tr=Nt.charCodeAt(or);(tr>64&&tr<91||tr>96&&tr<123)&&(Ft+=Nt[or])}return Ft}($e)]=Bt,!0;if(Bt){let Nt=RegExp("^"+Ie.value+"$"),Ft=Array.isArray(Bt)?Bt.slice(-1)[0].match(Nt):Bt.match(Nt);if(Ft)return Array.isArray(Ft)&&(Ft.groups?Object.keys(Ft.groups).forEach(or=>{Ot[or]=Ft.groups[or]}):Ie.type==="host"&&Ft[0]&&(Ot.host=Ft[0])),!0}return!1};return!!Rt.every(Ie=>yr(Ie))&&!ot.some(Ie=>yr(Ie))&&Ot}(Ce,Ve.query,Ke.has,Ke.missing);vt?Object.assign(Je,vt):Je=!1}if(Je){let{parsedDestination:vt,destQuery:ft}=function(Lt){let Rt,ot=Object.assign({},Lt.query);delete ot.__nextLocale,delete ot.__nextDefaultLocale,delete ot.__nextDataReq,delete ot.__nextInferredLocaleFromDefault,delete ot[Z.H4];let Ot=Lt.destination;for(let ir of Object.keys({...Lt.params,...ot}))Ot=Ot.replace(RegExp(":"+(0,ke.f)(ir),"g"),"__ESC_COLON_"+ir);let yr=Ae(Ot),Ie=yr.query,Bt=W(""+yr.pathname+(yr.hash||"")),$e=W(yr.hostname||""),Nt=[],Ft=[];(0,X.Bo)(Bt,Nt),(0,X.Bo)($e,Ft);let or=[];Nt.forEach(ir=>or.push(ir.name)),Ft.forEach(ir=>or.push(ir.name));let tr=(0,X.MY)(Bt,{validate:!1}),rr=(0,X.MY)($e,{validate:!1});for(let[ir,wr]of Object.entries(Ie))Array.isArray(wr)?Ie[ir]=wr.map(_r=>Q(W(_r),Lt.params)):typeof wr=="string"&&(Ie[ir]=Q(W(wr),Lt.params));let zt=Object.keys(Lt.params).filter(ir=>ir!=="nextInternalLocale");if(Lt.appendParamsToQuery&&!zt.some(ir=>or.includes(ir)))for(let ir of zt)ir in Ie||(Ie[ir]=Lt.params[ir]);if((0,_e.Ag)(Bt))for(let ir of Bt.split("/")){let wr=_e.Wz.find(_r=>ir.startsWith(_r));if(wr){Lt.params[0]=wr;break}}try{let[ir,wr]=(Rt=tr(Lt.params)).split("#",2);yr.hostname=rr(Lt.params),yr.pathname=ir,yr.hash=(wr?"#":"")+(wr||""),delete yr.search}catch(ir){throw ir.message.match(/Expected .*? to not repeat, but got an array/)?Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match"):ir}return yr.query={...ot,...yr.query},{newUrl:Rt,destQuery:Ie,parsedDestination:yr}}({appendParamsToQuery:!0,destination:Ke.destination,params:Je,query:Ve.query});if(vt.protocol)return!0;if(Object.assign(Ue,ft,Je),Object.assign(Ve.query,vt.query),delete vt.query,Object.assign(Ve,vt),qe=Ve.pathname,Si&&(qe=qe.replace(RegExp(`^${Si}`),"")||"/"),Ui){let Lt=(0,$.h)(qe,Ui.locales);qe=Lt.pathname,Ve.query.nextInternalLocale=Lt.detectedLocale||Je.nextInternalLocale}if(qe===Mr)return!0;if(_a&&xe){let Lt=xe(qe);if(Lt)return Ve.query={...Ve.query,...Lt},!0}}return!1};for(let Ke of oa.beforeFiles||[])We(Ke);if(qe!==Mr){let Ke=!1;for(let Je of oa.afterFiles||[])if(Ke=We(Je))break;if(!Ke&&!(()=>{let Je=(0,M.Q)(qe||"");return Je===(0,M.Q)(Mr)||xe?.(Je)})()){for(let Je of oa.fallback||[])if(Ke=We(Je))break}}return Ue},defaultRouteRegex:he,dynamicRouteMatcher:xe,defaultRouteMatches:Le,getParamsFromRouteMatches:function(Ce,Ve,Ue){return(0,ve.t)(function(){let{groups:qe,routeKeys:We}=he;return{re:{exec:Ke=>{let Je=Object.fromEntries(new URLSearchParams(Ke)),vt=Ui&&Ue&&Je[1]===Ue;for(let Rt of Object.keys(Je)){let ot=Je[Rt];Rt!==m.dN&&Rt.startsWith(m.dN)&&(Je[Rt.substring(m.dN.length)]=ot,delete Je[Rt])}let ft=Object.keys(We||{}),Lt=Rt=>{if(Ui){let ot=Array.isArray(Rt),Ot=ot?Rt[0]:Rt;if(typeof Ot=="string"&&Ui.locales.some(yr=>yr.toLowerCase()===Ot.toLowerCase()&&(Ue=yr,Ve.locale=Ue,!0)))return ot&&Rt.splice(0,1),!ot||Rt.length===0}return!1};return ft.every(Rt=>Je[Rt])?ft.reduce((Rt,ot)=>{let Ot=We?.[ot];return Ot&&!Lt(Je[ot])&&(Rt[qe[Ot].pos]=Je[ot]),Rt},{}):Object.keys(Je).reduce((Rt,ot)=>{if(!Lt(Je[ot])){let Ot=ot;return vt&&(Ot=parseInt(ot,10)-1+""),Object.assign(Rt,{[Ot]:Je[ot]})}return Rt},{})}},groups:qe}}())(Ce.headers["x-now-route-matches"])},normalizeDynamicRouteParams:(Ce,Ve)=>Ge(Ce,Ve,he,Le),normalizeVercelUrl:(Ce,Ve,Ue)=>ue(Ce,Ve,Ue,_a,he),interpolateDynamicPath:(Ce,Ve)=>ye(Ce,Ve,he)}}({pageIsDynamic:Da,page:pa,i18n:this.nextConfig.i18n,basePath:this.nextConfig.basePath,rewrites:((Zr=this.getRoutesManifest())==null?void 0:Zr.rewrites)||{beforeFiles:[],afterFiles:[],fallback:[]},caseSensitive:!!this.nextConfig.experimental.caseSensitiveRoutes});Ei&&!ci.locale&&(pe.pathname=`/${Ei}${pe.pathname}`);let Pn=pe.pathname,Ga=jr.handleRewrites(B,pe),rn=Object.keys(Ga),Ua=Pn!==pe.pathname;Ua&&pe.pathname&&(0,be.kL)(B,"rewroteURL",pe.pathname);let bn=new Set;for(let Mr of Object.keys(pe.query)){let Ui=pe.query[Mr];(0,Fi.LI)(Mr,Si=>{pe&&(pe.query[Si]=Ui,bn.add(Si),delete pe.query[Mr])})}if(Da){let Mr={},Ui=jr.normalizeDynamicRouteParams(pe.query);if(!Ui.hasValidParams&&Da&&!(0,Y.$)(Hr)){let Si=jr.dynamicRouteMatcher==null?void 0:jr.dynamicRouteMatcher.call(jr,Hr);Si&&(jr.normalizeDynamicRouteParams(Si),Object.assign(Ui.params,Si),Ui.hasValidParams=!0)}if(Ui.hasValidParams&&(Mr=Ui.params),B.headers["x-now-route-matches"]&&(0,Y.$)(sr)&&!Ui.hasValidParams){let Si={},oa=jr.getParamsFromRouteMatches(B,Si,pe.query.__nextLocale||"");Si.locale&&(pe.query.__nextLocale=Si.locale,delete pe.query.__nextInferredLocaleFromDefault),(Ui=jr.normalizeDynamicRouteParams(oa,!0)).hasValidParams&&(Mr=Ui.params)}Da&&jr.defaultRouteMatches&&Hr===pa&&!Ui.hasValidParams&&!jr.normalizeDynamicRouteParams({...Mr},!0).hasValidParams&&(Mr=jr.defaultRouteMatches),Mr&&(sr=jr.interpolateDynamicPath(pa,Mr),B.url=jr.interpolateDynamicPath(B.url,Mr))}for(let Mr of((Da||Ua)&&jr.normalizeVercelUrl(B,!0,[...rn,...Object.keys(((vi=jr.defaultRouteRegex)==null?void 0:vi.groups)||{})]),bn))delete pe.query[Mr];if(pe.pathname=sr,wi.pathname=pe.pathname,await this.normalizeAndAttachMetadata(B,le,pe))return}catch(sr){if(sr instanceof x._9||sr instanceof x.KM)return le.statusCode=400,this.renderError(null,B,le,"/_error",{});throw sr}if((0,be.kL)(B,"isLocaleDomain",!!Tr),ci.locale&&(B.url=(0,E.format)(wi),(0,be.kL)(B,"didStripLocale",!0)),this.minimalMode&&pe.query.__nextLocale||(ci.locale?pe.query.__nextLocale=ci.locale:Ei&&(pe.query.__nextLocale=Ei,pe.query.__nextInferredLocaleFromDefault="1")),!this.serverOptions.webServerConfig&&!(0,be.OX)(B,"incrementalCache")){let sr="https:";try{sr=new URL((0,be.OX)(B,"initURL")||"/","http://n").protocol}catch{}let vr=await this.getIncrementalCache({requestHeaders:Object.assign({},B.headers),requestProtocol:sr.substring(0,sr.length-1)});vr.resetRequestCache(),(0,be.kL)(B,"incrementalCache",vr),aa.__incrementalCache=vr}return(0,be.OX)(B,"invokePath"),!Ci&&ci.basePath&&(pe.pathname=(0,De.n)(pe.pathname,ci.basePath)),le.statusCode=200,await this.run(B,le,pe)}catch(Ze){if(Ze instanceof yi)throw Ze;if(Ze&&typeof Ze=="object"&&Ze.code==="ERR_INVALID_URL"||Ze instanceof x._9||Ze instanceof x.KM)return le.statusCode=400,this.renderError(null,B,le,"/_error",{});if(this.minimalMode||this.renderOpts.dev||Ze.bubble)throw Ze;this.logError(Qe(Ze)),le.statusCode=500,le.body("Internal Server Error").send()}}getRequestHandlerWithMetadata(B){let le=this.getRequestHandler();return(pe,Re,Pe)=>((0,be.lx)(pe,B),le(pe,Re,Pe))}getRequestHandler(){return this.handleRequest.bind(this)}setAssetPrefix(B){this.renderOpts.assetPrefix=B?B.replace(/\/$/,""):""}async prepare(){if(!this.prepared)return this.preparedPromise===null&&(this.preparedPromise=this.prepareImpl().then(()=>{this.prepared=!0,this.preparedPromise=null})),this.preparedPromise}async prepareImpl(){}async close(){}getAppPathRoutes(){let B={};return Object.keys(this.appPathsManifest||{}).forEach(le=>{let pe=(0,de.w)(le);B[pe]||(B[pe]=[]),B[pe].push(le)}),B}async run(B,le,pe){return(0,$t.Yz)().trace(Qt._J.run,async()=>this.runImpl(B,le,pe))}async runImpl(B,le,pe){await this.handleCatchallRenderRequest(B,le,pe)}async pipe(B,le){return(0,$t.Yz)().trace(Qt._J.pipe,async()=>this.pipeImpl(B,le))}async pipeImpl(B,le){let pe=(0,J.Q)(le.req.headers["user-agent"]||""),Re={...le,renderOpts:{...this.renderOpts,supportsDynamicResponse:!pe,isBot:!!pe}},Pe=await B(Re);if(Pe===null)return;let{req:it,res:yt}=Re,St=yt.statusCode,{body:It,type:er}=Pe,{revalidate:qr}=Pe;if(!yt.sent){let{generateEtags:Zr,poweredByHeader:vi,dev:Ze}=this.renderOpts;Ze&&(yt.setHeader("Cache-Control","no-store, must-revalidate"),qr=void 0),await this.sendRenderResult(it,yt,{result:It,type:er,generateEtags:Zr,poweredByHeader:vi,revalidate:qr,swrDelta:this.nextConfig.experimental.swrDelta}),yt.statusCode=St}}async getStaticHTML(B,le){let pe={...le,renderOpts:{...this.renderOpts,supportsDynamicResponse:!1}},Re=await B(pe);return Re===null?null:Re.body.toUnchunkedString()}async render(B,le,pe,Re={},Pe,it=!1){return(0,$t.Yz)().trace(Qt._J.render,async()=>this.renderImpl(B,le,pe,Re,Pe,it))}getWaitUntil(){let B=function(){let le=aa[k];return le?.get()}();if(B)return B.waitUntil}async renderImpl(B,le,pe,Re={},Pe,it=!1){var yt,St;return pe.startsWith("/")||console.warn(`Cannot render page with path "${pe}", did you mean "/${pe}"?. See more info here: https://nextjs.org/docs/messages/render-no-starting-slash`),this.renderOpts.customServer&&pe==="/index"&&!await this.hasPage("/index")&&(pe="/"),!it&&!this.minimalMode&&!Re.__nextDataReq&&(((yt=B.url)==null?void 0:yt.match(/^\/_next\//))||this.hasStaticDir&&B.url.match(/^\/static\//))?this.handleRequest(B,le,Pe):(St=pe,U.includes(St)?this.render404(B,le,Pe):this.pipe(It=>this.renderToResponse(It),{req:B,res:le,pathname:pe,query:Re}))}async getStaticPaths({pathname:B}){var le;let pe=(le=this.getPrerenderManifest().dynamicRoutes[B])==null?void 0:le.fallback;return{staticPaths:void 0,fallbackMode:typeof pe=="string"?"static":pe===null?"blocking":pe}}async renderToResponseWithComponents(B,le){return(0,$t.Yz)().trace(Qt._J.renderToResponseWithComponents,async()=>this.renderToResponseWithComponentsImpl(B,le))}pathCouldBeIntercepted(B){return(0,_e.Ag)(B)||this.interceptionRoutePatterns.some(le=>le.test(B))}setVaryHeader(B,le,pe,Re){let Pe=`${Z.A}, ${Z.ph}, ${Z.qw}`,it=Xr(B),yt=!1;pe&&this.pathCouldBeIntercepted(Re)?(le.setHeader("vary",`${Pe}, ${Z.TP}`),yt=!0):(pe||it)&&le.setHeader("vary",Pe),yt||delete B.headers[Z.TP]}async renderToResponseWithComponentsImpl({req:B,res:le,pathname:pe,renderOpts:Re},{components:Pe,query:it}){var yt,St,It,er,qr,Zr,vi;let Ze,Kt,Gr;pe===I&&(pe="/404");let bi=pe==="/_error",Wt=pe==="/404"||bi&&le.statusCode===404,Fr=pe==="/500"||bi&&le.statusCode===500,Tr=Pe.isAppPath===!0,Ei=!!Pe.getServerSideProps,wi=!!Pe.getStaticPaths,ci=(0,zr.x)(B),Ci=!!((yt=Pe.Component)!=null&&yt.getInitialProps),sr=!!Pe.getStaticProps,vr=(0,E.parse)(B.url||"").pathname||"/",Hr=(0,be.OX)(B,"rewroteURL")||vr;this.setVaryHeader(B,le,Tr,Hr);let sa=!1,pa=(0,Y.$)(Pe.page),Da=this.getPrerenderManifest();if(Tr&&pa){let We=await this.getStaticPaths({pathname:pe,page:Pe.page,isAppPath:Tr,requestHeaders:B.headers});if(Ze=We.staticPaths,sa=(Kt=We.fallbackMode)!==void 0,this.nextConfig.output==="export"){let Ke=Pe.page;if(Kt!=="static")throw Error(`Page "${Ke}" is missing exported function "generateStaticParams()", which is required with "output: export" config.`);let Je=(0,M.Q)(Hr);if(!Ze?.includes(Je))throw Error(`Page "${Ke}" is missing param "${Je}" in "generateStaticParams()", which is required with "output: export" config.`)}sa&&(wi=!0)}sa||Ze?.includes(Hr)||B.headers["x-now-route-matches"]?sr=!0:this.renderOpts.dev||(sr||=!!Da.routes[(0,Gi.w)(pe)]);let jr=!!(it.__nextDataReq||B.headers["x-nextjs-data"]&&this.serverOptions.webServerConfig)&&(sr||Ei),Pn=(B.headers[Z.qw.toLowerCase()]==="1"||(0,be.OX)(B,"isPrefetchRSCRequest"))??!1;if(!sr&&B.headers["x-middleware-prefetch"]&&!(Wt||pe==="/_error"))return le.setHeader("x-matched-path",pe),le.setHeader("x-middleware-skip","1"),le.setHeader("cache-control","private, no-cache, no-store, max-age=0, must-revalidate"),le.body("{}").send(),null;delete it.__nextDataReq,sr&&this.minimalMode&&B.headers["x-matched-path"]&&B.url.startsWith("/_next/data")&&(B.url=this.stripNextDataPath(B.url)),B.headers["x-nextjs-data"]&&(!le.statusCode||le.statusCode===200)&&le.setHeader("x-nextjs-matched-path",`${it.__nextLocale?`/${it.__nextLocale}`:""}${pe}`);let Ga=Xr(B),rn=(0,be.OX)(B,"postponed"),Ua=Re.experimental.ppr&&Ga&&!Pn;if(!Wt||jr||Ga||(le.statusCode=404),te.includes(pe)&&(le.statusCode=parseInt(pe.slice(1),10)),!ci&&!rn&&!Wt&&!Fr&&pe!=="/_error"&&B.method!=="HEAD"&&B.method!=="GET"&&(typeof Pe.Component=="string"||sr))return le.statusCode=405,le.setHeader("Allow",["GET","HEAD"]),await this.renderError(null,B,le,pe),null;if(typeof Pe.Component=="string")return{type:"html",body:j.Z.fromStatic(Pe.Component)};if(it.amp||delete it.amp,Re.supportsDynamicResponse===!0){let We=(0,J.Q)(B.headers["user-agent"]||""),Ke=typeof((qr=Pe.Document)==null?void 0:qr.getInitialProps)!="function"||"__NEXT_BUILTIN_DOCUMENT__"in Pe.Document;Re.supportsDynamicResponse=!sr&&!We&&!it.amp&&Ke,Re.isBot=We}!jr&&Tr&&Re.dev&&(Re.supportsDynamicResponse=!0);let bn=sr?(St=this.nextConfig.i18n)==null?void 0:St.defaultLocale:it.__nextDefaultLocale,Mr=it.__nextLocale,Ui=(It=this.nextConfig.i18n)==null?void 0:It.locales;Tr&&!Re.dev&&sr&&Ga&&!Ua&&(!((vi=Re.runtime)===m.Jp.experimentalEdge||vi===m.Jp.edge)||this.serverOptions.webServerConfig)&&Ai(B.headers);let Si=!1,oa=!1;sr&&({isOnDemandRevalidate:Si,revalidateOnlyGenerated:oa}=(0,q.Iq)(B,this.renderOpts.previewProps)),sr&&this.minimalMode&&B.headers["x-matched-path"]&&(Hr=vr),vr=(0,M.Q)(vr),Hr=(0,M.Q)(Hr),this.localeNormalizer&&(Hr=this.localeNormalizer.normalize(Hr)),jr&&(Hr=this.stripNextDataPath(Hr),vr=this.stripNextDataPath(vr));let _a=null;!sr||Re.supportsDynamicResponse||ci||rn||Ua||(_a=`${Mr?`/${Mr}`:""}${(pe==="/"||Hr==="/")&&Mr?"":Hr}${it.amp?".amp":""}`),(Wt||Fr)&&sr&&(_a=`${Mr?`/${Mr}`:""}${pe}${it.amp?".amp":""}`),_a&&(_a=(_a=_a.split("/").map(We=>{try{We=decodeURIComponent(We).replace(RegExp("([/#?]|%(2f|23|3f))","gi"),Ke=>encodeURIComponent(Ke))}catch{throw new x._9("failed to decode param")}return We}).join("/"))==="/index"&&pe==="/"?"/":_a);let Sn="https:";try{Sn=new URL((0,be.OX)(B,"initURL")||"/","http://n").protocol}catch{}let re=aa.__incrementalCache?aa.__incrementalCache:await this.getIncrementalCache({requestHeaders:Object.assign({},B.headers),requestProtocol:Sn.substring(0,Sn.length-1)});re?.resetRequestCache();let{routeModule:he}=Pe,xe=!!(this.nextConfig.experimental.ppr&&(this.renderOpts.dev||this.experimentalTestProxy)&&it.__nextppronly),Le=async({postponed:We})=>{let Ke,Je=!jr&&Re.dev===!0||!sr&&!wi||typeof We=="string"||Ua,vt=(0,E.parse)(B.url||"",!0).query;Re.params&&Object.keys(Re.params).forEach(Ie=>{delete vt[Ie]});let ft=vr!=="/"&&this.nextConfig.trailingSlash,Lt=(0,E.format)({pathname:`${Hr}${ft?"/":""}`,query:vt}),Rt={...Pe,...Re,...Tr?{incrementalCache:re,isRevalidate:sr&&!We&&!Ua,originalPathname:Pe.ComponentMod.originalPathname,serverActions:this.nextConfig.experimental.serverActions}:{},isNextDataRequest:jr,resolvedUrl:Lt,locale:Mr,locales:Ui,defaultLocale:bn,multiZoneDraftMode:this.nextConfig.experimental.multiZoneDraftMode,resolvedAsPath:Ei||Ci?(0,E.format)({pathname:`${vr}${ft?"/":""}`,query:vt}):Lt,supportsDynamicResponse:Je,isOnDemandRevalidate:Si,isDraftMode:!1,isServerAction:ci,postponed:We,builtInWaitUntil:this.getWaitUntil()};if(xe&&(Je=!1,Rt.nextExport=!0,Rt.supportsDynamicResponse=!1,Rt.isStaticGeneration=!0,Rt.isRevalidate=!0,Rt.isDebugPPRSkeleton=!0),he)if(he.definition.kind===s.APP_ROUTE){let Ie={params:Re.params,prerenderManifest:Da,renderOpts:{experimental:{ppr:!1},originalPathname:Pe.ComponentMod.originalPathname,supportsDynamicResponse:Je,incrementalCache:re,isRevalidate:sr,builtInWaitUntil:this.getWaitUntil()}};try{let Bt=_i.Og.fromBaseNextRequest(B,(0,_i.Ub)(le.originalResponse)),$e=await he.handle(Bt,Ie);return B.fetchMetrics=Ie.renderOpts.fetchMetrics,Ie.renderOpts.fetchTags,await ji(B,le,$e,Ie.renderOpts.waitUntil),null}catch(Bt){if(sr)throw Bt;return N.vU(Bt),await ji(B,le,new Response(null,{status:500})),null}}else if(he.definition.kind===s.PAGES)Rt.nextFontManifest=this.nextFontManifest,Rt.clientReferenceManifest=Pe.clientReferenceManifest,Ke=await he.render(B.originalRequest??B,le.originalResponse??le,{page:pe,params:Re.params,query:it,renderOpts:Rt});else if(he.definition.kind===s.APP_PAGE){let Ie=Pe.routeModule;Rt.nextFontManifest=this.nextFontManifest,Ke=await Ie.render(B.originalRequest??B,le.originalResponse??le,{page:Wt?"/404":pe,params:Re.params,query:it,renderOpts:Rt})}else throw Error("Invariant: Unknown route module type");else Ke=await this.renderHTML(B,le,pe,it,Rt);let{metadata:ot}=Ke,{headers:Ot={},fetchTags:yr}=ot;if(yr&&(Ot[m.Et]=yr),B.fetchMetrics=ot.fetchMetrics,Tr&&sr&&ot.revalidate===0&&!this.renderOpts.dev&&!Rt.experimental.ppr){let Ie=ot.staticBailoutInfo,Bt=Error(`Page changed from static to dynamic at runtime ${vr}${Ie?.description?`, reason: ${Ie.description}`:""}
see more here https://nextjs.org/docs/messages/app-static-to-dynamic-error`);if(Ie?.stack){let $e=Ie.stack;Bt.stack=Bt.message+$e.substring($e.indexOf(`
`))}throw Bt}return"isNotFound"in ot&&ot.isNotFound?{value:null,revalidate:ot.revalidate}:ot.isRedirect?{value:{kind:"REDIRECT",props:ot.pageData??ot.flightData},revalidate:ot.revalidate}:Ke.isNull?null:{value:{kind:"PAGE",html:Ke,pageData:ot.pageData??ot.flightData,postponed:ot.postponed,headers:Ot,status:Tr?le.statusCode:void 0},revalidate:ot.revalidate}},Ce=await this.responseCache.get(_a,async(We,Ke,Je)=>{if(this.renderOpts.dev,We||le.sent,Ze||({staticPaths:Ze,fallbackMode:Kt}=wi?await this.getStaticPaths({pathname:pe,requestHeaders:B.headers,isAppPath:Tr,page:Pe.page}):{staticPaths:void 0,fallbackMode:!1}),Kt==="static"&&(0,J.Q)(B.headers["user-agent"]||"")&&(Kt="blocking"),Si&&oa&&!Ke&&!this.minimalMode)return await this.render404(B,le),null;Ke?.isStale===-1&&(Si=!0),Si&&(Kt!==!1||Ke)&&(Kt="blocking");let vt=_a??(Re.dev&&Tr?Hr:null);vt&&it.amp&&(vt=vt.replace(/\.amp$/,"")),vt&&Ze?.includes(vt),this.nextConfig.experimental.isExperimentalCompile&&(Kt="blocking");let ft=await Le({postponed:Si||Je||!rn?void 0:rn});return ft?{...ft,revalidate:ft.revalidate}:null},{routeKind:he?.definition.kind,incrementalCache:re,isOnDemandRevalidate:Si,isPrefetch:B.headers.purpose==="prefetch"});if(!Ce){if(_a&&!(Si&&oa))throw Error("invariant: cache entry required but not generated");return null}let Ve=((er=Ce.value)==null?void 0:er.kind)==="PAGE"&&!!Ce.value.postponed;!sr||this.minimalMode||Ua||Ve&&!Pn||le.setHeader("x-nextjs-cache",Si?"REVALIDATED":Ce.isMiss?"MISS":Ce.isStale?"STALE":"HIT");let{value:Ue}=Ce;if(Ue?.kind==="IMAGE")throw Error("invariant SSG should not return an image cache value");if(rn)Gr=0;else if(this.minimalMode&&Ga&&!Pn&&Re.experimental.ppr)Gr=0;else if(!this.renderOpts.dev||Ei&&!jr)if(!Wt||jr)if(sr)if(Wt){let We=(0,be.OX)(B,"notFoundRevalidate");Gr=We===void 0?0:We}else if(Fr)Gr=0;else if(typeof Ce.revalidate=="number"){if(Ce.revalidate<1)throw Error(`Invariant: invalid Cache-Control duration provided: ${Ce.revalidate} < 1`);Gr=Ce.revalidate}else Ce.revalidate===!1&&(Gr=m.BR);else le.getHeader("Cache-Control")||(Gr=0);else Gr=0;Ce.revalidate=Gr;let qe=(0,be.OX)(B,"onCacheEntry");if(qe&&await qe(Ce,{url:(0,be.OX)(B,"initURL")}))return null;if(Ue){if(Ue.kind==="REDIRECT")return Ce.revalidate&&!le.getHeader("Cache-Control")&&le.setHeader("Cache-Control",se({revalidate:Ce.revalidate,swrDelta:this.nextConfig.experimental.swrDelta})),jr?{type:"json",body:j.Z.fromStatic(JSON.stringify(Ue.props)),revalidate:Ce.revalidate}:(await(We=>{let Ke={destination:We.pageProps.__N_REDIRECT,statusCode:We.pageProps.__N_REDIRECT_STATUS,basePath:We.pageProps.__N_REDIRECT_BASE_PATH},Je=f(Ke),{basePath:vt}=this.nextConfig;vt&&Ke.basePath!==!1&&Ke.destination.startsWith("/")&&(Ke.destination=`${vt}${Ke.destination}`),Ke.destination.startsWith("/")&&(Ke.destination=(0,x.U3)(Ke.destination)),le.redirect(Ke.destination,Je).body(Ke.destination).send()})(Ue.props),null);if(Ue.kind==="ROUTE"){let We={...Ue.headers};return this.minimalMode&&sr||delete We[m.Et],await ji(B,le,new Response(Ue.body,{headers:(0,Fi.EK)(We),status:Ue.status||200})),null}if(Tr){if(Ue.postponed&&rn)throw Error("Invariant: postponed state should not be present on a resume request");if(Ue.headers){let Je={...Ue.headers};for(let[vt,ft]of(this.minimalMode&&sr||delete Je[m.Et],Object.entries(Je)))if(ft!==void 0)if(Array.isArray(ft))for(let Lt of ft)le.appendHeader(vt,Lt);else typeof ft=="number"&&(ft=ft.toString()),le.appendHeader(vt,ft)}if(this.minimalMode&&sr&&((Zr=Ue.headers)==null?void 0:Zr[m.Et])&&le.setHeader(m.Et,Ue.headers[m.Et]),!Ue.status||Ga&&Re.experimental.ppr||(le.statusCode=Ue.status),Ue.postponed&&Ga&&le.setHeader(Z.VT,"1"),Ga){if(typeof Ue.pageData!="string"){if(Ue.postponed)throw Error("Invariant: Expected postponed to be undefined");return{type:"rsc",body:Ue.html,revalidate:Ua?0:Ce.revalidate}}return{type:"rsc",body:j.Z.fromStatic(Ue.pageData),revalidate:Ce.revalidate}}let We=Ue.html;if(!Ue.postponed||this.minimalMode)return{type:"html",body:We,revalidate:Ce.revalidate};if(xe)return{type:"html",body:We,revalidate:0};let Ke=new TransformStream;return We.chain(Ke.readable),Le({postponed:Ue.postponed}).then(async Je=>{var vt,ft;if(!Je)throw Error("Invariant: expected a result to be returned");if(((vt=Je.value)==null?void 0:vt.kind)!=="PAGE")throw Error(`Invariant: expected a page response, got ${(ft=Je.value)==null?void 0:ft.kind}`);await Je.value.html.pipeTo(Ke.writable)}).catch(Je=>{Ke.writable.abort(Je).catch(vt=>{console.error("couldn't abort transformer",vt)})}),{type:"html",body:We,revalidate:0}}else return jr?{type:"json",body:j.Z.fromStatic(JSON.stringify(Ue.pageData)),revalidate:Ce.revalidate}:{type:"html",body:Ue.html,revalidate:Ce.revalidate}}return(0,be.kL)(B,"notFoundRevalidate",Ce.revalidate),Ce.revalidate&&!le.getHeader("Cache-Control")&&le.setHeader("Cache-Control",se({revalidate:Ce.revalidate,swrDelta:this.nextConfig.experimental.swrDelta})),jr?(le.statusCode=404,le.body('{"notFound":true}').send()):(this.renderOpts.dev&&(it.__nextNotFoundSrcPage=pe),await this.render404(B,le,{pathname:pe,query:it},!1)),null}stripNextDataPath(B,le=!0){return B.includes(this.buildId)&&(B=b(B.substring(B.indexOf(this.buildId)+this.buildId.length).replace(/\.json$/,""))),this.localeNormalizer&&le?this.localeNormalizer.normalize(B):B}getOriginalAppPaths(B){if(this.enabledDirectories.app){var le;return((le=this.appPathRoutes)==null?void 0:le[B])||null}return null}async renderPageComponent(B,le){var pe,Re;let{query:Pe,pathname:it}=B,yt=this.getOriginalAppPaths(it),St=Array.isArray(yt),It=it;St&&(It=yt[yt.length-1]);let er=await this.findPageComponents({page:It,query:Pe,params:B.renderOpts.params||{},isAppPath:St,sriEnabled:!!((pe=this.nextConfig.experimental.sri)!=null&&pe.algorithm),appPaths:yt,shouldEnsure:!1});if(er){(Re=(0,$t.Yz)().getRootSpanAttributes())==null||Re.set("next.route",it);try{return await this.renderToResponseWithComponents(B,er)}catch(qr){let Zr=qr instanceof yi;if(!Zr||Zr&&le)throw qr}}return!1}async renderToResponse(B){return(0,$t.Yz)().trace(Qt._J.renderToResponse,{spanName:"rendering page",attributes:{"next.route":B.pathname}},async()=>this.renderToResponseImpl(B))}async renderToResponseImpl(B){var le;let{res:pe,query:Re,pathname:Pe}=B,it=!!Re._nextBubbleNoFallback;delete Re[Z.H4],delete Re._nextBubbleNoFallback;let yt={i18n:(le=this.i18nProvider)==null?void 0:le.fromQuery(Pe,Re)};try{for await(let St of this.matchers.matchAll(Pe,yt)){let It=(0,be.OX)(B.req,"invokeOutput");if(!this.minimalMode&&typeof It=="string"&&(0,Y.$)(It||"")&&It!==St.definition.pathname)continue;let er=await this.renderPageComponent({...B,pathname:St.definition.pathname,renderOpts:{...B.renderOpts,params:St.params}},it);if(er!==!1)return er}if(this.serverOptions.webServerConfig){B.pathname=this.serverOptions.webServerConfig.page;let St=await this.renderPageComponent(B,it);if(St!==!1)return St}}catch(St){let It=Qe(St);if(St instanceof x.At)throw console.error("Invariant: failed to load static page",JSON.stringify({page:Pe,url:B.req.url,matchedPath:B.req.headers["x-matched-path"],initUrl:(0,be.OX)(B.req,"initURL"),didRewrite:!!(0,be.OX)(B.req,"rewroteURL"),rewroteUrl:(0,be.OX)(B.req,"rewroteURL")},null,2)),It;if(It instanceof yi&&it)throw It;if(It instanceof x._9||It instanceof x.KM)return pe.statusCode=400,await this.renderErrorToResponse(B,It);pe.statusCode=500,await this.hasPage("/500")&&(B.query.__nextCustomErrorRender="1",await this.renderErrorToResponse(B,It),delete B.query.__nextCustomErrorRender);let er=It instanceof Na;if(!er){if(this.minimalMode,this.renderOpts.dev)throw Oe(It)&&(It.page=Pe),It;this.logError(Qe(It))}return await this.renderErrorToResponse(B,er?It.innerError:It)}return this.getMiddleware()&&B.req.headers["x-nextjs-data"]&&(!pe.statusCode||pe.statusCode===200||pe.statusCode===404)?(pe.setHeader("x-nextjs-matched-path",`${Re.__nextLocale?`/${Re.__nextLocale}`:""}${Pe}`),pe.statusCode=200,pe.setHeader("content-type","application/json"),pe.body("{}"),pe.send(),null):(pe.statusCode=404,this.renderErrorToResponse(B,null))}async renderToHTML(B,le,pe,Re={}){return(0,$t.Yz)().trace(Qt._J.renderToHTML,async()=>this.renderToHTMLImpl(B,le,pe,Re))}async renderToHTMLImpl(B,le,pe,Re={}){return this.getStaticHTML(Pe=>this.renderToResponse(Pe),{req:B,res:le,pathname:pe,query:Re})}async renderError(B,le,pe,Re,Pe={},it=!0){return(0,$t.Yz)().trace(Qt._J.renderError,async()=>this.renderErrorImpl(B,le,pe,Re,Pe,it))}async renderErrorImpl(B,le,pe,Re,Pe={},it=!0){return it&&pe.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate"),this.pipe(async yt=>{let St=await this.renderErrorToResponse(yt,B);if(this.minimalMode&&pe.statusCode===500)throw B;return St},{req:le,res:pe,pathname:Re,query:Pe})}async renderErrorToResponse(B,le){return(0,$t.Yz)().trace(Qt._J.renderErrorToResponse,async()=>this.renderErrorToResponseImpl(B,le))}async renderErrorToResponseImpl(B,le){if(this.renderOpts.dev&&B.pathname==="/favicon.ico")return{type:"html",body:j.Z.fromStatic("")};let{res:pe,query:Re}=B;try{let Pe=null;pe.statusCode===404&&(this.enabledDirectories.app&&(Pe=await this.findPageComponents({page:_,query:Re,params:{},isAppPath:!0,shouldEnsure:!0,url:B.req.url})),!Pe&&await this.hasPage("/404")&&(Pe=await this.findPageComponents({page:"/404",query:Re,params:{},isAppPath:!1,shouldEnsure:!0,url:B.req.url})));let it=`/${pe.statusCode}`;if(!B.query.__nextCustomErrorRender&&!Pe&&te.includes(it)&&(it!=="/500"||!this.renderOpts.dev)&&(Pe=await this.findPageComponents({page:it,query:Re,params:{},isAppPath:!1,shouldEnsure:!0,url:B.req.url})),Pe||(Pe=await this.findPageComponents({page:"/_error",query:Re,params:{},isAppPath:!1,shouldEnsure:!0,url:B.req.url}),it="/_error"),!Pe){if(this.renderOpts.dev)return{type:"html",body:j.Z.fromStatic(`
              <pre>missing required error components, refreshing...</pre>
              <script>
                async function check() {
                  const res = await fetch(location.href).catch(() => ({}))

                  if (res.status === 200) {
                    location.reload()
                  } else {
                    setTimeout(check, 1000)
                  }
                }
                check()
              <\/script>`)};throw new Na(Error("missing required error components"))}Pe.components.routeModule?(0,be.kL)(B.req,"match",{definition:Pe.components.routeModule.definition,params:void 0}):(0,be.d0)(B.req,"match");try{return await this.renderToResponseWithComponents({...B,pathname:it,renderOpts:{...B.renderOpts,err:le}},Pe)}catch(yt){throw yt instanceof yi?Error("invariant: failed to render error page"):yt}}catch(Pe){let it=Qe(Pe),yt=it instanceof Na;yt||this.logError(it),pe.statusCode=500;let St=await this.getFallbackErrorComponents(B.req.url);return St?((0,be.kL)(B.req,"match",{definition:St.routeModule.definition,params:void 0}),this.renderToResponseWithComponents({...B,pathname:"/_error",renderOpts:{...B.renderOpts,err:yt?it.innerError:it}},{query:Re,components:St})):{type:"html",body:j.Z.fromStatic("Internal Server Error")}}}async renderErrorToHTML(B,le,pe,Re,Pe={}){return this.getStaticHTML(it=>this.renderErrorToResponse(it,B),{req:le,res:pe,pathname:Re,query:Pe})}async render404(B,le,pe,Re=!0){let{pathname:Pe,query:it}=pe||(0,E.parse)(B.url,!0);return this.nextConfig.i18n&&(it.__nextLocale||=this.nextConfig.i18n.defaultLocale,it.__nextDefaultLocale||=this.nextConfig.i18n.defaultLocale),le.statusCode=404,this.renderError(null,B,le,Pe,it,Re)}}function Xr(lt){return lt.headers[Z.A.toLowerCase()]==="1"||!!(0,be.OX)(lt,"isRSCRequest")}let Hi=lt=>{let B=lt.length,le=0,pe=0,Re=8997,Pe=0,it=33826,yt=0,St=40164,It=0,er=52210;for(;le<B;)Re^=lt.charCodeAt(le++),pe=435*Re,Pe=435*it,yt=435*St,It=435*er,yt+=Re<<8,It+=it<<8,Pe+=pe>>>16,Re=65535&pe,yt+=Pe>>>16,it=65535&Pe,er=It+(yt>>>16)&65535,St=65535&yt;return(15&er)*281474976710656+4294967296*St+65536*it+(Re^er>>4)},ln=(lt,B=!1)=>(B?'W/"':'"')+Hi(lt).toString(36)+lt.length.toString(36)+'"';class dn{constructor(B){this.pendingResponses=new Map,Object.assign(this,{minimalMode:B})}get(B,le,pe){var Re;let Pe=B?`${B}-${pe.isOnDemandRevalidate?"1":"0"}`:null,it=Pe?this.pendingResponses.get(Pe):null;if(it)return it;let{promise:yt,resolve:St,reject:It}=new cr.Y;Pe&&this.pendingResponses.set(Pe,yt);let er=!1,qr=Zr=>{Pe&&this.pendingResponses.set(Pe,Promise.resolve(Zr)),er||(er=!0,St(Zr))};return Pe&&this.minimalMode&&((Re=this.previousCacheItem)==null?void 0:Re.key)===Pe&&this.previousCacheItem.expiresAt>Date.now()?(qr(this.previousCacheItem.entry),this.pendingResponses.delete(Pe)):(async()=>{try{let Zr=await le(er),vi=Zr===null?null:{...Zr,isMiss:!0};pe.isOnDemandRevalidate||qr(vi),B&&Zr&&Zr.revalidate!==void 0?this.previousCacheItem={key:Pe||B,entry:Zr,expiresAt:Date.now()+1e3}:this.previousCacheItem=void 0,pe.isOnDemandRevalidate&&qr(vi)}catch(Zr){er?console.error(Zr):It(Zr)}finally{Pe&&this.pendingResponses.delete(Pe)}})(),yt}}var un=u(95586);u(45158);let tn=new Set(["header","cookie","query","host"]),ss=/\(\?<([a-zA-Z][a-zA-Z0-9]*)>/g;var Wn=u(75471);class zn extends Fa{constructor(B){super(B),this.handleCatchallRenderRequest=async(le,pe,Re)=>{let{pathname:Pe,query:it}=Re;if(!Pe)throw Error("pathname is undefined");let yt=this.serverOptions.webServerConfig.pathname;if(Pe!==yt&&(Pe=yt,(0,Y.$)(Pe))){let It=(0,K.JV)(Pe,!1),er=(0,ve.t)(It)(Pe),qr=Ge(it,!1,It,er);Pe=ye(Pe,qr.hasValidParams?qr.params:it,It),ue(le,!0,Object.keys(It.routeKeys),!0,It)}if(Pe=(0,M.Q)(Pe),this.i18nProvider){let{detectedLocale:It}=await this.i18nProvider.analyze(Pe);It&&(Re.query.__nextLocale=It)}let St=!!it._nextBubbleNoFallback;Er(Pe)&&delete it._nextBubbleNoFallback;try{return await this.render(le,pe,Pe,it,Re,!0),!0}catch(It){if(It instanceof yi&&St)return!1;throw It}},Object.assign(this.renderOpts,B.webServerConfig.extendRenderOpts)}async getIncrementalCache({requestHeaders:B}){let le=!!this.renderOpts.dev;return new un.k({dev:le,requestHeaders:B,requestProtocol:"https",pagesDir:this.enabledDirectories.pages,appDir:this.enabledDirectories.app,allowedRevalidateHeaderKeys:this.nextConfig.experimental.allowedRevalidateHeaderKeys,minimalMode:this.minimalMode,fetchCache:!0,fetchCacheKeyPrefix:this.nextConfig.experimental.fetchCacheKeyPrefix,maxMemoryCacheSize:this.nextConfig.cacheMaxMemorySize,flushToDisk:!1,CurCacheHandler:this.serverOptions.webServerConfig.incrementalCacheHandler,getPrerenderManifest:()=>this.getPrerenderManifest(),experimental:{ppr:!1}})}getResponseCache(){return new dn(this.minimalMode)}async hasPage(B){return B===this.serverOptions.webServerConfig.page}getBuildId(){return this.serverOptions.webServerConfig.extendRenderOpts.buildId}getEnabledDirectories(){return{app:this.serverOptions.webServerConfig.pagesType==="app",pages:this.serverOptions.webServerConfig.pagesType==="pages"}}getPagesManifest(){return{[this.serverOptions.webServerConfig.pathname]:`server${this.serverOptions.webServerConfig.page}.js`}}getAppPathsManifest(){let B=this.serverOptions.webServerConfig.page;return{[this.serverOptions.webServerConfig.page]:`app${B}.js`}}attachRequestMeta(B,le){(0,be.kL)(B,"initQuery",{...le.query})}getPrerenderManifest(){return{version:-1,routes:{},dynamicRoutes:{},notFoundRoutes:[],preview:(0,Wn.X)()}}getNextFontManifest(){return this.serverOptions.webServerConfig.extendRenderOpts.nextFontManifest}renderHTML(B,le,pe,Re,Pe){let{renderToHTML:it}=this.serverOptions.webServerConfig;if(!it)throw Error("Invariant: routeModule should be configured when rendering pages");return pe===I&&(pe="/404"),it(B,le,pe,Re,Object.assign(Pe,{disableOptimizedLoading:!0,runtime:"experimental-edge"}))}async sendRenderResult(B,le,pe){let Re;if(le.setHeader("X-Edge-Runtime","1"),pe.poweredByHeader&&pe.type==="html"&&le.setHeader("X-Powered-By","Next.js"),le.getHeader("Content-Type")||le.setHeader("Content-Type",pe.result.contentType?pe.result.contentType:pe.type==="json"?"application/json":"text/html; charset=utf-8"),pe.result.isDynamic)Re=pe.result.pipeTo(le.transformStream.writable);else{let Pe=pe.result.toUnchunkedString();le.setHeader("Content-Length",String(new TextEncoder().encode(Pe).buffer.byteLength)),pe.generateEtags&&le.setHeader("ETag",ln(Pe)),le.body(Pe)}le.send(),Re&&await Re}async findPageComponents({page:B,query:le,params:pe,url:Re}){let Pe=await this.serverOptions.webServerConfig.loadComponent(B);return Pe?{query:{...le||{},...pe||{}},components:Pe}:null}async runApi(){return!0}async handleApiRequest(){return!1}loadEnvConfig(){}getPublicDir(){return""}getHasStaticDir(){return!1}async getFallback(){return""}getFontManifest(){}handleCompression(){}async handleUpgrade(){}async getFallbackErrorComponents(B){return null}getRoutesManifest(){}getMiddleware(){}getFilesystemPaths(){return new Set}async getPrefetchRsc(){return null}getinterceptionRoutePatterns(){var B;return((B=this.serverOptions.webServerConfig.interceptionRouteRewrites)==null?void 0:B.map(le=>new RegExp(function(pe,Re,Pe){let it=(0,X.Bo)(Re.source,[],{strict:!0,sensitive:!1,delimiter:"/"}).source;if(!Re.internal){var yt;it=it.replace(/\$$/,"(?:\\/)?$")}let St=it.replace(/\\\//g,"/");return pe!=="redirect"?{...Re,regex:St}:{...Re,statusCode:f(Re),permanent:void 0,regex:St}}("rewrite",le).regex)))??[]}}class vn{constructor(B,le,pe){this.method=B,this.url=le,this.body=pe}get cookies(){return this._cookies?this._cookies:this._cookies=ne(this.headers)()}}class In{constructor(B){this.destination=B}redirect(B,le){return this.setHeader("Location",B),this.statusCode=le,le===c.X.PermanentRedirect&&this.setHeader("Refresh",`0;url=${B}`),this}}class $n extends vn{constructor(B){let le=new URL(B.url);for(let[pe,Re]of(super(B.method,le.href.slice(le.origin.length),B.clone().body),this.request=B,this.fetchMetrics=B.fetchMetrics,this.headers={},B.headers.entries()))this.headers[pe]=Re}async parseBody(B){throw Error("parseBody is not implemented in the web runtime")}}class Ln extends In{constructor(B=new TransformStream){super(B.writable),this.transformStream=B,this.headers=new Headers,this.textBody=void 0,this.sendPromise=new cr.Y,this._sent=!1}setHeader(B,le){for(let pe of(this.headers.delete(B),Array.isArray(le)?le:[le]))this.headers.append(B,pe);return this}removeHeader(B){return this.headers.delete(B),this}getHeaderValues(B){var le;return(le=this.getHeader(B))==null?void 0:le.split(",").map(pe=>pe.trimStart())}getHeader(B){return this.headers.get(B)??void 0}getHeaders(){return(0,Fi.lb)(this.headers)}hasHeader(B){return this.headers.has(B)}appendHeader(B,le){return this.headers.append(B,le),this}body(B){return this.textBody=B,this}send(){this.sendPromise.resolve(),this._sent=!0}get sent(){return this._sent}async toResponse(){return this.sent||await this.sendPromise.promise,new Response(this.textBody??this.transformStream.readable,{headers:this.headers,status:this.statusCode,statusText:this.statusMessage})}}let Aa=Symbol.for("__next_internal_waitUntil__"),Yn=aa[Aa]||(aa[Aa]={waitUntilCounter:0,waitUntilResolve:void 0,waitUntilPromise:null});function jn({dev:lt,page:B,appMod:le,pageMod:pe,errorMod:Re,error500Mod:Pe,pagesType:it,Document:yt,buildManifest:St,reactLoadableManifest:It,interceptionRouteRewrites:er,renderToHTML:qr,clientReferenceManifest:Zr,subresourceIntegrityManifest:vi,serverActionsManifest:Ze,serverActions:Kt,config:Gr,buildId:bi,nextFontManifest:Wt,incrementalCacheHandler:Fr}){let Tr=it==="app",Ei={dev:lt,buildManifest:St,reactLoadableManifest:It,subresourceIntegrityManifest:vi,Document:yt,App:le?.default,clientReferenceManifest:Zr},wi=new zn({dev:lt,conf:Gr,minimalMode:!0,webServerConfig:{page:B,pathname:Tr?(0,de.w)(B):B,pagesType:it,interceptionRouteRewrites:er,extendRenderOpts:{buildId:bi,runtime:m.Jp.experimentalEdge,supportsDynamicResponse:!0,disableOptimizedLoading:!0,serverActionsManifest:Ze,serverActions:Kt,nextFontManifest:Wt},renderToHTML:qr,incrementalCacheHandler:Fr,loadComponent:async ci=>ci===B?{...Ei,Component:pe.default,pageConfig:pe.config||{},getStaticProps:pe.getStaticProps,getServerSideProps:pe.getServerSideProps,getStaticPaths:pe.getStaticPaths,ComponentMod:pe,isAppPath:!!pe.__next_app__,page:ci,routeModule:pe.routeModule}:ci==="/500"&&Pe?{...Ei,Component:Pe.default,pageConfig:Pe.config||{},getStaticProps:Pe.getStaticProps,getServerSideProps:Pe.getServerSideProps,getStaticPaths:Pe.getStaticPaths,ComponentMod:Pe,page:ci,routeModule:Pe.routeModule}:ci==="/_error"?{...Ei,Component:Re.default,pageConfig:Re.config||{},getStaticProps:Re.getStaticProps,getServerSideProps:Re.getServerSideProps,getStaticPaths:Re.getStaticPaths,ComponentMod:Re,page:ci,routeModule:Re.routeModule}:null}}).getRequestHandler();return async function(ci,Ci){let sr=new $n(ci),vr=new Ln;wi(sr,vr);let Hr=await vr.toResponse();if(Ci?.waitUntil){let sa=Yn.waitUntilPromise;sa&&Ci.waitUntil(sa)}return Hr}}},we.__chunk_3973=(ce,O,u)=>{var s;function x(){throw Error("Internal Error: do not use legacy react-dom/server APIs. If you encountered this error, please open an issue on the Next.js repo.")}s=u(8352),O.version=s.version,O.renderToReadableStream=s.renderToReadableStream,O.renderToNodeStream=s.renderToNodeStream,O.renderToStaticNodeStream=s.renderToStaticNodeStream,O.renderToString=x,O.renderToStaticMarkup=x,s.resume&&(O.resume=s.resume)},we.__chunk_67234=(ce,O,u)=>{"use strict";u.d(O,{O4:()=>g,ZK:()=>d,vU:()=>S});var s=u(45158);let x={wait:(0,s.ix)((0,s.Se)("\u25CB")),error:(0,s.Q6)((0,s.Se)("\u2A2F")),warn:(0,s.er)((0,s.Se)("\u26A0")),ready:"\u25B2",info:(0,s.ix)((0,s.Se)(" ")),event:(0,s.ek)((0,s.Se)("\u2713")),trace:(0,s.Ce)((0,s.Se)("\xBB"))},k={log:"log",warn:"warn",error:"error"};function E(c,...f){(f[0]===""||f[0]===void 0)&&f.length===1&&f.shift();let m=c in k?k[c]:"log",C=x[c];f.length===0?console[m](""):console[m](" "+C,...f)}function S(...c){E("error",...c)}function d(...c){E("warn",...c)}let o=new Set;function g(...c){o.has(c[0])||(o.add(c.join(" ")),d(...c))}},we.__chunk_47264=(ce,O,u)=>{"use strict";u.d(O,{UO:()=>s.UO,jD:()=>s.jD,lr:()=>s.lr,tv:()=>s.tv});var s=u(10079)},we.__chunk_277=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s.default});var s=u(84074)},we.__chunk_68827=ce=>{(()=>{"use strict";var O={328:k=>{k.exports=function(E){for(var S=5381,d=E.length;d;)S=33*S^E.charCodeAt(--d);return S>>>0}}},u={};function s(k){var E=u[k];if(E!==void 0)return E.exports;var S=u[k]={exports:{}},d=!0;try{O[k](S,S.exports,s),d=!1}finally{d&&delete u[k]}return S.exports}s.ab="//";var x=s(328);ce.exports=x})()},we.__chunk_20519=(ce,O,u)=>{"use strict";ce.exports=u(25263)},we.__chunk_24528=(ce,O,u)=>{"use strict";ce.exports=u(14993)},we.__chunk_14993=(ce,O)=>{"use strict";var u=Symbol.for("react.element"),s=Symbol.for("react.portal"),x=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),d=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),g=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),m=Symbol.iterator,C={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},I=Object.assign,_={};function R(Z,ne,W){this.props=Z,this.context=ne,this.refs=_,this.updater=W||C}function F(){}function L(Z,ne,W){this.props=Z,this.context=ne,this.refs=_,this.updater=W||C}R.prototype.isReactComponent={},R.prototype.setState=function(Z,ne){if(typeof Z!="object"&&typeof Z!="function"&&Z!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Z,ne,"setState")},R.prototype.forceUpdate=function(Z){this.updater.enqueueForceUpdate(this,Z,"forceUpdate")},F.prototype=R.prototype;var U=L.prototype=new F;U.constructor=L,I(U,R.prototype),U.isPureReactComponent=!0;var te=Array.isArray,Y={current:null},q={current:null},se={transition:null},J={ReactCurrentDispatcher:Y,ReactCurrentCache:q,ReactCurrentBatchConfig:se,ReactCurrentOwner:{current:null}},j=Object.prototype.hasOwnProperty,M=J.ReactCurrentOwner;function b(Z,ne,W){var Q,de={},ue=null,ye=null;if(ne!=null)for(Q in ne.ref!==void 0&&(ye=ne.ref),ne.key!==void 0&&(ue=""+ne.key),ne)j.call(ne,Q)&&Q!=="key"&&Q!=="ref"&&Q!=="__self"&&Q!=="__source"&&(de[Q]=ne[Q]);var Ge=arguments.length-2;if(Ge===1)de.children=W;else if(1<Ge){for(var Oe=Array(Ge),Qe=0;Qe<Ge;Qe++)Oe[Qe]=arguments[Qe+2];de.children=Oe}if(Z&&Z.defaultProps)for(Q in Ge=Z.defaultProps)de[Q]===void 0&&(de[Q]=Ge[Q]);return{$$typeof:u,type:Z,key:ue,ref:ye,props:de,_owner:M.current}}function N(Z){return typeof Z=="object"&&Z!==null&&Z.$$typeof===u}var $=/\/+/g;function X(Z,ne){var W,Q;return typeof Z=="object"&&Z!==null&&Z.key!=null?(W=""+Z.key,Q={"=":"=0",":":"=2"},"$"+W.replace(/[=:]/g,function(de){return Q[de]})):ne.toString(36)}function ae(){}function K(Z,ne,W){if(Z==null)return Z;var Q=[],de=0;return function ue(ye,Ge,Oe,Qe,be){var De,Xe,tt,Ct=typeof ye;(Ct==="undefined"||Ct==="boolean")&&(ye=null);var ct=!1;if(ye===null)ct=!0;else switch(Ct){case"string":case"number":ct=!0;break;case"object":switch(ye.$$typeof){case u:case s:ct=!0;break;case f:return ue((ct=ye._init)(ye._payload),Ge,Oe,Qe,be)}}if(ct)return be=be(ye),ct=Qe===""?"."+X(ye,0):Qe,te(be)?(Oe="",ct!=null&&(Oe=ct.replace($,"$&/")+"/"),ue(be,Ge,Oe,"",function(mt){return mt})):be!=null&&(N(be)&&(De=be,Xe=Oe+(!be.key||ye&&ye.key===be.key?"":(""+be.key).replace($,"$&/")+"/")+ct,be={$$typeof:u,type:De.type,key:Xe,ref:De.ref,props:De.props,_owner:De._owner}),Ge.push(be)),1;ct=0;var Tt=Qe===""?".":Qe+":";if(te(ye))for(var Dt=0;Dt<ye.length;Dt++)Ct=Tt+X(Qe=ye[Dt],Dt),ct+=ue(Qe,Ge,Oe,Ct,be);else if(typeof(Dt=(tt=ye)===null||typeof tt!="object"?null:typeof(tt=m&&tt[m]||tt["@@iterator"])=="function"?tt:null)=="function")for(ye=Dt.call(ye),Dt=0;!(Qe=ye.next()).done;)Ct=Tt+X(Qe=Qe.value,Dt++),ct+=ue(Qe,Ge,Oe,Ct,be);else if(Ct==="object"){if(typeof ye.then=="function")return ue(function(mt){switch(mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason;default:switch(typeof mt.status=="string"?mt.then(ae,ae):(mt.status="pending",mt.then(function(cr){mt.status==="pending"&&(mt.status="fulfilled",mt.value=cr)},function(cr){mt.status==="pending"&&(mt.status="rejected",mt.reason=cr)})),mt.status){case"fulfilled":return mt.value;case"rejected":throw mt.reason}}throw mt}(ye),Ge,Oe,Qe,be);throw Error("Objects are not valid as a React child (found: "+((Ge=String(ye))==="[object Object]"?"object with keys {"+Object.keys(ye).join(", ")+"}":Ge)+"). If you meant to render a collection of children, use an array instead.")}return ct}(Z,Q,"","",function(ue){return ne.call(W,ue,de++)}),Q}function ve(Z){if(Z._status===-1){var ne=Z._result;(ne=ne()).then(function(W){(Z._status===0||Z._status===-1)&&(Z._status=1,Z._result=W)},function(W){(Z._status===0||Z._status===-1)&&(Z._status=2,Z._result=W)}),Z._status===-1&&(Z._status=0,Z._result=ne)}if(Z._status===1)return Z._result.default;throw Z._result}function ke(){return new WeakMap}function fe(){return{s:0,v:void 0,o:null,p:null}}function Ae(){}var _e=typeof reportError=="function"?reportError:function(Z){console.error(Z)};O.Children={map:K,forEach:function(Z,ne,W){K(Z,function(){ne.apply(this,arguments)},W)},count:function(Z){var ne=0;return K(Z,function(){ne++}),ne},toArray:function(Z){return K(Z,function(ne){return ne})||[]},only:function(Z){if(!N(Z))throw Error("React.Children.only expected to receive a single React element child.");return Z}},O.Component=R,O.Fragment=x,O.Profiler=E,O.PureComponent=L,O.StrictMode=k,O.Suspense=g,O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,O.act=function(){throw Error("act(...) is not supported in production builds of React.")},O.cache=function(Z){return function(){var ne=q.current;if(!ne)return Z.apply(null,arguments);var W=ne.getCacheForType(ke);(ne=W.get(Z))===void 0&&(ne=fe(),W.set(Z,ne)),W=0;for(var Q=arguments.length;W<Q;W++){var de=arguments[W];if(typeof de=="function"||typeof de=="object"&&de!==null){var ue=ne.o;ue===null&&(ne.o=ue=new WeakMap),(ne=ue.get(de))===void 0&&(ne=fe(),ue.set(de,ne))}else(ue=ne.p)===null&&(ne.p=ue=new Map),(ne=ue.get(de))===void 0&&(ne=fe(),ue.set(de,ne))}if(ne.s===1)return ne.v;if(ne.s===2)throw ne.v;try{var ye=Z.apply(null,arguments);return(W=ne).s=1,W.v=ye}catch(Ge){throw(ye=ne).s=2,ye.v=Ge,Ge}}},O.cloneElement=function(Z,ne,W){if(Z==null)throw Error("The argument must be a React element, but you passed "+Z+".");var Q=I({},Z.props),de=Z.key,ue=Z.ref,ye=Z._owner;if(ne!=null){if(ne.ref!==void 0&&(ue=ne.ref,ye=M.current),ne.key!==void 0&&(de=""+ne.key),Z.type&&Z.type.defaultProps)var Ge=Z.type.defaultProps;for(Oe in ne)j.call(ne,Oe)&&Oe!=="key"&&Oe!=="ref"&&Oe!=="__self"&&Oe!=="__source"&&(Q[Oe]=ne[Oe]===void 0&&Ge!==void 0?Ge[Oe]:ne[Oe])}var Oe=arguments.length-2;if(Oe===1)Q.children=W;else if(1<Oe){Ge=Array(Oe);for(var Qe=0;Qe<Oe;Qe++)Ge[Qe]=arguments[Qe+2];Q.children=Ge}return{$$typeof:u,type:Z.type,key:de,ref:ue,props:Q,_owner:ye}},O.createContext=function(Z){return(Z={$$typeof:d,_currentValue:Z,_currentValue2:Z,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:S,_context:Z},Z.Consumer=Z},O.createElement=b,O.createFactory=function(Z){var ne=b.bind(null,Z);return ne.type=Z,ne},O.createRef=function(){return{current:null}},O.forwardRef=function(Z){return{$$typeof:o,render:Z}},O.isValidElement=N,O.lazy=function(Z){return{$$typeof:f,_payload:{_status:-1,_result:Z},_init:ve}},O.memo=function(Z,ne){return{$$typeof:c,type:Z,compare:ne===void 0?null:ne}},O.startTransition=function(Z){var ne=se.transition,W=new Set;se.transition={_callbacks:W};var Q=se.transition;try{var de=Z();typeof de=="object"&&de!==null&&typeof de.then=="function"&&(W.forEach(function(ue){return ue(Q,de)}),de.then(Ae,_e))}catch(ue){_e(ue)}finally{se.transition=ne}},O.unstable_useCacheRefresh=function(){return Y.current.useCacheRefresh()},O.use=function(Z){return Y.current.use(Z)},O.useCallback=function(Z,ne){return Y.current.useCallback(Z,ne)},O.useContext=function(Z){return Y.current.useContext(Z)},O.useDebugValue=function(){},O.useDeferredValue=function(Z,ne){return Y.current.useDeferredValue(Z,ne)},O.useEffect=function(Z,ne){return Y.current.useEffect(Z,ne)},O.useId=function(){return Y.current.useId()},O.useImperativeHandle=function(Z,ne,W){return Y.current.useImperativeHandle(Z,ne,W)},O.useInsertionEffect=function(Z,ne){return Y.current.useInsertionEffect(Z,ne)},O.useLayoutEffect=function(Z,ne){return Y.current.useLayoutEffect(Z,ne)},O.useMemo=function(Z,ne){return Y.current.useMemo(Z,ne)},O.useOptimistic=function(Z,ne){return Y.current.useOptimistic(Z,ne)},O.useReducer=function(Z,ne,W){return Y.current.useReducer(Z,ne,W)},O.useRef=function(Z){return Y.current.useRef(Z)},O.useState=function(Z){return Y.current.useState(Z)},O.useSyncExternalStore=function(Z,ne,W){return Y.current.useSyncExternalStore(Z,ne,W)},O.useTransition=function(){return Y.current.useTransition()},O.version="18.3.0-canary-178c267a4e-20241218"},we.__chunk_25263=(ce,O,u)=>{"use strict";var s=u(24528),x=Symbol.for("react.element"),k=Symbol.for("react.fragment"),E=Object.prototype.hasOwnProperty,S=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner;function d(o,g,c){var f,m={},C=null,I=null;for(f in c!==void 0&&(C=""+c),g.key!==void 0&&(C=""+g.key),g.ref!==void 0&&(I=g.ref),g)E.call(g,f)&&f!=="key"&&f!=="ref"&&(m[f]=g[f]);if(o&&o.defaultProps)for(f in g=o.defaultProps)m[f]===void 0&&(m[f]=g[f]);return{$$typeof:x,type:o,key:C,ref:I,props:m,_owner:S.current}}O.Fragment=k,O.jsx=d,O.jsxs=d},we.__chunk_52719=(ce,O,u)=>{"use strict";ce.exports=u(91254)},we.__chunk_91254=(ce,O,u)=>{"use strict";var s=u(85192),x={stream:!0},k=new Map;function E(W){var Q=aa.__next_require__(W);return typeof Q.then!="function"||Q.status==="fulfilled"?null:(Q.then(function(de){Q.status="fulfilled",Q.value=de},function(de){Q.status="rejected",Q.reason=de}),Q)}function S(){}var d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Dispatcher,o=Symbol.for("react.element"),g=Symbol.for("react.lazy"),c=Symbol.iterator,f=Array.isArray,m=Object.getPrototypeOf,C=Object.prototype,I=new WeakMap;function _(W,Q,de,ue){var ye=1,Ge=0,Oe=null;W=JSON.stringify(W,function Qe(be,De){if(De===null)return null;if(typeof De=="object"){if(typeof De.then=="function"){Oe===null&&(Oe=new FormData),Ge++;var Xe,tt,Ct=ye++;return De.then(function(Dt){Dt=JSON.stringify(Dt,Qe);var mt=Oe;mt.append(Q+Ct,Dt),--Ge==0&&de(mt)},function(Dt){ue(Dt)}),"$@"+Ct.toString(16)}if(f(De))return De;if(De instanceof FormData){Oe===null&&(Oe=new FormData);var ct=Oe,Tt=Q+(be=ye++)+"_";return De.forEach(function(Dt,mt){ct.append(Tt+mt,Dt)}),"$K"+be.toString(16)}if(De instanceof Map)return De=JSON.stringify(Array.from(De),Qe),Oe===null&&(Oe=new FormData),be=ye++,Oe.append(Q+be,De),"$Q"+be.toString(16);if(De instanceof Set)return De=JSON.stringify(Array.from(De),Qe),Oe===null&&(Oe=new FormData),be=ye++,Oe.append(Q+be,De),"$W"+be.toString(16);if(!((tt=De)===null||typeof tt!="object")&&(typeof(tt=c&&tt[c]||tt["@@iterator"])=="function"?tt:null))return Array.from(De);if((be=m(De))!==C&&(be===null||m(be)!==null))throw Error("Only plain objects, and a few built-ins, can be passed to Server Actions. Classes or null prototypes are not supported.");return De}if(typeof De=="string")return De[De.length-1]==="Z"&&this[be]instanceof Date?"$D"+De:De=De[0]==="$"?"$"+De:De;if(typeof De=="boolean")return De;if(typeof De=="number")return Number.isFinite(Xe=De)?Xe===0&&1/Xe==-1/0?"$-0":Xe:Xe===1/0?"$Infinity":Xe===-1/0?"$-Infinity":"$NaN";if(De===void 0)return"$undefined";if(typeof De=="function"){if((De=I.get(De))!==void 0)return De=JSON.stringify(De,Qe),Oe===null&&(Oe=new FormData),be=ye++,Oe.set(Q+be,De),"$F"+be.toString(16);throw Error("Client Functions cannot be passed directly to Server Functions. Only Functions passed from the Server can be passed back again.")}if(typeof De=="symbol"){if(Symbol.for(be=De.description)!==De)throw Error("Only global symbols received from Symbol.for(...) can be passed to Server Functions. The symbol Symbol.for("+De.description+") cannot be found among global symbols.");return"$S"+be}if(typeof De=="bigint")return"$n"+De.toString(10);throw Error("Type "+typeof De+" is not supported as an argument to a Server Function.")}),Oe===null?de(W):(Oe.set(Q+"0",W),Ge===0&&de(Oe))}var R=new WeakMap;function F(W){var Q=I.get(this);if(!Q)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var de=null;if(Q.bound!==null){if((de=R.get(Q))||(ue=Q,Oe=new Promise(function(be,De){ye=be,Ge=De}),_(ue,"",function(be){if(typeof be=="string"){var De=new FormData;De.append("0",be),be=De}Oe.status="fulfilled",Oe.value=be,ye(be)},function(be){Oe.status="rejected",Oe.reason=be,Ge(be)}),de=Oe,R.set(Q,de)),de.status==="rejected")throw de.reason;if(de.status!=="fulfilled")throw de;Q=de.value;var ue,ye,Ge,Oe,Qe=new FormData;Q.forEach(function(be,De){Qe.append("$ACTION_"+W+":"+De,be)}),de=Qe,Q="$ACTION_REF_"+W}else Q="$ACTION_ID_"+Q.id;return{name:Q,method:"POST",encType:"multipart/form-data",data:de}}function L(W,Q){var de=I.get(this);if(!de)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");if(de.id!==W)return!1;var ue=de.bound;if(ue===null)return Q===0;switch(ue.status){case"fulfilled":return ue.value.length===Q;case"pending":throw ue;case"rejected":throw ue.reason;default:throw typeof ue.status!="string"&&(ue.status="pending",ue.then(function(ye){ue.status="fulfilled",ue.value=ye},function(ye){ue.status="rejected",ue.reason=ye})),ue}}function U(W,Q,de){Object.defineProperties(W,{$$FORM_ACTION:{value:de===void 0?F:function(){var ue=I.get(this);if(!ue)throw Error("Tried to encode a Server Action from a different instance than the encoder is from. This is a bug in React.");var ye=ue.bound;return ye===null&&(ye=Promise.resolve([])),de(ue.id,ye)}},$$IS_SIGNATURE_EQUAL:{value:L},bind:{value:q}}),I.set(W,Q)}var te=Function.prototype.bind,Y=Array.prototype.slice;function q(){var W=te.apply(this,arguments),Q=I.get(this);if(Q){var de=Y.call(arguments,1),ue=null;ue=Q.bound!==null?Promise.resolve(Q.bound).then(function(ye){return ye.concat(de)}):Promise.resolve(de),Object.defineProperties(W,{$$FORM_ACTION:{value:this.$$FORM_ACTION},$$IS_SIGNATURE_EQUAL:{value:L},bind:{value:q}}),I.set(W,{id:Q.id,bound:ue})}return W}function se(W,Q,de,ue){this.status=W,this.value=Q,this.reason=de,this._response=ue}function J(W){switch(W.status){case"resolved_model":ae(W);break;case"resolved_module":K(W)}switch(W.status){case"fulfilled":return W.value;case"pending":case"blocked":case"cyclic":throw W;default:throw W.reason}}function j(W,Q){for(var de=0;de<W.length;de++)(0,W[de])(Q)}function M(W,Q,de){switch(W.status){case"fulfilled":j(Q,W.value);break;case"pending":case"blocked":case"cyclic":W.value=Q,W.reason=de;break;case"rejected":de&&j(de,W.reason)}}function b(W,Q){if(W.status==="pending"||W.status==="blocked"){var de=W.reason;W.status="rejected",W.reason=Q,de!==null&&j(de,Q)}}function N(W,Q){if(W.status==="pending"||W.status==="blocked"){var de=W.value,ue=W.reason;W.status="resolved_module",W.value=Q,de!==null&&(K(W),M(W,de,ue))}}se.prototype=Object.create(Promise.prototype),se.prototype.then=function(W,Q){switch(this.status){case"resolved_model":ae(this);break;case"resolved_module":K(this)}switch(this.status){case"fulfilled":W(this.value);break;case"pending":case"blocked":case"cyclic":W&&(this.value===null&&(this.value=[]),this.value.push(W)),Q&&(this.reason===null&&(this.reason=[]),this.reason.push(Q));break;default:Q(this.reason)}};var $=null,X=null;function ae(W){var Q=$,de=X;$=W,X=null;var ue=W.value;W.status="cyclic",W.value=null,W.reason=null;try{var ye=JSON.parse(ue,W._response._fromJSON);if(X!==null&&0<X.deps)X.value=ye,W.status="blocked",W.value=null,W.reason=null;else{var Ge=W.value;W.status="fulfilled",W.value=ye,Ge!==null&&j(Ge,ye)}}catch(Oe){W.status="rejected",W.reason=Oe}finally{$=Q,X=de}}function K(W){try{var Q=W.value,de=aa.__next_require__(Q[0]);if(Q.length===4&&typeof de.then=="function")if(de.status==="fulfilled")de=de.value;else throw de.reason;var ue=Q[2]==="*"?de:Q[2]===""?de.__esModule?de.default:de:de[Q[2]];W.status="fulfilled",W.value=ue}catch(ye){W.status="rejected",W.reason=ye}}function ve(W,Q){W._chunks.forEach(function(de){de.status==="pending"&&b(de,Q)})}function ke(W,Q){var de=W._chunks,ue=de.get(Q);return ue||(ue=new se("pending",null,null,W),de.set(Q,ue)),ue}function fe(W,Q){if((W=ke(W,Q)).status==="resolved_model"&&ae(W),W.status==="fulfilled")return W.value;throw W.reason}function Ae(){throw Error('Trying to call a function from "use server" but the callServer option was not implemented in your router runtime.')}function _e(){throw Error("Server Functions cannot be called during initial render. This would create a fetch waterfall. Try to use a Server Component to pass data to Client Components instead.")}function Z(W){var Q,de=W.ssrManifest.moduleMap;return(de={_bundlerConfig:de,_moduleLoading:W.ssrManifest.moduleLoading,_callServer:_e!==void 0?_e:Ae,_encodeFormAction:W.encodeFormAction,_nonce:W=typeof W.nonce=="string"?W.nonce:void 0,_chunks:new Map,_stringDecoder:new TextDecoder,_fromJSON:null,_rowState:0,_rowID:0,_rowTag:0,_rowLength:0,_buffer:[]})._fromJSON=(Q=de,function(ue,ye){return typeof ye=="string"?function(Ge,Oe,Qe,be){if(be[0]==="$"){if(be==="$")return o;switch(be[1]){case"$":return be.slice(1);case"L":return{$$typeof:g,_payload:Ge=ke(Ge,Oe=parseInt(be.slice(2),16)),_init:J};case"@":return be.length===2?new Promise(function(){}):ke(Ge,Oe=parseInt(be.slice(2),16));case"S":return Symbol.for(be.slice(2));case"F":return Oe=fe(Ge,Oe=parseInt(be.slice(2),16)),function(Xe,tt){function Ct(){var Tt=Array.prototype.slice.call(arguments),Dt=tt.bound;return Dt?Dt.status==="fulfilled"?ct(tt.id,Dt.value.concat(Tt)):Promise.resolve(Dt).then(function(mt){return ct(tt.id,mt.concat(Tt))}):ct(tt.id,Tt)}var ct=Xe._callServer;return U(Ct,tt,Xe._encodeFormAction),Ct}(Ge,Oe);case"Q":return new Map(Ge=fe(Ge,Oe=parseInt(be.slice(2),16)));case"W":return new Set(Ge=fe(Ge,Oe=parseInt(be.slice(2),16)));case"I":return 1/0;case"-":return be==="$-0"?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(be.slice(2)));case"n":return BigInt(be.slice(2));default:switch((Ge=ke(Ge,be=parseInt(be.slice(1),16))).status){case"resolved_model":ae(Ge);break;case"resolved_module":K(Ge)}switch(Ge.status){case"fulfilled":return Ge.value;case"pending":case"blocked":case"cyclic":var De;return be=$,Ge.then(function(Xe,tt,Ct,ct){if(X){var Tt=X;ct||Tt.deps++}else Tt=X={deps:ct?0:1,value:null};return function(Dt){tt[Ct]=Dt,Tt.deps--,Tt.deps===0&&Xe.status==="blocked"&&(Dt=Xe.value,Xe.status="fulfilled",Xe.value=Tt.value,Dt!==null&&j(Dt,Tt.value))}}(be,Oe,Qe,Ge.status==="cyclic"),(De=be,function(Xe){return b(De,Xe)})),null;default:throw Ge.reason}}}return be}(Q,this,ue,ye):typeof ye=="object"&&ye!==null?ue=ye[0]===o?{$$typeof:o,type:ye[1],key:ye[2],ref:null,props:ye[3],_owner:null}:ye:ye}),de}function ne(W,Q){function de(ye){ve(W,ye)}var ue=Q.getReader();ue.read().then(function ye(Ge){var Oe=Ge.value;if(Ge.done)ve(W,Error("Connection closed."));else{var Qe=0,be=W._rowState,De=W._rowID,Xe=W._rowTag,tt=W._rowLength;Ge=W._buffer;for(var Ct=Oe.length;Qe<Ct;){var ct=-1;switch(be){case 0:(ct=Oe[Qe++])===58?be=1:De=De<<4|(96<ct?ct-87:ct-48);continue;case 1:(be=Oe[Qe])===84?(Xe=be,be=2,Qe++):64<be&&91>be?(Xe=be,be=3,Qe++):(Xe=0,be=3);continue;case 2:(ct=Oe[Qe++])===44?be=4:tt=tt<<4|(96<ct?ct-87:ct-48);continue;case 3:ct=Oe.indexOf(10,Qe);break;case 4:(ct=Qe+tt)>Oe.length&&(ct=-1)}var Tt=Oe.byteOffset+Qe;if(-1<ct){Qe=new Uint8Array(Oe.buffer,Tt,ct-Qe),tt=W,Tt=Xe;var Dt=tt._stringDecoder;Xe="";for(var mt=0;mt<Ge.length;mt++)Xe+=Dt.decode(Ge[mt],x);switch(Xe+=Dt.decode(Qe),Tt){case 73:(function(cr,kr,Ht){var Or=cr._chunks,fr=Or.get(kr);Ht=JSON.parse(Ht,cr._fromJSON);var Oi=function(At,Pr){if(At){var hr=At[Pr[0]];if(At=hr[Pr[2]])hr=At.name;else{if(!(At=hr["*"]))throw Error('Could not find the module "'+Pr[0]+'" in the React SSR Manifest. This is probably a bug in the React Server Components bundler.');hr=Pr[2]}return Pr.length===4?[At.id,At.chunks,hr,1]:[At.id,At.chunks,hr]}return Pr}(cr._bundlerConfig,Ht);if(function(At,Pr,hr){if(At!==null)for(var gr=1;gr<Pr.length;gr+=2){var Jt=d.current;if(Jt){var Ir=Jt.preinitScript,ea=At.prefix+Pr[gr],ki=At.crossOrigin;ki=typeof ki=="string"?ki==="use-credentials"?ki:"":void 0,Ir.call(Jt,ea,{crossOrigin:ki,nonce:hr})}}}(cr._moduleLoading,Ht[1],cr._nonce),Ht=function(At){for(var Pr=At[1],hr=[],gr=0;gr<Pr.length;){var Jt=Pr[gr++];Pr[gr++];var Ir=k.get(Jt);if(Ir===void 0){Ir=u.e(Jt),hr.push(Ir);var ea=k.set.bind(k,Jt,null);Ir.then(ea,S),k.set(Jt,Ir)}else Ir!==null&&hr.push(Ir)}return At.length===4?hr.length===0?E(At[0]):Promise.all(hr).then(function(){return E(At[0])}):0<hr.length?Promise.all(hr):null}(Oi)){if(fr){var li=fr;li.status="blocked"}else li=new se("blocked",null,null,cr),Or.set(kr,li);Ht.then(function(){return N(li,Oi)},function(At){return b(li,At)})}else fr?N(fr,Oi):Or.set(kr,new se("resolved_module",Oi,null,cr))})(tt,De,Xe);break;case 72:if(De=Xe[0],tt=JSON.parse(Xe=Xe.slice(1),tt._fromJSON),Xe=d.current)switch(De){case"D":Xe.prefetchDNS(tt);break;case"C":typeof tt=="string"?Xe.preconnect(tt):Xe.preconnect(tt[0],tt[1]);break;case"L":De=tt[0],Qe=tt[1],tt.length===3?Xe.preload(De,Qe,tt[2]):Xe.preload(De,Qe);break;case"m":typeof tt=="string"?Xe.preloadModule(tt):Xe.preloadModule(tt[0],tt[1]);break;case"S":typeof tt=="string"?Xe.preinitStyle(tt):Xe.preinitStyle(tt[0],tt[1]===0?void 0:tt[1],tt.length===3?tt[2]:void 0);break;case"X":typeof tt=="string"?Xe.preinitScript(tt):Xe.preinitScript(tt[0],tt[1]);break;case"M":typeof tt=="string"?Xe.preinitModuleScript(tt):Xe.preinitModuleScript(tt[0],tt[1])}break;case 69:Qe=(Xe=JSON.parse(Xe)).digest,(Xe=Error("An error occurred in the Server Components render. The specific message is omitted in production builds to avoid leaking sensitive details. A digest property is included on this error instance which may provide additional details about the nature of the error.")).stack="Error: "+Xe.message,Xe.digest=Qe,(Tt=(Qe=tt._chunks).get(De))?b(Tt,Xe):Qe.set(De,new se("rejected",null,Xe,tt));break;case 84:tt._chunks.set(De,new se("fulfilled",Xe,null,tt));break;case 68:case 87:throw Error("Failed to read a RSC payload created by a development version of React on the server while using a production version on the client. Always use matching versions on the server and the client.");default:(Tt=(Qe=tt._chunks).get(De))?(tt=Tt,De=Xe,tt.status==="pending"&&(Xe=tt.value,Qe=tt.reason,tt.status="resolved_model",tt.value=De,Xe!==null&&(ae(tt),M(tt,Xe,Qe)))):Qe.set(De,new se("resolved_model",Xe,null,tt))}Qe=ct,be===3&&Qe++,tt=De=Xe=be=0,Ge.length=0}else{Oe=new Uint8Array(Oe.buffer,Tt,Oe.byteLength-Qe),Ge.push(Oe),tt-=Oe.byteLength;break}}return W._rowState=be,W._rowID=De,W._rowTag=Xe,W._rowLength=tt,ue.read().then(ye).catch(de)}}).catch(de)}O.createFromFetch=function(W,Q){var de=Z(Q);return W.then(function(ue){ne(de,ue.body)},function(ue){ve(de,ue)}),ke(de,0)},O.createFromReadableStream=function(W,Q){return ne(Q=Z(Q),W),ke(Q,0)},O.createServerReference=function(W){return function(Q,de,ue){function ye(){var Ge=Array.prototype.slice.call(arguments);return de(Q,Ge)}return U(ye,{id:Q,bound:null},ue),ye}(W,_e)},O.encodeReply=function(W){return new Promise(function(Q,de){_(W,"",Q,de)})}},we.__chunk_85192=(ce,O,u)=>{"use strict";ce.exports=u(10976)},we.__chunk_8352=(ce,O,u)=>{"use strict";var s=u(24528),x=u(85192),k=Symbol.for("react.element"),E=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),g=Symbol.for("react.provider"),c=Symbol.for("react.consumer"),f=Symbol.for("react.context"),m=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),R=Symbol.for("react.lazy"),F=Symbol.for("react.scope"),L=Symbol.for("react.debug_trace_mode"),U=Symbol.for("react.offscreen"),te=Symbol.for("react.legacy_hidden"),Y=Symbol.for("react.cache"),q=Symbol.iterator,se=Array.isArray;function J(A,T){var V=3&A.length,ee=A.length-V,ie=T;for(T=0;T<ee;){var Ee=255&A.charCodeAt(T)|(255&A.charCodeAt(++T))<<8|(255&A.charCodeAt(++T))<<16|(255&A.charCodeAt(++T))<<24;++T,ie^=Ee=461845907*(65535&(Ee=(Ee=3432918353*(65535&Ee)+((3432918353*(Ee>>>16)&65535)<<16)&4294967295)<<15|Ee>>>17))+((461845907*(Ee>>>16)&65535)<<16)&4294967295,ie=(65535&(ie=5*(65535&(ie=ie<<13|ie>>>19))+((5*(ie>>>16)&65535)<<16)&4294967295))+27492+(((ie>>>16)+58964&65535)<<16)}switch(Ee=0,V){case 3:Ee^=(255&A.charCodeAt(T+2))<<16;case 2:Ee^=(255&A.charCodeAt(T+1))<<8;case 1:Ee^=255&A.charCodeAt(T),ie^=461845907*(65535&(Ee=(Ee=3432918353*(65535&Ee)+((3432918353*(Ee>>>16)&65535)<<16)&4294967295)<<15|Ee>>>17))+((461845907*(Ee>>>16)&65535)<<16)&4294967295}return ie^=A.length,ie^=ie>>>16,ie=2246822507*(65535&ie)+((2246822507*(ie>>>16)&65535)<<16)&4294967295,ie^=ie>>>13,((ie=3266489909*(65535&ie)+((3266489909*(ie>>>16)&65535)<<16)&4294967295)^ie>>>16)>>>0}var j=null,M=0;function b(A,T){if(T.byteLength!==0)if(2048<T.byteLength)0<M&&(A.enqueue(new Uint8Array(j.buffer,0,M)),j=new Uint8Array(2048),M=0),A.enqueue(T);else{var V=j.length-M;V<T.byteLength&&(V===0?A.enqueue(j):(j.set(T.subarray(0,V),M),A.enqueue(j),T=T.subarray(V)),j=new Uint8Array(2048),M=0),j.set(T,M),M+=T.byteLength}}function N(A,T){return b(A,T),!0}function $(A){j&&0<M&&(A.enqueue(new Uint8Array(j.buffer,0,M)),j=null,M=0)}var X=new TextEncoder;function ae(A){return X.encode(A)}function K(A){return X.encode(A)}function ve(A,T){typeof A.error=="function"?A.error(T):A.close()}var ke=Object.assign,fe=Object.prototype.hasOwnProperty,Ae=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),_e={},Z={};function ne(A){return!!fe.call(Z,A)||!fe.call(_e,A)&&(Ae.test(A)?Z[A]=!0:(_e[A]=!0,!1))}var W=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" ")),Q=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),de=/["'&<>]/;function ue(A){if(typeof A=="boolean"||typeof A=="number")return""+A;A=""+A;var T=de.exec(A);if(T){var V,ee="",ie=0;for(V=T.index;V<A.length;V++){switch(A.charCodeAt(V)){case 34:T="&quot;";break;case 38:T="&amp;";break;case 39:T="&#x27;";break;case 60:T="&lt;";break;case 62:T="&gt;";break;default:continue}ie!==V&&(ee+=A.slice(ie,V)),ie=V+1,ee+=T}A=ie!==V?ee+A.slice(ie,V):ee}return A}var ye=/([A-Z])/g,Ge=/^ms-/,Oe=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Qe={pending:!1,data:null,method:null,action:null},be=x.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.Dispatcher,De={prefetchDNS:function(A){var T=us();if(T){var V,ee,ie=T.resumableState,Ee=T.renderState;typeof A=="string"&&A&&(ie.dnsResources.hasOwnProperty(A)||(ie.dnsResources[A]=null,(ee=(ie=Ee.headers)&&0<ie.remainingCapacity)&&(V="<"+(""+A).replace(ga,Vi)+">; rel=dns-prefetch",ee=2<=(ie.remainingCapacity-=V.length)),ee?(Ee.resets.dns[A]=null,ie.preconnects&&(ie.preconnects+=", "),ie.preconnects+=V):(ai(V=[],{href:A,rel:"dns-prefetch"}),Ee.preconnects.add(V))),rs(T))}},preconnect:function(A,T){var V=us();if(V){var ee=V.resumableState,ie=V.renderState;if(typeof A=="string"&&A){var Ee,He,Me=T==="use-credentials"?"credentials":typeof T=="string"?"anonymous":"default";ee.connectResources[Me].hasOwnProperty(A)||(ee.connectResources[Me][A]=null,(He=(ee=ie.headers)&&0<ee.remainingCapacity)&&(He="<"+(""+A).replace(ga,Vi)+">; rel=preconnect",typeof T=="string"&&(He+='; crossorigin="'+(""+T).replace(Ur,ta)+'"'),Ee=He,He=2<=(ee.remainingCapacity-=Ee.length)),He?(ie.resets.connect[Me][A]=null,ee.preconnects&&(ee.preconnects+=", "),ee.preconnects+=Ee):(ai(Me=[],{rel:"preconnect",href:A,crossOrigin:T}),ie.preconnects.add(Me))),rs(V)}}},preload:function(A,T,V){var ee=us();if(ee){var ie=ee.resumableState,Ee=ee.renderState;if(T&&A){switch(T){case"image":if(V)var He,Me=V.imageSrcSet,ht=V.imageSizes,pt=V.fetchPriority;var jt=Me?Me+`
`+(ht||""):A;if(ie.imageResources.hasOwnProperty(jt))return;ie.imageResources[jt]=Xe,(ie=Ee.headers)&&0<ie.remainingCapacity&&pt==="high"&&(He=Qr(A,T,V),2<=(ie.remainingCapacity-=He.length))?(Ee.resets.image[jt]=Xe,ie.highImagePreloads&&(ie.highImagePreloads+=", "),ie.highImagePreloads+=He):(ai(ie=[],ke({rel:"preload",href:Me?void 0:A,as:T},V)),pt==="high"?Ee.highImagePreloads.add(ie):(Ee.bulkPreloads.add(ie),Ee.preloads.images.set(jt,ie)));break;case"style":if(ie.styleResources.hasOwnProperty(A))return;ai(Me=[],ke({rel:"preload",href:A,as:T},V)),ie.styleResources[A]=V&&(typeof V.crossOrigin=="string"||typeof V.integrity=="string")?[V.crossOrigin,V.integrity]:Xe,Ee.preloads.stylesheets.set(A,Me),Ee.bulkPreloads.add(Me);break;case"script":if(ie.scriptResources.hasOwnProperty(A))return;Me=[],Ee.preloads.scripts.set(A,Me),Ee.bulkPreloads.add(Me),ai(Me,ke({rel:"preload",href:A,as:T},V)),ie.scriptResources[A]=V&&(typeof V.crossOrigin=="string"||typeof V.integrity=="string")?[V.crossOrigin,V.integrity]:Xe;break;default:if(ie.unknownResources.hasOwnProperty(T)){if((Me=ie.unknownResources[T]).hasOwnProperty(A))return}else Me={},ie.unknownResources[T]=Me;Me[A]=Xe,(ie=Ee.headers)&&0<ie.remainingCapacity&&T==="font"&&(jt=Qr(A,T,V),2<=(ie.remainingCapacity-=jt.length))?(Ee.resets.font[A]=Xe,ie.fontPreloads&&(ie.fontPreloads+=", "),ie.fontPreloads+=jt):(ai(ie=[],A=ke({rel:"preload",href:A,as:T},V)),T==="font"?Ee.fontPreloads.add(ie):Ee.bulkPreloads.add(ie))}rs(ee)}}},preloadModule:function(A,T){var V=us();if(V){var ee=V.resumableState,ie=V.renderState;if(A){var Ee=T&&typeof T.as=="string"?T.as:"script";if(Ee==="script"){if(ee.moduleScriptResources.hasOwnProperty(A))return;Ee=[],ee.moduleScriptResources[A]=T&&(typeof T.crossOrigin=="string"||typeof T.integrity=="string")?[T.crossOrigin,T.integrity]:Xe,ie.preloads.moduleScripts.set(A,Ee)}else{if(ee.moduleUnknownResources.hasOwnProperty(Ee)){var He=ee.unknownResources[Ee];if(He.hasOwnProperty(A))return}else He={},ee.moduleUnknownResources[Ee]=He;Ee=[],He[A]=Xe}ai(Ee,ke({rel:"modulepreload",href:A},T)),ie.bulkPreloads.add(Ee),rs(V)}}},preinitStyle:function(A,T,V){var ee=us();if(ee){var ie=ee.resumableState,Ee=ee.renderState;if(A){T=T||"default";var He=Ee.styles.get(T),Me=ie.styleResources.hasOwnProperty(A)?ie.styleResources[A]:void 0;Me!==null&&(ie.styleResources[A]=null,He||(He={precedence:ae(ue(T)),rules:[],hrefs:[],sheets:new Map},Ee.styles.set(T,He)),T={state:0,props:ke({rel:"stylesheet",href:A,"data-precedence":T},V)},Me&&(Me.length===2&&_r(T.props,Me),(Ee=Ee.preloads.stylesheets.get(A))&&0<Ee.length?Ee.length=0:T.state=1),He.sheets.set(A,T),rs(ee))}}},preinitScript:function(A,T){var V=us();if(V){var ee=V.resumableState,ie=V.renderState;if(A){var Ee=ee.scriptResources.hasOwnProperty(A)?ee.scriptResources[A]:void 0;Ee!==null&&(ee.scriptResources[A]=null,T=ke({src:A,async:!0},T),Ee&&(Ee.length===2&&_r(T,Ee),A=ie.preloads.scripts.get(A))&&(A.length=0),A=[],ie.scripts.add(A),hi(A,T),rs(V))}}},preinitModuleScript:function(A,T){var V=us();if(V){var ee=V.resumableState,ie=V.renderState;if(A){var Ee=ee.moduleScriptResources.hasOwnProperty(A)?ee.moduleScriptResources[A]:void 0;Ee!==null&&(ee.moduleScriptResources[A]=null,T=ke({src:A,type:"module",async:!0},T),Ee&&(Ee.length===2&&_r(T,Ee),A=ie.preloads.moduleScripts.get(A))&&(A.length=0),A=[],ie.scripts.add(A),hi(A,T),rs(V))}}}},Xe=[],tt=K('"></template>'),Ct=K("<script>"),ct=K("<\/script>"),Tt=K('<script src="'),Dt=K('<script type="module" src="'),mt=K('" nonce="'),cr=K('" integrity="'),kr=K('" crossorigin="'),Ht=K('" async=""><\/script>'),Or=/(<\/|<)(s)(cript)/gi;function fr(A,T,V,ee){return""+T+(V==="s"?"\\u0073":"\\u0053")+ee}var Oi=K('<script type="importmap">'),li=K("<\/script>");function At(A,T,V){return{insertionMode:A,selectedValue:T,tagScope:V}}function Pr(A,T,V){switch(T){case"noscript":return At(2,null,1|A.tagScope);case"select":return At(2,V.value!=null?V.value:V.defaultValue,A.tagScope);case"svg":return At(3,null,A.tagScope);case"picture":return At(2,null,2|A.tagScope);case"math":return At(4,null,A.tagScope);case"foreignObject":return At(2,null,A.tagScope);case"table":return At(5,null,A.tagScope);case"thead":case"tbody":case"tfoot":return At(6,null,A.tagScope);case"colgroup":return At(8,null,A.tagScope);case"tr":return At(7,null,A.tagScope)}return 5<=A.insertionMode?At(2,null,A.tagScope):A.insertionMode===0?At(T==="html"?1:2,null,A.tagScope):A.insertionMode===1?At(2,null,A.tagScope):A}var hr=K("<!-- -->");function gr(A,T,V,ee){return T===""?ee:(ee&&A.push(hr),A.push(ae(ue(T))),!0)}var Jt=new Map,Ir=K(' style="'),ea=K(":"),ki=K(";");function na(A,T){if(typeof T!="object")throw Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");var V,ee=!0;for(V in T)if(fe.call(T,V)){var ie=T[V];if(ie!=null&&typeof ie!="boolean"&&ie!==""){if(V.indexOf("--")===0){var Ee=ae(ue(V));ie=ae(ue((""+ie).trim()))}else(Ee=Jt.get(V))===void 0&&(Ee=K(ue(V.replace(ye,"-$1").toLowerCase().replace(Ge,"-ms-"))),Jt.set(V,Ee)),ie=typeof ie=="number"?ie===0||W.has(V)?ae(""+ie):ae(ie+"px"):ae(ue((""+ie).trim()));ee?(ee=!1,A.push(Ir,Ee,ea,ie)):A.push(ki,Ee,ea,ie)}}ee||A.push(mr)}var Kr=K(" "),Ni=K('="'),mr=K('"'),Er=K('=""');function Dr(A,T,V){V&&typeof V!="function"&&typeof V!="symbol"&&A.push(Kr,ae(T),Er)}function Ar(A,T,V){typeof V!="function"&&typeof V!="symbol"&&typeof V!="boolean"&&A.push(Kr,ae(T),Ni,ae(ue(V)),mr)}function Br(A){var T=A.nextFormID++;return A.idPrefix+T}var ba=K(ue("javascript:throw new Error('React form unexpectedly submitted.')")),Wr=K('<input type="hidden"');function pi(A,T){if(this.push(Wr),typeof A!="string")throw Error("File/Blob fields are not yet supported in progressive forms. It probably means you are closing over binary data or FormData in a Server Action.");Ar(this,"name",T),Ar(this,"value",A),this.push(Pa)}function Ba(A,T,V,ee,ie,Ee,He,Me){var ht=null;return typeof ee=="function"&&(typeof ee.$$FORM_ACTION=="function"?(ie=Br(T),Me=(T=ee.$$FORM_ACTION(ie)).name,ee=T.action||"",ie=T.encType,Ee=T.method,He=T.target,ht=T.data):(A.push(Kr,ae("formAction"),Ni,ba,mr),He=Ee=ie=ee=Me=null,Fi(T,V))),Me!=null&&Xt(A,"name",Me),ee!=null&&Xt(A,"formAction",ee),ie!=null&&Xt(A,"formEncType",ie),Ee!=null&&Xt(A,"formMethod",Ee),He!=null&&Xt(A,"formTarget",He),ht}function Xt(A,T,V){switch(T){case"className":Ar(A,"class",V);break;case"tabIndex":Ar(A,"tabindex",V);break;case"dir":case"role":case"viewBox":case"width":case"height":Ar(A,T,V);break;case"style":na(A,V);break;case"src":case"href":case"action":case"formAction":if(V==null||typeof V=="function"||typeof V=="symbol"||typeof V=="boolean")break;V=""+V,A.push(Kr,ae(T),Ni,ae(ue(V)),mr);break;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":case"ref":break;case"autoFocus":case"multiple":case"muted":Dr(A,T.toLowerCase(),V);break;case"xlinkHref":if(typeof V=="function"||typeof V=="symbol"||typeof V=="boolean")break;V=""+V,A.push(Kr,ae("xlink:href"),Ni,ae(ue(V)),mr);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":typeof V!="function"&&typeof V!="symbol"&&A.push(Kr,ae(T),Ni,ae(ue(V)),mr);break;case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":V&&typeof V!="function"&&typeof V!="symbol"&&A.push(Kr,ae(T),Er);break;case"capture":case"download":V===!0?A.push(Kr,ae(T),Er):V!==!1&&typeof V!="function"&&typeof V!="symbol"&&A.push(Kr,ae(T),Ni,ae(ue(V)),mr);break;case"cols":case"rows":case"size":case"span":typeof V!="function"&&typeof V!="symbol"&&!isNaN(V)&&1<=V&&A.push(Kr,ae(T),Ni,ae(ue(V)),mr);break;case"rowSpan":case"start":typeof V=="function"||typeof V=="symbol"||isNaN(V)||A.push(Kr,ae(T),Ni,ae(ue(V)),mr);break;case"xlinkActuate":Ar(A,"xlink:actuate",V);break;case"xlinkArcrole":Ar(A,"xlink:arcrole",V);break;case"xlinkRole":Ar(A,"xlink:role",V);break;case"xlinkShow":Ar(A,"xlink:show",V);break;case"xlinkTitle":Ar(A,"xlink:title",V);break;case"xlinkType":Ar(A,"xlink:type",V);break;case"xmlBase":Ar(A,"xml:base",V);break;case"xmlLang":Ar(A,"xml:lang",V);break;case"xmlSpace":Ar(A,"xml:space",V);break;default:if((!(2<T.length)||T[0]!=="o"&&T[0]!=="O"||T[1]!=="n"&&T[1]!=="N")&&ne(T=Q.get(T)||T)){switch(typeof V){case"function":case"symbol":return;case"boolean":var ee=T.toLowerCase().slice(0,5);if(ee!=="data-"&&ee!=="aria-")return}A.push(Kr,ae(T),Ni,ae(ue(V)),mr)}}}var ti=K(">"),Pa=K("/>");function $t(A,T,V){if(T!=null){if(V!=null)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");if(typeof T!="object"||!("__html"in T))throw Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://reactjs.org/link/dangerously-set-inner-html for more information.");(T=T.__html)!=null&&A.push(ae(""+T))}}var Qt=K(' selected=""'),Mi=K(`addEventListener("submit",function(a){if(!a.defaultPrevented){var c=a.target,d=a.submitter,e=c.action,b=d;if(d){var f=d.getAttribute("formAction");null!=f&&(e=f,b=null)}"javascript:throw new Error('React form unexpectedly submitted.')"===e&&(a.preventDefault(),b?(a=document.createElement("input"),a.name=b.name,a.value=b.value,b.parentNode.insertBefore(a,b),b=new FormData(c),a.parentNode.removeChild(a)):b=new FormData(c),a=c.ownerDocument||c,(a.$$reactFormReplay=a.$$reactFormReplay||[]).push(c,d,b))}});`);function Fi(A,T){(16&A.instructions)!=0||T.externalRuntimeScript||(A.instructions|=16,T.bootstrapChunks.unshift(T.startInlineScript,Mi,ct))}var ji=K("<!--F!-->"),_i=K("<!--F-->");function ai(A,T){for(var V in A.push(mi("link")),T)if(fe.call(T,V)){var ee=T[V];if(ee!=null)switch(V){case"children":case"dangerouslySetInnerHTML":throw Error("link is a self-closing tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:Xt(A,V,ee)}}return A.push(Pa),null}function di(A,T,V){for(var ee in A.push(mi(V)),T)if(fe.call(T,ee)){var ie=T[ee];if(ie!=null)switch(ee){case"children":case"dangerouslySetInnerHTML":throw Error(V+" is a self-closing tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:Xt(A,ee,ie)}}return A.push(Pa),null}function gi(A,T){A.push(mi("title"));var V,ee=null,ie=null;for(V in T)if(fe.call(T,V)){var Ee=T[V];if(Ee!=null)switch(V){case"children":ee=Ee;break;case"dangerouslySetInnerHTML":ie=Ee;break;default:Xt(A,V,Ee)}}return A.push(ti),typeof(T=Array.isArray(ee)?2>ee.length?ee[0]:null:ee)!="function"&&typeof T!="symbol"&&T!=null&&A.push(ae(ue(""+T))),$t(A,ie,ee),A.push(Yr("title")),null}function hi(A,T){A.push(mi("script"));var V,ee=null,ie=null;for(V in T)if(fe.call(T,V)){var Ee=T[V];if(Ee!=null)switch(V){case"children":ee=Ee;break;case"dangerouslySetInnerHTML":ie=Ee;break;default:Xt(A,V,Ee)}}return A.push(ti),$t(A,ie,ee),typeof ee=="string"&&A.push(ae(ue(ee))),A.push(Yr("script")),null}function Ri(A,T,V){A.push(mi(V));var ee,ie=V=null;for(ee in T)if(fe.call(T,ee)){var Ee=T[ee];if(Ee!=null)switch(ee){case"children":V=Ee;break;case"dangerouslySetInnerHTML":ie=Ee;break;default:Xt(A,ee,Ee)}}return A.push(ti),$t(A,ie,V),typeof V=="string"?(A.push(ae(ue(V))),null):V}var fi=K(`
`),Ai=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Bi=new Map;function mi(A){var T=Bi.get(A);if(T===void 0){if(!Ai.test(A))throw Error("Invalid tag: "+A);T=K("<"+A),Bi.set(A,T)}return T}var zr=K("<!DOCTYPE html>"),Gi=new Map;function Yr(A){var T=Gi.get(A);return T===void 0&&(T=K("</"+A+">"),Gi.set(A,T)),T}function yi(A,T){T=T.bootstrapChunks;for(var V=0;V<T.length-1;V++)b(A,T[V]);return!(V<T.length)||(V=T[V],T.length=0,N(A,V))}var Na=K('<template id="'),Fa=K('"></template>'),Xr=K("<!--$-->"),Hi=K('<!--$?--><template id="'),ln=K('"></template>'),dn=K("<!--$!-->"),un=K("<!--/$-->"),tn=K("<template"),ss=K('"'),Wn=K(' data-dgst="');K(' data-msg="'),K(' data-stck="');var zn=K("></template>");function vn(A,T,V){if(b(A,Hi),V===null)throw Error("An ID must have been assigned before we can complete the boundary.");return b(A,T.boundaryPrefix),b(A,ae(V.toString(16))),N(A,ln)}var In=K('<div hidden id="'),$n=K('">'),Ln=K("</div>"),Aa=K('<svg aria-hidden="true" style="display:none" id="'),Yn=K('">'),jn=K("</svg>"),lt=K('<math aria-hidden="true" style="display:none" id="'),B=K('">'),le=K("</math>"),pe=K('<table hidden id="'),Re=K('">'),Pe=K("</table>"),it=K('<table hidden><tbody id="'),yt=K('">'),St=K("</tbody></table>"),It=K('<table hidden><tr id="'),er=K('">'),qr=K("</tr></table>"),Zr=K('<table hidden><colgroup id="'),vi=K('">'),Ze=K("</colgroup></table>"),Kt=K('$RS=function(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Gr=K('$RS("'),bi=K('","'),Wt=K('")<\/script>'),Fr=K('<template data-rsi="" data-sid="'),Tr=K('" data-pid="'),Ei=K('$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RC("'),wi=K('$RC("'),ci=K(`$RC=function(b,c,e){c=document.getElementById(c);c.parentNode.removeChild(c);var a=document.getElementById(b);if(a){b=a.previousSibling;if(e)b.data="$!",a.setAttribute("data-dgst",e);else{e=b.parentNode;a=b.nextSibling;var f=0;do{if(a&&8===a.nodeType){var d=a.data;if("/$"===d)if(0===f)break;else f--;else"$"!==d&&"$?"!==d&&"$!"!==d||f++}d=a.nextSibling;e.removeChild(a);a=d}while(a);for(;c.firstChild;)e.insertBefore(c.firstChild,a);b.data="$"}b._reactRetry&&b._reactRetry()}};$RM=new Map;
$RR=function(r,t,w){for(var u=$RC,n=$RM,p=new Map,q=document,g,b,h=q.querySelectorAll("link[data-precedence],style[data-precedence]"),v=[],k=0;b=h[k++];)"not all"===b.getAttribute("media")?v.push(b):("LINK"===b.tagName&&n.set(b.getAttribute("href"),b),p.set(b.dataset.precedence,g=b));b=0;h=[];var l,a;for(k=!0;;){if(k){var f=w[b++];if(!f){k=!1;b=0;continue}var c=!1,m=0;var d=f[m++];if(a=n.get(d)){var e=a._p;c=!0}else{a=q.createElement("link");a.href=d;a.rel="stylesheet";for(a.dataset.precedence=
l=f[m++];e=f[m++];)a.setAttribute(e,f[m++]);e=a._p=new Promise(function(x,y){a.onload=x;a.onerror=y});n.set(d,a)}d=a.getAttribute("media");!e||"l"===e.s||d&&!matchMedia(d).matches||h.push(e);if(c)continue}else{a=v[b++];if(!a)break;l=a.getAttribute("data-precedence");a.removeAttribute("media")}c=p.get(l)||g;c===g&&(g=a);p.set(l,a);c?c.parentNode.insertBefore(a,c.nextSibling):(c=q.head,c.insertBefore(a,c.firstChild))}Promise.all(h).then(u.bind(null,r,t,""),u.bind(null,r,t,"Resource failed to load"))};$RR("`),Ci=K(`$RM=new Map;
$RR=function(r,t,w){for(var u=$RC,n=$RM,p=new Map,q=document,g,b,h=q.querySelectorAll("link[data-precedence],style[data-precedence]"),v=[],k=0;b=h[k++];)"not all"===b.getAttribute("media")?v.push(b):("LINK"===b.tagName&&n.set(b.getAttribute("href"),b),p.set(b.dataset.precedence,g=b));b=0;h=[];var l,a;for(k=!0;;){if(k){var f=w[b++];if(!f){k=!1;b=0;continue}var c=!1,m=0;var d=f[m++];if(a=n.get(d)){var e=a._p;c=!0}else{a=q.createElement("link");a.href=d;a.rel="stylesheet";for(a.dataset.precedence=
l=f[m++];e=f[m++];)a.setAttribute(e,f[m++]);e=a._p=new Promise(function(x,y){a.onload=x;a.onerror=y});n.set(d,a)}d=a.getAttribute("media");!e||"l"===e.s||d&&!matchMedia(d).matches||h.push(e);if(c)continue}else{a=v[b++];if(!a)break;l=a.getAttribute("data-precedence");a.removeAttribute("media")}c=p.get(l)||g;c===g&&(g=a);p.set(l,a);c?c.parentNode.insertBefore(a,c.nextSibling):(c=q.head,c.insertBefore(a,c.firstChild))}Promise.all(h).then(u.bind(null,r,t,""),u.bind(null,r,t,"Resource failed to load"))};$RR("`),sr=K('$RR("'),vr=K('","'),Hr=K('",'),sa=K('"'),pa=K(")<\/script>"),Da=K('<template data-rci="" data-bid="'),jr=K('<template data-rri="" data-bid="'),Pn=K('" data-sid="'),Ga=K('" data-sty="'),rn=K('$RX=function(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};;$RX("'),Ua=K('$RX("'),bn=K('"'),Mr=K(","),Ui=K(")<\/script>"),Si=K('<template data-rxi="" data-bid="'),oa=K('" data-dgst="'),_a=K('" data-msg="'),Sn=K('" data-stck="'),re=/[<\u2028\u2029]/g;function he(A){return JSON.stringify(A).replace(re,function(T){switch(T){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var xe=/[&><\u2028\u2029]/g;function Le(A){return JSON.stringify(A).replace(xe,function(T){switch(T){case"&":return"\\u0026";case">":return"\\u003e";case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSObjectForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var Ce=K('<style media="not all" data-precedence="'),Ve=K('" data-href="'),Ue=K('">'),qe=K("</style>"),We=!1,Ke=!0;function Je(A){var T=A.rules,V=A.hrefs,ee=0;if(V.length){for(b(this,Ce),b(this,A.precedence),b(this,Ve);ee<V.length-1;ee++)b(this,V[ee]),b(this,Ie);for(b(this,V[ee]),b(this,Ue),ee=0;ee<T.length;ee++)b(this,T[ee]);Ke=N(this,qe),We=!0,T.length=0,V.length=0}}function vt(A){return A.state!==2&&(We=!0)}function ft(A,T,V){return We=!1,Ke=!0,T.styles.forEach(Je,A),T.stylesheets.forEach(vt),We&&(V.stylesToHoist=!0),Ke}function Lt(A){for(var T=0;T<A.length;T++)b(this,A[T]);A.length=0}var Rt=[];function ot(A){ai(Rt,A.props);for(var T=0;T<Rt.length;T++)b(this,Rt[T]);Rt.length=0,A.state=2}var Ot=K('<style data-precedence="'),yr=K('" data-href="'),Ie=K(" "),Bt=K('">'),$e=K("</style>");function Nt(A){var T=0<A.sheets.size;A.sheets.forEach(ot,this),A.sheets.clear();var V=A.rules,ee=A.hrefs;if(!T||ee.length){if(b(this,Ot),b(this,A.precedence),A=0,ee.length){for(b(this,yr);A<ee.length-1;A++)b(this,ee[A]),b(this,Ie);b(this,ee[A])}for(b(this,Bt),A=0;A<V.length;A++)b(this,V[A]);b(this,$e),V.length=0,ee.length=0}}function Ft(A){if(A.state===0){A.state=1;var T=A.props;for(ai(Rt,{rel:"preload",as:"style",href:A.props.href,crossOrigin:T.crossOrigin,fetchPriority:T.fetchPriority,integrity:T.integrity,media:T.media,hrefLang:T.hrefLang,referrerPolicy:T.referrerPolicy}),A=0;A<Rt.length;A++)b(this,Rt[A]);Rt.length=0}}function or(A){A.sheets.forEach(Ft,this),A.sheets.clear()}var tr=K("["),rr=K(",["),zt=K(","),ir=K("]");function wr(){return{styles:new Set,stylesheets:new Set}}function _r(A,T){A.crossOrigin==null&&(A.crossOrigin=T[0]),A.integrity==null&&(A.integrity=T[1])}function Qr(A,T,V){for(var ee in T="<"+(A=(""+A).replace(ga,Vi))+'>; rel=preload; as="'+(T=(""+T).replace(Ur,ta))+'"',V)fe.call(V,ee)&&typeof(A=V[ee])=="string"&&(T+="; "+ee.toLowerCase()+'="'+(""+A).replace(Ur,ta)+'"');return T}var ga=/[<>\r\n]/g;function Vi(A){switch(A){case"<":return"%3C";case">":return"%3E";case`
`:return"%0A";case"\r":return"%0D";default:throw Error("escapeLinkHrefForHeaderContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}var Ur=/["';,\r\n]/g;function ta(A){switch(A){case'"':return"%22";case"'":return"%27";case";":return"%3B";case",":return"%2C";case`
`:return"%0A";case"\r":return"%0D";default:throw Error("escapeStringForLinkHeaderQuotedParamValueContextReplacer encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}}function Ii(A){this.styles.add(A)}function ni(A){this.stylesheets.add(A)}var qi=typeof AsyncLocalStorage=="function",wa=qi?new AsyncLocalStorage:null,Ki=Symbol.for("react.client.reference");function ra(A){if(A==null)return null;if(typeof A=="function")return A.$$typeof===Ki?null:A.displayName||A.name||null;if(typeof A=="string")return A;switch(A){case S:return"Fragment";case E:return"Portal";case o:return"Profiler";case d:return"StrictMode";case C:return"Suspense";case I:return"SuspenseList";case Y:return"Cache"}if(typeof A=="object")switch(A.$$typeof){case g:return(A._context.displayName||"Context")+".Provider";case f:return(A.displayName||"Context")+".Consumer";case m:var T=A.render;return(A=A.displayName)||(A=(A=T.displayName||T.name||"")!==""?"ForwardRef("+A+")":"ForwardRef"),A;case _:return(T=A.displayName||null)!==null?T:ra(A.type)||"Memo";case R:T=A._payload,A=A._init;try{return ra(A(T))}catch{}}return null}var la={};function Xn(A,T){if(!(A=A.contextTypes))return la;var V,ee={};for(V in A)ee[V]=T[V];return ee}var an=null;function cn(A,T){if(A!==T){A.context._currentValue=A.parentValue,A=A.parent;var V=T.parent;if(A===null){if(V!==null)throw Error("The stacks must reach the root at the same time. This is a bug in React.")}else{if(V===null)throw Error("The stacks must reach the root at the same time. This is a bug in React.");cn(A,V)}T.context._currentValue=T.value}}function Dn(A){var T=an;T!==A&&(T===null?function V(ee){var ie=ee.parent;ie!==null&&V(ie),ee.context._currentValue=ee.value}(A):A===null?function V(ee){ee.context._currentValue=ee.parentValue,(ee=ee.parent)!==null&&V(ee)}(T):T.depth===A.depth?cn(T,A):T.depth>A.depth?function V(ee,ie){if(ee.context._currentValue=ee.parentValue,(ee=ee.parent)===null)throw Error("The depth must equal at least at zero before reaching the root. This is a bug in React.");ee.depth===ie.depth?cn(ee,ie):V(ee,ie)}(T,A):function V(ee,ie){var Ee=ie.parent;if(Ee===null)throw Error("The depth must equal at least at zero before reaching the root. This is a bug in React.");ee.depth===Ee.depth?cn(ee,Ee):V(ee,Ee),ie.context._currentValue=ie.value}(T,A),an=A)}var os={isMounted:function(){return!1},enqueueSetState:function(A,T){(A=A._reactInternals).queue!==null&&A.queue.push(T)},enqueueReplaceState:function(A,T){(A=A._reactInternals).replace=!0,A.queue=[T]},enqueueForceUpdate:function(){}};function ps(A,T,V,ee){var ie=A.state!==void 0?A.state:null;A.updater=os,A.props=V,A.state=ie;var Ee={queue:[],replace:!1};A._reactInternals=Ee;var He=T.contextType;if(A.context=typeof He=="object"&&He!==null?He._currentValue:ee,typeof(He=T.getDerivedStateFromProps)=="function"&&(ie=(He=He(V,ie))==null?ie:ke({},ie,He),A.state=ie),typeof T.getDerivedStateFromProps!="function"&&typeof A.getSnapshotBeforeUpdate!="function"&&(typeof A.UNSAFE_componentWillMount=="function"||typeof A.componentWillMount=="function"))if(T=A.state,typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount(),T!==A.state&&os.enqueueReplaceState(A,A.state,null),Ee.queue!==null&&0<Ee.queue.length)if(T=Ee.queue,He=Ee.replace,Ee.queue=null,Ee.replace=!1,He&&T.length===1)A.state=T[0];else{for(Ee=He?T[0]:A.state,ie=!0,He=He?1:0;He<T.length;He++){var Me=T[He];(Me=typeof Me=="function"?Me.call(A,Ee,V,ee):Me)!=null&&(ie?(ie=!1,Ee=ke({},Ee,Me)):ke(Ee,Me))}A.state=Ee}else Ee.queue=null}var $a={id:1,overflow:""};function Bn(A,T,V){var ee=A.id;A=A.overflow;var ie=32-xn(ee)-1;ee&=~(1<<ie),V+=1;var Ee=32-xn(T)+ie;if(30<Ee){var He=ie-ie%5;return Ee=(ee&(1<<He)-1).toString(32),ee>>=He,ie-=He,{id:1<<32-xn(T)+ie|V<<ie|ee,overflow:Ee+A}}return{id:1<<Ee|V<<ie|ee,overflow:A}}var xn=Math.clz32?Math.clz32:function(A){return(A>>>=0)==0?32:31-(Gn(A)/Zn|0)|0},Gn=Math.log,Zn=Math.LN2,Li=Error("Suspense Exception: This is not a real error! It's an implementation detail of `use` to interrupt the current render. You must either rethrow it immediately, or move the `use` call outside of the `try/catch` block. Capturing without rethrowing will lead to unexpected behavior.\n\nTo handle async errors, wrap your component in an error boundary, or call the promise's `.catch` method and pass the result to `use`");function Qn(){}var ja=null;function Ha(){if(ja===null)throw Error("Expected a suspended thenable. This is a bug in React. Please file an issue.");var A=ja;return ja=null,A}var On=typeof Object.is=="function"?Object.is:function(A,T){return A===T&&(A!==0||1/A==1/T)||A!=A&&T!=T},ma=null,Tn=null,hn=null,za=null,Rr=null,pr=null,Cr=!1,$r=!1,ya=0,Vr=0,Wi=-1,Gt=0,ri=null,Jr=null,zi=0;function Ne(){if(ma===null)throw Error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.`);return ma}function Sa(){if(0<zi)throw Error("Rendered more hooks than during the previous render");return{memoizedState:null,queue:null,next:null}}function br(){return pr===null?Rr===null?(Cr=!1,Rr=pr=Sa()):(Cr=!0,pr=Rr):pr.next===null?(Cr=!1,pr=pr.next=Sa()):(Cr=!0,pr=pr.next),pr}function Pi(){var A=ri;return ri=null,A}function ka(){za=hn=Tn=ma=null,$r=!1,Rr=null,zi=0,pr=Jr=null}function nn(A,T){return typeof T=="function"?T(A):T}function da(A,T,V){if(ma=Ne(),pr=br(),Cr){var ee=pr.queue;if(T=ee.dispatch,Jr!==null&&(V=Jr.get(ee))!==void 0){Jr.delete(ee),ee=pr.memoizedState;do ee=A(ee,V.action),V=V.next;while(V!==null);return pr.memoizedState=ee,[ee,T]}return[pr.memoizedState,T]}return A=A===nn?typeof T=="function"?T():T:V!==void 0?V(T):T,pr.memoizedState=A,A=(A=pr.queue={last:null,dispatch:null}).dispatch=Ya.bind(null,ma,A),[pr.memoizedState,A]}function ia(A,T){if(ma=Ne(),pr=br(),T=T===void 0?null:T,pr!==null){var V=pr.memoizedState;if(V!==null&&T!==null){var ee=V[1];e:if(ee===null)ee=!1;else{for(var ie=0;ie<ee.length&&ie<T.length;ie++)if(!On(T[ie],ee[ie])){ee=!1;break e}ee=!0}if(ee)return V[0]}}return A=A(),pr.memoizedState=[A,T],A}function Ya(A,T,V){if(25<=zi)throw Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");if(A===ma)if($r=!0,A={action:V,next:null},Jr===null&&(Jr=new Map),(V=Jr.get(T))===void 0)Jr.set(T,A);else{for(T=V;T.next!==null;)T=T.next;T.next=A}}function Jn(){throw Error("startTransition cannot be called during server rendering.")}function Xa(){throw Error("Cannot update optimistic state while rendering.")}function fn(A){var T=Gt;return Gt+=1,ri===null&&(ri=[]),function(V,ee,ie){switch((ie=V[ie])===void 0?V.push(ee):ie!==ee&&(ee.then(Qn,Qn),ee=ie),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason;default:if(typeof ee.status!="string")switch((V=ee).status="pending",V.then(function(Ee){if(ee.status==="pending"){var He=ee;He.status="fulfilled",He.value=Ee}},function(Ee){if(ee.status==="pending"){var He=ee;He.status="rejected",He.reason=Ee}}),ee.status){case"fulfilled":return ee.value;case"rejected":throw ee.reason}throw ja=ee,Li}}(ri,A,T)}function ls(){throw Error("Cache cannot be refreshed during server rendering.")}function es(){}var zs,Ys={readContext:function(A){return A._currentValue},use:function(A){if(A!==null&&typeof A=="object"){if(typeof A.then=="function")return fn(A);if(A.$$typeof===f)return A._currentValue}throw Error("An unsupported type was passed to use(): "+String(A))},useContext:function(A){return Ne(),A._currentValue},useMemo:ia,useReducer:da,useRef:function(A){ma=Ne();var T=(pr=br()).memoizedState;return T===null?(A={current:A},pr.memoizedState=A):T},useState:function(A){return da(nn,A)},useInsertionEffect:es,useLayoutEffect:es,useCallback:function(A,T){return ia(function(){return A},T)},useImperativeHandle:es,useEffect:es,useDebugValue:es,useDeferredValue:function(A){return Ne(),A},useTransition:function(){return Ne(),[!1,Jn]},useId:function(){var A=Tn.treeContext,T=A.overflow;A=((A=A.id)&~(1<<32-xn(A)-1)).toString(32)+T;var V=ts;if(V===null)throw Error("Invalid hook call. Hooks can only be called inside of the body of a function component.");return T=ya++,A=":"+V.idPrefix+"R"+A,0<T&&(A+="H"+T.toString(32)),A+":"},useSyncExternalStore:function(A,T,V){if(V===void 0)throw Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");return V()},useCacheRefresh:function(){return ls},useHostTransitionStatus:function(){return Ne(),Qe},useOptimistic:function(A){return Ne(),[A,Xa]},useFormState:function(A,T,V){Ne();var ee=Vr++,ie=hn;if(typeof A.$$FORM_ACTION=="function"){var Ee=null,He=za;ie=ie.formState;var Me=A.$$IS_SIGNATURE_EQUAL;if(ie!==null&&typeof Me=="function"){var ht=ie[1];Me.call(A,ie[2],ie[3])&&ht===(Ee=V!==void 0?"p"+V:"k"+J(JSON.stringify([He,null,ee]),0))&&(Wi=ee,T=ie[0])}var pt=A.bind(null,T);return A=function(Et){pt(Et)},typeof pt.$$FORM_ACTION=="function"&&(A.$$FORM_ACTION=function(Et){Et=pt.$$FORM_ACTION(Et),V!==void 0&&(V+="",Et.action=V);var dr=Et.data;return dr&&(Ee===null&&(Ee=V!==void 0?"p"+V:"k"+J(JSON.stringify([He,null,ee]),0)),dr.append("$ACTION_KEY",Ee)),Et}),[T,A]}var jt=A.bind(null,T);return[T,function(Et){jt(Et)}]}},ts=null,Qo={getCacheSignal:function(){throw Error("Not implemented.")},getCacheForType:function(){throw Error("Not implemented.")}};function No(A){if(zs===void 0)try{throw Error()}catch(V){var T=V.stack.trim().match(/\n( *(at )?)/);zs=T&&T[1]||""}return`
`+zs+A}var Xs=!1;function yo(A,T){if(!A||Xs)return"";Xs=!0;var V=Error.prepareStackTrace;Error.prepareStackTrace=void 0;var ee={DetermineComponentFrameRoot:function(){try{if(T){var Et=function(){throw Error()};if(Object.defineProperty(Et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Et,[])}catch(Sr){var dr=Sr}Reflect.construct(A,[],Et)}else{try{Et.call()}catch(Sr){dr=Sr}A.call(Et.prototype)}}else{try{throw Error()}catch(Sr){dr=Sr}(Et=A())&&typeof Et.catch=="function"&&Et.catch(function(){})}}catch(Sr){if(Sr&&dr&&typeof Sr.stack=="string")return[Sr.stack,dr.stack]}return[null,null]}};ee.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var ie=Object.getOwnPropertyDescriptor(ee.DetermineComponentFrameRoot,"name");ie&&ie.configurable&&Object.defineProperty(ee.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});try{var Ee=ee.DetermineComponentFrameRoot(),He=Ee[0],Me=Ee[1];if(He&&Me){var ht=He.split(`
`),pt=Me.split(`
`);for(ie=ee=0;ee<ht.length&&!ht[ee].includes("DetermineComponentFrameRoot");)ee++;for(;ie<pt.length&&!pt[ie].includes("DetermineComponentFrameRoot");)ie++;if(ee===ht.length||ie===pt.length)for(ee=ht.length-1,ie=pt.length-1;1<=ee&&0<=ie&&ht[ee]!==pt[ie];)ie--;for(;1<=ee&&0<=ie;ee--,ie--)if(ht[ee]!==pt[ie]){if(ee!==1||ie!==1)do if(ee--,ie--,0>ie||ht[ee]!==pt[ie]){var jt=`
`+ht[ee].replace(" at new "," at ");return A.displayName&&jt.includes("<anonymous>")&&(jt=jt.replace("<anonymous>",A.displayName)),jt}while(1<=ee&&0<=ie);break}}}finally{Xs=!1,Error.prepareStackTrace=V}return(V=A?A.displayName||A.name:"")?No(V):""}var vo=Oe.ReactCurrentDispatcher,As=Oe.ReactCurrentCache;function Fo(A){return console.error(A),null}function Mn(){}var ds=null;function us(){if(ds)return ds;if(qi){var A=wa.getStore();if(A)return A}return null}function Uo(A,T){A.pingedTasks.push(T),A.pingedTasks.length===1&&(A.flushScheduled=A.destination!==null,setTimeout(function(){return To(A)},0))}function Zs(A,T){return{status:0,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,completedSegments:[],byteSize:0,fallbackAbortableTasks:T,errorDigest:null,contentState:wr(),fallbackState:wr(),trackedContentKeyPath:null,trackedFallbackNode:null}}function Qs(A,T,V,ee,ie,Ee,He,Me,ht,pt,jt,Et,dr,Sr,xr){A.allPendingTasks++,ie===null?A.pendingRootTasks++:ie.pendingTasks++;var Vt={replay:null,node:V,childIndex:ee,ping:function(){return Uo(A,Vt)},blockedBoundary:ie,blockedSegment:Ee,hoistableState:He,abortSet:Me,keyPath:ht,formatContext:pt,legacyContext:jt,context:Et,treeContext:dr,componentStack:Sr,thenableState:T,isFallback:xr};return Me.add(Vt),Vt}function $o(A,T,V,ee,ie,Ee,He,Me,ht,pt,jt,Et,dr,Sr,xr){A.allPendingTasks++,Ee===null?A.pendingRootTasks++:Ee.pendingTasks++,V.pendingTasks++;var Vt={replay:V,node:ee,childIndex:ie,ping:function(){return Uo(A,Vt)},blockedBoundary:Ee,blockedSegment:null,hoistableState:He,abortSet:Me,keyPath:ht,formatContext:pt,legacyContext:jt,context:Et,treeContext:dr,componentStack:Sr,thenableState:T,isFallback:xr};return Me.add(Vt),Vt}function Cs(A,T,V,ee,ie,Ee){return{status:0,id:-1,index:T,parentFlushed:!1,chunks:[],children:[],parentFormatContext:ee,boundary:V,lastPushedText:ie,textEmbedded:Ee}}function cs(A,T){return{tag:0,parent:A.componentStack,type:T}}function Hn(A,T){if(T&&A.trackedPostpones!==null){try{A="";do{switch(T.tag){case 0:A+=No(T.type,null);break;case 1:A+=yo(T.type,!1);break;case 2:A+=yo(T.type,!0)}T=T.parent}while(T);var V=A}catch(ee){V=`
Error generating stack: `+ee.message+`
`+ee.stack}V={componentStack:V}}else V={};return V}function Va(A,T,V){if((A=A.onError(T,V))==null||typeof A=="string")return A}function Ca(A,T){var V=A.onShellError;V(T),(V=A.onFatalError)(T),A.destination!==null?(A.status=2,ve(A.destination,T)):(A.status=1,A.fatalError=T)}function jo(A,T,V,ee,ie,Ee){var He=T.thenableState;for(T.thenableState=null,ma={},Tn=T,hn=A,za=V,Vr=ya=0,Wi=-1,Gt=0,ri=He,A=ee(ie,Ee);$r;)$r=!1,Vr=ya=0,Wi=-1,Gt=0,zi+=1,pr=null,A=ee(ie,Ee);return ka(),A}function En(A,T,V,ee,ie){var Ee=ee.render(),He=ie.childContextTypes;if(He!=null){if(V=T.legacyContext,typeof ee.getChildContext!="function")ie=V;else{for(var Me in ee=ee.getChildContext())if(!(Me in He))throw Error((ra(ie)||"Unknown")+'.getChildContext(): key "'+Me+'" is not defined in childContextTypes.');ie=ke({},V,ee)}T.legacyContext=ie,qa(A,T,Ee,-1),T.legacyContext=V}else ie=T.keyPath,T.keyPath=V,qa(A,T,Ee,-1),T.keyPath=ie}function wn(A,T,V,ee,ie,Ee,He){var Me=!1;if(Ee!==0&&A.formState!==null){var ht=T.blockedSegment;if(ht!==null){Me=!0,ht=ht.chunks;for(var pt=0;pt<Ee;pt++)pt===He?ht.push(ji):ht.push(_i)}}Ee=T.keyPath,T.keyPath=V,ie?(V=T.treeContext,T.treeContext=Bn(V,1,0),pn(A,T,ee,-1),T.treeContext=V):Me?pn(A,T,ee,-1):qa(A,T,ee,-1),T.keyPath=Ee}function bo(A,T){if(A&&A.defaultProps)for(var V in T=ke({},T),A=A.defaultProps)T[V]===void 0&&(T[V]=A[V]);return T}function Is(A,T,V,ee,ie,Ee){if(typeof ee=="function")if(ee.prototype&&ee.prototype.isReactComponent){Ee=T.componentStack,T.componentStack={tag:2,parent:T.componentStack,type:ee};var He=Xn(ee,T.legacyContext),Me=ee.contextType;ps(Me=new ee(ie,typeof Me=="object"&&Me!==null?Me._currentValue:He),ee,ie,He),En(A,T,V,Me,ee),T.componentStack=Ee}else{Ee=Xn(ee,T.legacyContext),He=T.componentStack,T.componentStack={tag:1,parent:T.componentStack,type:ee},Me=jo(A,T,V,ee,ie,Ee);var ht=ya!==0,pt=Vr,jt=Wi;typeof Me=="object"&&Me!==null&&typeof Me.render=="function"&&Me.$$typeof===void 0?(ps(Me,ee,ie,Ee),En(A,T,V,Me,ee)):wn(A,T,V,Me,ht,pt,jt),T.componentStack=He}else if(typeof ee=="string"){if(Ee=T.componentStack,T.componentStack=cs(T,ee),(He=T.blockedSegment)===null)He=ie.children,Me=T.formatContext,ht=T.keyPath,T.formatContext=Pr(Me,ee,ie),T.keyPath=V,pn(A,T,He,-1),T.formatContext=Me,T.keyPath=ht;else{ht=function(wt,Ra,gt,ei,Yt,Di,va,Xi,ua){switch(Ra){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":break;case"select":wt.push(mi("select"));var Za,Ka=null,_n=null;for(Za in gt)if(fe.call(gt,Za)){var Qa=gt[Za];if(Qa!=null)switch(Za){case"children":Ka=Qa;break;case"dangerouslySetInnerHTML":_n=Qa;break;case"defaultValue":case"value":break;default:Xt(wt,Za,Qa)}}return wt.push(ti),$t(wt,_n,Ka),Ka;case"option":var Oa=va.selectedValue;wt.push(mi("option"));var ui,sn=null,xa=null,Ia=null,ca=null;for(ui in gt)if(fe.call(gt,ui)){var Nr=gt[ui];if(Nr!=null)switch(ui){case"children":sn=Nr;break;case"selected":Ia=Nr;break;case"dangerouslySetInnerHTML":ca=Nr;break;case"value":xa=Nr;default:Xt(wt,ui,Nr)}}if(Oa!=null){var Ma,Fn,Zi=xa!==null?""+xa:(Ma=sn,Fn="",s.Children.forEach(Ma,function(kt){kt!=null&&(Fn+=kt)}),Fn);if(se(Oa)){for(var Ja=0;Ja<Oa.length;Ja++)if(""+Oa[Ja]===Zi){wt.push(Qt);break}}else""+Oa===Zi&&wt.push(Qt)}else Ia&&wt.push(Qt);return wt.push(ti),$t(wt,ca,sn),sn;case"textarea":wt.push(mi("textarea"));var La,ha=null,Wa=null,mn=null;for(La in gt)if(fe.call(gt,La)){var on=gt[La];if(on!=null)switch(La){case"children":mn=on;break;case"value":ha=on;break;case"defaultValue":Wa=on;break;case"dangerouslySetInnerHTML":throw Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");default:Xt(wt,La,on)}}if(ha===null&&Wa!==null&&(ha=Wa),wt.push(ti),mn!=null){if(ha!=null)throw Error("If you supply `defaultValue` on a <textarea>, do not pass children.");if(se(mn)){if(1<mn.length)throw Error("<textarea> can only have at most one child.");ha=""+mn[0]}ha=""+mn}return typeof ha=="string"&&ha[0]===`
`&&wt.push(fi),ha!==null&&wt.push(ae(ue(""+ha))),null;case"input":wt.push(mi("input"));var Vn,Bo=null,is=null,wo=null,Go=null,Ho=null,Ms=null,ao=null,no=null,Ns=null;for(Vn in gt)if(fe.call(gt,Vn)){var Rn=gt[Vn];if(Rn!=null)switch(Vn){case"children":case"dangerouslySetInnerHTML":throw Error("input is a self-closing tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");case"name":Bo=Rn;break;case"formAction":is=Rn;break;case"formEncType":wo=Rn;break;case"formMethod":Go=Rn;break;case"formTarget":Ho=Rn;break;case"defaultChecked":Ns=Rn;break;case"defaultValue":ao=Rn;break;case"checked":no=Rn;break;case"value":Ms=Rn;break;default:Xt(wt,Vn,Rn)}}var ko=Ba(wt,ei,Yt,is,wo,Go,Ho,Bo);return no!==null?Dr(wt,"checked",no):Ns!==null&&Dr(wt,"checked",Ns),Ms!==null?Xt(wt,"value",Ms):ao!==null&&Xt(wt,"value",ao),wt.push(Pa),ko!==null&&ko.forEach(pi,wt),null;case"button":wt.push(mi("button"));var Fs,ys=null,so=null,Us=null,_o=null,Vo=null,qo=null,oo=null;for(Fs in gt)if(fe.call(gt,Fs)){var qn=gt[Fs];if(qn!=null)switch(Fs){case"children":ys=qn;break;case"dangerouslySetInnerHTML":so=qn;break;case"name":Us=qn;break;case"formAction":_o=qn;break;case"formEncType":Vo=qn;break;case"formMethod":qo=qn;break;case"formTarget":oo=qn;break;default:Xt(wt,Fs,qn)}}var lo=Ba(wt,ei,Yt,_o,Vo,qo,oo,Us);if(wt.push(ti),lo!==null&&lo.forEach(pi,wt),$t(wt,so,ys),typeof ys=="string"){wt.push(ae(ue(ys)));var Ko=null}else Ko=ys;return Ko;case"form":wt.push(mi("form"));var hs,vs=null,Ro=null,as=null,bs=null,fs=null,Ss=null;for(hs in gt)if(fe.call(gt,hs)){var Un=gt[hs];if(Un!=null)switch(hs){case"children":vs=Un;break;case"dangerouslySetInnerHTML":Ro=Un;break;case"action":as=Un;break;case"encType":bs=Un;break;case"method":fs=Un;break;case"target":Ss=Un;break;default:Xt(wt,hs,Un)}}var uo=null,$s=null;if(typeof as=="function")if(typeof as.$$FORM_ACTION=="function"){var co=Br(ei),xs=as.$$FORM_ACTION(co);as=xs.action||"",bs=xs.encType,fs=xs.method,Ss=xs.target,uo=xs.data,$s=xs.name}else wt.push(Kr,ae("action"),Ni,ba,mr),Ss=fs=bs=as=null,Fi(ei,Yt);if(as!=null&&Xt(wt,"action",as),bs!=null&&Xt(wt,"encType",bs),fs!=null&&Xt(wt,"method",fs),Ss!=null&&Xt(wt,"target",Ss),wt.push(ti),$s!==null&&(wt.push(Wr),Ar(wt,"name",$s),wt.push(Pa),uo!==null&&uo.forEach(pi,wt)),$t(wt,Ro,vs),typeof vs=="string"){wt.push(ae(ue(vs)));var Ao=null}else Ao=vs;return Ao;case"menuitem":for(var js in wt.push(mi("menuitem")),gt)if(fe.call(gt,js)){var Co=gt[js];if(Co!=null)switch(js){case"children":case"dangerouslySetInnerHTML":throw Error("menuitems cannot have `children` nor `dangerouslySetInnerHTML`.");default:Xt(wt,js,Co)}}return wt.push(ti),null;case"title":if(va.insertionMode===3||1&va.tagScope||gt.itemProp!=null)var Io=gi(wt,gt);else ua?Io=null:(gi(Yt.hoistableChunks,gt),Io=void 0);return Io;case"link":var Jo=gt.rel,Kn=gt.href,ho=gt.precedence;if(va.insertionMode===3||1&va.tagScope||gt.itemProp!=null||typeof Jo!="string"||typeof Kn!="string"||Kn===""){ai(wt,gt);var Bs=null}else if(gt.rel==="stylesheet")if(typeof ho!="string"||gt.disabled!=null||gt.onLoad||gt.onError)Bs=ai(wt,gt);else{var Ts=Yt.styles.get(ho),Gs=ei.styleResources.hasOwnProperty(Kn)?ei.styleResources[Kn]:void 0;if(Gs!==null){ei.styleResources[Kn]=null,Ts||(Ts={precedence:ae(ue(ho)),rules:[],hrefs:[],sheets:new Map},Yt.styles.set(ho,Ts));var fo={state:0,props:ke({},gt,{"data-precedence":gt.precedence,precedence:null})};if(Gs){Gs.length===2&&_r(fo.props,Gs);var Lo=Yt.preloads.stylesheets.get(Kn);Lo&&0<Lo.length?Lo.length=0:fo.state=1}Ts.sheets.set(Kn,fo),Di&&Di.stylesheets.add(fo)}else if(Ts){var Po=Ts.sheets.get(Kn);Po&&Di&&Di.stylesheets.add(Po)}Xi&&wt.push(hr),Bs=null}else gt.onLoad||gt.onError?Bs=ai(wt,gt):(Xi&&wt.push(hr),Bs=ua?null:ai(Yt.hoistableChunks,gt));return Bs;case"script":var po=gt.async;if(typeof gt.src!="string"||!gt.src||!po||typeof po=="function"||typeof po=="symbol"||gt.onLoad||gt.onError||va.insertionMode===3||1&va.tagScope||gt.itemProp!=null)var Hs=hi(wt,gt);else{var Es=gt.src;if(gt.type==="module")var ws=ei.moduleScriptResources,Vs=Yt.preloads.moduleScripts;else ws=ei.scriptResources,Vs=Yt.preloads.scripts;var go=ws.hasOwnProperty(Es)?ws[Es]:void 0;if(go!==null){ws[Es]=null;var Wo=gt;if(go){go.length===2&&_r(Wo=ke({},gt),go);var zo=Vs.get(Es);zo&&(zo.length=0)}var Do=[];Yt.scripts.add(Do),hi(Do,Wo)}Xi&&wt.push(hr),Hs=null}return Hs;case"style":var qs=gt.precedence,ns=gt.href;if(va.insertionMode===3||1&va.tagScope||gt.itemProp!=null||typeof qs!="string"||typeof ns!="string"||ns===""){wt.push(mi("style"));var Ks,ks=null,mo=null;for(Ks in gt)if(fe.call(gt,Ks)){var Ws=gt[Ks];if(Ws!=null)switch(Ks){case"children":ks=Ws;break;case"dangerouslySetInnerHTML":mo=Ws;break;default:Xt(wt,Ks,Ws)}}wt.push(ti);var _s=Array.isArray(ks)?2>ks.length?ks[0]:null:ks;typeof _s!="function"&&typeof _s!="symbol"&&_s!=null&&wt.push(ae(ue(""+_s))),$t(wt,mo,ks),wt.push(Yr("style"));var Yo=null}else{var en=Yt.styles.get(qs);if((ei.styleResources.hasOwnProperty(ns)?ei.styleResources[ns]:void 0)!==null){ei.styleResources[ns]=null,en?en.hrefs.push(ae(ue(ns))):(en={precedence:ae(ue(qs)),rules:[],hrefs:[ae(ue(ns))],sheets:new Map},Yt.styles.set(qs,en));var y,e=en.rules,t=null,r=null;for(y in gt)if(fe.call(gt,y)){var i=gt[y];if(i!=null)switch(y){case"children":t=i;break;case"dangerouslySetInnerHTML":r=i}}var a=Array.isArray(t)?2>t.length?t[0]:null:t;typeof a!="function"&&typeof a!="symbol"&&a!=null&&e.push(ae(ue(""+a))),$t(e,r,t)}en&&Di&&Di.styles.add(en),Xi&&wt.push(hr),Yo=void 0}return Yo;case"meta":if(va.insertionMode===3||1&va.tagScope||gt.itemProp!=null)var n=di(wt,gt,"meta");else Xi&&wt.push(hr),n=ua?null:typeof gt.charSet=="string"?di(Yt.charsetChunks,gt,"meta"):gt.name==="viewport"?di(Yt.viewportChunks,gt,"meta"):di(Yt.hoistableChunks,gt,"meta");return n;case"listing":case"pre":wt.push(mi(Ra));var l,h=null,p=null;for(l in gt)if(fe.call(gt,l)){var v=gt[l];if(v!=null)switch(l){case"children":h=v;break;case"dangerouslySetInnerHTML":p=v;break;default:Xt(wt,l,v)}}if(wt.push(ti),p!=null){if(h!=null)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");if(typeof p!="object"||!("__html"in p))throw Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://reactjs.org/link/dangerously-set-inner-html for more information.");var w=p.__html;w!=null&&(typeof w=="string"&&0<w.length&&w[0]===`
`?wt.push(fi,ae(w)):wt.push(ae(""+w)))}return typeof h=="string"&&h[0]===`
`&&wt.push(fi),h;case"img":var P=gt.src,D=gt.srcSet;if(!(gt.loading==="lazy"||!P&&!D||typeof P!="string"&&P!=null||typeof D!="string"&&D!=null)&&gt.fetchPriority!=="low"&&!(2&va.tagScope)&&(typeof P!="string"||P[4]!==":"||P[0]!=="d"&&P[0]!=="D"||P[1]!=="a"&&P[1]!=="A"||P[2]!=="t"&&P[2]!=="T"||P[3]!=="a"&&P[3]!=="A")&&(typeof D!="string"||D[4]!==":"||D[0]!=="d"&&D[0]!=="D"||D[1]!=="a"&&D[1]!=="A"||D[2]!=="t"&&D[2]!=="T"||D[3]!=="a"&&D[3]!=="A")){var G=typeof gt.sizes=="string"?gt.sizes:void 0,z=D?D+`
`+(G||""):P,H=Yt.preloads.images,oe=H.get(z);if(oe)(gt.fetchPriority==="high"||10>Yt.highImagePreloads.size)&&(H.delete(z),Yt.highImagePreloads.add(oe));else if(!ei.imageResources.hasOwnProperty(z)){ei.imageResources[z]=Xe;var Se,me=gt.crossOrigin,Te=typeof me=="string"?me==="use-credentials"?me:"":void 0,Be=Yt.headers;Be&&0<Be.remainingCapacity&&(gt.fetchPriority==="high"||500>Be.highImagePreloads.length)&&(Se=Qr(P,"image",{imageSrcSet:gt.srcSet,imageSizes:gt.sizes,crossOrigin:Te,integrity:gt.integrity,nonce:gt.nonce,type:gt.type,fetchPriority:gt.fetchPriority,referrerPolicy:gt.refererPolicy}),2<=(Be.remainingCapacity-=Se.length))?(Yt.resets.image[z]=Xe,Be.highImagePreloads&&(Be.highImagePreloads+=", "),Be.highImagePreloads+=Se):(ai(oe=[],{rel:"preload",as:"image",href:D?void 0:P,imageSrcSet:D,imageSizes:G,crossOrigin:Te,integrity:gt.integrity,type:gt.type,fetchPriority:gt.fetchPriority,referrerPolicy:gt.referrerPolicy}),gt.fetchPriority==="high"||10>Yt.highImagePreloads.size?Yt.highImagePreloads.add(oe):(Yt.bulkPreloads.add(oe),H.set(z,oe)))}}return di(wt,gt,"img");case"base":case"area":case"br":case"col":case"embed":case"hr":case"keygen":case"param":case"source":case"track":case"wbr":return di(wt,gt,Ra);case"head":if(2>va.insertionMode&&Yt.headChunks===null){Yt.headChunks=[];var je=Ri(Yt.headChunks,gt,"head")}else je=Ri(wt,gt,"head");return je;case"html":if(va.insertionMode===0&&Yt.htmlChunks===null){Yt.htmlChunks=[zr];var ge=Ri(Yt.htmlChunks,gt,"html")}else ge=Ri(wt,gt,"html");return ge;default:if(Ra.indexOf("-")!==-1){wt.push(mi(Ra));var ze,Fe=null,rt=null;for(ze in gt)if(fe.call(gt,ze)){var st=gt[ze];if(st!=null)switch(ze){case"children":Fe=st;break;case"dangerouslySetInnerHTML":rt=st;break;case"style":na(wt,st);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"ref":break;default:ne(ze)&&typeof st!="function"&&typeof st!="symbol"&&wt.push(Kr,ae(ze),Ni,ae(ue(st)),mr)}}return wt.push(ti),$t(wt,rt,Fe),Fe}}return Ri(wt,gt,Ra)}(He.chunks,ee,ie,A.resumableState,A.renderState,T.hoistableState,T.formatContext,He.lastPushedText,T.isFallback),He.lastPushedText=!1,Me=T.formatContext,pt=T.keyPath,T.formatContext=Pr(Me,ee,ie),T.keyPath=V,pn(A,T,ht,-1),T.formatContext=Me,T.keyPath=pt;e:{switch(V=He.chunks,A=A.resumableState,ee){case"title":case"style":case"script":case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break e;case"body":if(1>=Me.insertionMode){A.hasBody=!0;break e}break;case"html":if(Me.insertionMode===0){A.hasHtml=!0;break e}}V.push(Yr(ee))}He.lastPushedText=!1}T.componentStack=Ee}else{switch(ee){case te:case L:case d:case o:case S:ee=T.keyPath,T.keyPath=V,qa(A,T,ie.children,-1),T.keyPath=ee;return;case U:ie.mode!=="hidden"&&(ee=T.keyPath,T.keyPath=V,qa(A,T,ie.children,-1),T.keyPath=ee);return;case I:ee=T.componentStack,T.componentStack=cs(T,"SuspenseList"),Ee=T.keyPath,T.keyPath=V,qa(A,T,ie.children,-1),T.keyPath=Ee,T.componentStack=ee;return;case F:throw Error("ReactDOMServer does not yet support scope components.");case C:e:if(T.replay!==null){ee=T.keyPath,T.keyPath=V,V=ie.children;try{pn(A,T,V,-1)}finally{T.keyPath=ee}}else{var Et=T.componentStack;ee=T.componentStack=cs(T,"Suspense");var dr=T.keyPath;Ee=T.blockedBoundary;var Sr=T.hoistableState,xr=T.blockedSegment;He=ie.fallback;var Vt=ie.children;Me=Zs(A,ie=new Set),A.trackedPostpones!==null&&(Me.trackedContentKeyPath=V),ht=Cs(A,xr.chunks.length,Me,T.formatContext,!1,!1),xr.children.push(ht),xr.lastPushedText=!1;var ur=Cs(A,0,null,T.formatContext,!1,!1);ur.parentFlushed=!0,T.blockedBoundary=Me,T.hoistableState=Me.contentState,T.blockedSegment=ur,T.keyPath=V;try{if(pn(A,T,Vt,-1),ur.lastPushedText&&ur.textEmbedded&&ur.chunks.push(hr),ur.status=1,kn(Me,ur),Me.pendingTasks===0&&Me.status===0){Me.status=1,T.componentStack=Et;break e}}catch(wt){ur.status=4,Me.status=4,pt=Hn(A,T.componentStack),jt=Va(A,wt,pt),Me.errorDigest=jt,Ls(A,Me)}finally{T.blockedBoundary=Ee,T.hoistableState=Sr,T.blockedSegment=xr,T.keyPath=dr,T.componentStack=Et}pt=[V[0],"Suspense Fallback",V[2]],(jt=A.trackedPostpones)!==null&&(Et=[pt[1],pt[2],[],null],jt.workingMap.set(pt,Et),Me.status===5?jt.workingMap.get(V)[4]=Et:Me.trackedFallbackNode=Et),T=Qs(A,null,He,-1,Ee,ht,Me.fallbackState,ie,pt,T.formatContext,T.legacyContext,T.context,T.treeContext,ee,!0),A.pingedTasks.push(T)}return}if(typeof ee=="object"&&ee!==null)switch(ee.$$typeof){case m:He=T.componentStack,T.componentStack={tag:1,parent:T.componentStack,type:ee.render},ie=jo(A,T,V,ee.render,ie,Ee),wn(A,T,V,ie,ya!==0,Vr,Wi),T.componentStack=He;return;case _:ie=bo(ee=ee.type,ie),Is(A,T,V,ee,ie,Ee);return;case g:if(He=ie.children,Ee=T.keyPath,ee=ee._context,ie=ie.value,Me=ee._currentValue,ee._currentValue=ie,an=ie={parent:ht=an,depth:ht===null?0:ht.depth+1,context:ee,parentValue:Me,value:ie},T.context=ie,T.keyPath=V,qa(A,T,He,-1),(A=an)===null)throw Error("Tried to pop a Context at the root of the app. This is a bug in React.");A.context._currentValue=A.parentValue,A=an=A.parent,T.context=A,T.keyPath=Ee;return;case f:ie=(ie=ie.children)(ee._currentValue),ee=T.keyPath,T.keyPath=V,qa(A,T,ie,-1),T.keyPath=ee;return;case c:case R:Ee=T.componentStack,T.componentStack=cs(T,"Lazy"),ie=bo(ee=(He=ee._init)(ee._payload),ie),Is(A,T,V,ee,ie,void 0),T.componentStack=Ee;return}throw Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: "+(ee==null?ee:typeof ee)+".")}}function So(A,T,V,ee,ie){var Ee=T.replay,He=T.blockedBoundary,Me=Cs(A,0,null,T.formatContext,!1,!1);Me.id=V,Me.parentFlushed=!0;try{T.replay=null,T.blockedSegment=Me,pn(A,T,ee,ie),Me.status=1,He===null?A.completedRootSegment=Me:(kn(He,Me),He.parentFlushed&&A.partialBoundaries.push(He))}finally{T.replay=Ee,T.blockedSegment=null}}function qa(A,T,V,ee){if(T.replay!==null&&typeof T.replay.slots=="number")So(A,T,T.replay.slots,V,ee);else if(T.node=V,T.childIndex=ee,V!==null){if(typeof V=="object"){switch(V.$$typeof){case k:var ie=V.type,Ee=V.key,He=V.props,Me=V.ref,ht=ra(ie),pt=Ee??(ee===-1?0:ee);if(Ee=[T.keyPath,ht,pt],T.replay!==null)e:{var jt=T.replay;for(V=0,ee=jt.nodes;V<ee.length;V++){var Et=ee[V];if(pt===Et[1]){if(Et.length===4){if(ht!==null&&ht!==Et[0])throw Error("Expected the resume to render <"+Et[0]+"> in this slot but instead it rendered <"+ht+">. The tree doesn't match so React will fallback to client rendering.");var dr=Et[2];ht=Et[3],pt=T.node,T.replay={nodes:dr,slots:ht,pendingTasks:1};try{if(Is(A,T,Ee,ie,He,Me),T.replay.pendingTasks===1&&0<T.replay.nodes.length)throw Error("Couldn't find all resumable slots by key/index during replaying. The tree doesn't match so React will fallback to client rendering.");T.replay.pendingTasks--}catch(Di){if(typeof Di=="object"&&Di!==null&&(Di===Li||typeof Di.then=="function"))throw T.node===pt&&(T.replay=jt),Di;T.replay.pendingTasks--,He=Hn(A,T.componentStack),Ee=A,A=T.blockedBoundary,He=Va(Ee,ie=Di,He),gs(Ee,A,dr,ht,ie,He)}T.replay=jt}else{if(ie!==C)throw Error("Expected the resume to render <Suspense> in this slot but instead it rendered <"+(ra(ie)||"Unknown")+">. The tree doesn't match so React will fallback to client rendering.");t:{jt=void 0,ie=Et[5],Me=Et[2],ht=Et[3],pt=Et[4]===null?[]:Et[4][2],Et=Et[4]===null?null:Et[4][3];var Sr=T.componentStack,xr=T.componentStack=cs(T,"Suspense"),Vt=T.keyPath,ur=T.replay,wt=T.blockedBoundary,Ra=T.hoistableState,gt=He.children;He=He.fallback;var ei=new Set,Yt=Zs(A,ei);Yt.parentFlushed=!0,Yt.rootSegmentID=ie,T.blockedBoundary=Yt,T.hoistableState=Yt.contentState,T.replay={nodes:Me,slots:ht,pendingTasks:1};try{if(pn(A,T,gt,-1),T.replay.pendingTasks===1&&0<T.replay.nodes.length)throw Error("Couldn't find all resumable slots by key/index during replaying. The tree doesn't match so React will fallback to client rendering.");if(T.replay.pendingTasks--,Yt.pendingTasks===0&&Yt.status===0){Yt.status=1,A.completedBoundaries.push(Yt);break t}}catch(Di){Yt.status=4,dr=Hn(A,T.componentStack),jt=Va(A,Di,dr),Yt.errorDigest=jt,T.replay.pendingTasks--,A.clientRenderedBoundaries.push(Yt)}finally{T.blockedBoundary=wt,T.hoistableState=Ra,T.replay=ur,T.keyPath=Vt,T.componentStack=Sr}T=$o(A,null,{nodes:pt,slots:Et,pendingTasks:0},He,-1,wt,Yt.fallbackState,ei,[Ee[0],"Suspense Fallback",Ee[2]],T.formatContext,T.legacyContext,T.context,T.treeContext,xr,!0),A.pingedTasks.push(T)}}ee.splice(V,1);break e}}}else Is(A,T,Ee,ie,He,Me);return;case E:throw Error("Portals are not currently supported by the server renderer. Render them conditionally so that they only appear on the client render.");case R:He=T.componentStack,T.componentStack=cs(T,"Lazy"),V=(Ee=V._init)(V._payload),T.componentStack=He,qa(A,T,V,ee);return}if(se(V)){Js(A,T,V,ee);return}if((He=V===null||typeof V!="object"?null:typeof(He=q&&V[q]||V["@@iterator"])=="function"?He:null)&&(He=He.call(V))){if(!(V=He.next()).done){Ee=[];do Ee.push(V.value),V=He.next();while(!V.done);Js(A,T,Ee,ee)}return}if(typeof V.then=="function")return T.thenableState=null,qa(A,T,fn(V),ee);if(V.$$typeof===f)return qa(A,T,V._currentValue,ee);throw Error("Objects are not valid as a React child (found: "+((ee=Object.prototype.toString.call(V))==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":ee)+"). If you meant to render a collection of children, use an array instead.")}typeof V=="string"?(ee=T.blockedSegment)!==null&&(ee.lastPushedText=gr(ee.chunks,V,A.renderState,ee.lastPushedText)):typeof V=="number"&&(ee=T.blockedSegment)!==null&&(ee.lastPushedText=gr(ee.chunks,""+V,A.renderState,ee.lastPushedText))}}function Js(A,T,V,ee){var ie=T.keyPath;if(ee!==-1&&(T.keyPath=[T.keyPath,"Fragment",ee],T.replay!==null)){for(var Ee=T.replay,He=Ee.nodes,Me=0;Me<He.length;Me++){var ht=He[Me];if(ht[1]===ee){ee=ht[2],ht=ht[3],T.replay={nodes:ee,slots:ht,pendingTasks:1};try{if(Js(A,T,V,-1),T.replay.pendingTasks===1&&0<T.replay.nodes.length)throw Error("Couldn't find all resumable slots by key/index during replaying. The tree doesn't match so React will fallback to client rendering.");T.replay.pendingTasks--}catch(jt){if(typeof jt=="object"&&jt!==null&&(jt===Li||typeof jt.then=="function"))throw jt;T.replay.pendingTasks--,V=Hn(A,T.componentStack);var pt=T.blockedBoundary;V=Va(A,jt,V),gs(A,pt,ee,ht,jt,V)}T.replay=Ee,He.splice(Me,1);break}}T.keyPath=ie;return}if(Ee=T.treeContext,He=V.length,T.replay!==null&&(Me=T.replay.slots)!==null&&typeof Me=="object"){for(ee=0;ee<He;ee++)ht=V[ee],T.treeContext=Bn(Ee,He,ee),typeof(pt=Me[ee])=="number"?(So(A,T,pt,ht,ee),delete Me[ee]):pn(A,T,ht,ee);T.treeContext=Ee,T.keyPath=ie;return}for(Me=0;Me<He;Me++)ee=V[Me],T.treeContext=Bn(Ee,He,Me),pn(A,T,ee,Me);T.treeContext=Ee,T.keyPath=ie}function Ls(A,T){(A=A.trackedPostpones)!==null&&(T=T.trackedContentKeyPath)!==null&&(T=A.workingMap.get(T))!==void 0&&(T.length=4,T[2]=[],T[3]=null)}function pn(A,T,V,ee){var ie=T.formatContext,Ee=T.legacyContext,He=T.context,Me=T.keyPath,ht=T.treeContext,pt=T.componentStack,jt=T.blockedSegment;if(jt===null)try{return qa(A,T,V,ee)}catch(Sr){if(ka(),typeof(V=Sr===Li?Ha():Sr)=="object"&&V!==null&&typeof V.then=="function"){A=$o(A,ee=Pi(),T.replay,T.node,T.childIndex,T.blockedBoundary,T.hoistableState,T.abortSet,T.keyPath,T.formatContext,T.legacyContext,T.context,T.treeContext,T.componentStack!==null?T.componentStack.parent:null,T.isFallback).ping,V.then(A,A),T.formatContext=ie,T.legacyContext=Ee,T.context=He,T.keyPath=Me,T.treeContext=ht,T.componentStack=pt,Dn(He);return}}else{var Et=jt.children.length,dr=jt.chunks.length;try{return qa(A,T,V,ee)}catch(Sr){if(ka(),jt.children.length=Et,jt.chunks.length=dr,typeof(V=Sr===Li?Ha():Sr)=="object"&&V!==null&&typeof V.then=="function"){ee=Pi(),Et=Cs(A,(jt=T.blockedSegment).chunks.length,null,T.formatContext,jt.lastPushedText,!0),jt.children.push(Et),jt.lastPushedText=!1,A=Qs(A,ee,T.node,T.childIndex,T.blockedBoundary,Et,T.hoistableState,T.abortSet,T.keyPath,T.formatContext,T.legacyContext,T.context,T.treeContext,T.componentStack!==null?T.componentStack.parent:null,T.isFallback).ping,V.then(A,A),T.formatContext=ie,T.legacyContext=Ee,T.context=He,T.keyPath=Me,T.treeContext=ht,T.componentStack=pt,Dn(He);return}}}throw T.formatContext=ie,T.legacyContext=Ee,T.context=He,T.keyPath=Me,T.treeContext=ht,Dn(He),V}function xo(A){var T=A.blockedBoundary;(A=A.blockedSegment)!==null&&(A.status=3,Nn(this,T,A))}function gs(A,T,V,ee,ie,Ee){for(var He=0;He<V.length;He++){var Me=V[He];if(Me.length===4)gs(A,T,Me[2],Me[3],ie,Ee);else{Me=Me[5];var ht=Zs(A,new Set);ht.parentFlushed=!0,ht.rootSegmentID=Me,ht.status=4,ht.errorDigest=Ee,ht.parentFlushed&&A.clientRenderedBoundaries.push(ht)}}if(V.length=0,ee!==null){if(T===null)throw Error("We should not have any resumable nodes in the shell. This is a bug in React.");if(T.status!==4&&(T.status=4,T.errorDigest=Ee,T.parentFlushed&&A.clientRenderedBoundaries.push(T)),typeof ee=="object")for(var pt in ee)delete ee[pt]}}function eo(A,T){try{var V=A.renderState,ee=V.onHeaders;if(ee){var ie=V.headers;if(ie){V.headers=null;var Ee=ie.preconnects;if(ie.fontPreloads&&(Ee&&(Ee+=", "),Ee+=ie.fontPreloads),ie.highImagePreloads&&(Ee&&(Ee+=", "),Ee+=ie.highImagePreloads),!T){var He=V.styles.values(),Me=He.next();e:for(;0<ie.remainingCapacity&&!Me.done;Me=He.next())for(var ht=Me.value.sheets.values(),pt=ht.next();0<ie.remainingCapacity&&!pt.done;pt=ht.next()){var jt=pt.value,Et=jt.props,dr=Et.href,Sr=jt.props,xr=Qr(Sr.href,"style",{crossOrigin:Sr.crossOrigin,integrity:Sr.integrity,nonce:Sr.nonce,type:Sr.type,fetchPriority:Sr.fetchPriority,referrerPolicy:Sr.referrerPolicy,media:Sr.media});if(2<=(ie.remainingCapacity-=xr.length))V.resets.style[dr]=Xe,Ee&&(Ee+=", "),Ee+=xr,V.resets.style[dr]=typeof Et.crossOrigin=="string"||typeof Et.integrity=="string"?[Et.crossOrigin,Et.integrity]:Xe;else break e}}ee(Ee?{Link:Ee}:{})}}}catch(Vt){Va(A,Vt,{})}}function gn(A){A.trackedPostpones===null&&eo(A,!0),A.onShellError=Mn,(A=A.onShellReady)()}function Yi(A){eo(A,A.trackedPostpones===null||A.completedRootSegment===null||A.completedRootSegment.status!==5),(A=A.onAllReady)()}function kn(A,T){if(T.chunks.length===0&&T.children.length===1&&T.children[0].boundary===null&&T.children[0].id===-1){var V=T.children[0];V.id=T.id,V.parentFlushed=!0,V.status===1&&kn(A,V)}else A.completedSegments.push(T)}function Nn(A,T,V){if(T===null){if(V!==null&&V.parentFlushed){if(A.completedRootSegment!==null)throw Error("There can only be one root segment. This is a bug in React.");A.completedRootSegment=V}A.pendingRootTasks--,A.pendingRootTasks===0&&gn(A)}else T.pendingTasks--,T.status!==4&&(T.pendingTasks===0?(T.status===0&&(T.status=1),V!==null&&V.parentFlushed&&V.status===1&&kn(T,V),T.parentFlushed&&A.completedBoundaries.push(T),T.status===1&&(T.fallbackAbortableTasks.forEach(xo,A),T.fallbackAbortableTasks.clear())):V!==null&&V.parentFlushed&&V.status===1&&(kn(T,V),T.completedSegments.length===1&&T.parentFlushed&&A.partialBoundaries.push(T)));A.allPendingTasks--,A.allPendingTasks===0&&Yi(A)}function To(A){if(A.status!==2){var T=an,V=vo.current;vo.current=Ys;var ee=As.current;As.current=Qo;var ie=ds;ds=A;var Ee=ts;ts=A.resumableState;try{var He,Me=A.pingedTasks;for(He=0;He<Me.length;He++){var ht=Me[He],pt=A,jt=ht.blockedSegment;if(jt===null){var Et=pt;if(ht.replay.pendingTasks!==0){Dn(ht.context);try{if(qa(Et,ht,ht.node,ht.childIndex),ht.replay.pendingTasks===1&&0<ht.replay.nodes.length)throw Error("Couldn't find all resumable slots by key/index during replaying. The tree doesn't match so React will fallback to client rendering.");ht.replay.pendingTasks--,ht.abortSet.delete(ht),Nn(Et,ht.blockedBoundary,null)}catch(ua){ka();var dr=ua===Li?Ha():ua;if(typeof dr=="object"&&dr!==null&&typeof dr.then=="function"){var Sr=ht.ping;dr.then(Sr,Sr),ht.thenableState=Pi()}else{ht.replay.pendingTasks--,ht.abortSet.delete(ht);var xr=Hn(Et,ht.componentStack);pt=void 0;var Vt=Et,ur=ht.blockedBoundary,wt=ht.replay.nodes,Ra=ht.replay.slots;pt=Va(Vt,dr,xr),gs(Vt,ur,wt,Ra,dr,pt),Et.pendingRootTasks--,Et.pendingRootTasks===0&&gn(Et),Et.allPendingTasks--,Et.allPendingTasks===0&&Yi(Et)}}finally{}}}else if(Et=void 0,Vt=jt,Vt.status===0){Dn(ht.context);var gt=Vt.children.length,ei=Vt.chunks.length;try{qa(pt,ht,ht.node,ht.childIndex),Vt.lastPushedText&&Vt.textEmbedded&&Vt.chunks.push(hr),ht.abortSet.delete(ht),Vt.status=1,Nn(pt,ht.blockedBoundary,Vt)}catch(ua){ka(),Vt.children.length=gt,Vt.chunks.length=ei;var Yt=ua===Li?Ha():ua;if(typeof Yt=="object"&&Yt!==null&&typeof Yt.then=="function"){var Di=ht.ping;Yt.then(Di,Di),ht.thenableState=Pi()}else{var va=Hn(pt,ht.componentStack);ht.abortSet.delete(ht),Vt.status=4;var Xi=ht.blockedBoundary;Et=Va(pt,Yt,va),Xi===null?Ca(pt,Yt):(Xi.pendingTasks--,Xi.status!==4&&(Xi.status=4,Xi.errorDigest=Et,Ls(pt,Xi),Xi.parentFlushed&&pt.clientRenderedBoundaries.push(Xi))),pt.allPendingTasks--,pt.allPendingTasks===0&&Yi(pt)}}finally{}}}Me.splice(0,He),A.destination!==null&&io(A,A.destination)}catch(ua){Va(A,ua,{}),Ca(A,ua)}finally{ts=Ee,vo.current=V,As.current=ee,V===Ys&&Dn(T),ds=ie}}}function to(A,T,V,ee){switch(V.parentFlushed=!0,V.status){case 0:V.id=A.nextSegmentId++;case 5:return ee=V.id,V.lastPushedText=!1,V.textEmbedded=!1,A=A.renderState,b(T,Na),b(T,A.placeholderPrefix),b(T,A=ae(ee.toString(16))),N(T,Fa);case 1:V.status=2;var ie=!0,Ee=V.chunks,He=0;V=V.children;for(var Me=0;Me<V.length;Me++){for(ie=V[Me];He<ie.index;He++)b(T,Ee[He]);ie=Ps(A,T,ie,ee)}for(;He<Ee.length-1;He++)b(T,Ee[He]);return He<Ee.length&&(ie=N(T,Ee[He])),ie;default:throw Error("Aborted, errored or already flushed boundaries should not be flushed again. This is a bug in React.")}}function Ps(A,T,V,ee){var ie=V.boundary;if(ie===null)return to(A,T,V,ee);if(ie.parentFlushed=!0,ie.status===4)ie=ie.errorDigest,N(T,dn),b(T,tn),ie&&(b(T,Wn),b(T,ae(ue(ie))),b(T,ss)),N(T,zn),to(A,T,V,ee);else if(ie.status!==1)ie.status===0&&(ie.rootSegmentID=A.nextSegmentId++),0<ie.completedSegments.length&&A.partialBoundaries.push(ie),vn(T,A.renderState,ie.rootSegmentID),ee&&((ie=ie.fallbackState).styles.forEach(Ii,ee),ie.stylesheets.forEach(ni,ee)),to(A,T,V,ee);else if(ie.byteSize>A.progressiveChunkSize)ie.rootSegmentID=A.nextSegmentId++,A.completedBoundaries.push(ie),vn(T,A.renderState,ie.rootSegmentID),to(A,T,V,ee);else{if(ee&&((V=ie.contentState).styles.forEach(Ii,ee),V.stylesheets.forEach(ni,ee)),N(T,Xr),(V=ie.completedSegments).length!==1)throw Error("A previously unvisited boundary must have exactly one root segment. This is a bug in React.");Ps(A,T,V[0],ee)}return N(T,un)}function ms(A,T,V,ee){return function(ie,Ee,He,Me){switch(He.insertionMode){case 0:case 1:case 2:return b(ie,In),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,$n);case 3:return b(ie,Aa),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,Yn);case 4:return b(ie,lt),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,B);case 5:return b(ie,pe),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,Re);case 6:return b(ie,it),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,yt);case 7:return b(ie,It),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,er);case 8:return b(ie,Zr),b(ie,Ee.segmentPrefix),b(ie,ae(Me.toString(16))),N(ie,vi);default:throw Error("Unknown insertion mode. This is a bug in React.")}}(T,A.renderState,V.parentFormatContext,V.id),Ps(A,T,V,ee),function(ie,Ee){switch(Ee.insertionMode){case 0:case 1:case 2:return N(ie,Ln);case 3:return N(ie,jn);case 4:return N(ie,le);case 5:return N(ie,Pe);case 6:return N(ie,St);case 7:return N(ie,qr);case 8:return N(ie,Ze);default:throw Error("Unknown insertion mode. This is a bug in React.")}}(T,V.parentFormatContext)}function ro(A,T,V){for(var ee,ie,Ee,He,Me=V.completedSegments,ht=0;ht<Me.length;ht++)Ds(A,T,V,Me[ht]);Me.length=0,ft(T,V.contentState,A.renderState),Me=A.resumableState,A=A.renderState,ht=V.rootSegmentID,V=V.contentState;var pt=A.stylesToHoist;A.stylesToHoist=!1;var jt=Me.streamingFormat===0;return jt?(b(T,A.startInlineScript),pt?(2&Me.instructions)==0?(Me.instructions|=10,b(T,ci)):(8&Me.instructions)==0?(Me.instructions|=8,b(T,Ci)):b(T,sr):(2&Me.instructions)==0?(Me.instructions|=2,b(T,Ei)):b(T,wi)):pt?b(T,jr):b(T,Da),Me=ae(ht.toString(16)),b(T,A.boundaryPrefix),b(T,Me),jt?b(T,vr):b(T,Pn),b(T,A.segmentPrefix),b(T,Me),pt?(jt?(b(T,Hr),ee=V,b(T,tr),ie=tr,ee.stylesheets.forEach(function(Et){if(Et.state!==2)if(Et.state===3)b(T,ie),b(T,ae(Le(""+Et.props.href))),b(T,ir),ie=rr;else{b(T,ie);var dr=Et.props["data-precedence"],Sr=Et.props;for(var xr in b(T,ae(Le(""+Et.props.href))),dr=""+dr,b(T,zt),b(T,ae(Le(dr))),Sr)if(fe.call(Sr,xr)){var Vt=Sr[xr];if(Vt!=null)switch(xr){case"href":case"rel":case"precedence":case"data-precedence":break;case"children":case"dangerouslySetInnerHTML":throw Error("link is a self-closing tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:e:{dr=T;var ur=xr.toLowerCase();switch(typeof Vt){case"function":case"symbol":break e}switch(xr){case"innerHTML":case"dangerouslySetInnerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":case"style":case"ref":break e;case"className":ur="class",Vt=""+Vt;break;case"hidden":if(Vt===!1)break e;Vt="";break;case"src":case"href":Vt=""+Vt;break;default:if(2<xr.length&&(xr[0]==="o"||xr[0]==="O")&&(xr[1]==="n"||xr[1]==="N")||!ne(xr))break e;Vt=""+Vt}b(dr,zt),b(dr,ae(Le(ur))),b(dr,zt),b(dr,ae(Le(Vt)))}}}b(T,ir),ie=rr,Et.state=3}})):(b(T,Ga),Ee=V,b(T,tr),He=tr,Ee.stylesheets.forEach(function(Et){if(Et.state!==2)if(Et.state===3)b(T,He),b(T,ae(ue(JSON.stringify(""+Et.props.href)))),b(T,ir),He=rr;else{b(T,He);var dr=Et.props["data-precedence"],Sr=Et.props;for(var xr in b(T,ae(ue(JSON.stringify(""+Et.props.href)))),dr=""+dr,b(T,zt),b(T,ae(ue(JSON.stringify(dr)))),Sr)if(fe.call(Sr,xr)){var Vt=Sr[xr];if(Vt!=null)switch(xr){case"href":case"rel":case"precedence":case"data-precedence":break;case"children":case"dangerouslySetInnerHTML":throw Error("link is a self-closing tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:e:{dr=T;var ur=xr.toLowerCase();switch(typeof Vt){case"function":case"symbol":break e}switch(xr){case"innerHTML":case"dangerouslySetInnerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":case"style":case"ref":break e;case"className":ur="class",Vt=""+Vt;break;case"hidden":if(Vt===!1)break e;Vt="";break;case"src":case"href":Vt=""+Vt;break;default:if(2<xr.length&&(xr[0]==="o"||xr[0]==="O")&&(xr[1]==="n"||xr[1]==="N")||!ne(xr))break e;Vt=""+Vt}b(dr,zt),b(dr,ae(ue(JSON.stringify(ur)))),b(dr,zt),b(dr,ae(ue(JSON.stringify(Vt))))}}}b(T,ir),He=rr,Et.state=3}})),b(T,ir)):jt&&b(T,sa),Me=jt?N(T,pa):N(T,tt),yi(T,A)&&Me}function Ds(A,T,V,ee){if(ee.status===2)return!0;var ie=V.contentState,Ee=ee.id;if(Ee===-1){if((ee.id=V.rootSegmentID)===-1)throw Error("A root segment ID must have been assigned by now. This is a bug in React.");return ms(A,T,ee,ie)}return Ee===V.rootSegmentID?ms(A,T,ee,ie):(ms(A,T,ee,ie),V=A.resumableState,A=A.renderState,(ee=V.streamingFormat===0)?(b(T,A.startInlineScript),(1&V.instructions)==0?(V.instructions|=1,b(T,Kt)):b(T,Gr)):b(T,Fr),b(T,A.segmentPrefix),b(T,Ee=ae(Ee.toString(16))),ee?b(T,bi):b(T,Tr),b(T,A.placeholderPrefix),b(T,Ee),T=ee?N(T,Wt):N(T,tt))}function io(A,T){j=new Uint8Array(2048),M=0;try{var V,ee=A.completedRootSegment;if(ee!==null){if(ee.status===5||A.pendingRootTasks!==0)return;var ie=A.renderState;if((A.allPendingTasks!==0||A.trackedPostpones!==null)&&ie.externalRuntimeScript){var Ee=ie.externalRuntimeScript,He=A.resumableState,Me=Ee.src,ht=Ee.chunks;He.scriptResources.hasOwnProperty(Me)||(He.scriptResources[Me]=null,ie.scripts.add(ht))}var pt,jt=ie.htmlChunks,Et=ie.headChunks;if(jt){for(pt=0;pt<jt.length;pt++)b(T,jt[pt]);if(Et)for(pt=0;pt<Et.length;pt++)b(T,Et[pt]);else b(T,mi("head")),b(T,ti)}else if(Et)for(pt=0;pt<Et.length;pt++)b(T,Et[pt]);var dr=ie.charsetChunks;for(pt=0;pt<dr.length;pt++)b(T,dr[pt]);dr.length=0,ie.preconnects.forEach(Lt,T),ie.preconnects.clear();var Sr=ie.viewportChunks;for(pt=0;pt<Sr.length;pt++)b(T,Sr[pt]);Sr.length=0,ie.fontPreloads.forEach(Lt,T),ie.fontPreloads.clear(),ie.highImagePreloads.forEach(Lt,T),ie.highImagePreloads.clear(),ie.styles.forEach(Nt,T);var xr=ie.importMapChunks;for(pt=0;pt<xr.length;pt++)b(T,xr[pt]);xr.length=0,ie.bootstrapScripts.forEach(Lt,T),ie.scripts.forEach(Lt,T),ie.scripts.clear(),ie.bulkPreloads.forEach(Lt,T),ie.bulkPreloads.clear();var Vt=ie.hoistableChunks;for(pt=0;pt<Vt.length;pt++)b(T,Vt[pt]);Vt.length=0,jt&&Et===null&&b(T,Yr("head")),Ps(A,T,ee,null),A.completedRootSegment=null,yi(T,A.renderState)}var ur=A.renderState;ee=0;var wt=ur.viewportChunks;for(ee=0;ee<wt.length;ee++)b(T,wt[ee]);wt.length=0,ur.preconnects.forEach(Lt,T),ur.preconnects.clear(),ur.fontPreloads.forEach(Lt,T),ur.fontPreloads.clear(),ur.highImagePreloads.forEach(Lt,T),ur.highImagePreloads.clear(),ur.styles.forEach(or,T),ur.scripts.forEach(Lt,T),ur.scripts.clear(),ur.bulkPreloads.forEach(Lt,T),ur.bulkPreloads.clear();var Ra=ur.hoistableChunks;for(ee=0;ee<Ra.length;ee++)b(T,Ra[ee]);Ra.length=0;var gt=A.clientRenderedBoundaries;for(V=0;V<gt.length;V++){var ei=gt[V];ur=T;var Yt=A.resumableState,Di=A.renderState,va=ei.rootSegmentID,Xi=ei.errorDigest,ua=ei.errorMessage,Za=ei.errorComponentStack,Ka=Yt.streamingFormat===0;if(Ka?(b(ur,Di.startInlineScript),(4&Yt.instructions)==0?(Yt.instructions|=4,b(ur,rn)):b(ur,Ua)):b(ur,Si),b(ur,Di.boundaryPrefix),b(ur,ae(va.toString(16))),Ka&&b(ur,bn),(Xi||ua||Za)&&(Ka?(b(ur,Mr),b(ur,ae(he(Xi||"")))):(b(ur,oa),b(ur,ae(ue(Xi||""))))),(ua||Za)&&(Ka?(b(ur,Mr),b(ur,ae(he(ua||"")))):(b(ur,_a),b(ur,ae(ue(ua||""))))),Za&&(Ka?(b(ur,Mr),b(ur,ae(he(Za)))):(b(ur,Sn),b(ur,ae(ue(Za))))),Ka?!N(ur,Ui):!N(ur,tt)){A.destination=null,V++,gt.splice(0,V);return}}gt.splice(0,V);var _n=A.completedBoundaries;for(V=0;V<_n.length;V++)if(!ro(A,T,_n[V])){A.destination=null,V++,_n.splice(0,V);return}_n.splice(0,V),$(T),j=new Uint8Array(2048),M=0;var Qa=A.partialBoundaries;for(V=0;V<Qa.length;V++){var Oa=Qa[V];e:{gt=A,ei=T;var ui=Oa.completedSegments;for(Yt=0;Yt<ui.length;Yt++)if(!Ds(gt,ei,Oa,ui[Yt])){Yt++,ui.splice(0,Yt);var sn=!1;break e}ui.splice(0,Yt),sn=ft(ei,Oa.contentState,gt.renderState)}if(!sn){A.destination=null,V++,Qa.splice(0,V);return}}Qa.splice(0,V);var xa=A.completedBoundaries;for(V=0;V<xa.length;V++)if(!ro(A,T,xa[V])){A.destination=null,V++,xa.splice(0,V);return}xa.splice(0,V)}finally{A.allPendingTasks===0&&A.pingedTasks.length===0&&A.clientRenderedBoundaries.length===0&&A.completedBoundaries.length===0?(A.flushScheduled=!1,(V=A.resumableState).hasBody&&b(T,Yr("body")),V.hasHtml&&b(T,Yr("html")),$(T),T.close(),A.destination=null):$(T)}}function Eo(A){eo(A,A.pendingRootTasks===0)}function rs(A){A.flushScheduled===!1&&A.pingedTasks.length===0&&A.destination!==null&&(A.flushScheduled=!0,setTimeout(function(){var T=A.destination;T?io(A,T):A.flushScheduled=!1},0))}function Os(A,T){try{var V=A.abortableTasks;if(0<V.size){var ee=T===void 0?Error("The render was aborted by the server without a reason."):T;V.forEach(function(ie){return function Ee(He,Me,ht){var pt=He.blockedBoundary,jt=He.blockedSegment;if(jt!==null&&(jt.status=3),pt===null){if(pt={},Me.status!==1&&Me.status!==2){if((He=He.replay)===null){Va(Me,ht,pt),Ca(Me,ht);return}He.pendingTasks--,He.pendingTasks===0&&0<He.nodes.length&&(pt=Va(Me,ht,pt),gs(Me,null,He.nodes,He.slots,ht,pt)),Me.pendingRootTasks--,Me.pendingRootTasks===0&&gn(Me)}}else pt.pendingTasks--,pt.status!==4&&(pt.status=4,He=Hn(Me,He.componentStack),He=Va(Me,ht,He),pt.errorDigest=He,Ls(Me,pt),pt.parentFlushed&&Me.clientRenderedBoundaries.push(pt)),pt.fallbackAbortableTasks.forEach(function(Et){return Ee(Et,Me,ht)}),pt.fallbackAbortableTasks.clear();Me.allPendingTasks--,Me.allPendingTasks===0&&Yi(Me)}(ie,A,ee)}),V.clear()}A.destination!==null&&io(A,A.destination)}catch(ie){Va(A,ie,{}),Ca(A,ie)}}O.renderToReadableStream=function(A,T){return new Promise(function(V,ee){var ie,Ee,He,Me,ht,pt,jt,Et,dr,Sr,xr,Vt,ur,wt,Ra,gt,ei,Yt,Di,va,Xi,ua,Za,Ka,_n=new Promise(function(Ia,ca){Za=Ia,ua=ca}),Qa=T?T.onHeaders:void 0;Qa&&(Ka=function(Ia){Qa(new Headers(Ia))});var Oa=(ie=T?T.identifierPrefix:void 0,Ee=T?T.unstable_externalRuntimeSrc:void 0,He=T?T.bootstrapScriptContent:void 0,Me=T?T.bootstrapScripts:void 0,ht=T?T.bootstrapModules:void 0,pt=0,Ee!==void 0&&(pt=1),{idPrefix:ie===void 0?"":ie,nextFormID:0,streamingFormat:pt,bootstrapScriptContent:He,bootstrapScripts:Me,bootstrapModules:ht,instructions:0,hasBody:!1,hasHtml:!1,unknownResources:{},dnsResources:{},connectResources:{default:{},anonymous:{},credentials:{}},imageResources:{},styleResources:{},scriptResources:{},moduleUnknownResources:{},moduleScriptResources:{}}),ui=(Et=A,dr=Oa,Sr=function(Ia,ca,Nr,Ma,Fn,Zi){var Ja=ca===void 0?Ct:K('<script nonce="'+ue(ca)+'">'),La=Ia.idPrefix,ha=[],Wa=null,mn=Ia.bootstrapScriptContent,on=Ia.bootstrapScripts,Vn=Ia.bootstrapModules;if(mn!==void 0&&ha.push(Ja,ae((""+mn).replace(Or,fr)),ct),Nr!==void 0&&(typeof Nr=="string"?hi((Wa={src:Nr,chunks:[]}).chunks,{src:Nr,async:!0,integrity:void 0,nonce:ca}):hi((Wa={src:Nr.src,chunks:[]}).chunks,{src:Nr.src,async:!0,integrity:Nr.integrity,nonce:ca})),Nr=[],Ma!==void 0&&(Nr.push(Oi),Nr.push(ae((""+JSON.stringify(Ma)).replace(Or,fr))),Nr.push(li)),Ma=Fn?{preconnects:"",fontPreloads:"",highImagePreloads:"",remainingCapacity:typeof Zi=="number"?Zi:2e3}:null,Fn={placeholderPrefix:K(La+"P:"),segmentPrefix:K(La+"S:"),boundaryPrefix:K(La+"B:"),startInlineScript:Ja,htmlChunks:null,headChunks:null,externalRuntimeScript:Wa,bootstrapChunks:ha,importMapChunks:Nr,onHeaders:Fn,headers:Ma,resets:{font:{},dns:{},connect:{default:{},anonymous:{},credentials:{}},image:{},style:{}},charsetChunks:[],viewportChunks:[],hoistableChunks:[],preconnects:new Set,fontPreloads:new Set,highImagePreloads:new Set,styles:new Map,bootstrapScripts:new Set,scripts:new Set,bulkPreloads:new Set,preloads:{images:new Map,stylesheets:new Map,scripts:new Map,moduleScripts:new Map},nonce:ca,hoistableState:null,stylesToHoist:!1},on!==void 0)for(Ja=0;Ja<on.length;Ja++)Nr=on[Ja],Ma=Wa=void 0,Zi={rel:"preload",as:"script",fetchPriority:"low",nonce:ca},typeof Nr=="string"?Zi.href=La=Nr:(Zi.href=La=Nr.src,Zi.integrity=Ma=typeof Nr.integrity=="string"?Nr.integrity:void 0,Zi.crossOrigin=Wa=typeof Nr=="string"||Nr.crossOrigin==null?void 0:Nr.crossOrigin==="use-credentials"?"use-credentials":""),Nr=Ia,mn=La,Nr.scriptResources[mn]=null,Nr.moduleScriptResources[mn]=null,ai(Nr=[],Zi),Fn.bootstrapScripts.add(Nr),ha.push(Tt,ae(ue(La))),ca&&ha.push(mt,ae(ue(ca))),typeof Ma=="string"&&ha.push(cr,ae(ue(Ma))),typeof Wa=="string"&&ha.push(kr,ae(ue(Wa))),ha.push(Ht);if(Vn!==void 0)for(on=0;on<Vn.length;on++)Zi=Vn[on],Wa=La=void 0,Ma={rel:"modulepreload",fetchPriority:"low",nonce:ca},typeof Zi=="string"?Ma.href=Ja=Zi:(Ma.href=Ja=Zi.src,Ma.integrity=Wa=typeof Zi.integrity=="string"?Zi.integrity:void 0,Ma.crossOrigin=La=typeof Zi=="string"||Zi.crossOrigin==null?void 0:Zi.crossOrigin==="use-credentials"?"use-credentials":""),Zi=Ia,Nr=Ja,Zi.scriptResources[Nr]=null,Zi.moduleScriptResources[Nr]=null,ai(Zi=[],Ma),Fn.bootstrapScripts.add(Zi),ha.push(Dt,ae(ue(Ja))),ca&&ha.push(mt,ae(ue(ca))),typeof Wa=="string"&&ha.push(cr,ae(ue(Wa))),typeof La=="string"&&ha.push(kr,ae(ue(La))),ha.push(Ht);return Fn}(Oa,T?T.nonce:void 0,T?T.unstable_externalRuntimeSrc:void 0,T?T.importMap:void 0,Ka,T?T.maxHeadersLength:void 0),xr=At((jt=T?T.namespaceURI:void 0)==="http://www.w3.org/2000/svg"?3:jt==="http://www.w3.org/1998/Math/MathML"?4:0,null,0),Vt=T?T.progressiveChunkSize:void 0,ur=T?T.onError:void 0,wt=Za,Ra=function(){var Ia=new ReadableStream({type:"bytes",pull:function(ca){if(ui.status===1)ui.status=2,ve(ca,ui.fatalError);else if(ui.status!==2&&ui.destination===null){ui.destination=ca;try{io(ui,ca)}catch(Nr){Va(ui,Nr,{}),Ca(ui,Nr)}}},cancel:function(ca){ui.destination=null,Os(ui,ca)}},{highWaterMark:0});Ia.allReady=_n,V(Ia)},gt=function(Ia){_n.catch(function(){}),ee(Ia)},ei=ua,Yt=T?T.onPostpone:void 0,Di=T?T.formState:void 0,be.current=De,va=[],(Sr=Cs(dr={destination:null,flushScheduled:!1,resumableState:dr,renderState:Sr,rootFormatContext:xr,progressiveChunkSize:Vt===void 0?12800:Vt,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:Xi=new Set,pingedTasks:va,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],trackedPostpones:null,onError:ur===void 0?Fo:ur,onPostpone:Yt===void 0?Mn:Yt,onAllReady:wt===void 0?Mn:wt,onShellReady:Ra===void 0?Mn:Ra,onShellError:gt===void 0?Mn:gt,onFatalError:ei===void 0?Mn:ei,formState:Di===void 0?null:Di},0,null,xr,!1,!1)).parentFlushed=!0,Et=Qs(dr,null,Et,-1,null,Sr,null,Xi,null,xr,la,null,$a,null,!1),va.push(Et),dr);if(T&&T.signal){var sn=T.signal;if(sn.aborted)Os(ui,sn.reason);else{var xa=function(){Os(ui,sn.reason),sn.removeEventListener("abort",xa)};sn.addEventListener("abort",xa)}}ui.flushScheduled=ui.destination!==null,setTimeout(qi?function(){return wa.run(ui,To,ui)}:function(){return To(ui)},0),ui.trackedPostpones===null&&setTimeout(qi?function(){return wa.run(ui,Eo,ui)}:function(){return Eo(ui)},0)})},O.version="18.3.0-canary-178c267a4e-20241218"},we.__chunk_10976=(ce,O,u)=>{"use strict";var s=u(24528),x={usingClientEntryPoint:!1,Events:null,Dispatcher:{current:null}};function k(c){var f="https://react.dev/errors/"+c;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)f+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+c+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function E(c,f){return c==="font"?"":typeof f=="string"?f==="use-credentials"?f:"":void 0}var S=x.Dispatcher,d=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function o(){return d.current.useHostTransitionStatus()}function g(c,f,m){return d.current.useFormState(c,f,m)}O.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x,O.createPortal=function(){throw Error(k(448))},O.experimental_useFormState=function(c,f,m){return g(c,f,m)},O.experimental_useFormStatus=function(){return o()},O.flushSync=function(){throw Error(k(449))},O.preconnect=function(c,f){var m=S.current;m&&typeof c=="string"&&(f=f?typeof(f=f.crossOrigin)=="string"?f==="use-credentials"?f:"":void 0:null,m.preconnect(c,f))},O.prefetchDNS=function(c){var f=S.current;f&&typeof c=="string"&&f.prefetchDNS(c)},O.preinit=function(c,f){var m=S.current;if(m&&typeof c=="string"&&f&&typeof f.as=="string"){var C=f.as,I=E(C,f.crossOrigin),_=typeof f.integrity=="string"?f.integrity:void 0,R=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;C==="style"?m.preinitStyle(c,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:I,integrity:_,fetchPriority:R}):C==="script"&&m.preinitScript(c,{crossOrigin:I,integrity:_,fetchPriority:R,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},O.preinitModule=function(c,f){var m=S.current;if(m&&typeof c=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var C=E(f.as,f.crossOrigin);m.preinitModuleScript(c,{crossOrigin:C,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&m.preinitModuleScript(c)},O.preload=function(c,f){var m=S.current;if(m&&typeof c=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var C=f.as,I=E(C,f.crossOrigin);m.preload(c,C,{crossOrigin:I,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0})}},O.preloadModule=function(c,f){var m=S.current;if(m&&typeof c=="string")if(f){var C=E(f.as,f.crossOrigin);m.preloadModule(c,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:C,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else m.preloadModule(c)},O.unstable_batchedUpdates=function(c,f){return c(f)},O.useFormState=g,O.useFormStatus=o,O.version="18.3.0-canary-178c267a4e-20241218"},we.__chunk_69018=ce=>{(function(){"use strict";var O={815:function(k){k.exports=function(S,d,o,g){d=d||"&",o=o||"=";var c={};if(typeof S!="string"||S.length===0)return c;var f=/\+/g;S=S.split(d);var m=1e3;g&&typeof g.maxKeys=="number"&&(m=g.maxKeys);var C=S.length;m>0&&C>m&&(C=m);for(var I=0;I<C;++I){var _,R,F,L,U=S[I].replace(f,"%20"),te=U.indexOf(o);te>=0?(_=U.substr(0,te),R=U.substr(te+1)):(_=U,R=""),F=decodeURIComponent(_),L=decodeURIComponent(R),Object.prototype.hasOwnProperty.call(c,F)?E(c[F])?c[F].push(L):c[F]=[c[F],L]:c[F]=L}return c};var E=Array.isArray||function(S){return Object.prototype.toString.call(S)==="[object Array]"}},577:function(k){var E=function(g){switch(typeof g){case"string":return g;case"boolean":return g?"true":"false";case"number":return isFinite(g)?g:"";default:return""}};k.exports=function(g,c,f,m){return c=c||"&",f=f||"=",g===null&&(g=void 0),typeof g=="object"?d(o(g),function(C){var I=encodeURIComponent(E(C))+f;return S(g[C])?d(g[C],function(_){return I+encodeURIComponent(E(_))}).join(c):I+encodeURIComponent(E(g[C]))}).join(c):m?encodeURIComponent(E(m))+f+encodeURIComponent(E(g)):""};var S=Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"};function d(g,c){if(g.map)return g.map(c);for(var f=[],m=0;m<g.length;m++)f.push(c(g[m],m));return f}var o=Object.keys||function(g){var c=[];for(var f in g)Object.prototype.hasOwnProperty.call(g,f)&&c.push(f);return c}}},u={};function s(k){var E=u[k];if(E!==void 0)return E.exports;var S=u[k]={exports:{}},d=!0;try{O[k](S,S.exports,s),d=!1}finally{d&&delete u[k]}return S.exports}s.ab="//";var x={};x.decode=x.parse=s(815),x.encode=x.stringify=s(577),ce.exports=x})()},we.__chunk_37529=(ce,O)=>{"use strict";function u(k,E){E===void 0&&(E={});for(var S=function(j){for(var M=[],b=0;b<j.length;){var N=j[b];if(N==="*"||N==="+"||N==="?"){M.push({type:"MODIFIER",index:b,value:j[b++]});continue}if(N==="\\"){M.push({type:"ESCAPED_CHAR",index:b++,value:j[b++]});continue}if(N==="{"){M.push({type:"OPEN",index:b,value:j[b++]});continue}if(N==="}"){M.push({type:"CLOSE",index:b,value:j[b++]});continue}if(N===":"){for(var $="",X=b+1;X<j.length;){var ae=j.charCodeAt(X);if(ae>=48&&ae<=57||ae>=65&&ae<=90||ae>=97&&ae<=122||ae===95){$+=j[X++];continue}break}if(!$)throw TypeError("Missing parameter name at "+b);M.push({type:"NAME",index:b,value:$}),b=X;continue}if(N==="("){var K=1,ve="",X=b+1;if(j[X]==="?")throw TypeError('Pattern cannot start with "?" at '+X);for(;X<j.length;){if(j[X]==="\\"){ve+=j[X++]+j[X++];continue}if(j[X]===")"){if(--K==0){X++;break}}else if(j[X]==="("&&(K++,j[X+1]!=="?"))throw TypeError("Capturing groups are not allowed at "+X);ve+=j[X++]}if(K)throw TypeError("Unbalanced pattern at "+b);if(!ve)throw TypeError("Missing pattern at "+b);M.push({type:"PATTERN",index:b,value:ve}),b=X;continue}M.push({type:"CHAR",index:b,value:j[b++]})}return M.push({type:"END",index:b,value:""}),M}(k),d=E.prefixes,o=d===void 0?"./":d,g="[^"+s(E.delimiter||"/#?")+"]+?",c=[],f=0,m=0,C="",I=function(j){if(m<S.length&&S[m].type===j)return S[m++].value},_=function(j){var M=I(j);if(M!==void 0)return M;var b=S[m];throw TypeError("Unexpected "+b.type+" at "+b.index+", expected "+j)},R=function(){for(var j,M="";j=I("CHAR")||I("ESCAPED_CHAR");)M+=j;return M};m<S.length;){var F=I("CHAR"),L=I("NAME"),U=I("PATTERN");if(L||U){var te=F||"";o.indexOf(te)===-1&&(C+=te,te=""),C&&(c.push(C),C=""),c.push({name:L||f++,prefix:te,suffix:"",pattern:U||g,modifier:I("MODIFIER")||""});continue}var Y=F||I("ESCAPED_CHAR");if(Y){C+=Y;continue}if(C&&(c.push(C),C=""),I("OPEN")){var te=R(),q=I("NAME")||"",se=I("PATTERN")||"",J=R();_("CLOSE"),c.push({name:q||(se?f++:""),pattern:q&&!se?g:se,prefix:te,suffix:J,modifier:I("MODIFIER")||""});continue}_("END")}return c}function s(k){return k.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function x(k){return k&&k.sensitive?"":"i"}O.MY=function(k,E){var S,d,o,g,c,f,m,C;return S=u(k,E),(d=E)===void 0&&(d={}),o=x(d),c=(g=d.encode)===void 0?function(I){return I}:g,m=(f=d.validate)===void 0||f,C=S.map(function(I){if(typeof I=="object")return RegExp("^(?:"+I.pattern+")$",o)}),function(I){for(var _="",R=0;R<S.length;R++){var F=S[R];if(typeof F=="string"){_+=F;continue}var L=I?I[F.name]:void 0,U=F.modifier==="?"||F.modifier==="*",te=F.modifier==="*"||F.modifier==="+";if(Array.isArray(L)){if(!te)throw TypeError('Expected "'+F.name+'" to not repeat, but got an array');if(L.length===0){if(U)continue;throw TypeError('Expected "'+F.name+'" to not be empty')}for(var Y=0;Y<L.length;Y++){var q=c(L[Y],F);if(m&&!C[R].test(q))throw TypeError('Expected all "'+F.name+'" to match "'+F.pattern+'", but got "'+q+'"');_+=F.prefix+q+F.suffix}continue}if(typeof L=="string"||typeof L=="number"){var q=c(String(L),F);if(m&&!C[R].test(q))throw TypeError('Expected "'+F.name+'" to match "'+F.pattern+'", but got "'+q+'"');_+=F.prefix+q+F.suffix;continue}if(!U){var se=te?"an array":"a string";throw TypeError('Expected "'+F.name+'" to be '+se)}}return _}},O.WS=function(k,E,S){S===void 0&&(S={});var d=S.decode,o=d===void 0?function(g){return g}:d;return function(g){var c=k.exec(g);if(!c)return!1;for(var f=c[0],m=c.index,C=Object.create(null),I=1;I<c.length;I++)(function(_){if(c[_]!==void 0){var R=E[_-1];R.modifier==="*"||R.modifier==="+"?C[R.name]=c[_].split(R.prefix+R.suffix).map(function(F){return o(F,R)}):C[R.name]=o(c[_],R)}})(I);return{path:f,index:m,params:C}}},O.Bo=function k(E,S,d){return E instanceof RegExp?function(o,g){if(!g)return o;var c=o.source.match(/\((?!\?)/g);if(c)for(var f=0;f<c.length;f++)g.push({name:f,prefix:"",suffix:"",modifier:"",pattern:""});return o}(E,S):Array.isArray(E)?RegExp("(?:"+E.map(function(o){return k(o,S,d).source}).join("|")+")",x(d)):function(o,g,c){c===void 0&&(c={});for(var f=c.strict,m=f!==void 0&&f,C=c.start,I=c.end,_=c.encode,R=_===void 0?function(b){return b}:_,F="["+s(c.endsWith||"")+"]|$",L="["+s(c.delimiter||"/#?")+"]",U=C===void 0||C?"^":"",te=0;te<o.length;te++){var Y=o[te];if(typeof Y=="string")U+=s(R(Y));else{var q=s(R(Y.prefix)),se=s(R(Y.suffix));if(Y.pattern)if(g&&g.push(Y),q||se)if(Y.modifier==="+"||Y.modifier==="*"){var J=Y.modifier==="*"?"?":"";U+="(?:"+q+"((?:"+Y.pattern+")(?:"+se+q+"(?:"+Y.pattern+"))*)"+se+")"+J}else U+="(?:"+q+"("+Y.pattern+")"+se+")"+Y.modifier;else U+="("+Y.pattern+")"+Y.modifier;else U+="(?:"+q+se+")"+Y.modifier}}if(I===void 0||I)m||(U+=L+"?"),U+=c.endsWith?"(?="+F+")":"$";else{var j=o[o.length-1],M=typeof j=="string"?L.indexOf(j[j.length-1])>-1:j===void 0;m||(U+="(?:"+L+"(?="+F+"))?"),M||(U+="(?="+L+"|"+F+")")}return new RegExp(U,x(c))}(u(E,d),S,d)}},we.__chunk_75665=ce=>{(function(){"use strict";var O={114:function(k){function E(o){if(typeof o!="string")throw TypeError("Path must be a string. Received "+JSON.stringify(o))}function S(o,g){for(var c,f="",m=0,C=-1,I=0,_=0;_<=o.length;++_){if(_<o.length)c=o.charCodeAt(_);else{if(c===47)break;c=47}if(c===47){if(!(C===_-1||I===1))if(C!==_-1&&I===2){if(f.length<2||m!==2||f.charCodeAt(f.length-1)!==46||f.charCodeAt(f.length-2)!==46){if(f.length>2){var R=f.lastIndexOf("/");if(R!==f.length-1){R===-1?(f="",m=0):m=(f=f.slice(0,R)).length-1-f.lastIndexOf("/"),C=_,I=0;continue}}else if(f.length===2||f.length===1){f="",m=0,C=_,I=0;continue}}g&&(f.length>0?f+="/..":f="..",m=2)}else f.length>0?f+="/"+o.slice(C+1,_):f=o.slice(C+1,_),m=_-C-1;C=_,I=0}else c===46&&I!==-1?++I:I=-1}return f}var d={resolve:function(){for(var o,g,c="",f=!1,m=arguments.length-1;m>=-1&&!f;m--)m>=0?g=arguments[m]:(o===void 0&&(o=""),g=o),E(g),g.length!==0&&(c=g+"/"+c,f=g.charCodeAt(0)===47);return c=S(c,!f),f?c.length>0?"/"+c:"/":c.length>0?c:"."},normalize:function(o){if(E(o),o.length===0)return".";var g=o.charCodeAt(0)===47,c=o.charCodeAt(o.length-1)===47;return(o=S(o,!g)).length!==0||g||(o="."),o.length>0&&c&&(o+="/"),g?"/"+o:o},isAbsolute:function(o){return E(o),o.length>0&&o.charCodeAt(0)===47},join:function(){if(arguments.length==0)return".";for(var o,g=0;g<arguments.length;++g){var c=arguments[g];E(c),c.length>0&&(o===void 0?o=c:o+="/"+c)}return o===void 0?".":d.normalize(o)},relative:function(o,g){if(E(o),E(g),o===g||(o=d.resolve(o))===(g=d.resolve(g)))return"";for(var c=1;c<o.length&&o.charCodeAt(c)===47;++c);for(var f=o.length,m=f-c,C=1;C<g.length&&g.charCodeAt(C)===47;++C);for(var I=g.length-C,_=m<I?m:I,R=-1,F=0;F<=_;++F){if(F===_){if(I>_){if(g.charCodeAt(C+F)===47)return g.slice(C+F+1);if(F===0)return g.slice(C+F)}else m>_&&(o.charCodeAt(c+F)===47?R=F:F===0&&(R=0));break}var L=o.charCodeAt(c+F);if(L!==g.charCodeAt(C+F))break;L===47&&(R=F)}var U="";for(F=c+R+1;F<=f;++F)(F===f||o.charCodeAt(F)===47)&&(U.length===0?U+="..":U+="/..");return U.length>0?U+g.slice(C+R):(C+=R,g.charCodeAt(C)===47&&++C,g.slice(C))},_makeLong:function(o){return o},dirname:function(o){if(E(o),o.length===0)return".";for(var g=o.charCodeAt(0),c=g===47,f=-1,m=!0,C=o.length-1;C>=1;--C)if((g=o.charCodeAt(C))===47){if(!m){f=C;break}}else m=!1;return f===-1?c?"/":".":c&&f===1?"//":o.slice(0,f)},basename:function(o,g){if(g!==void 0&&typeof g!="string")throw TypeError('"ext" argument must be a string');E(o);var c,f=0,m=-1,C=!0;if(g!==void 0&&g.length>0&&g.length<=o.length){if(g.length===o.length&&g===o)return"";var I=g.length-1,_=-1;for(c=o.length-1;c>=0;--c){var R=o.charCodeAt(c);if(R===47){if(!C){f=c+1;break}}else _===-1&&(C=!1,_=c+1),I>=0&&(R===g.charCodeAt(I)?--I==-1&&(m=c):(I=-1,m=_))}return f===m?m=_:m===-1&&(m=o.length),o.slice(f,m)}for(c=o.length-1;c>=0;--c)if(o.charCodeAt(c)===47){if(!C){f=c+1;break}}else m===-1&&(C=!1,m=c+1);return m===-1?"":o.slice(f,m)},extname:function(o){E(o);for(var g=-1,c=0,f=-1,m=!0,C=0,I=o.length-1;I>=0;--I){var _=o.charCodeAt(I);if(_===47){if(!m){c=I+1;break}continue}f===-1&&(m=!1,f=I+1),_===46?g===-1?g=I:C!==1&&(C=1):g!==-1&&(C=-1)}return g===-1||f===-1||C===0||C===1&&g===f-1&&g===c+1?"":o.slice(g,f)},format:function(o){var g,c;if(o===null||typeof o!="object")throw TypeError('The "pathObject" argument must be of type Object. Received type '+typeof o);return g=o.dir||o.root,c=o.base||(o.name||"")+(o.ext||""),g?g===o.root?g+c:g+"/"+c:c},parse:function(o){E(o);var g,c={root:"",dir:"",base:"",ext:"",name:""};if(o.length===0)return c;var f=o.charCodeAt(0),m=f===47;m?(c.root="/",g=1):g=0;for(var C=-1,I=0,_=-1,R=!0,F=o.length-1,L=0;F>=g;--F){if((f=o.charCodeAt(F))===47){if(!R){I=F+1;break}continue}_===-1&&(R=!1,_=F+1),f===46?C===-1?C=F:L!==1&&(L=1):C!==-1&&(L=-1)}return C===-1||_===-1||L===0||L===1&&C===_-1&&C===I+1?_!==-1&&(I===0&&m?c.base=c.name=o.slice(1,_):c.base=c.name=o.slice(I,_)):(I===0&&m?(c.name=o.slice(1,C),c.base=o.slice(1,_)):(c.name=o.slice(I,C),c.base=o.slice(I,_)),c.ext=o.slice(C,_)),I>0?c.dir=o.slice(0,I-1):m&&(c.dir="/"),c},sep:"/",delimiter:":",win32:null,posix:null};d.posix=d,k.exports=d}},u={};function s(k){var E=u[k];if(E!==void 0)return E.exports;var S=u[k]={exports:{}},d=!0;try{O[k](S,S.exports,s),d=!1}finally{d&&delete u[k]}return S.exports}s.ab="//";var x=s(114);ce.exports=x})()},we.__chunk_28668=(ce,O,u)=>{(function(){var s={452:function(S){"use strict";S.exports=u(69018)}},x={};function k(S){var d=x[S];if(d!==void 0)return d.exports;var o=x[S]={exports:{}},g=!0;try{s[S](o,o.exports,k),g=!1}finally{g&&delete x[S]}return o.exports}k.ab="//";var E={};(function(){var S,d=(S=k(452))&&typeof S=="object"&&"default"in S?S.default:S,o=/https?|ftp|gopher|file/;function g(q){typeof q=="string"&&(q=Y(q));var se,J,j,M,b,N,$,X,ae,K=(J=(se=q).auth,j=se.hostname,M=se.protocol||"",b=se.pathname||"",N=se.hash||"",$=se.query||"",X=!1,J=J?encodeURIComponent(J).replace(/%3A/i,":")+"@":"",se.host?X=J+se.host:j&&(X=J+(~j.indexOf(":")?"["+j+"]":j),se.port&&(X+=":"+se.port)),$&&typeof $=="object"&&($=d.encode($)),ae=se.search||$&&"?"+$||"",M&&M.substr(-1)!==":"&&(M+=":"),se.slashes||(!M||o.test(M))&&X!==!1?(X="//"+(X||""),b&&b[0]!=="/"&&(b="/"+b)):X||(X=""),N&&N[0]!=="#"&&(N="#"+N),ae&&ae[0]!=="?"&&(ae="?"+ae),{protocol:M,host:X,pathname:b=b.replace(/[?#]/g,encodeURIComponent),search:ae=ae.replace("#","%23"),hash:N});return""+K.protocol+K.host+K.pathname+K.search+K.hash}var c="http://",f=c+"w.w",m=/^([a-z0-9.+-]*:\/\/\/)([a-z0-9.+-]:\/*)?/i,C=/https?|ftp|gopher|file/;function I(q,se){var J=typeof q=="string"?Y(q):q;q=typeof q=="object"?g(q):q;var j=Y(se),M="";J.protocol&&!J.slashes&&(M=J.protocol,q=q.replace(J.protocol,""),M+=se[0]==="/"||q[0]==="/"?"/":""),M&&j.protocol&&(M="",j.slashes||(M=j.protocol,se=se.replace(j.protocol,"")));var b=q.match(m);b&&!j.protocol&&(q=q.substr((M=b[1]+(b[2]||"")).length),/^\/\/[^/]/.test(se)&&(M=M.slice(0,-1)));var N=new URL(q,f+"/"),$=new URL(se,N).toString().replace(f,""),X=j.protocol||J.protocol;return X+=J.slashes||j.slashes?"//":"",!M&&X?$=$.replace(c,X):M&&($=$.replace(c,"")),C.test($)||~se.indexOf(".")||q.slice(-1)==="/"||se.slice(-1)==="/"||$.slice(-1)!=="/"||($=$.slice(0,-1)),M&&($=M+($[0]==="/"?$.substr(1):$)),$}function _(){}_.prototype.parse=Y,_.prototype.format=g,_.prototype.resolve=I,_.prototype.resolveObject=I;var R=/^https?|ftp|gopher|file/,F=/^(.*?)([#?].*)/,L=/^([a-z0-9.+-]*:)(\/{0,3})(.*)/i,U=/^([a-z0-9.+-]*:)?\/\/\/*/i,te=/^([a-z0-9.+-]*:)(\/{0,2})\[(.*)\]$/i;function Y(q,se,J){if(se===void 0&&(se=!1),J===void 0&&(J=!1),q&&typeof q=="object"&&q instanceof _)return q;var j=(q=q.trim()).match(F);q=j?j[1].replace(/\\/g,"/")+j[2]:q.replace(/\\/g,"/"),te.test(q)&&q.slice(-1)!=="/"&&(q+="/");var M=!/(^javascript)/.test(q)&&q.match(L),b=U.test(q),N="";M&&(R.test(M[1])||(N=M[1].toLowerCase(),q=""+M[2]+M[3]),M[2]||(b=!1,R.test(M[1])?(N=M[1],q=""+M[3]):q="//"+M[3]),M[2].length!==3&&M[2].length!==1||(N=M[1],q="/"+M[3]));var $,X=(j?j[1]:q).match(/^https?:\/\/[^/]+(:[0-9]+)(?=\/|$)/),ae=X&&X[1],K=new _,ve="",ke="";try{$=new URL(q)}catch(_e){ve=_e,N||J||!/^\/\//.test(q)||/^\/\/.+[@.]/.test(q)||(ke="/",q=q.substr(1));try{$=new URL(q,f)}catch{return K.protocol=N,K.href=N,K}}K.slashes=b&&!ke,K.host=$.host==="w.w"?"":$.host,K.hostname=$.hostname==="w.w"?"":$.hostname.replace(/(\[|\])/g,""),K.protocol=ve?N||null:$.protocol,K.search=$.search.replace(/\\/g,"%5C"),K.hash=$.hash.replace(/\\/g,"%5C");var fe=q.split("#");!K.search&&~fe[0].indexOf("?")&&(K.search="?"),K.hash||fe[1]!==""||(K.hash="#"),K.query=se?d.decode($.search.substr(1)):K.search.substr(1),K.pathname=ke+(M?$.pathname.replace(/['^|`]/g,function(_e){return"%"+_e.charCodeAt().toString(16).toUpperCase()}).replace(/((?:%[0-9A-F]{2})+)/g,function(_e,Z){try{return decodeURIComponent(Z).split("").map(function(ne){var W=ne.charCodeAt();return W>256||/^[a-z0-9]$/i.test(ne)?ne:"%"+W.toString(16).toUpperCase()}).join("")}catch{return Z}}):$.pathname),K.protocol==="about:"&&K.pathname==="blank"&&(K.protocol="",K.pathname=""),ve&&q[0]!=="/"&&(K.pathname=K.pathname.substr(1)),N&&!R.test(N)&&q.slice(-1)!=="/"&&K.pathname==="/"&&(K.pathname=""),K.path=K.pathname+K.search,K.auth=[$.username,$.password].map(decodeURIComponent).filter(Boolean).join(":"),K.port=$.port,ae&&!K.host.endsWith(ae)&&(K.host+=ae,K.port=ae.slice(1)),K.href=ke?""+K.pathname+K.search+K.hash:g(K);var Ae=/^(file)/.test(K.href)?["host","hostname"]:[];return Object.keys(K).forEach(function(_e){~Ae.indexOf(_e)||(K[_e]=K[_e]||null)}),K}E.parse=Y,E.format=g,E.resolve=I,E.resolveObject=function(q,se){return Y(I(q,se))},E.Url=_})(),ce.exports=E})()},we.__chunk_65530=ce=>{(()=>{"use strict";var O={806:(k,E,S)=>{let d=S(190),o=Symbol("max"),g=Symbol("length"),c=Symbol("lengthCalculator"),f=Symbol("allowStale"),m=Symbol("maxAge"),C=Symbol("dispose"),I=Symbol("noDisposeOnSet"),_=Symbol("lruList"),R=Symbol("cache"),F=Symbol("updateAgeOnGet"),L=()=>1;class U{constructor(b){if(typeof b=="number"&&(b={max:b}),b||(b={}),b.max&&(typeof b.max!="number"||b.max<0))throw TypeError("max must be a non-negative number");this[o]=b.max||1/0;let N=b.length||L;if(this[c]=typeof N!="function"?L:N,this[f]=b.stale||!1,b.maxAge&&typeof b.maxAge!="number")throw TypeError("maxAge must be a number");this[m]=b.maxAge||0,this[C]=b.dispose,this[I]=b.noDisposeOnSet||!1,this[F]=b.updateAgeOnGet||!1,this.reset()}set max(b){if(typeof b!="number"||b<0)throw TypeError("max must be a non-negative number");this[o]=b||1/0,q(this)}get max(){return this[o]}set allowStale(b){this[f]=!!b}get allowStale(){return this[f]}set maxAge(b){if(typeof b!="number")throw TypeError("maxAge must be a non-negative number");this[m]=b,q(this)}get maxAge(){return this[m]}set lengthCalculator(b){typeof b!="function"&&(b=L),b!==this[c]&&(this[c]=b,this[g]=0,this[_].forEach(N=>{N.length=this[c](N.value,N.key),this[g]+=N.length})),q(this)}get lengthCalculator(){return this[c]}get length(){return this[g]}get itemCount(){return this[_].length}rforEach(b,N){N=N||this;for(let $=this[_].tail;$!==null;){let X=$.prev;j(this,b,$,N),$=X}}forEach(b,N){N=N||this;for(let $=this[_].head;$!==null;){let X=$.next;j(this,b,$,N),$=X}}keys(){return this[_].toArray().map(b=>b.key)}values(){return this[_].toArray().map(b=>b.value)}reset(){this[C]&&this[_]&&this[_].length&&this[_].forEach(b=>this[C](b.key,b.value)),this[R]=new Map,this[_]=new d,this[g]=0}dump(){return this[_].map(b=>!Y(this,b)&&{k:b.key,v:b.value,e:b.now+(b.maxAge||0)}).toArray().filter(b=>b)}dumpLru(){return this[_]}set(b,N,$){if(($=$||this[m])&&typeof $!="number")throw TypeError("maxAge must be a number");let X=$?Date.now():0,ae=this[c](N,b);if(this[R].has(b)){if(ae>this[o])return se(this,this[R].get(b)),!1;let ve=this[R].get(b).value;return this[C]&&!this[I]&&this[C](b,ve.value),ve.now=X,ve.maxAge=$,ve.value=N,this[g]+=ae-ve.length,ve.length=ae,this.get(b),q(this),!0}let K=new J(b,N,ae,X,$);return K.length>this[o]?(this[C]&&this[C](b,N),!1):(this[g]+=K.length,this[_].unshift(K),this[R].set(b,this[_].head),q(this),!0)}has(b){return!!this[R].has(b)&&!Y(this,this[R].get(b).value)}get(b){return te(this,b,!0)}peek(b){return te(this,b,!1)}pop(){let b=this[_].tail;return b?(se(this,b),b.value):null}del(b){se(this,this[R].get(b))}load(b){this.reset();let N=Date.now();for(let $=b.length-1;$>=0;$--){let X=b[$],ae=X.e||0;if(ae===0)this.set(X.k,X.v);else{let K=ae-N;K>0&&this.set(X.k,X.v,K)}}}prune(){this[R].forEach((b,N)=>te(this,N,!1))}}let te=(M,b,N)=>{let $=M[R].get(b);if($){let X=$.value;if(Y(M,X)){if(se(M,$),!M[f])return}else N&&(M[F]&&($.value.now=Date.now()),M[_].unshiftNode($));return X.value}},Y=(M,b)=>{if(!b||!b.maxAge&&!M[m])return!1;let N=Date.now()-b.now;return b.maxAge?N>b.maxAge:M[m]&&N>M[m]},q=M=>{if(M[g]>M[o])for(let b=M[_].tail;M[g]>M[o]&&b!==null;){let N=b.prev;se(M,b),b=N}},se=(M,b)=>{if(b){let N=b.value;M[C]&&M[C](N.key,N.value),M[g]-=N.length,M[R].delete(N.key),M[_].removeNode(b)}};class J{constructor(b,N,$,X,ae){this.key=b,this.value=N,this.length=$,this.now=X,this.maxAge=ae||0}}let j=(M,b,N,$)=>{let X=N.value;Y(M,X)&&(se(M,N),M[f]||(X=void 0)),X&&b.call($,X.value,X.key,M)};k.exports=U},76:k=>{k.exports=function(E){E.prototype[Symbol.iterator]=function*(){for(let S=this.head;S;S=S.next)yield S.value}}},190:(k,E,S)=>{function d(g){var c=this;if(c instanceof d||(c=new d),c.tail=null,c.head=null,c.length=0,g&&typeof g.forEach=="function")g.forEach(function(C){c.push(C)});else if(arguments.length>0)for(var f=0,m=arguments.length;f<m;f++)c.push(arguments[f]);return c}function o(g,c,f,m){if(!(this instanceof o))return new o(g,c,f,m);this.list=m,this.value=g,c?(c.next=this,this.prev=c):this.prev=null,f?(f.prev=this,this.next=f):this.next=null}k.exports=d,d.Node=o,d.create=d,d.prototype.removeNode=function(g){if(g.list!==this)throw Error("removing node which does not belong to this list");var c=g.next,f=g.prev;return c&&(c.prev=f),f&&(f.next=c),g===this.head&&(this.head=c),g===this.tail&&(this.tail=f),g.list.length--,g.next=null,g.prev=null,g.list=null,c},d.prototype.unshiftNode=function(g){if(g!==this.head){g.list&&g.list.removeNode(g);var c=this.head;g.list=this,g.next=c,c&&(c.prev=g),this.head=g,this.tail||(this.tail=g),this.length++}},d.prototype.pushNode=function(g){if(g!==this.tail){g.list&&g.list.removeNode(g);var c=this.tail;g.list=this,g.prev=c,c&&(c.next=g),this.tail=g,this.head||(this.head=g),this.length++}},d.prototype.push=function(){for(var g,c=0,f=arguments.length;c<f;c++)g=arguments[c],this.tail=new o(g,this.tail,null,this),this.head||(this.head=this.tail),this.length++;return this.length},d.prototype.unshift=function(){for(var g,c=0,f=arguments.length;c<f;c++)g=arguments[c],this.head=new o(g,null,this.head,this),this.tail||(this.tail=this.head),this.length++;return this.length},d.prototype.pop=function(){if(this.tail){var g=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,g}},d.prototype.shift=function(){if(this.head){var g=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,g}},d.prototype.forEach=function(g,c){c=c||this;for(var f=this.head,m=0;f!==null;m++)g.call(c,f.value,m,this),f=f.next},d.prototype.forEachReverse=function(g,c){c=c||this;for(var f=this.tail,m=this.length-1;f!==null;m--)g.call(c,f.value,m,this),f=f.prev},d.prototype.get=function(g){for(var c=0,f=this.head;f!==null&&c<g;c++)f=f.next;if(c===g&&f!==null)return f.value},d.prototype.getReverse=function(g){for(var c=0,f=this.tail;f!==null&&c<g;c++)f=f.prev;if(c===g&&f!==null)return f.value},d.prototype.map=function(g,c){c=c||this;for(var f=new d,m=this.head;m!==null;)f.push(g.call(c,m.value,this)),m=m.next;return f},d.prototype.mapReverse=function(g,c){c=c||this;for(var f=new d,m=this.tail;m!==null;)f.push(g.call(c,m.value,this)),m=m.prev;return f},d.prototype.reduce=function(g,c){var f,m=this.head;if(arguments.length>1)f=c;else if(this.head)m=this.head.next,f=this.head.value;else throw TypeError("Reduce of empty list with no initial value");for(var C=0;m!==null;C++)f=g(f,m.value,C),m=m.next;return f},d.prototype.reduceReverse=function(g,c){var f,m=this.tail;if(arguments.length>1)f=c;else if(this.tail)m=this.tail.prev,f=this.tail.value;else throw TypeError("Reduce of empty list with no initial value");for(var C=this.length-1;m!==null;C--)f=g(f,m.value,C),m=m.prev;return f},d.prototype.toArray=function(){for(var g=Array(this.length),c=0,f=this.head;f!==null;c++)g[c]=f.value,f=f.next;return g},d.prototype.toArrayReverse=function(){for(var g=Array(this.length),c=0,f=this.tail;f!==null;c++)g[c]=f.value,f=f.prev;return g},d.prototype.slice=function(g,c){(c=c||this.length)<0&&(c+=this.length),(g=g||0)<0&&(g+=this.length);var f=new d;if(c<g||c<0)return f;g<0&&(g=0),c>this.length&&(c=this.length);for(var m=0,C=this.head;C!==null&&m<g;m++)C=C.next;for(;C!==null&&m<c;m++,C=C.next)f.push(C.value);return f},d.prototype.sliceReverse=function(g,c){(c=c||this.length)<0&&(c+=this.length),(g=g||0)<0&&(g+=this.length);var f=new d;if(c<g||c<0)return f;g<0&&(g=0),c>this.length&&(c=this.length);for(var m=this.length,C=this.tail;C!==null&&m>c;m--)C=C.prev;for(;C!==null&&m>g;m--,C=C.prev)f.push(C.value);return f},d.prototype.splice=function(g,c){g>this.length&&(g=this.length-1),g<0&&(g=this.length+g);for(var f=0,m=this.head;m!==null&&f<g;f++)m=m.next;for(var C=[],f=0;m&&f<c;f++)C.push(m.value),m=this.removeNode(m);m===null&&(m=this.tail),m!==this.head&&m!==this.tail&&(m=m.prev);for(var f=2;f<arguments.length;f++)m=function(_,R,F){var L=R===_.head?new o(F,null,R,_):new o(F,R,R.next,_);return L.next===null&&(_.tail=L),L.prev===null&&(_.head=L),_.length++,L}(this,m,arguments[f]);return C},d.prototype.reverse=function(){for(var g=this.head,c=this.tail,f=g;f!==null;f=f.prev){var m=f.prev;f.prev=f.next,f.next=m}return this.head=c,this.tail=g,this};try{S(76)(d)}catch{}}},u={};function s(k){var E=u[k];if(E!==void 0)return E.exports;var S=u[k]={exports:{}},d=!0;try{O[k](S,S.exports,s),d=!1}finally{d&&delete u[k]}return S.exports}s.ab="//";var x=s(806);ce.exports=x})()},we.__chunk_33627=ce=>{(()=>{"use strict";typeof __nccwpck_require__<"u"&&(__nccwpck_require__.ab="//");var O={};(()=>{O.parse=function(E,S){if(typeof E!="string")throw TypeError("argument str must be a string");for(var d={},o=E.split(x),g=(S||{}).decode||u,c=0;c<o.length;c++){var f=o[c],m=f.indexOf("=");if(!(m<0)){var C=f.substr(0,m).trim(),I=f.substr(++m,f.length).trim();I[0]=='"'&&(I=I.slice(1,-1)),d[C]==null&&(d[C]=function(_,R){try{return R(_)}catch{return _}}(I,g))}}return d},O.serialize=function(E,S,d){var o=d||{},g=o.encode||s;if(typeof g!="function")throw TypeError("option encode is invalid");if(!k.test(E))throw TypeError("argument name is invalid");var c=g(S);if(c&&!k.test(c))throw TypeError("argument val is invalid");var f=E+"="+c;if(o.maxAge!=null){var m=o.maxAge-0;if(isNaN(m)||!isFinite(m))throw TypeError("option maxAge is invalid");f+="; Max-Age="+Math.floor(m)}if(o.domain){if(!k.test(o.domain))throw TypeError("option domain is invalid");f+="; Domain="+o.domain}if(o.path){if(!k.test(o.path))throw TypeError("option path is invalid");f+="; Path="+o.path}if(o.expires){if(typeof o.expires.toUTCString!="function")throw TypeError("option expires is invalid");f+="; Expires="+o.expires.toUTCString()}if(o.httpOnly&&(f+="; HttpOnly"),o.secure&&(f+="; Secure"),o.sameSite)switch(typeof o.sameSite=="string"?o.sameSite.toLowerCase():o.sameSite){case!0:case"strict":f+="; SameSite=Strict";break;case"lax":f+="; SameSite=Lax";break;case"none":f+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return f};var u=decodeURIComponent,s=encodeURIComponent,x=/; */,k=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),ce.exports=O})()},we.__chunk_41874=(ce,O,u)=>{(()=>{"use strict";var s={491:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ContextAPI=void 0;let g=o(223),c=o(172),f=o(930),m="context",C=new g.NoopContextManager;class I{constructor(){}static getInstance(){return this._instance||(this._instance=new I),this._instance}setGlobalContextManager(R){return(0,c.registerGlobal)(m,R,f.DiagAPI.instance())}active(){return this._getContextManager().active()}with(R,F,L,...U){return this._getContextManager().with(R,F,L,...U)}bind(R,F){return this._getContextManager().bind(R,F)}_getContextManager(){return(0,c.getGlobal)(m)||C}disable(){this._getContextManager().disable(),(0,c.unregisterGlobal)(m,f.DiagAPI.instance())}}d.ContextAPI=I},930:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.DiagAPI=void 0;let g=o(56),c=o(912),f=o(957),m=o(172);class C{constructor(){function _(F){return function(...L){let U=(0,m.getGlobal)("diag");if(U)return U[F](...L)}}let R=this;R.setLogger=(F,L={logLevel:f.DiagLogLevel.INFO})=>{var U,te,Y;if(F===R){let J=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return R.error((U=J.stack)!==null&&U!==void 0?U:J.message),!1}typeof L=="number"&&(L={logLevel:L});let q=(0,m.getGlobal)("diag"),se=(0,c.createLogLevelDiagLogger)((te=L.logLevel)!==null&&te!==void 0?te:f.DiagLogLevel.INFO,F);if(q&&!L.suppressOverrideMessage){let J=(Y=Error().stack)!==null&&Y!==void 0?Y:"<failed to generate stacktrace>";q.warn(`Current logger will be overwritten from ${J}`),se.warn(`Current logger will overwrite one already registered from ${J}`)}return(0,m.registerGlobal)("diag",se,R,!0)},R.disable=()=>{(0,m.unregisterGlobal)("diag",R)},R.createComponentLogger=F=>new g.DiagComponentLogger(F),R.verbose=_("verbose"),R.debug=_("debug"),R.info=_("info"),R.warn=_("warn"),R.error=_("error")}static instance(){return this._instance||(this._instance=new C),this._instance}}d.DiagAPI=C},653:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.MetricsAPI=void 0;let g=o(660),c=o(172),f=o(930),m="metrics";class C{constructor(){}static getInstance(){return this._instance||(this._instance=new C),this._instance}setGlobalMeterProvider(_){return(0,c.registerGlobal)(m,_,f.DiagAPI.instance())}getMeterProvider(){return(0,c.getGlobal)(m)||g.NOOP_METER_PROVIDER}getMeter(_,R,F){return this.getMeterProvider().getMeter(_,R,F)}disable(){(0,c.unregisterGlobal)(m,f.DiagAPI.instance())}}d.MetricsAPI=C},181:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.PropagationAPI=void 0;let g=o(172),c=o(874),f=o(194),m=o(277),C=o(369),I=o(930),_="propagation",R=new c.NoopTextMapPropagator;class F{constructor(){this.createBaggage=C.createBaggage,this.getBaggage=m.getBaggage,this.getActiveBaggage=m.getActiveBaggage,this.setBaggage=m.setBaggage,this.deleteBaggage=m.deleteBaggage}static getInstance(){return this._instance||(this._instance=new F),this._instance}setGlobalPropagator(U){return(0,g.registerGlobal)(_,U,I.DiagAPI.instance())}inject(U,te,Y=f.defaultTextMapSetter){return this._getGlobalPropagator().inject(U,te,Y)}extract(U,te,Y=f.defaultTextMapGetter){return this._getGlobalPropagator().extract(U,te,Y)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,g.unregisterGlobal)(_,I.DiagAPI.instance())}_getGlobalPropagator(){return(0,g.getGlobal)(_)||R}}d.PropagationAPI=F},997:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TraceAPI=void 0;let g=o(172),c=o(846),f=o(139),m=o(607),C=o(930),I="trace";class _{constructor(){this._proxyTracerProvider=new c.ProxyTracerProvider,this.wrapSpanContext=f.wrapSpanContext,this.isSpanContextValid=f.isSpanContextValid,this.deleteSpan=m.deleteSpan,this.getSpan=m.getSpan,this.getActiveSpan=m.getActiveSpan,this.getSpanContext=m.getSpanContext,this.setSpan=m.setSpan,this.setSpanContext=m.setSpanContext}static getInstance(){return this._instance||(this._instance=new _),this._instance}setGlobalTracerProvider(F){let L=(0,g.registerGlobal)(I,this._proxyTracerProvider,C.DiagAPI.instance());return L&&this._proxyTracerProvider.setDelegate(F),L}getTracerProvider(){return(0,g.getGlobal)(I)||this._proxyTracerProvider}getTracer(F,L){return this.getTracerProvider().getTracer(F,L)}disable(){(0,g.unregisterGlobal)(I,C.DiagAPI.instance()),this._proxyTracerProvider=new c.ProxyTracerProvider}}d.TraceAPI=_},277:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.deleteBaggage=d.setBaggage=d.getActiveBaggage=d.getBaggage=void 0;let g=o(491),c=(0,o(780).createContextKey)("OpenTelemetry Baggage Key");function f(m){return m.getValue(c)||void 0}d.getBaggage=f,d.getActiveBaggage=function(){return f(g.ContextAPI.getInstance().active())},d.setBaggage=function(m,C){return m.setValue(c,C)},d.deleteBaggage=function(m){return m.deleteValue(c)}},993:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.BaggageImpl=void 0;class o{constructor(c){this._entries=c?new Map(c):new Map}getEntry(c){let f=this._entries.get(c);if(f)return Object.assign({},f)}getAllEntries(){return Array.from(this._entries.entries()).map(([c,f])=>[c,f])}setEntry(c,f){let m=new o(this._entries);return m._entries.set(c,f),m}removeEntry(c){let f=new o(this._entries);return f._entries.delete(c),f}removeEntries(...c){let f=new o(this._entries);for(let m of c)f._entries.delete(m);return f}clear(){return new o}}d.BaggageImpl=o},830:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.baggageEntryMetadataSymbol=void 0,d.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.baggageEntryMetadataFromString=d.createBaggage=void 0;let g=o(930),c=o(993),f=o(830),m=g.DiagAPI.instance();d.createBaggage=function(C={}){return new c.BaggageImpl(new Map(Object.entries(C)))},d.baggageEntryMetadataFromString=function(C){return typeof C!="string"&&(m.error(`Cannot create baggage metadata from unknown type: ${typeof C}`),C=""),{__TYPE__:f.baggageEntryMetadataSymbol,toString:()=>C}}},67:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.context=void 0;let g=o(491);d.context=g.ContextAPI.getInstance()},223:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NoopContextManager=void 0;let g=o(780);class c{active(){return g.ROOT_CONTEXT}with(m,C,I,..._){return C.call(I,..._)}bind(m,C){return C}enable(){return this}disable(){return this}}d.NoopContextManager=c},780:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ROOT_CONTEXT=d.createContextKey=void 0,d.createContextKey=function(g){return Symbol.for(g)};class o{constructor(c){let f=this;f._currentContext=c?new Map(c):new Map,f.getValue=m=>f._currentContext.get(m),f.setValue=(m,C)=>{let I=new o(f._currentContext);return I._currentContext.set(m,C),I},f.deleteValue=m=>{let C=new o(f._currentContext);return C._currentContext.delete(m),C}}}d.ROOT_CONTEXT=new o},506:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.diag=void 0;let g=o(930);d.diag=g.DiagAPI.instance()},56:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.DiagComponentLogger=void 0;let g=o(172);class c{constructor(C){this._namespace=C.namespace||"DiagComponentLogger"}debug(...C){return f("debug",this._namespace,C)}error(...C){return f("error",this._namespace,C)}info(...C){return f("info",this._namespace,C)}warn(...C){return f("warn",this._namespace,C)}verbose(...C){return f("verbose",this._namespace,C)}}function f(m,C,I){let _=(0,g.getGlobal)("diag");if(_)return I.unshift(C),_[m](...I)}d.DiagComponentLogger=c},972:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.DiagConsoleLogger=void 0;let o=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class g{constructor(){for(let f=0;f<o.length;f++)this[o[f].n]=function(m){return function(...C){if(console){let I=console[m];if(typeof I!="function"&&(I=console.log),typeof I=="function")return I.apply(console,C)}}}(o[f].c)}}d.DiagConsoleLogger=g},912:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createLogLevelDiagLogger=void 0;let g=o(957);d.createLogLevelDiagLogger=function(c,f){function m(C,I){let _=f[C];return typeof _=="function"&&c>=I?_.bind(f):function(){}}return c<g.DiagLogLevel.NONE?c=g.DiagLogLevel.NONE:c>g.DiagLogLevel.ALL&&(c=g.DiagLogLevel.ALL),f=f||{},{error:m("error",g.DiagLogLevel.ERROR),warn:m("warn",g.DiagLogLevel.WARN),info:m("info",g.DiagLogLevel.INFO),debug:m("debug",g.DiagLogLevel.DEBUG),verbose:m("verbose",g.DiagLogLevel.VERBOSE)}}},957:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.DiagLogLevel=void 0,function(o){o[o.NONE=0]="NONE",o[o.ERROR=30]="ERROR",o[o.WARN=50]="WARN",o[o.INFO=60]="INFO",o[o.DEBUG=70]="DEBUG",o[o.VERBOSE=80]="VERBOSE",o[o.ALL=9999]="ALL"}(d.DiagLogLevel||(d.DiagLogLevel={}))},172:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.unregisterGlobal=d.getGlobal=d.registerGlobal=void 0;let g=o(200),c=o(521),f=o(130),m=c.VERSION.split(".")[0],C=Symbol.for(`opentelemetry.js.api.${m}`),I=g._globalThis;d.registerGlobal=function(_,R,F,L=!1){var U;let te=I[C]=(U=I[C])!==null&&U!==void 0?U:{version:c.VERSION};if(!L&&te[_]){let Y=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${_}`);return F.error(Y.stack||Y.message),!1}if(te.version!==c.VERSION){let Y=Error(`@opentelemetry/api: Registration of version v${te.version} for ${_} does not match previously registered API v${c.VERSION}`);return F.error(Y.stack||Y.message),!1}return te[_]=R,F.debug(`@opentelemetry/api: Registered a global for ${_} v${c.VERSION}.`),!0},d.getGlobal=function(_){var R,F;let L=(R=I[C])===null||R===void 0?void 0:R.version;if(L&&(0,f.isCompatible)(L))return(F=I[C])===null||F===void 0?void 0:F[_]},d.unregisterGlobal=function(_,R){R.debug(`@opentelemetry/api: Unregistering a global for ${_} v${c.VERSION}.`);let F=I[C];F&&delete F[_]}},130:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.isCompatible=d._makeCompatibilityCheck=void 0;let g=o(521),c=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function f(m){let C=new Set([m]),I=new Set,_=m.match(c);if(!_)return()=>!1;let R={major:+_[1],minor:+_[2],patch:+_[3],prerelease:_[4]};if(R.prerelease!=null)return function(L){return L===m};function F(L){return I.add(L),!1}return function(L){if(C.has(L))return!0;if(I.has(L))return!1;let U=L.match(c);if(!U)return F(L);let te={major:+U[1],minor:+U[2],patch:+U[3],prerelease:U[4]};return te.prerelease!=null||R.major!==te.major?F(L):R.major===0?R.minor===te.minor&&R.patch<=te.patch?(C.add(L),!0):F(L):R.minor<=te.minor?(C.add(L),!0):F(L)}}d._makeCompatibilityCheck=f,d.isCompatible=f(g.VERSION)},886:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.metrics=void 0;let g=o(653);d.metrics=g.MetricsAPI.getInstance()},901:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ValueType=void 0,function(o){o[o.INT=0]="INT",o[o.DOUBLE=1]="DOUBLE"}(d.ValueType||(d.ValueType={}))},102:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createNoopMeter=d.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=d.NOOP_OBSERVABLE_GAUGE_METRIC=d.NOOP_OBSERVABLE_COUNTER_METRIC=d.NOOP_UP_DOWN_COUNTER_METRIC=d.NOOP_HISTOGRAM_METRIC=d.NOOP_COUNTER_METRIC=d.NOOP_METER=d.NoopObservableUpDownCounterMetric=d.NoopObservableGaugeMetric=d.NoopObservableCounterMetric=d.NoopObservableMetric=d.NoopHistogramMetric=d.NoopUpDownCounterMetric=d.NoopCounterMetric=d.NoopMetric=d.NoopMeter=void 0;class o{constructor(){}createHistogram(L,U){return d.NOOP_HISTOGRAM_METRIC}createCounter(L,U){return d.NOOP_COUNTER_METRIC}createUpDownCounter(L,U){return d.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(L,U){return d.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(L,U){return d.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(L,U){return d.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(L,U){}removeBatchObservableCallback(L){}}d.NoopMeter=o;class g{}d.NoopMetric=g;class c extends g{add(L,U){}}d.NoopCounterMetric=c;class f extends g{add(L,U){}}d.NoopUpDownCounterMetric=f;class m extends g{record(L,U){}}d.NoopHistogramMetric=m;class C{addCallback(L){}removeCallback(L){}}d.NoopObservableMetric=C;class I extends C{}d.NoopObservableCounterMetric=I;class _ extends C{}d.NoopObservableGaugeMetric=_;class R extends C{}d.NoopObservableUpDownCounterMetric=R,d.NOOP_METER=new o,d.NOOP_COUNTER_METRIC=new c,d.NOOP_HISTOGRAM_METRIC=new m,d.NOOP_UP_DOWN_COUNTER_METRIC=new f,d.NOOP_OBSERVABLE_COUNTER_METRIC=new I,d.NOOP_OBSERVABLE_GAUGE_METRIC=new _,d.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new R,d.createNoopMeter=function(){return d.NOOP_METER}},660:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NOOP_METER_PROVIDER=d.NoopMeterProvider=void 0;let g=o(102);class c{getMeter(m,C,I){return g.NOOP_METER}}d.NoopMeterProvider=c,d.NOOP_METER_PROVIDER=new c},200:function(S,d,o){var g=this&&this.__createBinding||(Object.create?function(f,m,C,I){I===void 0&&(I=C),Object.defineProperty(f,I,{enumerable:!0,get:function(){return m[C]}})}:function(f,m,C,I){I===void 0&&(I=C),f[I]=m[C]}),c=this&&this.__exportStar||function(f,m){for(var C in f)C==="default"||Object.prototype.hasOwnProperty.call(m,C)||g(m,f,C)};Object.defineProperty(d,"__esModule",{value:!0}),c(o(46),d)},651:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d._globalThis=void 0,d._globalThis=typeof aa=="object"?aa:u.g},46:function(S,d,o){var g=this&&this.__createBinding||(Object.create?function(f,m,C,I){I===void 0&&(I=C),Object.defineProperty(f,I,{enumerable:!0,get:function(){return m[C]}})}:function(f,m,C,I){I===void 0&&(I=C),f[I]=m[C]}),c=this&&this.__exportStar||function(f,m){for(var C in f)C==="default"||Object.prototype.hasOwnProperty.call(m,C)||g(m,f,C)};Object.defineProperty(d,"__esModule",{value:!0}),c(o(651),d)},939:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.propagation=void 0;let g=o(181);d.propagation=g.PropagationAPI.getInstance()},874:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NoopTextMapPropagator=void 0;class o{inject(c,f){}extract(c,f){return c}fields(){return[]}}d.NoopTextMapPropagator=o},194:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.defaultTextMapSetter=d.defaultTextMapGetter=void 0,d.defaultTextMapGetter={get(o,g){if(o!=null)return o[g]},keys:o=>o==null?[]:Object.keys(o)},d.defaultTextMapSetter={set(o,g,c){o!=null&&(o[g]=c)}}},845:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.trace=void 0;let g=o(997);d.trace=g.TraceAPI.getInstance()},403:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NonRecordingSpan=void 0;let g=o(476);class c{constructor(m=g.INVALID_SPAN_CONTEXT){this._spanContext=m}spanContext(){return this._spanContext}setAttribute(m,C){return this}setAttributes(m){return this}addEvent(m,C){return this}setStatus(m){return this}updateName(m){return this}end(m){}isRecording(){return!1}recordException(m,C){}}d.NonRecordingSpan=c},614:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NoopTracer=void 0;let g=o(491),c=o(607),f=o(403),m=o(139),C=g.ContextAPI.getInstance();class I{startSpan(R,F,L=C.active()){if(F?.root)return new f.NonRecordingSpan;let U=L&&(0,c.getSpanContext)(L);return typeof U=="object"&&typeof U.spanId=="string"&&typeof U.traceId=="string"&&typeof U.traceFlags=="number"&&(0,m.isSpanContextValid)(U)?new f.NonRecordingSpan(U):new f.NonRecordingSpan}startActiveSpan(R,F,L,U){let te,Y,q;if(arguments.length<2)return;arguments.length==2?q=F:arguments.length==3?(te=F,q=L):(te=F,Y=L,q=U);let se=Y??C.active(),J=this.startSpan(R,te,se),j=(0,c.setSpan)(se,J);return C.with(j,q,void 0,J)}}d.NoopTracer=I},124:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.NoopTracerProvider=void 0;let g=o(614);class c{getTracer(m,C,I){return new g.NoopTracer}}d.NoopTracerProvider=c},125:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ProxyTracer=void 0;let g=new(o(614)).NoopTracer;class c{constructor(m,C,I,_){this._provider=m,this.name=C,this.version=I,this.options=_}startSpan(m,C,I){return this._getTracer().startSpan(m,C,I)}startActiveSpan(m,C,I,_){let R=this._getTracer();return Reflect.apply(R.startActiveSpan,R,arguments)}_getTracer(){if(this._delegate)return this._delegate;let m=this._provider.getDelegateTracer(this.name,this.version,this.options);return m?(this._delegate=m,this._delegate):g}}d.ProxyTracer=c},846:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.ProxyTracerProvider=void 0;let g=o(125),c=new(o(124)).NoopTracerProvider;class f{getTracer(C,I,_){var R;return(R=this.getDelegateTracer(C,I,_))!==null&&R!==void 0?R:new g.ProxyTracer(this,C,I,_)}getDelegate(){var C;return(C=this._delegate)!==null&&C!==void 0?C:c}setDelegate(C){this._delegate=C}getDelegateTracer(C,I,_){var R;return(R=this._delegate)===null||R===void 0?void 0:R.getTracer(C,I,_)}}d.ProxyTracerProvider=f},996:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.SamplingDecision=void 0,function(o){o[o.NOT_RECORD=0]="NOT_RECORD",o[o.RECORD=1]="RECORD",o[o.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(d.SamplingDecision||(d.SamplingDecision={}))},607:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.getSpanContext=d.setSpanContext=d.deleteSpan=d.setSpan=d.getActiveSpan=d.getSpan=void 0;let g=o(780),c=o(403),f=o(491),m=(0,g.createContextKey)("OpenTelemetry Context Key SPAN");function C(_){return _.getValue(m)||void 0}function I(_,R){return _.setValue(m,R)}d.getSpan=C,d.getActiveSpan=function(){return C(f.ContextAPI.getInstance().active())},d.setSpan=I,d.deleteSpan=function(_){return _.deleteValue(m)},d.setSpanContext=function(_,R){return I(_,new c.NonRecordingSpan(R))},d.getSpanContext=function(_){var R;return(R=C(_))===null||R===void 0?void 0:R.spanContext()}},325:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TraceStateImpl=void 0;let g=o(564);class c{constructor(m){this._internalState=new Map,m&&this._parse(m)}set(m,C){let I=this._clone();return I._internalState.has(m)&&I._internalState.delete(m),I._internalState.set(m,C),I}unset(m){let C=this._clone();return C._internalState.delete(m),C}get(m){return this._internalState.get(m)}serialize(){return this._keys().reduce((m,C)=>(m.push(C+"="+this.get(C)),m),[]).join(",")}_parse(m){!(m.length>512)&&(this._internalState=m.split(",").reverse().reduce((C,I)=>{let _=I.trim(),R=_.indexOf("=");if(R!==-1){let F=_.slice(0,R),L=_.slice(R+1,I.length);(0,g.validateKey)(F)&&(0,g.validateValue)(L)&&C.set(F,L)}return C},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let m=new c;return m._internalState=new Map(this._internalState),m}}d.TraceStateImpl=c},564:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.validateValue=d.validateKey=void 0;let o="[_0-9a-z-*/]",g=`[a-z]${o}{0,255}`,c=`[a-z0-9]${o}{0,240}@[a-z]${o}{0,13}`,f=RegExp(`^(?:${g}|${c})$`),m=/^[ -~]{0,255}[!-~]$/,C=/,|=/;d.validateKey=function(I){return f.test(I)},d.validateValue=function(I){return m.test(I)&&!C.test(I)}},98:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.createTraceState=void 0;let g=o(325);d.createTraceState=function(c){return new g.TraceStateImpl(c)}},476:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.INVALID_SPAN_CONTEXT=d.INVALID_TRACEID=d.INVALID_SPANID=void 0;let g=o(475);d.INVALID_SPANID="0000000000000000",d.INVALID_TRACEID="00000000000000000000000000000000",d.INVALID_SPAN_CONTEXT={traceId:d.INVALID_TRACEID,spanId:d.INVALID_SPANID,traceFlags:g.TraceFlags.NONE}},357:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.SpanKind=void 0,function(o){o[o.INTERNAL=0]="INTERNAL",o[o.SERVER=1]="SERVER",o[o.CLIENT=2]="CLIENT",o[o.PRODUCER=3]="PRODUCER",o[o.CONSUMER=4]="CONSUMER"}(d.SpanKind||(d.SpanKind={}))},139:(S,d,o)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.wrapSpanContext=d.isSpanContextValid=d.isValidSpanId=d.isValidTraceId=void 0;let g=o(476),c=o(403),f=/^([0-9a-f]{32})$/i,m=/^[0-9a-f]{16}$/i;function C(_){return f.test(_)&&_!==g.INVALID_TRACEID}function I(_){return m.test(_)&&_!==g.INVALID_SPANID}d.isValidTraceId=C,d.isValidSpanId=I,d.isSpanContextValid=function(_){return C(_.traceId)&&I(_.spanId)},d.wrapSpanContext=function(_){return new c.NonRecordingSpan(_)}},847:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.SpanStatusCode=void 0,function(o){o[o.UNSET=0]="UNSET",o[o.OK=1]="OK",o[o.ERROR=2]="ERROR"}(d.SpanStatusCode||(d.SpanStatusCode={}))},475:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.TraceFlags=void 0,function(o){o[o.NONE=0]="NONE",o[o.SAMPLED=1]="SAMPLED"}(d.TraceFlags||(d.TraceFlags={}))},521:(S,d)=>{Object.defineProperty(d,"__esModule",{value:!0}),d.VERSION=void 0,d.VERSION="1.6.0"}},x={};function k(S){var d=x[S];if(d!==void 0)return d.exports;var o=x[S]={exports:{}},g=!0;try{s[S].call(o.exports,o,o.exports,k),g=!1}finally{g&&delete x[S]}return o.exports}k.ab="//";var E={};(()=>{Object.defineProperty(E,"__esModule",{value:!0}),E.trace=E.propagation=E.metrics=E.diag=E.context=E.INVALID_SPAN_CONTEXT=E.INVALID_TRACEID=E.INVALID_SPANID=E.isValidSpanId=E.isValidTraceId=E.isSpanContextValid=E.createTraceState=E.TraceFlags=E.SpanStatusCode=E.SpanKind=E.SamplingDecision=E.ProxyTracerProvider=E.ProxyTracer=E.defaultTextMapSetter=E.defaultTextMapGetter=E.ValueType=E.createNoopMeter=E.DiagLogLevel=E.DiagConsoleLogger=E.ROOT_CONTEXT=E.createContextKey=E.baggageEntryMetadataFromString=void 0;var S=k(369);Object.defineProperty(E,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return S.baggageEntryMetadataFromString}});var d=k(780);Object.defineProperty(E,"createContextKey",{enumerable:!0,get:function(){return d.createContextKey}}),Object.defineProperty(E,"ROOT_CONTEXT",{enumerable:!0,get:function(){return d.ROOT_CONTEXT}});var o=k(972);Object.defineProperty(E,"DiagConsoleLogger",{enumerable:!0,get:function(){return o.DiagConsoleLogger}});var g=k(957);Object.defineProperty(E,"DiagLogLevel",{enumerable:!0,get:function(){return g.DiagLogLevel}});var c=k(102);Object.defineProperty(E,"createNoopMeter",{enumerable:!0,get:function(){return c.createNoopMeter}});var f=k(901);Object.defineProperty(E,"ValueType",{enumerable:!0,get:function(){return f.ValueType}});var m=k(194);Object.defineProperty(E,"defaultTextMapGetter",{enumerable:!0,get:function(){return m.defaultTextMapGetter}}),Object.defineProperty(E,"defaultTextMapSetter",{enumerable:!0,get:function(){return m.defaultTextMapSetter}});var C=k(125);Object.defineProperty(E,"ProxyTracer",{enumerable:!0,get:function(){return C.ProxyTracer}});var I=k(846);Object.defineProperty(E,"ProxyTracerProvider",{enumerable:!0,get:function(){return I.ProxyTracerProvider}});var _=k(996);Object.defineProperty(E,"SamplingDecision",{enumerable:!0,get:function(){return _.SamplingDecision}});var R=k(357);Object.defineProperty(E,"SpanKind",{enumerable:!0,get:function(){return R.SpanKind}});var F=k(847);Object.defineProperty(E,"SpanStatusCode",{enumerable:!0,get:function(){return F.SpanStatusCode}});var L=k(475);Object.defineProperty(E,"TraceFlags",{enumerable:!0,get:function(){return L.TraceFlags}});var U=k(98);Object.defineProperty(E,"createTraceState",{enumerable:!0,get:function(){return U.createTraceState}});var te=k(139);Object.defineProperty(E,"isSpanContextValid",{enumerable:!0,get:function(){return te.isSpanContextValid}}),Object.defineProperty(E,"isValidTraceId",{enumerable:!0,get:function(){return te.isValidTraceId}}),Object.defineProperty(E,"isValidSpanId",{enumerable:!0,get:function(){return te.isValidSpanId}});var Y=k(476);Object.defineProperty(E,"INVALID_SPANID",{enumerable:!0,get:function(){return Y.INVALID_SPANID}}),Object.defineProperty(E,"INVALID_TRACEID",{enumerable:!0,get:function(){return Y.INVALID_TRACEID}}),Object.defineProperty(E,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return Y.INVALID_SPAN_CONTEXT}});let q=k(67);Object.defineProperty(E,"context",{enumerable:!0,get:function(){return q.context}});let se=k(506);Object.defineProperty(E,"diag",{enumerable:!0,get:function(){return se.diag}});let J=k(886);Object.defineProperty(E,"metrics",{enumerable:!0,get:function(){return J.metrics}});let j=k(939);Object.defineProperty(E,"propagation",{enumerable:!0,get:function(){return j.propagation}});let M=k(845);Object.defineProperty(E,"trace",{enumerable:!0,get:function(){return M.trace}}),E.default={context:q.context,diag:se.diag,metrics:J.metrics,propagation:j.propagation,trace:M.trace}})(),ce.exports=E})()},we.__chunk_73850=ce=>{"use strict";var O=Object.defineProperty,u=Object.getOwnPropertyDescriptor,s=Object.getOwnPropertyNames,x=Object.prototype.hasOwnProperty,k={};function E(m){var C;let I=["path"in m&&m.path&&`Path=${m.path}`,"expires"in m&&(m.expires||m.expires===0)&&`Expires=${(typeof m.expires=="number"?new Date(m.expires):m.expires).toUTCString()}`,"maxAge"in m&&typeof m.maxAge=="number"&&`Max-Age=${m.maxAge}`,"domain"in m&&m.domain&&`Domain=${m.domain}`,"secure"in m&&m.secure&&"Secure","httpOnly"in m&&m.httpOnly&&"HttpOnly","sameSite"in m&&m.sameSite&&`SameSite=${m.sameSite}`,"partitioned"in m&&m.partitioned&&"Partitioned","priority"in m&&m.priority&&`Priority=${m.priority}`].filter(Boolean),_=`${m.name}=${encodeURIComponent((C=m.value)!=null?C:"")}`;return I.length===0?_:`${_}; ${I.join("; ")}`}function S(m){let C=new Map;for(let I of m.split(/; */)){if(!I)continue;let _=I.indexOf("=");if(_===-1){C.set(I,"true");continue}let[R,F]=[I.slice(0,_),I.slice(_+1)];try{C.set(R,decodeURIComponent(F??"true"))}catch{}}return C}function d(m){var C,I;if(!m)return;let[[_,R],...F]=S(m),{domain:L,expires:U,httponly:te,maxage:Y,path:q,samesite:se,secure:J,partitioned:j,priority:M}=Object.fromEntries(F.map(([b,N])=>[b.toLowerCase(),N]));return function(b){let N={};for(let $ in b)b[$]&&(N[$]=b[$]);return N}({name:_,value:decodeURIComponent(R),domain:L,...U&&{expires:new Date(U)},...te&&{httpOnly:!0},...typeof Y=="string"&&{maxAge:Number(Y)},path:q,...se&&{sameSite:o.includes(C=(C=se).toLowerCase())?C:void 0},...J&&{secure:!0},...M&&{priority:g.includes(I=(I=M).toLowerCase())?I:void 0},...j&&{partitioned:!0}})}((m,C)=>{for(var I in C)O(m,I,{get:C[I],enumerable:!0})})(k,{RequestCookies:()=>c,ResponseCookies:()=>f,parseCookie:()=>S,parseSetCookie:()=>d,stringifyCookie:()=>E}),ce.exports=((m,C,I,_)=>{if(C&&typeof C=="object"||typeof C=="function")for(let R of s(C))x.call(m,R)||R===I||O(m,R,{get:()=>C[R],enumerable:!(_=u(C,R))||_.enumerable});return m})(O({},"__esModule",{value:!0}),k);var o=["strict","lax","none"],g=["low","medium","high"],c=class{constructor(m){this._parsed=new Map,this._headers=m;let C=m.get("cookie");if(C)for(let[I,_]of S(C))this._parsed.set(I,{name:I,value:_})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...m){let C=typeof m[0]=="string"?m[0]:m[0].name;return this._parsed.get(C)}getAll(...m){var C;let I=Array.from(this._parsed);if(!m.length)return I.map(([R,F])=>F);let _=typeof m[0]=="string"?m[0]:(C=m[0])==null?void 0:C.name;return I.filter(([R])=>R===_).map(([R,F])=>F)}has(m){return this._parsed.has(m)}set(...m){let[C,I]=m.length===1?[m[0].name,m[0].value]:m,_=this._parsed;return _.set(C,{name:C,value:I}),this._headers.set("cookie",Array.from(_).map(([R,F])=>E(F)).join("; ")),this}delete(m){let C=this._parsed,I=Array.isArray(m)?m.map(_=>C.delete(_)):C.delete(m);return this._headers.set("cookie",Array.from(C).map(([_,R])=>E(R)).join("; ")),I}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(m=>`${m.name}=${encodeURIComponent(m.value)}`).join("; ")}},f=class{constructor(m){var C,I,_;this._parsed=new Map,this._headers=m;let R=(_=(I=(C=m.getSetCookie)==null?void 0:C.call(m))!=null?I:m.get("set-cookie"))!=null?_:[];for(let F of Array.isArray(R)?R:function(L){if(!L)return[];var U,te,Y,q,se,J=[],j=0;function M(){for(;j<L.length&&/\s/.test(L.charAt(j));)j+=1;return j<L.length}for(;j<L.length;){for(U=j,se=!1;M();)if((te=L.charAt(j))===","){for(Y=j,j+=1,M(),q=j;j<L.length&&(te=L.charAt(j))!=="="&&te!==";"&&te!==",";)j+=1;j<L.length&&L.charAt(j)==="="?(se=!0,j=q,J.push(L.substring(U,Y)),U=j):j=Y+1}else j+=1;(!se||j>=L.length)&&J.push(L.substring(U,L.length))}return J}(R)){let L=d(F);L&&this._parsed.set(L.name,L)}}get(...m){let C=typeof m[0]=="string"?m[0]:m[0].name;return this._parsed.get(C)}getAll(...m){var C;let I=Array.from(this._parsed.values());if(!m.length)return I;let _=typeof m[0]=="string"?m[0]:(C=m[0])==null?void 0:C.name;return I.filter(R=>R.name===_)}has(m){return this._parsed.has(m)}set(...m){let[C,I,_]=m.length===1?[m[0].name,m[0].value,m[0]]:m,R=this._parsed;return R.set(C,function(F={name:"",value:""}){return typeof F.expires=="number"&&(F.expires=new Date(F.expires)),F.maxAge&&(F.expires=new Date(Date.now()+1e3*F.maxAge)),(F.path===null||F.path===void 0)&&(F.path="/"),F}({name:C,value:I,..._})),function(F,L){for(let[,U]of(L.delete("set-cookie"),F)){let te=E(U);L.append("set-cookie",te)}}(R,this._headers),this}delete(...m){let[C,I,_]=typeof m[0]=="string"?[m[0]]:[m[0].name,m[0].path,m[0].domain];return this.set({name:C,path:I,domain:_,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(E).join("; ")}}},we.__chunk_17581=ce=>{"use strict";var O=function(){this.init=function(){var u={};this.on=function(s,x){u[s]||(u[s]=[]),u[s]=u[s].concat(x)},this.off=function(s,x){var k;return!!u[s]&&(k=u[s].indexOf(x),u[s]=u[s].slice(),u[s].splice(k,1),k>-1)},this.trigger=function(s){var x,k,E,S;if(x=u[s])if(arguments.length==2)for(k=0,E=x.length;k<E;++k)x[k].call(this,arguments[1]);else{for(S=[],k=arguments.length,k=1;k<arguments.length;++k)S.push(arguments[k]);for(k=0,E=x.length;k<E;++k)x[k].apply(this,S)}},this.dispose=function(){u={}}}};O.prototype.pipe=function(u){return this.on("data",function(s){u.push(s)}),this.on("done",function(s){u.flush(s)}),this.on("partialdone",function(s){u.partialFlush(s)}),this.on("endedtimeline",function(s){u.endTimeline(s)}),this.on("reset",function(s){u.reset(s)}),u},O.prototype.push=function(u){this.trigger("data",u)},O.prototype.flush=function(u){this.trigger("done",u)},O.prototype.partialFlush=function(u){this.trigger("partialdone",u)},O.prototype.endTimeline=function(u){this.trigger("endedtimeline",u)},O.prototype.reset=function(u){this.trigger("reset",u)},ce.exports=O},we.__chunk_98096=ce=>{"use strict";var O;O=function(u){var s=u.byteLength,x=0,k=0;this.length=function(){return 8*s},this.bitsAvailable=function(){return 8*s+k},this.loadWord=function(){var E=u.byteLength-s,S=new Uint8Array(4),d=Math.min(4,s);if(d===0)throw Error("no bytes available");S.set(u.subarray(E,E+d)),x=new DataView(S.buffer).getUint32(0),k=8*d,s-=d},this.skipBits=function(E){var S;k>E||(E-=k,S=Math.floor(E/8),E-=8*S,s-=S,this.loadWord()),x<<=E,k-=E},this.readBits=function(E){var S=Math.min(k,E),d=x>>>32-S;return(k-=S)>0?x<<=S:s>0&&this.loadWord(),(S=E-S)>0?d<<S|this.readBits(S):d},this.skipLeadingZeros=function(){var E;for(E=0;E<k;++E)if((x&2147483648>>>E)!=0)return x<<=E,k-=E,E;return this.loadWord(),E+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var E=this.skipLeadingZeros();return this.readBits(E+1)-1},this.readExpGolomb=function(){var E=this.readUnsignedExpGolomb();return 1&E?1+E>>>1:-1*(E>>>1)},this.readBoolean=function(){return this.readBits(1)===1},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()},ce.exports=O},we.__chunk_6056=ce=>{var O,u,s,x,k,E,S;O=function(d){return 9e4*d},u=function(d,o){return d*o},s=function(d){return d/9e4},x=function(d,o){return d/o},k=function(d,o){return O(x(d,o))},E=function(d,o){return u(s(d),o)},S=function(d,o,g){return s(g?d:d-o)},ce.exports={ONE_SECOND_IN_TS:9e4,secondsToVideoTs:O,secondsToAudioTs:u,videoTsToSeconds:s,audioTsToSeconds:x,audioTsToVideoTs:k,videoTsToAudioTs:E,metadataTsToSeconds:S}},we.__chunk_30930=ce=>{ce.exports={toUnsigned:function(O){return O>>>0},toHexString:function(O){return("00"+O.toString(16)).slice(-2)}}},we.__chunk_95252=(ce,O,u)=>{"use strict";var s=u(80249),x=u(8725).handleRollover,k={};k.ts=u(21042),k.aac=u(17323);var E=u(6056).ONE_SECOND_IN_TS,S=function(m,C){for(var I,_=0,R=188;R<m.byteLength;){if(m[_]===71&&m[R]===71){switch(I=m.subarray(_,R),k.ts.parseType(I,C.pid)){case"pat":C.pid||(C.pid=k.ts.parsePat(I));break;case"pmt":C.table||(C.table=k.ts.parsePmt(I))}if(C.pid&&C.table)return;_+=188,R+=188;continue}_++,R++}},d=function(m,C,I){for(var _,R,F,L,U=0,te=188,Y=!1;te<=m.byteLength;){if(m[U]===71&&(m[te]===71||te===m.byteLength)){if(_=m.subarray(U,te),k.ts.parseType(_,C.pid)==="pes"&&(R=k.ts.parsePesType(_,C.table),F=k.ts.parsePayloadUnitStartIndicator(_),R==="audio"&&F&&(L=k.ts.parsePesTime(_))&&(L.type="audio",I.audio.push(L),Y=!0)),Y)break;U+=188,te+=188;continue}U++,te++}for(U=(te=m.byteLength)-188,Y=!1;U>=0;){if(m[U]===71&&(m[te]===71||te===m.byteLength)){if(_=m.subarray(U,te),k.ts.parseType(_,C.pid)==="pes"&&(R=k.ts.parsePesType(_,C.table),F=k.ts.parsePayloadUnitStartIndicator(_),R==="audio"&&F&&(L=k.ts.parsePesTime(_))&&(L.type="audio",I.audio.push(L),Y=!0)),Y)break;U-=188,te-=188;continue}U--,te--}},o=function(m,C,I){for(var _,R,F,L,U,te,Y,q=0,se=188,J=!1,j={data:[],size:0};se<m.byteLength;){if(m[q]===71&&m[se]===71){if(_=m.subarray(q,se),k.ts.parseType(_,C.pid)==="pes"&&(R=k.ts.parsePesType(_,C.table),F=k.ts.parsePayloadUnitStartIndicator(_),R==="video"&&(F&&!J&&(L=k.ts.parsePesTime(_))&&(L.type="video",I.video.push(L),J=!0),!I.firstKeyFrame))){if(F&&j.size!==0){for(U=new Uint8Array(j.size),te=0;j.data.length;)Y=j.data.shift(),U.set(Y,te),te+=Y.byteLength;if(k.ts.videoPacketContainsKeyFrame(U)){var M=k.ts.parsePesTime(U);M?(I.firstKeyFrame=M,I.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself.")}j.size=0}j.data.push(_),j.size+=_.byteLength}if(J&&I.firstKeyFrame)break;q+=188,se+=188;continue}q++,se++}for(q=(se=m.byteLength)-188,J=!1;q>=0;){if(m[q]===71&&m[se]===71){if(_=m.subarray(q,se),k.ts.parseType(_,C.pid)==="pes"&&(R=k.ts.parsePesType(_,C.table),F=k.ts.parsePayloadUnitStartIndicator(_),R==="video"&&F&&(L=k.ts.parsePesTime(_))&&(L.type="video",I.video.push(L),J=!0)),J)break;q-=188,se-=188;continue}q--,se--}},g=function(m,C){if(m.audio&&m.audio.length){var I=C;I===void 0&&(I=m.audio[0].dts),m.audio.forEach(function(F){F.dts=x(F.dts,I),F.pts=x(F.pts,I),F.dtsTime=F.dts/E,F.ptsTime=F.pts/E})}if(m.video&&m.video.length){var _=C;if(_===void 0&&(_=m.video[0].dts),m.video.forEach(function(F){F.dts=x(F.dts,_),F.pts=x(F.pts,_),F.dtsTime=F.dts/E,F.ptsTime=F.pts/E}),m.firstKeyFrame){var R=m.firstKeyFrame;R.dts=x(R.dts,_),R.pts=x(R.pts,_),R.dtsTime=R.dts/E,R.ptsTime=R.dts/E}}},c=function(m){for(var C,I=!1,_=0,R=null,F=null,L=0,U=0;m.length-U>=3;){switch(k.aac.parseType(m,U)){case"timed-metadata":if(m.length-U<10||(L=k.aac.parseId3TagSize(m,U))>m.length){I=!0;break}F===null&&(C=m.subarray(U,U+L),F=k.aac.parseAacTimestamp(C)),U+=L;break;case"audio":if(m.length-U<7||(L=k.aac.parseAdtsSize(m,U))>m.length){I=!0;break}R===null&&(C=m.subarray(U,U+L),R=k.aac.parseSampleRate(C)),_++,U+=L;break;default:U++}if(I)return null}if(R===null||F===null)return null;var te=E/R;return{audio:[{type:"audio",dts:F,pts:F},{type:"audio",dts:F+1024*_*te,pts:F+1024*_*te}]}},f=function(m){var C={pid:null,table:null},I={};for(var _ in S(m,C),C.table)if(C.table.hasOwnProperty(_))switch(C.table[_]){case s.H264_STREAM_TYPE:I.video=[],o(m,C,I),I.video.length===0&&delete I.video;break;case s.ADTS_STREAM_TYPE:I.audio=[],d(m,C,I),I.audio.length===0&&delete I.audio}return I};ce.exports={inspect:function(m,C){var I;return(I=k.aac.isLikelyAacData(m)?c(m):f(m))&&(I.audio||I.video)?(g(I,C),I):null},parseAudioPes_:d}},we.__chunk_15620=(ce,O,u)=>{var s=u(686);ce.exports=function(x){var k,E={version:x[0],flags:new Uint8Array(x.subarray(1,4)),samples:[]},S=new DataView(x.buffer,x.byteOffset,x.byteLength),d=1&E.flags[2],o=4&E.flags[2],g=1&E.flags[1],c=2&E.flags[1],f=4&E.flags[1],m=8&E.flags[1],C=S.getUint32(4),I=8;for(d&&(E.dataOffset=S.getInt32(I),I+=4),o&&C&&(k={flags:s(x.subarray(I,I+4))},I+=4,g&&(k.duration=S.getUint32(I),I+=4),c&&(k.size=S.getUint32(I),I+=4),m&&(E.version===1?k.compositionTimeOffset=S.getInt32(I):k.compositionTimeOffset=S.getUint32(I),I+=4),E.samples.push(k),C--);C--;)k={},g&&(k.duration=S.getUint32(I),I+=4),c&&(k.size=S.getUint32(I),I+=4),f&&(k.flags=s(x.subarray(I,I+4)),I+=4),m&&(E.version===1?k.compositionTimeOffset=S.getInt32(I):k.compositionTimeOffset=S.getUint32(I),I+=4),E.samples.push(k);return E}},we.__chunk_5231=ce=>{ce.exports=function(O){var u,s=new DataView(O.buffer,O.byteOffset,O.byteLength),x={version:O[0],flags:new Uint8Array(O.subarray(1,4)),trackId:s.getUint32(4)},k=1&x.flags[2],E=2&x.flags[2],S=8&x.flags[2],d=16&x.flags[2],o=32&x.flags[2],g=65536&x.flags[0],c=131072&x.flags[0];return u=8,k&&(u+=4,x.baseDataOffset=s.getUint32(12),u+=4),E&&(x.sampleDescriptionIndex=s.getUint32(u),u+=4),S&&(x.defaultSampleDuration=s.getUint32(u),u+=4),d&&(x.defaultSampleSize=s.getUint32(u),u+=4),o&&(x.defaultSampleFlags=s.getUint32(u)),g&&(x.durationIsEmpty=!0),!k&&c&&(x.baseDataOffsetIsMoof=!0),x}},we.__chunk_63214=(ce,O,u)=>{var s=u(30930).toUnsigned;ce.exports=function(x){var k={version:x[0],flags:new Uint8Array(x.subarray(1,4)),baseMediaDecodeTime:s(x[4]<<24|x[5]<<16|x[6]<<8|x[7])};return k.version===1&&(k.baseMediaDecodeTime*=4294967296,k.baseMediaDecodeTime+=s(x[8]<<24|x[9]<<16|x[10]<<8|x[11])),k}},we.__chunk_52585=ce=>{ce.exports=function(O){var u,s=new DataView(O.buffer,O.byteOffset,O.byteLength),x={version:O[0],flags:new Uint8Array(O.subarray(1,4)),references:[],referenceId:s.getUint32(4),timescale:s.getUint32(8),earliestPresentationTime:s.getUint32(12),firstOffset:s.getUint32(16)},k=s.getUint16(22);for(u=24;k;u+=12,k--)x.references.push({referenceType:(128&O[u])>>>7,referencedSize:2147483647&s.getUint32(u),subsegmentDuration:s.getUint32(u+4),startsWithSap:!!(128&O[u+8]),sapType:(112&O[u+8])>>>4,sapDeltaTime:268435455&s.getUint32(u+8)});return x}},we.__chunk_686=ce=>{ce.exports=function(O){return{isLeading:(12&O[0])>>>2,dependsOn:3&O[0],isDependedOn:(192&O[1])>>>6,hasRedundancy:(48&O[1])>>>4,paddingValue:(14&O[1])>>>1,isNonSyncSample:1&O[1],degradationPriority:O[2]<<8|O[3]}}},we.__chunk_20177=(ce,O,u)=>{"use strict";var s,x,k=function(g){return new Date(1e3*g-20828448e5)},E=u(15799),S=u(79353),d=function(g){var c,f,m=new DataView(g.buffer,g.byteOffset,g.byteLength),C=[];for(c=0;c+4<g.length;c+=f){if(f=m.getUint32(c),c+=4,f<=0){C.push("<span style='color:red;'>MALFORMED DATA</span>");continue}switch(31&g[c]){case 1:C.push("slice_layer_without_partitioning_rbsp");break;case 5:C.push("slice_layer_without_partitioning_rbsp_idr");break;case 6:C.push("sei_rbsp");break;case 7:C.push("seq_parameter_set_rbsp");break;case 8:C.push("pic_parameter_set_rbsp");break;case 9:C.push("access_unit_delimiter_rbsp");break;default:C.push("UNKNOWN NAL - "+g[c]&31)}}return C},o={avc1:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength);return{dataReferenceIndex:c.getUint16(6),width:c.getUint16(24),height:c.getUint16(26),horizresolution:c.getUint16(28)+c.getUint16(30)/16,vertresolution:c.getUint16(32)+c.getUint16(34)/16,frameCount:c.getUint16(40),depth:c.getUint16(74),config:s(g.subarray(78,g.byteLength))}},avcC:function(g){var c,f,m,C,I=new DataView(g.buffer,g.byteOffset,g.byteLength),_={configurationVersion:g[0],avcProfileIndication:g[1],profileCompatibility:g[2],avcLevelIndication:g[3],lengthSizeMinusOne:3&g[4],sps:[],pps:[]},R=31&g[5];for(C=0,m=6;C<R;C++)f=I.getUint16(m),m+=2,_.sps.push(new Uint8Array(g.subarray(m,m+f))),m+=f;for(c=g[m],m++,C=0;C<c;C++)f=I.getUint16(m),m+=2,_.pps.push(new Uint8Array(g.subarray(m,m+f))),m+=f;return _},btrt:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength);return{bufferSizeDB:c.getUint32(0),maxBitrate:c.getUint32(4),avgBitrate:c.getUint32(8)}},esds:function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),esId:g[6]<<8|g[7],streamPriority:31&g[8],decoderConfig:{objectProfileIndication:g[11],streamType:g[12]>>>2&63,bufferSize:g[13]<<16|g[14]<<8|g[15],maxBitrate:g[16]<<24|g[17]<<16|g[18]<<8|g[19],avgBitrate:g[20]<<24|g[21]<<16|g[22]<<8|g[23],decoderConfigDescriptor:{tag:g[24],length:g[25],audioObjectType:g[26]>>>3&31,samplingFrequencyIndex:(7&g[26])<<1|g[27]>>>7&1,channelConfiguration:g[27]>>>3&15}}}},ftyp:function(g){for(var c=new DataView(g.buffer,g.byteOffset,g.byteLength),f={majorBrand:E(g.subarray(0,4)),minorVersion:c.getUint32(4),compatibleBrands:[]},m=8;m<g.byteLength;)f.compatibleBrands.push(E(g.subarray(m,m+4))),m+=4;return f},dinf:function(g){return{boxes:s(g)}},dref:function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),dataReferences:s(g.subarray(8))}},hdlr:function(g){var c={version:new DataView(g.buffer,g.byteOffset,g.byteLength).getUint8(0),flags:new Uint8Array(g.subarray(1,4)),handlerType:E(g.subarray(8,12)),name:""},f=8;for(f=24;f<g.byteLength;f++){if(g[f]===0){f++;break}c.name+=String.fromCharCode(g[f])}return c.name=decodeURIComponent(escape(c.name)),c},mdat:function(g){return{byteLength:g.byteLength,nals:d(g)}},mdhd:function(g){var c,f=new DataView(g.buffer,g.byteOffset,g.byteLength),m=4,C={version:f.getUint8(0),flags:new Uint8Array(g.subarray(1,4)),language:""};return C.version===1?(m+=4,C.creationTime=k(f.getUint32(m)),m+=8,C.modificationTime=k(f.getUint32(m)),m+=4,C.timescale=f.getUint32(m),m+=8):(C.creationTime=k(f.getUint32(m)),m+=4,C.modificationTime=k(f.getUint32(m)),m+=4,C.timescale=f.getUint32(m),m+=4),C.duration=f.getUint32(m),m+=4,c=f.getUint16(m),C.language+=String.fromCharCode((c>>10)+96),C.language+=String.fromCharCode(((992&c)>>5)+96),C.language+=String.fromCharCode((31&c)+96),C},mdia:function(g){return{boxes:s(g)}},mfhd:function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),sequenceNumber:g[4]<<24|g[5]<<16|g[6]<<8|g[7]}},minf:function(g){return{boxes:s(g)}},mp4a:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength),f={dataReferenceIndex:c.getUint16(6),channelcount:c.getUint16(16),samplesize:c.getUint16(18),samplerate:c.getUint16(24)+c.getUint16(26)/65536};return g.byteLength>28&&(f.streamDescriptor=s(g.subarray(28))[0]),f},moof:function(g){return{boxes:s(g)}},moov:function(g){return{boxes:s(g)}},mvex:function(g){return{boxes:s(g)}},mvhd:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength),f=4,m={version:c.getUint8(0),flags:new Uint8Array(g.subarray(1,4))};return m.version===1?(f+=4,m.creationTime=k(c.getUint32(f)),f+=8,m.modificationTime=k(c.getUint32(f)),f+=4,m.timescale=c.getUint32(f),f+=8):(m.creationTime=k(c.getUint32(f)),f+=4,m.modificationTime=k(c.getUint32(f)),f+=4,m.timescale=c.getUint32(f),f+=4),m.duration=c.getUint32(f),f+=4,m.rate=c.getUint16(f)+c.getUint16(f+2)/16,f+=4,m.volume=c.getUint8(f)+c.getUint8(f+1)/8,f+=12,m.matrix=new Uint32Array(g.subarray(f,f+36)),f+=60,m.nextTrackId=c.getUint32(f),m},pdin:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength);return{version:c.getUint8(0),flags:new Uint8Array(g.subarray(1,4)),rate:c.getUint32(4),initialDelay:c.getUint32(8)}},sdtp:function(g){var c,f={version:g[0],flags:new Uint8Array(g.subarray(1,4)),samples:[]};for(c=4;c<g.byteLength;c++)f.samples.push({dependsOn:(48&g[c])>>4,isDependedOn:(12&g[c])>>2,hasRedundancy:3&g[c]});return f},sidx:u(52585),smhd:function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),balance:g[4]+g[5]/256}},stbl:function(g){return{boxes:s(g)}},stco:function(g){var c,f=new DataView(g.buffer,g.byteOffset,g.byteLength),m={version:g[0],flags:new Uint8Array(g.subarray(1,4)),chunkOffsets:[]},C=f.getUint32(4);for(c=8;C;c+=4,C--)m.chunkOffsets.push(f.getUint32(c));return m},stsc:function(g){var c,f=new DataView(g.buffer,g.byteOffset,g.byteLength),m=f.getUint32(4),C={version:g[0],flags:new Uint8Array(g.subarray(1,4)),sampleToChunks:[]};for(c=8;m;c+=12,m--)C.sampleToChunks.push({firstChunk:f.getUint32(c),samplesPerChunk:f.getUint32(c+4),sampleDescriptionIndex:f.getUint32(c+8)});return C},stsd:function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),sampleDescriptions:s(g.subarray(8))}},stsz:function(g){var c,f=new DataView(g.buffer,g.byteOffset,g.byteLength),m={version:g[0],flags:new Uint8Array(g.subarray(1,4)),sampleSize:f.getUint32(4),entries:[]};for(c=12;c<g.byteLength;c+=4)m.entries.push(f.getUint32(c));return m},stts:function(g){var c,f=new DataView(g.buffer,g.byteOffset,g.byteLength),m={version:g[0],flags:new Uint8Array(g.subarray(1,4)),timeToSamples:[]},C=f.getUint32(4);for(c=8;C;c+=8,C--)m.timeToSamples.push({sampleCount:f.getUint32(c),sampleDelta:f.getUint32(c+4)});return m},styp:function(g){return o.ftyp(g)},tfdt:u(63214),tfhd:u(5231),tkhd:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength),f=4,m={version:c.getUint8(0),flags:new Uint8Array(g.subarray(1,4))};return m.version===1?(f+=4,m.creationTime=k(c.getUint32(f)),f+=8,m.modificationTime=k(c.getUint32(f)),f+=4,m.trackId=c.getUint32(f),f+=12):(m.creationTime=k(c.getUint32(f)),f+=4,m.modificationTime=k(c.getUint32(f)),f+=4,m.trackId=c.getUint32(f),f+=8),m.duration=c.getUint32(f),f+=12,m.layer=c.getUint16(f),f+=2,m.alternateGroup=c.getUint16(f),f+=2,m.volume=c.getUint8(f)+c.getUint8(f+1)/8,f+=4,m.matrix=new Uint32Array(g.subarray(f,f+36)),f+=36,m.width=c.getUint16(f)+c.getUint16(f+2)/65536,f+=4,m.height=c.getUint16(f)+c.getUint16(f+2)/65536,m},traf:function(g){return{boxes:s(g)}},trak:function(g){return{boxes:s(g)}},trex:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength);return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),trackId:c.getUint32(4),defaultSampleDescriptionIndex:c.getUint32(8),defaultSampleDuration:c.getUint32(12),defaultSampleSize:c.getUint32(16),sampleDependsOn:3&g[20],sampleIsDependedOn:(192&g[21])>>6,sampleHasRedundancy:(48&g[21])>>4,samplePaddingValue:(14&g[21])>>1,sampleIsDifferenceSample:!!(1&g[21]),sampleDegradationPriority:c.getUint16(22)}},trun:u(15620),"url ":function(g){return{version:g[0],flags:new Uint8Array(g.subarray(1,4))}},vmhd:function(g){var c=new DataView(g.buffer,g.byteOffset,g.byteLength);return{version:g[0],flags:new Uint8Array(g.subarray(1,4)),graphicsmode:c.getUint16(4),opcolor:new Uint16Array([c.getUint16(6),c.getUint16(8),c.getUint16(10)])}}};s=function(g){for(var c,f,m,C,I,_=0,R=[],F=new ArrayBuffer(g.length),L=new Uint8Array(F),U=0;U<g.length;++U)L[U]=g[U];for(c=new DataView(F);_<g.byteLength;)f=c.getUint32(_),m=E(g.subarray(_+4,_+8)),C=f>1?_+f:g.byteLength,(I=(o[m]||function(te){return{data:te}})(g.subarray(_+8,C))).size=f,I.type=m,R.push(I),_=C;return R},x=function(g,c){var f;return f=Array(2*(c=c||0)+1).join(" "),g.map(function(m,C){return f+m.type+`
`+Object.keys(m).filter(function(I){return I!=="type"&&I!=="boxes"}).map(function(I){var _=f+"  "+I+": ",R=m[I];if(R instanceof Uint8Array||R instanceof Uint32Array){var F=Array.prototype.slice.call(new Uint8Array(R.buffer,R.byteOffset,R.byteLength)).map(function(L){return" "+("00"+L.toString(16)).slice(-2)}).join("").match(/.{1,24}/g);return F?F.length===1?_+"<"+F.join("").slice(1)+">":_+`<
`+F.map(function(L){return f+"  "+L}).join(`
`)+`
`+f+"  >":_+"<>"}return _+JSON.stringify(R,null,2).split(`
`).map(function(L,U){return U===0?L:f+"  "+L}).join(`
`)}).join(`
`)+(m.boxes?`
`+x(m.boxes,c+1):"")}).join(`
`)},ce.exports={inspect:s,textify:x,parseType:E,findBox:S,parseTraf:o.traf,parseTfdt:o.tfdt,parseHdlr:o.hdlr,parseTfhd:o.tfhd,parseTrun:o.trun,parseSidx:o.sidx}},we.__chunk_45092=ce=>{"use strict";var O={8:"audio",9:"video",18:"metadata"},u=function(S){for(var d,o=[];S.byteLength>0;)d=0,o.push("0x"+("00"+S[d++].toString(16)).slice(-2).toUpperCase()),S=S.subarray(d);return o.join(" ")},s=function(S,d){var o=S[1]&parseInt("01111111",2)<<16|S[2]<<8|S[3];return(d=d||{}).avcPacketType=["AVC Sequence Header","AVC NALU","AVC End-of-Sequence"][S[0]],d.CompositionTime=S[1]&parseInt("10000000",2)?-o:o,S[0]===1?d.nalUnitTypeRaw=u(S.subarray(4,100)):d.data=u(S.subarray(4)),d},x=function(S,d){var o=S[0]&parseInt("00001111",2);return(d=d||{}).frameType=["Unknown","Keyframe (for AVC, a seekable frame)","Inter frame (for AVC, a nonseekable frame)","Disposable inter frame (H.263 only)","Generated keyframe (reserved for server use only)","Video info/command frame"][(S[0]&parseInt("11110000",2))>>>4],d.codecID=o,o===7?s(S.subarray(1),d):d},k=function(S,d){var o,g,c=(S[0]&parseInt("11110000",2))>>>4;return(d=d||{}).soundFormat=["Linear PCM, platform endian","ADPCM","MP3","Linear PCM, little endian","Nellymoser 16-kHz mono","Nellymoser 8-kHz mono","Nellymoser","G.711 A-law logarithmic PCM","G.711 mu-law logarithmic PCM","reserved","AAC","Speex","MP3 8-Khz","Device-specific sound"][c],d.soundRate=["5.5-kHz","11-kHz","22-kHz","44-kHz"][(S[0]&parseInt("00001100",2))>>>2],d.soundSize=(S[0]&parseInt("00000010",2))>>>1?"16-bit":"8-bit",d.soundType=S[0]&parseInt("00000001",2)?"Stereo":"Mono",c===10?(o=S.subarray(1),(g=(g=d)||{}).aacPacketType=["AAC Sequence Header","AAC Raw"][o[0]],g.data=u(o.subarray(1)),g):d},E=function(S){var d={tagType:O[S[0]],dataSize:S[1]<<16|S[2]<<8|S[3],timestamp:S[7]<<24|S[4]<<16|S[5]<<8|S[6],streamID:S[8]<<16|S[9]<<8|S[10]};switch(S[0]){case 8:k(S.subarray(11),d);break;case 9:x(S.subarray(11),d)}return d};ce.exports={inspectTag:E,inspect:function(S){var d,o,g=[];for(o=13;o<S.byteLength;)d=(S[o+1]<<16|S[o+2]<<8|S[o+3])+11,g.push(E(S.subarray(o,o+d))),o+=d+4;return g},textify:function(S){return JSON.stringify(S,null,2)}}},we.__chunk_566=ce=>{"use strict";ce.exports={parseSei:function(O){for(var u=0,s={payloadType:-1,payloadSize:0},x=0,k=0;u<O.byteLength&&O[u]!==128;){for(;O[u]===255;)x+=255,u++;for(x+=O[u++];O[u]===255;)k+=255,u++;if(k+=O[u++],!s.payload&&x===4){if(String.fromCharCode(O[u+3],O[u+4],O[u+5],O[u+6])==="GA94"){s.payloadType=x,s.payloadSize=k,s.payload=O.subarray(u,u+k);break}s.payload=void 0}u+=k,x=0,k=0}return s},parseUserData:function(O){return O.payload[0]!==181||(O.payload[1]<<8|O.payload[2])!=49||String.fromCharCode(O.payload[3],O.payload[4],O.payload[5],O.payload[6])!=="GA94"||O.payload[7]!==3?null:O.payload.subarray(8,O.payload.length-1)},parseCaptionPackets:function(O,u){var s,x,k,E,S=[];if(!(64&u[0]))return S;for(s=0,x=31&u[0];s<x;s++)E={type:3&u[(k=3*s)+2],pts:O},4&u[k+2]&&(E.ccData=u[k+3]<<8|u[k+4],S.push(E));return S},discardEmulationPreventionBytes:function(O){for(var u,s,x=O.byteLength,k=[],E=1;E<x-2;)O[E]===0&&O[E+1]===0&&O[E+2]===3?(k.push(E+2),E+=2):E++;if(k.length===0)return O;s=new Uint8Array(u=x-k.length);var S=0;for(E=0;E<u;S++,E++)S===k[0]&&(S++,k.shift()),s[E]=O[S];return s},USER_DATA_REGISTERED_ITU_T_T35:4}},we.__chunk_28868=(ce,O,u)=>{"use strict";var s=u(17581),x=u(27011),k=u(4970),E=u(94383),S=u(23166),d=function(o,g){var c,f,m,C=0,I=[],_=[],R=null,F=null,L=!0;g=g||{},d.prototype.init.call(this),this.push=function(U){k.collectDtsInfo(o,U),o.timelineStartInfo.dts===void 0&&(o.timelineStartInfo.dts=U.dts),U.nalUnitType!=="seq_parameter_set_rbsp"||c||(c=U.config,o.sps=[U.data],S.forEach(function(te){o[te]=c[te]},this)),U.nalUnitType!=="pic_parameter_set_rbsp"||f||(f=U.data,o.pps=[U.data]),I.push(U)},this.processNals_=function(U){for(I=_.concat(I);I.length&&I[0].nalUnitType!=="access_unit_delimiter_rbsp";)I.shift();if(I.length!==0){var te,Y=E.groupNalsIntoFrames(I);if(Y.length){if(_=Y[Y.length-1],U&&(Y.pop(),Y.duration-=_.duration,Y.nalCount-=_.length,Y.byteLength-=_.byteLength),!Y.length){I=[];return}if(this.trigger("timelineStartInfo",o.timelineStartInfo),L){if(!(m=E.groupFramesIntoGops(Y))[0][0].keyFrame){if(!(m=E.extendFirstKeyFrame(m))[0][0].keyFrame){I=[].concat.apply([],Y).concat(_),_=[];return}(Y=[].concat.apply([],m)).duration=m.duration}L=!1}for(R===null&&(F=R=Y[0].pts),F+=Y.duration,this.trigger("timingInfo",{start:R,end:F}),te=0;te<Y.length;te++){var q=Y[te];o.samples=E.generateSampleTableForFrame(q);var se=x.mdat(E.concatenateNalDataForFrame(q));k.clearDtsInfo(o),k.collectDtsInfo(o,q),o.baseMediaDecodeTime=k.calculateTrackBaseMediaDecodeTime(o,g.keepOriginalTimestamps);var J=x.moof(C,[o]);C++,o.initSegment=x.initSegment([o]);var j=new Uint8Array(J.byteLength+se.byteLength);j.set(J),j.set(se,J.byteLength),this.trigger("data",{track:o,boxes:j,sequence:C,videoFrameDts:q.dts,videoFramePts:q.pts})}I=[]}}},this.resetTimingAndConfig_=function(){c=void 0,f=void 0,R=null,F=null},this.partialFlush=function(){this.processNals_(!0),this.trigger("partialdone","VideoSegmentStream")},this.flush=function(){this.processNals_(!1),this.resetTimingAndConfig_(),this.trigger("done","VideoSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","VideoSegmentStream")},this.reset=function(){this.resetTimingAndConfig_(),_=[],I=[],L=!0,this.trigger("reset")}};d.prototype=new s,ce.exports=d},we.__chunk_71104=(ce,O,u)=>{var s=u(17581),x=u(6237),k=u(55707),E=u(30777),S=u(28868),d=u(4970),o=u(17323).isLikelyAacData,g=u(56659),c=u(72646),f=u(6056),m=function(F){return F.prototype=new s,F.prototype.init.call(F),F},C=function(F){var L={type:"ts",tracks:{audio:null,video:null},packet:new x.TransportPacketStream,parse:new x.TransportParseStream,elementary:new x.ElementaryStream,timestampRollover:new x.TimestampRolloverStream,adts:new k.Adts,h264:new k.h264.H264Stream,captionStream:new x.CaptionStream,metadataStream:new x.MetadataStream};return L.headOfPipeline=L.packet,L.packet.pipe(L.parse).pipe(L.elementary).pipe(L.timestampRollover),L.timestampRollover.pipe(L.h264),L.h264.pipe(L.captionStream),L.timestampRollover.pipe(L.metadataStream),L.timestampRollover.pipe(L.adts),L.elementary.on("data",function(U){if(U.type==="metadata"){for(var te=0;te<U.tracks.length;te++)L.tracks[U.tracks[te].type]||(L.tracks[U.tracks[te].type]=U.tracks[te],L.tracks[U.tracks[te].type].timelineStartInfo.baseMediaDecodeTime=F.baseMediaDecodeTime);L.tracks.video&&!L.videoSegmentStream&&(L.videoSegmentStream=new S(L.tracks.video,F),L.videoSegmentStream.on("timelineStartInfo",function(Y){L.tracks.audio&&!F.keepOriginalTimestamps&&L.audioSegmentStream.setEarliestDts(Y.dts-F.baseMediaDecodeTime)}),L.videoSegmentStream.on("timingInfo",L.trigger.bind(L,"videoTimingInfo")),L.videoSegmentStream.on("data",function(Y){L.trigger("data",{type:"video",data:Y})}),L.videoSegmentStream.on("done",L.trigger.bind(L,"done")),L.videoSegmentStream.on("partialdone",L.trigger.bind(L,"partialdone")),L.videoSegmentStream.on("endedtimeline",L.trigger.bind(L,"endedtimeline")),L.h264.pipe(L.videoSegmentStream)),L.tracks.audio&&!L.audioSegmentStream&&(L.audioSegmentStream=new E(L.tracks.audio,F),L.audioSegmentStream.on("data",function(Y){L.trigger("data",{type:"audio",data:Y})}),L.audioSegmentStream.on("done",L.trigger.bind(L,"done")),L.audioSegmentStream.on("partialdone",L.trigger.bind(L,"partialdone")),L.audioSegmentStream.on("endedtimeline",L.trigger.bind(L,"endedtimeline")),L.audioSegmentStream.on("timingInfo",L.trigger.bind(L,"audioTimingInfo")),L.adts.pipe(L.audioSegmentStream)),L.trigger("trackinfo",{hasAudio:!!L.tracks.audio,hasVideo:!!L.tracks.video})}}),L.captionStream.on("data",function(U){var te;te=L.tracks.video&&L.tracks.video.timelineStartInfo.pts||0,U.startTime=f.metadataTsToSeconds(U.startPts,te,F.keepOriginalTimestamps),U.endTime=f.metadataTsToSeconds(U.endPts,te,F.keepOriginalTimestamps),L.trigger("caption",U)}),(L=m(L)).metadataStream.on("data",L.trigger.bind(L,"id3Frame")),L},I=function(F){var L={type:"aac",tracks:{audio:null},metadataStream:new x.MetadataStream,aacStream:new c,audioRollover:new x.TimestampRolloverStream("audio"),timedMetadataRollover:new x.TimestampRolloverStream("timed-metadata"),adtsStream:new g(!0)};return L.headOfPipeline=L.aacStream,L.aacStream.pipe(L.audioRollover).pipe(L.adtsStream),L.aacStream.pipe(L.timedMetadataRollover).pipe(L.metadataStream),L.metadataStream.on("timestamp",function(U){L.aacStream.setTimestamp(U.timeStamp)}),L.aacStream.on("data",function(U){U.type!=="timed-metadata"&&U.type!=="audio"||L.audioSegmentStream||(L.tracks.audio=L.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:F.baseMediaDecodeTime},codec:"adts",type:"audio"},L.audioSegmentStream=new E(L.tracks.audio,F),L.audioSegmentStream.on("data",function(te){L.trigger("data",{type:"audio",data:te})}),L.audioSegmentStream.on("partialdone",L.trigger.bind(L,"partialdone")),L.audioSegmentStream.on("done",L.trigger.bind(L,"done")),L.audioSegmentStream.on("endedtimeline",L.trigger.bind(L,"endedtimeline")),L.audioSegmentStream.on("timingInfo",L.trigger.bind(L,"audioTimingInfo")),L.adtsStream.pipe(L.audioSegmentStream),L.trigger("trackinfo",{hasAudio:!!L.tracks.audio,hasVideo:!!L.tracks.video}))}),(L=m(L)).metadataStream.on("data",L.trigger.bind(L,"id3Frame")),L},_=function(F,L){F.on("data",L.trigger.bind(L,"data")),F.on("done",L.trigger.bind(L,"done")),F.on("partialdone",L.trigger.bind(L,"partialdone")),F.on("endedtimeline",L.trigger.bind(L,"endedtimeline")),F.on("audioTimingInfo",L.trigger.bind(L,"audioTimingInfo")),F.on("videoTimingInfo",L.trigger.bind(L,"videoTimingInfo")),F.on("trackinfo",L.trigger.bind(L,"trackinfo")),F.on("id3Frame",function(U){U.dispatchType=F.metadataStream.dispatchType,U.cueTime=f.videoTsToSeconds(U.pts),L.trigger("id3Frame",U)}),F.on("caption",function(U){L.trigger("caption",U)})},R=function(F){var L=null,U=!0;F=F||{},R.prototype.init.call(this),F.baseMediaDecodeTime=F.baseMediaDecodeTime||0,this.push=function(te){if(U){var Y=o(te);Y&&(!L||L.type!=="aac")?_(L=I(F),this):Y||L&&L.type==="ts"||_(L=C(F),this),U=!1}L.headOfPipeline.push(te)},this.flush=function(){L&&(U=!0,L.headOfPipeline.flush())},this.partialFlush=function(){L&&L.headOfPipeline.partialFlush()},this.endTimeline=function(){L&&L.headOfPipeline.endTimeline()},this.reset=function(){L&&L.headOfPipeline.reset()},this.setBaseMediaDecodeTime=function(te){F.keepOriginalTimestamps||(F.baseMediaDecodeTime=te),L&&(L.tracks.audio&&(L.tracks.audio.timelineStartInfo.dts=void 0,L.tracks.audio.timelineStartInfo.pts=void 0,d.clearDtsInfo(L.tracks.audio),L.audioRollover&&L.audioRollover.discontinuity()),L.tracks.video&&(L.videoSegmentStream&&(L.videoSegmentStream.gopCache_=[]),L.tracks.video.timelineStartInfo.dts=void 0,L.tracks.video.timelineStartInfo.pts=void 0,d.clearDtsInfo(L.tracks.video)),L.timestampRollover&&L.timestampRollover.discontinuity())},this.setRemux=function(te){F.remux=te,L&&L.coalesceStream&&L.coalesceStream.setRemux(te)},this.setAudioAppendStart=function(te){L&&L.tracks.audio&&L.audioSegmentStream&&L.audioSegmentStream.setAudioAppendStart(te)},this.alignGopsWith=function(te){}};R.prototype=new s,ce.exports=R},we.__chunk_99726=(ce,O,u)=>{ce.exports={Transmuxer:u(71104)}},we.__chunk_30777=(ce,O,u)=>{"use strict";var s=u(17581),x=u(27011),k=u(25840),E=u(4970),S=u(6056).ONE_SECOND_IN_TS,d=u(91565),o=function(g,c){var f=[],m=0,C=0,I=0,_=1/0,R=null,F=null;c=c||{},o.prototype.init.call(this),this.push=function(L){E.collectDtsInfo(g,L),g&&d.forEach(function(U){g[U]=L[U]}),f.push(L)},this.setEarliestDts=function(L){C=L},this.setVideoBaseMediaDecodeTime=function(L){_=L},this.setAudioAppendStart=function(L){I=L},this.processFrames_=function(){var L,U,te,Y,q;f.length!==0&&(L=k.trimAdtsFramesByEarliestDts(f,g,C)).length!==0&&(g.baseMediaDecodeTime=E.calculateTrackBaseMediaDecodeTime(g,c.keepOriginalTimestamps),k.prefixWithSilence(g,L,I,_),g.samples=k.generateSampleTable(L),te=x.mdat(k.concatenateFrameData(L)),f=[],U=x.moof(m,[g]),m++,g.initSegment=x.initSegment([g]),(Y=new Uint8Array(U.byteLength+te.byteLength)).set(U),Y.set(te,U.byteLength),E.clearDtsInfo(g),R===null&&(F=R=L[0].pts),F+=L.length*(1024*S/g.samplerate),q={start:R},this.trigger("timingInfo",q),this.trigger("data",{track:g,boxes:Y}))},this.flush=function(){this.processFrames_(),this.trigger("timingInfo",{start:R,end:F}),this.resetTiming_(),this.trigger("done","AudioSegmentStream")},this.partialFlush=function(){this.processFrames_(),this.trigger("partialdone","AudioSegmentStream")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline","AudioSegmentStream")},this.resetTiming_=function(){E.clearDtsInfo(g),R=null,F=null},this.reset=function(){this.resetTiming_(),f=[],this.trigger("reset")}};o.prototype=new s,ce.exports=o},we.__chunk_9779=(ce,O,u)=>{"use strict";var s,x,k,E,S=u(17581),d=u(27011),o=u(94383),g=u(25840),c=u(4970),f=u(6237),m=u(6056),C=u(56659),I=u(44596).H264Stream,_=u(72646),R=u(17323).isLikelyAacData,F=u(6056).ONE_SECOND_IN_TS,L=u(91565),U=u(23166),te=function(q,se){var J;if(q.length!==se.length)return!1;for(J=0;J<q.length;J++)if(q[J]!==se[J])return!1;return!0},Y=function(q,se,J,j,M,b){return{start:{dts:q,pts:q+(J-se)},end:{dts:q+(j-se),pts:q+(M-J)},prependedContentDuration:b,baseMediaDecodeTime:q}};(x=function(q,se){var J=[],j=0,M=0,b=0,N=1/0;se=se||{},x.prototype.init.call(this),this.push=function($){c.collectDtsInfo(q,$),q&&L.forEach(function(X){q[X]=$[X]}),J.push($)},this.setEarliestDts=function($){M=$},this.setVideoBaseMediaDecodeTime=function($){N=$},this.setAudioAppendStart=function($){b=$},this.flush=function(){var $,X,ae,K,ve;if(J.length===0){this.trigger("done","AudioSegmentStream");return}$=g.trimAdtsFramesByEarliestDts(J,q,M),q.baseMediaDecodeTime=c.calculateTrackBaseMediaDecodeTime(q,se.keepOriginalTimestamps),g.prefixWithSilence(q,$,b,N),q.samples=g.generateSampleTable($),ae=d.mdat(g.concatenateFrameData($)),J=[],K=new Uint8Array((X=d.moof(j,[q])).byteLength+ae.byteLength),j++,K.set(X),K.set(ae,X.byteLength),c.clearDtsInfo(q),ve=Math.ceil(1024*F/q.samplerate),$.length&&this.trigger("timingInfo",{start:$[0].pts,end:$[0].pts+$.length*ve}),this.trigger("data",{track:q,boxes:K}),this.trigger("done","AudioSegmentStream")},this.reset=function(){c.clearDtsInfo(q),J=[],this.trigger("reset")}}).prototype=new S,(s=function(q,se){var J,j,M=0,b=[],N=[];se=se||{},s.prototype.init.call(this),delete q.minPTS,this.gopCache_=[],this.push=function($){c.collectDtsInfo(q,$),$.nalUnitType!=="seq_parameter_set_rbsp"||J||(J=$.config,q.sps=[$.data],U.forEach(function(X){q[X]=J[X]},this)),$.nalUnitType!=="pic_parameter_set_rbsp"||j||(j=$.data,q.pps=[$.data]),b.push($)},this.flush=function(){for(var $,X,ae,K,ve,ke,fe,Ae,_e,Z=0;b.length&&b[0].nalUnitType!=="access_unit_delimiter_rbsp";)b.shift();if(b.length===0){this.resetStream_(),this.trigger("done","VideoSegmentStream");return}if(X=o.groupNalsIntoFrames(b),(K=o.groupFramesIntoGops(X))[0][0].keyFrame||((ae=this.getGopForFusion_(b[0],q))?(Z=ae.duration,K.unshift(ae),K.byteLength+=ae.byteLength,K.nalCount+=ae.nalCount,K.pts=ae.pts,K.dts=ae.dts,K.duration+=ae.duration):K=o.extendFirstKeyFrame(K)),N.length){if(!($=se.alignGopsAtEnd?this.alignGopsAtEnd_(K):this.alignGopsAtStart_(K))){this.gopCache_.unshift({gop:K.pop(),pps:q.pps,sps:q.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),b=[],this.resetStream_(),this.trigger("done","VideoSegmentStream");return}c.clearDtsInfo(q),K=$}c.collectDtsInfo(q,K),q.samples=o.generateSampleTable(K),ke=d.mdat(o.concatenateNalData(K)),q.baseMediaDecodeTime=c.calculateTrackBaseMediaDecodeTime(q,se.keepOriginalTimestamps),this.trigger("processedGopsInfo",K.map(function(ne){return{pts:ne.pts,dts:ne.dts,byteLength:ne.byteLength}})),Ae=K[0],_e=K[K.length-1],this.trigger("segmentTimingInfo",Y(q.baseMediaDecodeTime,Ae.dts,Ae.pts,_e.dts+_e.duration,_e.pts+_e.duration,Z)),this.trigger("timingInfo",{start:K[0].pts,end:K[K.length-1].pts+K[K.length-1].duration}),this.gopCache_.unshift({gop:K.pop(),pps:q.pps,sps:q.sps}),this.gopCache_.length=Math.min(6,this.gopCache_.length),b=[],this.trigger("baseMediaDecodeTime",q.baseMediaDecodeTime),this.trigger("timelineStartInfo",q.timelineStartInfo),fe=new Uint8Array((ve=d.moof(M,[q])).byteLength+ke.byteLength),M++,fe.set(ve),fe.set(ke,ve.byteLength),this.trigger("data",{track:q,boxes:fe}),this.resetStream_(),this.trigger("done","VideoSegmentStream")},this.reset=function(){this.resetStream_(),b=[],this.gopCache_.length=0,N.length=0,this.trigger("reset")},this.resetStream_=function(){c.clearDtsInfo(q),J=void 0,j=void 0},this.getGopForFusion_=function($){var X,ae,K,ve,ke,fe=1/0;for(ke=0;ke<this.gopCache_.length;ke++)K=(ve=this.gopCache_[ke]).gop,q.pps&&te(q.pps[0],ve.pps[0])&&q.sps&&te(q.sps[0],ve.sps[0])&&!(K.dts<q.timelineStartInfo.dts)&&(X=$.dts-K.dts-K.duration)>=-1e4&&X<=45e3&&(!ae||fe>X)&&(ae=ve,fe=X);return ae?ae.gop:null},this.alignGopsAtStart_=function($){var X,ae,K,ve,ke,fe,Ae,_e;for(ke=$.byteLength,fe=$.nalCount,Ae=$.duration,X=ae=0;X<N.length&&ae<$.length&&(K=N[X],ve=$[ae],K.pts!==ve.pts);){if(ve.pts>K.pts){X++;continue}ae++,ke-=ve.byteLength,fe-=ve.nalCount,Ae-=ve.duration}return ae===0?$:ae===$.length?null:((_e=$.slice(ae)).byteLength=ke,_e.duration=Ae,_e.nalCount=fe,_e.pts=_e[0].pts,_e.dts=_e[0].dts,_e)},this.alignGopsAtEnd_=function($){for(X=N.length-1,ae=$.length-1,ke=null,fe=!1;X>=0&&ae>=0;){if(K=N[X],ve=$[ae],K.pts===ve.pts){fe=!0;break}if(K.pts>ve.pts){X--;continue}X===N.length-1&&(ke=ae),ae--}if(!fe&&ke===null)return null;if((Ae=fe?ae:ke)===0)return $;var X,ae,K,ve,ke,fe,Ae,_e=$.slice(Ae),Z=_e.reduce(function(ne,W){return ne.byteLength+=W.byteLength,ne.duration+=W.duration,ne.nalCount+=W.nalCount,ne},{byteLength:0,duration:0,nalCount:0});return _e.byteLength=Z.byteLength,_e.duration=Z.duration,_e.nalCount=Z.nalCount,_e.pts=_e[0].pts,_e.dts=_e[0].dts,_e},this.alignGopsWith=function($){N=$}}).prototype=new S,(E=function(q,se){this.numberOfTracks=0,this.metadataStream=se,(q=q||{}).remux!==void 0?this.remuxTracks=!!q.remux:this.remuxTracks=!0,typeof q.keepOriginalTimestamps=="boolean"?this.keepOriginalTimestamps=q.keepOriginalTimestamps:this.keepOriginalTimestamps=!1,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,this.emittedTracks=0,E.prototype.init.call(this),this.push=function(J){return J.text?this.pendingCaptions.push(J):J.frames?this.pendingMetadata.push(J):(this.pendingTracks.push(J.track),this.pendingBytes+=J.boxes.byteLength,J.track.type==="video"&&(this.videoTrack=J.track,this.pendingBoxes.push(J.boxes)),void(J.track.type==="audio"&&(this.audioTrack=J.track,this.pendingBoxes.unshift(J.boxes))))}}).prototype=new S,E.prototype.flush=function(q){var se,J,j,M,b=0,N={captions:[],captionStreams:{},metadata:[],info:{}},$=0;if(this.pendingTracks.length<this.numberOfTracks){if(q!=="VideoSegmentStream"&&q!=="AudioSegmentStream"||this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++,this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?($=this.videoTrack.timelineStartInfo.pts,U.forEach(function(X){N.info[X]=this.videoTrack[X]},this)):this.audioTrack&&($=this.audioTrack.timelineStartInfo.pts,L.forEach(function(X){N.info[X]=this.audioTrack[X]},this)),this.videoTrack||this.audioTrack){for(this.pendingTracks.length===1?N.type=this.pendingTracks[0].type:N.type="combined",this.emittedTracks+=this.pendingTracks.length,j=d.initSegment(this.pendingTracks),N.initSegment=new Uint8Array(j.byteLength),N.initSegment.set(j),N.data=new Uint8Array(this.pendingBytes),M=0;M<this.pendingBoxes.length;M++)N.data.set(this.pendingBoxes[M],b),b+=this.pendingBoxes[M].byteLength;for(M=0;M<this.pendingCaptions.length;M++)(se=this.pendingCaptions[M]).startTime=m.metadataTsToSeconds(se.startPts,$,this.keepOriginalTimestamps),se.endTime=m.metadataTsToSeconds(se.endPts,$,this.keepOriginalTimestamps),N.captionStreams[se.stream]=!0,N.captions.push(se);for(M=0;M<this.pendingMetadata.length;M++)(J=this.pendingMetadata[M]).cueTime=m.metadataTsToSeconds(J.pts,$,this.keepOriginalTimestamps),N.metadata.push(J);for(N.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",N),M=0;M<N.captions.length;M++)se=N.captions[M],this.trigger("caption",se);for(M=0;M<N.metadata.length;M++)J=N.metadata[M],this.trigger("id3Frame",J)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)},E.prototype.setRemux=function(q){this.remuxTracks=q},(k=function(q){var se,J,j=this,M=!0;k.prototype.init.call(this),q=q||{},this.baseMediaDecodeTime=q.baseMediaDecodeTime||0,this.transmuxPipeline_={},d.setDuration(q.duration),this.setupAacPipeline=function(){var b={};this.transmuxPipeline_=b,b.type="aac",b.metadataStream=new f.MetadataStream,b.aacStream=new _,b.audioTimestampRolloverStream=new f.TimestampRolloverStream("audio"),b.timedMetadataTimestampRolloverStream=new f.TimestampRolloverStream("timed-metadata"),b.adtsStream=new C,b.coalesceStream=new E(q,b.metadataStream),b.headOfPipeline=b.aacStream,b.aacStream.pipe(b.audioTimestampRolloverStream).pipe(b.adtsStream),b.aacStream.pipe(b.timedMetadataTimestampRolloverStream).pipe(b.metadataStream).pipe(b.coalesceStream),b.metadataStream.on("timestamp",function(N){b.aacStream.setTimestamp(N.timeStamp)}),b.aacStream.on("data",function(N){N.type!=="timed-metadata"&&N.type!=="audio"||b.audioSegmentStream||(J=J||{timelineStartInfo:{baseMediaDecodeTime:j.baseMediaDecodeTime},codec:"adts",type:"audio"},b.coalesceStream.numberOfTracks++,b.audioSegmentStream=new x(J,q),b.audioSegmentStream.on("timingInfo",j.trigger.bind(j,"audioTimingInfo")),b.adtsStream.pipe(b.audioSegmentStream).pipe(b.coalesceStream),j.trigger("trackinfo",{hasAudio:!!J,hasVideo:!!se}))}),b.coalesceStream.on("data",this.trigger.bind(this,"data")),b.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setupTsPipeline=function(){var b={};this.transmuxPipeline_=b,b.type="ts",b.metadataStream=new f.MetadataStream,b.packetStream=new f.TransportPacketStream,b.parseStream=new f.TransportParseStream,b.elementaryStream=new f.ElementaryStream,b.timestampRolloverStream=new f.TimestampRolloverStream,b.adtsStream=new C,b.h264Stream=new I,b.captionStream=new f.CaptionStream,b.coalesceStream=new E(q,b.metadataStream),b.headOfPipeline=b.packetStream,b.packetStream.pipe(b.parseStream).pipe(b.elementaryStream).pipe(b.timestampRolloverStream),b.timestampRolloverStream.pipe(b.h264Stream),b.timestampRolloverStream.pipe(b.adtsStream),b.timestampRolloverStream.pipe(b.metadataStream).pipe(b.coalesceStream),b.h264Stream.pipe(b.captionStream).pipe(b.coalesceStream),b.elementaryStream.on("data",function(N){var $;if(N.type==="metadata"){for($=N.tracks.length;$--;)se||N.tracks[$].type!=="video"?J||N.tracks[$].type!=="audio"||((J=N.tracks[$]).timelineStartInfo.baseMediaDecodeTime=j.baseMediaDecodeTime):(se=N.tracks[$]).timelineStartInfo.baseMediaDecodeTime=j.baseMediaDecodeTime;se&&!b.videoSegmentStream&&(b.coalesceStream.numberOfTracks++,b.videoSegmentStream=new s(se,q),b.videoSegmentStream.on("timelineStartInfo",function(X){J&&!q.keepOriginalTimestamps&&(J.timelineStartInfo=X,b.audioSegmentStream.setEarliestDts(X.dts-j.baseMediaDecodeTime))}),b.videoSegmentStream.on("processedGopsInfo",j.trigger.bind(j,"gopInfo")),b.videoSegmentStream.on("segmentTimingInfo",j.trigger.bind(j,"videoSegmentTimingInfo")),b.videoSegmentStream.on("baseMediaDecodeTime",function(X){J&&b.audioSegmentStream.setVideoBaseMediaDecodeTime(X)}),b.videoSegmentStream.on("timingInfo",j.trigger.bind(j,"videoTimingInfo")),b.h264Stream.pipe(b.videoSegmentStream).pipe(b.coalesceStream)),J&&!b.audioSegmentStream&&(b.coalesceStream.numberOfTracks++,b.audioSegmentStream=new x(J,q),b.audioSegmentStream.on("timingInfo",j.trigger.bind(j,"audioTimingInfo")),b.adtsStream.pipe(b.audioSegmentStream).pipe(b.coalesceStream)),j.trigger("trackinfo",{hasAudio:!!J,hasVideo:!!se})}}),b.coalesceStream.on("data",this.trigger.bind(this,"data")),b.coalesceStream.on("id3Frame",function(N){N.dispatchType=b.metadataStream.dispatchType,j.trigger("id3Frame",N)}),b.coalesceStream.on("caption",this.trigger.bind(this,"caption")),b.coalesceStream.on("done",this.trigger.bind(this,"done"))},this.setBaseMediaDecodeTime=function(b){var N=this.transmuxPipeline_;q.keepOriginalTimestamps||(this.baseMediaDecodeTime=b),J&&(J.timelineStartInfo.dts=void 0,J.timelineStartInfo.pts=void 0,c.clearDtsInfo(J),N.audioTimestampRolloverStream&&N.audioTimestampRolloverStream.discontinuity()),se&&(N.videoSegmentStream&&(N.videoSegmentStream.gopCache_=[]),se.timelineStartInfo.dts=void 0,se.timelineStartInfo.pts=void 0,c.clearDtsInfo(se),N.captionStream.reset()),N.timestampRolloverStream&&N.timestampRolloverStream.discontinuity()},this.setAudioAppendStart=function(b){J&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(b)},this.setRemux=function(b){var N=this.transmuxPipeline_;q.remux=b,N&&N.coalesceStream&&N.coalesceStream.setRemux(b)},this.alignGopsWith=function(b){se&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(b)},this.push=function(b){if(M){var N=R(b);N&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():N||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline(),M=!1}this.transmuxPipeline_.headOfPipeline.push(b)},this.flush=function(){M=!0,this.transmuxPipeline_.headOfPipeline.flush()},this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()},this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()},this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}}).prototype=new S,ce.exports={Transmuxer:k,VideoSegmentStream:s,AudioSegmentStream:x,AUDIO_PROPERTIES:L,VIDEO_PROPERTIES:U,generateVideoSegmentTimingInfo:Y}},we.__chunk_4970=(ce,O,u)=>{var s=u(6056).ONE_SECOND_IN_TS;ce.exports={clearDtsInfo:function(x){delete x.minSegmentDts,delete x.maxSegmentDts,delete x.minSegmentPts,delete x.maxSegmentPts},calculateTrackBaseMediaDecodeTime:function(x,k){var E,S=x.minSegmentDts;return k||(S-=x.timelineStartInfo.dts),E=Math.max(0,E=x.timelineStartInfo.baseMediaDecodeTime+S),x.type==="audio"&&(E*=x.samplerate/s,E=Math.floor(E)),E},collectDtsInfo:function(x,k){typeof k.pts=="number"&&(x.timelineStartInfo.pts===void 0&&(x.timelineStartInfo.pts=k.pts),x.minSegmentPts===void 0?x.minSegmentPts=k.pts:x.minSegmentPts=Math.min(x.minSegmentPts,k.pts),x.maxSegmentPts===void 0?x.maxSegmentPts=k.pts:x.maxSegmentPts=Math.max(x.maxSegmentPts,k.pts)),typeof k.dts=="number"&&(x.timelineStartInfo.dts===void 0&&(x.timelineStartInfo.dts=k.dts),x.minSegmentDts===void 0?x.minSegmentDts=k.dts:x.minSegmentDts=Math.min(x.minSegmentDts,k.dts),x.maxSegmentDts===void 0?x.maxSegmentDts=k.dts:x.maxSegmentDts=Math.max(x.maxSegmentDts,k.dts))}}},we.__chunk_13529=(ce,O,u)=>{"use strict";var s,x,k,E,S,d,o=u(30930).toUnsigned,g=u(30930).toHexString,c=u(79353),f=u(15799),m=u(5231),C=u(15620),I=u(63214);s=function(_){return c(_,["moov","trak"]).reduce(function(R,F){var L,U,te,Y;return(L=c(F,["tkhd"])[0])&&(U=L[0]===0?12:20,te=o(L[U]<<24|L[U+1]<<16|L[U+2]<<8|L[U+3]),Y=c(F,["mdia","mdhd"])[0])?(U=Y[0]===0?12:20,R[te]=o(Y[U]<<24|Y[U+1]<<16|Y[U+2]<<8|Y[U+3]),R):null},{})},x=function(_,R){var F,L,U;return F=c(R,["moof","traf"]),L=[].concat.apply([],F.map(function(te){return c(te,["tfhd"]).map(function(Y){var q;return q=_[o(Y[4]<<24|Y[5]<<16|Y[6]<<8|Y[7])]||9e4,(c(te,["tfdt"]).map(function(se){var J,j;return J=se[0],j=o(se[4]<<24|se[5]<<16|se[6]<<8|se[7]),J===1&&(j*=4294967296,j+=o(se[8]<<24|se[9]<<16|se[10]<<8|se[11])),j})[0]||1/0)/q})})),isFinite(U=Math.min.apply(null,L))?U:0},k=function(_,R){var F,L=c(R,["moof","traf"]),U=0,te=0;if(L&&L.length){var Y=c(L[0],["tfhd"])[0],q=c(L[0],["trun"])[0],se=c(L[0],["tfdt"])[0];if(Y&&(F=m(Y).trackId),se&&(U=I(se).baseMediaDecodeTime),q){var J=C(q);J.samples&&J.samples.length&&(te=J.samples[0].compositionTimeOffset||0)}}return(U+te)/(_[F]||9e4)},E=function(_){var R=c(_,["moov","trak"]),F=[];return R.forEach(function(L){var U=c(L,["mdia","hdlr"]),te=c(L,["tkhd"]);U.forEach(function(Y,q){var se,J,j=f(Y.subarray(8,12)),M=te[q];j==="vide"&&(J=(se=new DataView(M.buffer,M.byteOffset,M.byteLength)).getUint8(0)===0?se.getUint32(12):se.getUint32(20),F.push(J))})}),F},d=function(_){var R=_[0]===0?12:20;return o(_[R]<<24|_[R+1]<<16|_[R+2]<<8|_[R+3])},S=function(_){var R=c(_,["moov","trak"]),F=[];return R.forEach(function(L){var U={},te=c(L,["tkhd"])[0];te&&(j=(J=new DataView(te.buffer,te.byteOffset,te.byteLength)).getUint8(0),U.id=j===0?J.getUint32(12):J.getUint32(20));var Y=c(L,["mdia","hdlr"])[0];if(Y){var q=f(Y.subarray(8,12));q==="vide"?U.type="video":q==="soun"?U.type="audio":U.type=q}var se=c(L,["mdia","minf","stbl","stsd"])[0];if(se){var J,j,M,b=se.subarray(8);U.codec=f(b.subarray(4,8));var N=c(b,[U.codec])[0];N&&(/^[a-z]vc[1-9]$/i.test(U.codec)?f((M=N.subarray(78)).subarray(4,8))==="avcC"&&M.length>11?(U.codec+=".",U.codec+=g(M[9]),U.codec+=g(M[10]),U.codec+=g(M[11])):U.codec="avc1.4d400d":/^mp4[a,v]$/i.test(U.codec)&&(f((M=N.subarray(28)).subarray(4,8))==="esds"&&M.length>20&&M[19]!==0?(U.codec+="."+g(M[19]),U.codec+="."+g(M[20]>>>2&63).replace(/^0/,"")):U.codec="mp4a.40.2"))}var $=c(L,["mdia","mdhd"])[0];$&&(U.timescale=d($)),F.push(U)}),F},ce.exports={findBox:c,parseType:f,timescale:s,startTime:x,compositionStartTime:k,videoTrackIds:E,tracks:S,getTimescaleFromMediaHeader:d}},we.__chunk_15799=ce=>{ce.exports=function(O){return""+(String.fromCharCode(O[0])+String.fromCharCode(O[1])+String.fromCharCode(O[2])+String.fromCharCode(O[3]))}},we.__chunk_27011=ce=>{"use strict";var O,u,s,x,k,E,S,d,o,g,c,f,m,C,I,_,R,F,L,U,te,Y,q,se,J,j,M,b,N,$,X,ae,K,ve,ke=4294967295;(function(){var fe;if(q={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array<"u"){for(fe in q)q.hasOwnProperty(fe)&&(q[fe]=[fe.charCodeAt(0),fe.charCodeAt(1),fe.charCodeAt(2),fe.charCodeAt(3)]);se=new Uint8Array([105,115,111,109]),j=new Uint8Array([97,118,99,49]),J=new Uint8Array([0,0,0,1]),M={video:new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),audio:new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0])},$=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),N=new Uint8Array([0,0,0,0,0,0,0,0]),ae=X=new Uint8Array([0,0,0,0,0,0,0,0]),K=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),ve=X,b=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}})(),O=function(fe){var Ae,_e,Z=[],ne=0;for(Ae=1;Ae<arguments.length;Ae++)Z.push(arguments[Ae]);for(Ae=Z.length;Ae--;)ne+=Z[Ae].byteLength;for(new DataView((_e=new Uint8Array(ne+8)).buffer,_e.byteOffset,_e.byteLength).setUint32(0,_e.byteLength),_e.set(fe,4),Ae=0,ne=8;Ae<Z.length;Ae++)_e.set(Z[Ae],ne),ne+=Z[Ae].byteLength;return _e},u=function(){return O(q.dinf,O(q.dref,$))},s=function(fe){return O(q.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,fe.audioobjecttype<<3|fe.samplingfrequencyindex>>>1,fe.samplingfrequencyindex<<7|fe.channelcount<<3,6,1,2]))},x=function(){return O(q.ftyp,se,J,se,j)},_=function(fe){return O(q.hdlr,M[fe])},k=function(fe){return O(q.mdat,fe)},I=function(fe){var Ae=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,fe.duration>>>24&255,fe.duration>>>16&255,fe.duration>>>8&255,255&fe.duration,85,196,0,0]);return fe.samplerate&&(Ae[12]=fe.samplerate>>>24&255,Ae[13]=fe.samplerate>>>16&255,Ae[14]=fe.samplerate>>>8&255,Ae[15]=255&fe.samplerate,fe.duration=fe.duration/9e4*fe.samplerate,Ae[16]=fe.duration>>>24&255,Ae[17]=fe.duration>>>16&255,Ae[18]=fe.duration>>>8&255,Ae[19]=255&fe.duration),O(q.mdhd,Ae)},C=function(fe){return O(q.mdia,I(fe),_(fe.type),S(fe))},E=function(fe){return O(q.mfhd,new Uint8Array([0,0,0,0,(4278190080&fe)>>24,(16711680&fe)>>16,(65280&fe)>>8,255&fe]))},S=function(fe){return O(q.minf,fe.type==="video"?O(q.vmhd,b):O(q.smhd,N),u(),F(fe))},d=function(fe,Ae){for(var _e=[],Z=Ae.length;Z--;)_e[Z]=U(Ae[Z]);return O.apply(null,[q.moof,E(fe)].concat(_e))},o=function(fe){for(var Ae=fe.length,_e=[];Ae--;)_e[Ae]=f(fe[Ae]);return O.apply(null,[q.moov,c(ke)].concat(_e).concat(g(fe)))},g=function(fe){for(var Ae=fe.length,_e=[];Ae--;)_e[Ae]=te(fe[Ae]);return O.apply(null,[q.mvex].concat(_e))},c=function(fe){var Ae=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&fe)>>24,(16711680&fe)>>16,(65280&fe)>>8,255&fe,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return O(q.mvhd,Ae)},R=function(fe){var Ae,_e,Z=fe.samples||[],ne=new Uint8Array(4+Z.length);for(_e=0;_e<Z.length;_e++)Ae=Z[_e].flags,ne[_e+4]=Ae.dependsOn<<4|Ae.isDependedOn<<2|Ae.hasRedundancy;return O(q.sdtp,ne)},F=function(fe){return O(q.stbl,L(fe),O(q.stts,ve),O(q.stsc,ae),O(q.stsz,K),O(q.stco,X))},function(){var fe,Ae;L=function(_e){return O(q.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),_e.type==="video"?fe(_e):Ae(_e))},fe=function(_e){var Z,ne,W=_e.sps||[],Q=_e.pps||[],de=[],ue=[];for(Z=0;Z<W.length;Z++)de.push((65280&W[Z].byteLength)>>>8),de.push(255&W[Z].byteLength),de=de.concat(Array.prototype.slice.call(W[Z]));for(Z=0;Z<Q.length;Z++)ue.push((65280&Q[Z].byteLength)>>>8),ue.push(255&Q[Z].byteLength),ue=ue.concat(Array.prototype.slice.call(Q[Z]));if(ne=[q.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&_e.width)>>8,255&_e.width,(65280&_e.height)>>8,255&_e.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),O(q.avcC,new Uint8Array([1,_e.profileIdc,_e.profileCompatibility,_e.levelIdc,255].concat([W.length],de,[Q.length],ue))),O(q.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],_e.sarRatio){var ye=_e.sarRatio[0],Ge=_e.sarRatio[1];ne.push(O(q.pasp,new Uint8Array([(4278190080&ye)>>24,(16711680&ye)>>16,(65280&ye)>>8,255&ye,(4278190080&Ge)>>24,(16711680&Ge)>>16,(65280&Ge)>>8,255&Ge])))}return O.apply(null,ne)},Ae=function(_e){return O(q.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&_e.channelcount)>>8,255&_e.channelcount,(65280&_e.samplesize)>>8,255&_e.samplesize,0,0,0,0,(65280&_e.samplerate)>>8,255&_e.samplerate,0,0]),s(_e))}}(),m=function(fe){var Ae=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&fe.id)>>24,(16711680&fe.id)>>16,(65280&fe.id)>>8,255&fe.id,0,0,0,0,(4278190080&fe.duration)>>24,(16711680&fe.duration)>>16,(65280&fe.duration)>>8,255&fe.duration,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&fe.width)>>8,255&fe.width,0,0,(65280&fe.height)>>8,255&fe.height,0,0]);return O(q.tkhd,Ae)},U=function(fe){var Ae,_e,Z,ne,W,Q;return Ae=O(q.tfhd,new Uint8Array([0,0,0,58,(4278190080&fe.id)>>24,(16711680&fe.id)>>16,(65280&fe.id)>>8,255&fe.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),W=Math.floor(fe.baseMediaDecodeTime/4294967296),Q=Math.floor(fe.baseMediaDecodeTime%4294967296),_e=O(q.tfdt,new Uint8Array([1,0,0,0,W>>>24&255,W>>>16&255,W>>>8&255,255&W,Q>>>24&255,Q>>>16&255,Q>>>8&255,255&Q])),fe.type==="audio"?(Z=Y(fe,92),O(q.traf,Ae,_e,Z)):(ne=R(fe),Z=Y(fe,ne.length+92),O(q.traf,Ae,_e,Z,ne))},f=function(fe){return fe.duration=fe.duration||ke,O(q.trak,m(fe),C(fe))},te=function(fe){var Ae=new Uint8Array([0,0,0,0,(4278190080&fe.id)>>24,(16711680&fe.id)>>16,(65280&fe.id)>>8,255&fe.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return fe.type!=="video"&&(Ae[Ae.length-1]=0),O(q.trex,Ae)},function(){var fe,Ae,_e;_e=function(Z,ne){var W=0,Q=0,de=0,ue=0;return Z.length&&(Z[0].duration!==void 0&&(W=1),Z[0].size!==void 0&&(Q=2),Z[0].flags!==void 0&&(de=4),Z[0].compositionTimeOffset!==void 0&&(ue=8)),[0,0,W|Q|de|ue,1,(4278190080&Z.length)>>>24,(16711680&Z.length)>>>16,(65280&Z.length)>>>8,255&Z.length,(4278190080&ne)>>>24,(16711680&ne)>>>16,(65280&ne)>>>8,255&ne]},Ae=function(Z,ne){var W,Q,de,ue,ye,Ge;for(ne+=20+16*(ue=Z.samples||[]).length,(Q=new Uint8Array((de=_e(ue,ne)).length+16*ue.length)).set(de),W=de.length,Ge=0;Ge<ue.length;Ge++)ye=ue[Ge],Q[W++]=(4278190080&ye.duration)>>>24,Q[W++]=(16711680&ye.duration)>>>16,Q[W++]=(65280&ye.duration)>>>8,Q[W++]=255&ye.duration,Q[W++]=(4278190080&ye.size)>>>24,Q[W++]=(16711680&ye.size)>>>16,Q[W++]=(65280&ye.size)>>>8,Q[W++]=255&ye.size,Q[W++]=ye.flags.isLeading<<2|ye.flags.dependsOn,Q[W++]=ye.flags.isDependedOn<<6|ye.flags.hasRedundancy<<4|ye.flags.paddingValue<<1|ye.flags.isNonSyncSample,Q[W++]=61440&ye.flags.degradationPriority,Q[W++]=15&ye.flags.degradationPriority,Q[W++]=(4278190080&ye.compositionTimeOffset)>>>24,Q[W++]=(16711680&ye.compositionTimeOffset)>>>16,Q[W++]=(65280&ye.compositionTimeOffset)>>>8,Q[W++]=255&ye.compositionTimeOffset;return O(q.trun,Q)},fe=function(Z,ne){var W,Q,de,ue,ye,Ge;for(ne+=20+8*(ue=Z.samples||[]).length,(W=new Uint8Array((de=_e(ue,ne)).length+8*ue.length)).set(de),Q=de.length,Ge=0;Ge<ue.length;Ge++)ye=ue[Ge],W[Q++]=(4278190080&ye.duration)>>>24,W[Q++]=(16711680&ye.duration)>>>16,W[Q++]=(65280&ye.duration)>>>8,W[Q++]=255&ye.duration,W[Q++]=(4278190080&ye.size)>>>24,W[Q++]=(16711680&ye.size)>>>16,W[Q++]=(65280&ye.size)>>>8,W[Q++]=255&ye.size;return O(q.trun,W)},Y=function(Z,ne){return Z.type==="audio"?fe(Z,ne):Ae(Z,ne)}}(),ce.exports={ftyp:x,mdat:k,moof:d,moov:o,setDuration:function(fe){fe&&(ke=9e4*fe)},initSegment:function(fe){var Ae,_e=x(),Z=o(fe);return(Ae=new Uint8Array(_e.byteLength+Z.byteLength)).set(_e),Ae.set(Z,_e.byteLength),Ae}}},we.__chunk_85760=(ce,O,u)=>{ce.exports={generator:u(27011),probe:u(13529),Transmuxer:u(9779).Transmuxer,AudioSegmentStream:u(9779).AudioSegmentStream,VideoSegmentStream:u(9779).VideoSegmentStream,CaptionParser:u(60573)}},we.__chunk_94383=ce=>{var O=function(u,s){var x={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}};return x.dataOffset=s,x.compositionTimeOffset=u.pts-u.dts,x.duration=u.duration,x.size=4*u.length,x.size+=u.byteLength,u.keyFrame&&(x.flags.dependsOn=2,x.flags.isNonSyncSample=0),x};ce.exports={groupNalsIntoFrames:function(u){var s,x,k=[],E=[];for(s=0,E.byteLength=0,E.nalCount=0,E.duration=0,k.byteLength=0;s<u.length;s++)(x=u[s]).nalUnitType==="access_unit_delimiter_rbsp"?(k.length&&(k.duration=x.dts-k.dts,E.byteLength+=k.byteLength,E.nalCount+=k.length,E.duration+=k.duration,E.push(k)),(k=[x]).byteLength=x.data.byteLength,k.pts=x.pts,k.dts=x.dts):(x.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(k.keyFrame=!0),k.duration=x.dts-k.dts,k.byteLength+=x.data.byteLength,k.push(x));return E.length&&(!k.duration||k.duration<=0)&&(k.duration=E[E.length-1].duration),E.byteLength+=k.byteLength,E.nalCount+=k.length,E.duration+=k.duration,E.push(k),E},groupFramesIntoGops:function(u){var s,x,k=[],E=[];for(s=0,k.byteLength=0,k.nalCount=0,k.duration=0,k.pts=u[0].pts,k.dts=u[0].dts,E.byteLength=0,E.nalCount=0,E.duration=0,E.pts=u[0].pts,E.dts=u[0].dts;s<u.length;s++)(x=u[s]).keyFrame?(k.length&&(E.push(k),E.byteLength+=k.byteLength,E.nalCount+=k.nalCount,E.duration+=k.duration),(k=[x]).nalCount=x.length,k.byteLength=x.byteLength,k.pts=x.pts,k.dts=x.dts,k.duration=x.duration):(k.duration+=x.duration,k.nalCount+=x.length,k.byteLength+=x.byteLength,k.push(x));return E.length&&k.duration<=0&&(k.duration=E[E.length-1].duration),E.byteLength+=k.byteLength,E.nalCount+=k.nalCount,E.duration+=k.duration,E.push(k),E},extendFirstKeyFrame:function(u){var s;return!u[0][0].keyFrame&&u.length>1&&(s=u.shift(),u.byteLength-=s.byteLength,u.nalCount-=s.nalCount,u[0][0].dts=s.dts,u[0][0].pts=s.pts,u[0][0].duration+=s.duration),u},generateSampleTable:function(u,s){var x,k,E,S,d=s||0,o=[];for(x=0;x<u.length;x++)for(k=0,S=u[x];k<S.length;k++)E=O(S[k],d),d+=E.size,o.push(E);return o},concatenateNalData:function(u){var s,x,k,E,S,d,o=0,g=new Uint8Array(u.byteLength+4*u.nalCount),c=new DataView(g.buffer);for(s=0;s<u.length;s++)for(x=0,E=u[s];x<E.length;x++)for(k=0,S=E[x];k<S.length;k++)d=S[k],c.setUint32(o,d.data.byteLength),o+=4,g.set(d.data,o),o+=d.data.byteLength;return g},generateSampleTableForFrame:function(u,s){var x=[];return x.push(O(u,s||0)),x},concatenateNalDataForFrame:function(u){var s,x,k=0,E=new Uint8Array(u.byteLength+4*u.length),S=new DataView(E.buffer);for(s=0;s<u.length;s++)x=u[s],S.setUint32(k,x.data.byteLength),k+=4,E.set(x.data,k),k+=x.data.byteLength;return E}}},we.__chunk_79353=(ce,O,u)=>{var s=u(30930).toUnsigned,x=u(15799),k=function(E,S){var d,o,g,c,f,m=[];if(!S.length)return null;for(d=0;d<E.byteLength;)o=s(E[d]<<24|E[d+1]<<16|E[d+2]<<8|E[d+3]),g=x(E.subarray(d+4,d+8)),c=o>1?d+o:E.byteLength,g===S[0]&&(S.length===1?m.push(E.subarray(d+8,c)):(f=k(E.subarray(d+8,c),S.slice(1))).length&&(m=m.concat(f))),d=c;return m};ce.exports=k},we.__chunk_60573=(ce,O,u)=>{"use strict";var s=u(566).discardEmulationPreventionBytes,x=u(35969).CaptionStream,k=u(79353),E=u(63214),S=u(15620),d=u(5231),o=function(m,C){for(var I=m,_=0;_<C.length;_++){var R=C[_];if(I<R.size)return R;I-=R.size}return null},g=function(m,C,I){var _,R,F,L,U=new DataView(m.buffer,m.byteOffset,m.byteLength),te=[];for(R=0;R+4<m.length;R+=F)if(F=U.getUint32(R),R+=4,!(F<=0))switch(31&m[R]){case 6:var Y=m.subarray(R+1,R+1+F),q=o(R,C);if(_={nalUnitType:"sei_rbsp",size:F,data:Y,escapedRBSP:s(Y),trackId:I},q)_.pts=q.pts,_.dts=q.dts,L=q;else if(L)_.pts=L.pts,_.dts=L.dts;else{console.log("We've encountered a nal unit without data. See mux.js#233.");break}te.push(_)}return te},c=function(m,C,I){var _=C,R=I.defaultSampleDuration||0,F=I.defaultSampleSize||0,L=I.trackId,U=[];return m.forEach(function(te){var Y=S(te).samples;Y.forEach(function(q){q.duration===void 0&&(q.duration=R),q.size===void 0&&(q.size=F),q.trackId=L,q.dts=_,q.compositionTimeOffset===void 0&&(q.compositionTimeOffset=0),q.pts=_+q.compositionTimeOffset,_+=q.duration}),U=U.concat(Y)}),U},f=function(m,C){var I=k(m,["moof","traf"]),_=k(m,["mdat"]),R={},F=[];return _.forEach(function(L,U){var te=I[U];F.push({mdat:L,traf:te})}),F.forEach(function(L){var U,te=L.mdat,Y=L.traf,q=d(k(Y,["tfhd"])[0]),se=q.trackId,J=k(Y,["tfdt"]),j=J.length>0?E(J[0]).baseMediaDecodeTime:0,M=k(Y,["trun"]);C===se&&M.length>0&&(U=g(te,c(M,j,q),se),R[se]||(R[se]=[]),R[se]=R[se].concat(U))}),R};ce.exports=function(){var m,C,I,_,R,F,L=!1;this.isInitialized=function(){return L},this.init=function(U){m=new x,L=!0,F=!!U&&U.isPartial,m.on("data",function(te){te.startTime=te.startPts/_,te.endTime=te.endPts/_,R.captions.push(te),R.captionStreams[te.stream]=!0})},this.isNewInit=function(U,te){return(!U||U.length!==0)&&(!te||typeof te!="object"||Object.keys(te).length!==0)&&(I!==U[0]||_!==te[I])},this.parse=function(U,te,Y){if(!this.isInitialized()||!te||!Y)return null;if(this.isNewInit(te,Y))_=Y[I=te[0]];else if(I===null||!_)return C.push(U),null;for(;C.length>0;){var q,se,J,j=C.shift();this.parse(j,te,Y)}return se=I,J=_,(q=se===null?null:{seiNals:f(U,se)[se],timescale:J})!==null&&q.seiNals?(this.pushNals(q.seiNals),this.flushStream(),R):null},this.pushNals=function(U){if(!this.isInitialized()||!U||U.length===0)return null;U.forEach(function(te){m.push(te)})},this.flushStream=function(){if(!this.isInitialized())return null;F?m.partialFlush():m.flush()},this.clearParsedCaptions=function(){R.captions=[],R.captionStreams={}},this.resetCaptionStream=function(){if(!this.isInitialized())return null;m.reset()},this.clearAllCaptions=function(){this.clearParsedCaptions(),this.resetCaptionStream()},this.reset=function(){C=[],I=null,_=null,R?this.clearParsedCaptions():R={captions:[],captionStreams:{}},this.resetCaptionStream()},this.reset()}},we.__chunk_25840=(ce,O,u)=>{var s=u(65474),x=u(6056),k=function(E){var S,d=0;for(S=0;S<E.length;S++)d+=E[S].data.byteLength;return d};ce.exports={prefixWithSilence:function(E,S,d,o){var g,c,f,m,C=0,I=0,_=0;if(S.length&&(g=x.audioTsToVideoTs(E.baseMediaDecodeTime,E.samplerate),C=Math.ceil(x.ONE_SECOND_IN_TS/(E.samplerate/1024)),d&&o&&(_=(I=Math.floor((g-Math.max(d,o))/C))*C),!(I<1)&&!(_>x.ONE_SECOND_IN_TS/2))){for((c=s()[E.samplerate])||(c=S[0].data),f=0;f<I;f++)m=S[0],S.splice(0,0,{data:c,dts:m.dts-C,pts:m.pts-C});E.baseMediaDecodeTime-=Math.floor(x.videoTsToAudioTs(_,E.samplerate))}},trimAdtsFramesByEarliestDts:function(E,S,d){return S.minSegmentDts>=d?E:(S.minSegmentDts=1/0,E.filter(function(o){return o.dts>=d&&(S.minSegmentDts=Math.min(S.minSegmentDts,o.dts),S.minSegmentPts=S.minSegmentDts,!0)}))},generateSampleTable:function(E){var S,d=[];for(S=0;S<E.length;S++)d.push({size:E[S].data.byteLength,duration:1024});return d},concatenateFrameData:function(E){var S,d,o=0,g=new Uint8Array(k(E));for(S=0;S<E.length;S++)d=E[S],g.set(d.data,o),o+=d.data.byteLength;return g}}},we.__chunk_8725=(ce,O,u)=>{"use strict";var s=u(17581),x="shared",k=function(S,d){var o=1;for(S>d&&(o=-1);Math.abs(d-S)>4294967296;)S+=8589934592*o;return S},E=function(S){var d,o;E.prototype.init.call(this),this.type_=S||x,this.push=function(g){(this.type_===x||g.type===this.type_)&&(o===void 0&&(o=g.dts),g.dts=k(g.dts,o),g.pts=k(g.pts,o),d=g.dts,this.trigger("data",g))},this.flush=function(){o=d,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.discontinuity=function(){o=void 0,d=void 0},this.reset=function(){this.discontinuity(),this.trigger("reset")}};E.prototype=new s,ce.exports={TimestampRolloverStream:E,handleRollover:k}},we.__chunk_80249=ce=>{"use strict";ce.exports={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21}},we.__chunk_21042=(ce,O,u)=>{"use strict";var s=u(80249),x=function(d){var o=31&d[1];return o<<=8,o|=d[2]},k=function(d){return!!(64&d[1])},E=function(d){var o=0;return(48&d[3])>>>4>1&&(o+=d[4]+1),o},S=function(d){switch(d){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}};ce.exports={parseType:function(d,o){var g=x(d);return g===0?"pat":g===o?"pmt":o?"pes":null},parsePat:function(d){var o=k(d),g=4+E(d);return o&&(g+=d[g]+1),(31&d[g+10])<<8|d[g+11]},parsePmt:function(d){var o,g={},c=k(d),f=4+E(d);if(c&&(f+=d[f]+1),1&d[f+5]){o=3+((15&d[f+1])<<8|d[f+2])-4;for(var m=12+((15&d[f+10])<<8|d[f+11]);m<o;){var C=f+m;g[(31&d[C+1])<<8|d[C+2]]=d[C],m+=((15&d[C+3])<<8|d[C+4])+5}return g}},parsePayloadUnitStartIndicator:k,parsePesType:function(d,o){switch(o[x(d)]){case s.H264_STREAM_TYPE:return"video";case s.ADTS_STREAM_TYPE:return"audio";case s.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},parsePesTime:function(d){if(!k(d))return null;var o,g=4+E(d);if(g>=d.byteLength)return null;var c=null;return 192&(o=d[g+7])&&((c={}).pts=(14&d[g+9])<<27|(255&d[g+10])<<20|(254&d[g+11])<<12|(255&d[g+12])<<5|(254&d[g+13])>>>3,c.pts*=4,c.pts+=(6&d[g+13])>>>1,c.dts=c.pts,64&o&&(c.dts=(14&d[g+14])<<27|(255&d[g+15])<<20|(254&d[g+16])<<12|(255&d[g+17])<<5|(254&d[g+18])>>>3,c.dts*=4,c.dts+=(6&d[g+18])>>>1)),c},videoPacketContainsKeyFrame:function(d){for(var o=4+E(d),g=d.subarray(o),c=0,f=0,m=!1;f<g.byteLength-3;f++)if(g[f+2]===1){c=f+5;break}for(;c<g.byteLength;)switch(g[c]){case 0:if(g[c-1]!==0){c+=2;break}if(g[c-2]!==0){c++;break}f+3!==c-2&&S(31&g[f+3])==="slice_layer_without_partitioning_rbsp_idr"&&(m=!0);do c++;while(g[c]!==1&&c<g.length);f=c-2,c+=3;break;case 1:if(g[c-1]!==0||g[c-2]!==0){c+=3;break}S(31&g[f+3])==="slice_layer_without_partitioning_rbsp_idr"&&(m=!0),f=c-2,c+=3;break;default:c+=3}return g=g.subarray(f),c-=f,f=0,g&&g.byteLength>3&&S(31&g[f+3])==="slice_layer_without_partitioning_rbsp_idr"&&(m=!0),m}}},we.__chunk_72742=(ce,O,u)=>{"use strict";var s,x=u(17581),k=u(80249),E=function(g,c,f){var m,C="";for(m=c;m<f;m++)C+="%"+("00"+g[m].toString(16)).slice(-2);return C},S=function(g,c,f){return decodeURIComponent(E(g,c,f))},d=function(g){return g[0]<<21|g[1]<<14|g[2]<<7|g[3]},o={TXXX:function(g){var c;if(g.data[0]===3){for(c=1;c<g.data.length;c++)if(g.data[c]===0){g.description=S(g.data,1,c),g.value=S(g.data,c+1,g.data.length).replace(/\0*$/,"");break}g.data=g.value}},WXXX:function(g){var c;if(g.data[0]===3){for(c=1;c<g.data.length;c++)if(g.data[c]===0){g.description=S(g.data,1,c),g.url=S(g.data,c+1,g.data.length);break}}},PRIV:function(g){var c;for(c=0;c<g.data.length;c++)if(g.data[c]===0){g.owner=unescape(E(g.data,0,c));break}g.privateData=g.data.subarray(c+1),g.data=g.privateData}};(s=function(g){var c,f={debug:!!(g&&g.debug),descriptor:g&&g.descriptor},m=0,C=[],I=0;if(s.prototype.init.call(this),this.dispatchType=k.METADATA_STREAM_TYPE.toString(16),f.descriptor)for(c=0;c<f.descriptor.length;c++)this.dispatchType+=("00"+f.descriptor[c].toString(16)).slice(-2);this.push=function(_){var R,F,L,U,te;if(_.type==="timed-metadata"){if(_.dataAlignmentIndicator&&(I=0,C.length=0),C.length===0&&(_.data.length<10||_.data[0]!==73||_.data[1]!==68||_.data[2]!==51)){f.debug&&console.log("Skipping unrecognized metadata packet");return}if(C.push(_),I+=_.data.byteLength,C.length===1&&(m=d(_.data.subarray(6,10))+10),!(I<m)){for(te=0,R={data:new Uint8Array(m),frames:[],pts:C[0].pts,dts:C[0].dts};te<m;)R.data.set(C[0].data.subarray(0,m-te),te),te+=C[0].data.byteLength,I-=C[0].data.byteLength,C.shift();F=10,64&R.data[5]&&(F+=4+d(R.data.subarray(10,14)),m-=d(R.data.subarray(16,20)));do{if((L=d(R.data.subarray(F+4,F+8)))<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");if((U={id:String.fromCharCode(R.data[F],R.data[F+1],R.data[F+2],R.data[F+3]),data:R.data.subarray(F+10,F+L+10)}).key=U.id,o[U.id]&&(o[U.id](U),U.owner==="com.apple.streaming.transportStreamTimestamp")){var Y=U.data,q=(1&Y[3])<<30|Y[4]<<22|Y[5]<<14|Y[6]<<6|Y[7]>>>2;q*=4,q+=3&Y[7],U.timeStamp=q,R.pts===void 0&&R.dts===void 0&&(R.pts=U.timeStamp,R.dts=U.timeStamp),this.trigger("timestamp",U)}R.frames.push(U),F+=10+L}while(F<m);this.trigger("data",R)}}}}).prototype=new x,ce.exports=s},we.__chunk_6237=(ce,O,u)=>{"use strict";var s,x,k,E=u(17581),S=u(35969),d=u(80249),o=u(8725).TimestampRolloverStream;(s=function(){var f=new Uint8Array(188),m=0;s.prototype.init.call(this),this.push=function(C){var I,_=0,R=188;for(m?((I=new Uint8Array(C.byteLength+m)).set(f.subarray(0,m)),I.set(C,m),m=0):I=C;R<I.byteLength;){if(I[_]===71&&I[R]===71){this.trigger("data",I.subarray(_,R)),_+=188,R+=188;continue}_++,R++}_<I.byteLength&&(f.set(I.subarray(_),0),m=I.byteLength-_)},this.flush=function(){m===188&&f[0]===71&&(this.trigger("data",f),m=0),this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")},this.reset=function(){m=0,this.trigger("reset")}}).prototype=new E,(x=function(){var f,m,C,I;x.prototype.init.call(this),I=this,this.packetsWaitingForPmt=[],this.programMapTable=void 0,f=function(_,R){var F=0;R.payloadUnitStartIndicator&&(F+=_[F]+1),R.type==="pat"?m(_.subarray(F),R):C(_.subarray(F),R)},m=function(_,R){R.section_number=_[7],R.last_section_number=_[8],I.pmtPid=(31&_[10])<<8|_[11],R.pmtPid=I.pmtPid},C=function(_,R){var F,L;if(1&_[5]){for(I.programMapTable={video:null,audio:null,"timed-metadata":{}},F=3+((15&_[1])<<8|_[2])-4,L=12+((15&_[10])<<8|_[11]);L<F;){var U=_[L],te=(31&_[L+1])<<8|_[L+2];U===d.H264_STREAM_TYPE&&I.programMapTable.video===null?I.programMapTable.video=te:U===d.ADTS_STREAM_TYPE&&I.programMapTable.audio===null?I.programMapTable.audio=te:U===d.METADATA_STREAM_TYPE&&(I.programMapTable["timed-metadata"][te]=U),L+=((15&_[L+3])<<8|_[L+4])+5}R.programMapTable=I.programMapTable}},this.push=function(_){var R={},F=4;if(R.payloadUnitStartIndicator=!!(64&_[1]),R.pid=31&_[1],R.pid<<=8,R.pid|=_[2],(48&_[3])>>>4>1&&(F+=_[F]+1),R.pid===0)R.type="pat",f(_.subarray(F),R),this.trigger("data",R);else if(R.pid===this.pmtPid)for(R.type="pmt",f(_.subarray(F),R),this.trigger("data",R);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===void 0?this.packetsWaitingForPmt.push([_,F,R]):this.processPes_(_,F,R)},this.processPes_=function(_,R,F){F.pid===this.programMapTable.video?F.streamType=d.H264_STREAM_TYPE:F.pid===this.programMapTable.audio?F.streamType=d.ADTS_STREAM_TYPE:F.streamType=this.programMapTable["timed-metadata"][F.pid],F.type="pes",F.data=_.subarray(R),this.trigger("data",F)}}).prototype=new E,x.STREAM_TYPES={h264:27,adts:15},(k=function(){var f,m=this,C={data:[],size:0},I={data:[],size:0},_={data:[],size:0},R=function(L,U){var te;U.packetLength=6+(L[4]<<8|L[5]),U.dataAlignmentIndicator=(4&L[6])!=0,192&(te=L[7])&&(U.pts=(14&L[9])<<27|(255&L[10])<<20|(254&L[11])<<12|(255&L[12])<<5|(254&L[13])>>>3,U.pts*=4,U.pts+=(6&L[13])>>>1,U.dts=U.pts,64&te&&(U.dts=(14&L[14])<<27|(255&L[15])<<20|(254&L[16])<<12|(255&L[17])<<5|(254&L[18])>>>3,U.dts*=4,U.dts+=(6&L[18])>>>1)),U.data=L.subarray(9+L[8])},F=function(L,U,te){var Y,q=new Uint8Array(L.size),se={type:U},J=0,j=0,M=!1;if(L.data.length&&!(L.size<9)){for(J=0,se.trackId=L.data[0].pid;J<L.data.length;J++)Y=L.data[J],q.set(Y.data,j),j+=Y.data.byteLength;R(q,se),M=U==="video"||se.packetLength<=L.size,(te||M)&&(L.size=0,L.data.length=0),M&&m.trigger("data",se)}};k.prototype.init.call(this),this.push=function(L){({pat:function(){},pes:function(){var U,te;switch(L.streamType){case d.H264_STREAM_TYPE:U=C,te="video";break;case d.ADTS_STREAM_TYPE:U=I,te="audio";break;case d.METADATA_STREAM_TYPE:U=_,te="timed-metadata";break;default:return}L.payloadUnitStartIndicator&&F(U,te,!0),U.data.push(L),U.size+=L.data.byteLength},pmt:function(){var U={type:"metadata",tracks:[]};(f=L.programMapTable).video!==null&&U.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+f.video,codec:"avc",type:"video"}),f.audio!==null&&U.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+f.audio,codec:"adts",type:"audio"}),m.trigger("data",U)}})[L.type]()},this.reset=function(){C.size=0,C.data.length=0,I.size=0,I.data.length=0,this.trigger("reset")},this.flushStreams_=function(){F(C,"video"),F(I,"audio"),F(_,"timed-metadata")},this.flush=function(){this.flushStreams_(),this.trigger("done")}}).prototype=new E;var g={PAT_PID:0,MP2T_PACKET_LENGTH:188,TransportPacketStream:s,TransportParseStream:x,ElementaryStream:k,TimestampRolloverStream:o,CaptionStream:S.CaptionStream,Cea608Stream:S.Cea608Stream,MetadataStream:u(72742)};for(var c in d)d.hasOwnProperty(c)&&(g[c]=d[c]);ce.exports=g},we.__chunk_85456=(ce,O,u)=>{ce.exports=u(6237)},we.__chunk_35969=(ce,O,u)=>{"use strict";var s=u(17581),x=u(566),k=function(){k.prototype.init.call(this),this.captionPackets_=[],this.ccStreams_=[new g(0,0),new g(0,1),new g(1,0),new g(1,1)],this.reset(),this.ccStreams_.forEach(function(c){c.on("data",this.trigger.bind(this,"data")),c.on("partialdone",this.trigger.bind(this,"partialdone")),c.on("done",this.trigger.bind(this,"done"))},this)};k.prototype=new s,k.prototype.push=function(c){var f,m,C;if(c.nalUnitType==="sei_rbsp"&&(f=x.parseSei(c.escapedRBSP)).payloadType===x.USER_DATA_REGISTERED_ITU_T_T35&&(m=x.parseUserData(f))){if(c.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}if(c.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--,this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}C=x.parseCaptionPackets(c.pts,m),this.captionPackets_=this.captionPackets_.concat(C),this.latestDts_!==c.dts&&(this.numSameDts_=0),this.numSameDts_++,this.latestDts_=c.dts}},k.prototype.flushCCStreams=function(c){this.ccStreams_.forEach(function(f){return c==="flush"?f.flush():f.partialFlush()},this)},k.prototype.flushStream=function(c){if(!this.captionPackets_.length){this.flushCCStreams(c);return}this.captionPackets_.forEach(function(f,m){f.presortIndex=m}),this.captionPackets_.sort(function(f,m){return f.pts===m.pts?f.presortIndex-m.presortIndex:f.pts-m.pts}),this.captionPackets_.forEach(function(f){f.type<2&&this.dispatchCea608Packet(f)},this),this.captionPackets_.length=0,this.flushCCStreams(c)},k.prototype.flush=function(){return this.flushStream("flush")},k.prototype.partialFlush=function(){return this.flushStream("partialFlush")},k.prototype.reset=function(){this.latestDts_=null,this.ignoreNextEqualDts_=!1,this.numSameDts_=0,this.activeCea608Channel_=[null,null],this.ccStreams_.forEach(function(c){c.reset()})},k.prototype.dispatchCea608Packet=function(c){this.setsTextOrXDSActive(c)?this.activeCea608Channel_[c.type]=null:this.setsChannel1Active(c)?this.activeCea608Channel_[c.type]=0:this.setsChannel2Active(c)&&(this.activeCea608Channel_[c.type]=1),this.activeCea608Channel_[c.type]!==null&&this.ccStreams_[(c.type<<1)+this.activeCea608Channel_[c.type]].push(c)},k.prototype.setsChannel1Active=function(c){return(30720&c.ccData)==4096},k.prototype.setsChannel2Active=function(c){return(30720&c.ccData)==6144},k.prototype.setsTextOrXDSActive=function(c){return(28928&c.ccData)==256||(30974&c.ccData)==4138||(30974&c.ccData)==6186};var E={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},S=function(c){return c===null?"":String.fromCharCode(c=E[c]||c)},d=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],o=function(){for(var c=[],f=15;f--;)c.push("");return c},g=function(c,f){g.prototype.init.call(this),this.field_=c||0,this.dataChannel_=f||0,this.name_="CC"+((this.field_<<1|this.dataChannel_)+1),this.setConstants(),this.reset(),this.push=function(m){var C,I,_,R,F;if((C=32639&m.ccData)===this.lastControlCode_){this.lastControlCode_=null;return}if((61440&C)==4096?this.lastControlCode_=C:C!==this.PADDING_&&(this.lastControlCode_=null),_=C>>>8,R=255&C,C!==this.PADDING_)if(C===this.RESUME_CAPTION_LOADING_)this.mode_="popOn";else if(C===this.END_OF_CAPTION_)this.mode_="popOn",this.clearFormatting(m.pts),this.flushDisplayed(m.pts),I=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=I,this.startPts_=m.pts;else if(C===this.ROLL_UP_2_ROWS_)this.rollUpRows_=2,this.setRollUp(m.pts);else if(C===this.ROLL_UP_3_ROWS_)this.rollUpRows_=3,this.setRollUp(m.pts);else if(C===this.ROLL_UP_4_ROWS_)this.rollUpRows_=4,this.setRollUp(m.pts);else if(C===this.CARRIAGE_RETURN_)this.clearFormatting(m.pts),this.flushDisplayed(m.pts),this.shiftRowsUp_(),this.startPts_=m.pts;else if(C===this.BACKSPACE_)this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1);else if(C===this.ERASE_DISPLAYED_MEMORY_)this.flushDisplayed(m.pts),this.displayed_=o();else if(C===this.ERASE_NON_DISPLAYED_MEMORY_)this.nonDisplayed_=o();else if(C===this.RESUME_DIRECT_CAPTIONING_)this.mode_!=="paintOn"&&(this.flushDisplayed(m.pts),this.displayed_=o()),this.mode_="paintOn",this.startPts_=m.pts;else if(this.isSpecialCharacter(_,R))F=S((_=(3&_)<<8)|R),this[this.mode_](m.pts,F),this.column_++;else if(this.isExtCharacter(_,R))this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),F=S((_=(3&_)<<8)|R),this[this.mode_](m.pts,F),this.column_++;else if(this.isMidRowCode(_,R))this.clearFormatting(m.pts),this[this.mode_](m.pts," "),this.column_++,(14&R)==14&&this.addFormatting(m.pts,["i"]),(1&R)==1&&this.addFormatting(m.pts,["u"]);else if(this.isOffsetControlCode(_,R))this.column_+=3&R;else if(this.isPAC(_,R)){var L=d.indexOf(7968&C);this.mode_==="rollUp"&&(L-this.rollUpRows_+1<0&&(L=this.rollUpRows_-1),this.setRollUp(m.pts,L)),L!==this.row_&&(this.clearFormatting(m.pts),this.row_=L),1&R&&this.formatting_.indexOf("u")===-1&&this.addFormatting(m.pts,["u"]),(16&C)==16&&(this.column_=((14&C)>>1)*4),this.isColorPAC(R)&&(14&R)==14&&this.addFormatting(m.pts,["i"])}else this.isNormalChar(_)&&(R===0&&(R=null),F=S(_)+S(R),this[this.mode_](m.pts,F),this.column_+=F.length)}};g.prototype=new s,g.prototype.flushDisplayed=function(c){var f=this.displayed_.map(function(m){try{return m.trim()}catch{return console.error("Skipping malformed caption."),""}}).join(`
`).replace(/^\n+|\n+$/g,"");f.length&&this.trigger("data",{startPts:this.startPts_,endPts:c,text:f,stream:this.name_})},g.prototype.reset=function(){this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=o(),this.nonDisplayed_=o(),this.lastControlCode_=null,this.column_=0,this.row_=14,this.rollUpRows_=2,this.formatting_=[]},g.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31),this.PADDING_=0,this.RESUME_CAPTION_LOADING_=32|this.CONTROL_,this.END_OF_CAPTION_=47|this.CONTROL_,this.ROLL_UP_2_ROWS_=37|this.CONTROL_,this.ROLL_UP_3_ROWS_=38|this.CONTROL_,this.ROLL_UP_4_ROWS_=39|this.CONTROL_,this.CARRIAGE_RETURN_=45|this.CONTROL_,this.RESUME_DIRECT_CAPTIONING_=41|this.CONTROL_,this.BACKSPACE_=33|this.CONTROL_,this.ERASE_DISPLAYED_MEMORY_=44|this.CONTROL_,this.ERASE_NON_DISPLAYED_MEMORY_=46|this.CONTROL_},g.prototype.isSpecialCharacter=function(c,f){return c===this.EXT_&&f>=48&&f<=63},g.prototype.isExtCharacter=function(c,f){return(c===this.EXT_+1||c===this.EXT_+2)&&f>=32&&f<=63},g.prototype.isMidRowCode=function(c,f){return c===this.EXT_&&f>=32&&f<=47},g.prototype.isOffsetControlCode=function(c,f){return c===this.OFFSET_&&f>=33&&f<=35},g.prototype.isPAC=function(c,f){return c>=this.BASE_&&c<this.BASE_+8&&f>=64&&f<=127},g.prototype.isColorPAC=function(c){return c>=64&&c<=79||c>=96&&c<=127},g.prototype.isNormalChar=function(c){return c>=32&&c<=127},g.prototype.setRollUp=function(c,f){if(this.mode_!=="rollUp"&&(this.row_=14,this.mode_="rollUp",this.flushDisplayed(c),this.nonDisplayed_=o(),this.displayed_=o()),f!==void 0&&f!==this.row_)for(var m=0;m<this.rollUpRows_;m++)this.displayed_[f-m]=this.displayed_[this.row_-m],this.displayed_[this.row_-m]="";f===void 0&&(f=this.row_),this.topRow_=f-this.rollUpRows_+1},g.prototype.addFormatting=function(c,f){this.formatting_=this.formatting_.concat(f);var m=f.reduce(function(C,I){return C+"<"+I+">"},"");this[this.mode_](c,m)},g.prototype.clearFormatting=function(c){if(this.formatting_.length){var f=this.formatting_.reverse().reduce(function(m,C){return m+"</"+C+">"},"");this.formatting_=[],this[this.mode_](c,f)}},g.prototype.popOn=function(c,f){var m=this.nonDisplayed_[this.row_];m+=f,this.nonDisplayed_[this.row_]=m},g.prototype.rollUp=function(c,f){var m=this.displayed_[this.row_];m+=f,this.displayed_[this.row_]=m},g.prototype.shiftRowsUp_=function(){var c;for(c=0;c<this.topRow_;c++)this.displayed_[c]="";for(c=this.row_+1;c<15;c++)this.displayed_[c]="";for(c=this.topRow_;c<this.row_;c++)this.displayed_[c]=this.displayed_[c+1];this.displayed_[this.row_]=""},g.prototype.paintOn=function(c,f){var m=this.displayed_[this.row_];m+=f,this.displayed_[this.row_]=m},ce.exports={CaptionStream:k,Cea608Stream:g}},we.__chunk_16536=(ce,O,u)=>{"use strict";var s={codecs:u(55707),mp4:u(85760),flv:u(69368),mp2t:u(85456),partial:u(99726)};s.mp4.tools=u(20177),s.flv.tools=u(45092),s.mp2t.tools=u(95252),ce.exports=s},we.__chunk_7493=(ce,O,u)=>{"use strict";var s,x,k,E,S,d,o=u(17581),g=u(83198),c=u(6237),f=u(56659),m=u(44596).H264Stream,C=u(4993),I=u(87960);E=function(_,R){typeof R.pts=="number"&&(_.timelineStartInfo.pts===void 0?_.timelineStartInfo.pts=R.pts:_.timelineStartInfo.pts=Math.min(_.timelineStartInfo.pts,R.pts)),typeof R.dts=="number"&&(_.timelineStartInfo.dts===void 0?_.timelineStartInfo.dts=R.dts:_.timelineStartInfo.dts=Math.min(_.timelineStartInfo.dts,R.dts))},S=function(_,R){var F=new g(g.METADATA_TAG);return F.dts=R,F.pts=R,F.writeMetaDataDouble("videocodecid",7),F.writeMetaDataDouble("width",_.width),F.writeMetaDataDouble("height",_.height),F},d=function(_,R){var F,L=new g(g.VIDEO_TAG,!0);for(L.dts=R,L.pts=R,L.writeByte(1),L.writeByte(_.profileIdc),L.writeByte(_.profileCompatibility),L.writeByte(_.levelIdc),L.writeByte(255),L.writeByte(225),L.writeShort(_.sps[0].length),L.writeBytes(_.sps[0]),L.writeByte(_.pps.length),F=0;F<_.pps.length;++F)L.writeShort(_.pps[F].length),L.writeBytes(_.pps[F]);return L},(k=function(_){var R,F=[],L=[];k.prototype.init.call(this),this.push=function(U){E(_,U),_&&(_.audioobjecttype=U.audioobjecttype,_.channelcount=U.channelcount,_.samplerate=U.samplerate,_.samplingfrequencyindex=U.samplingfrequencyindex,_.samplesize=U.samplesize,_.extraData=_.audioobjecttype<<11|_.samplingfrequencyindex<<7|_.channelcount<<3),U.pts=Math.round(U.pts/90),U.dts=Math.round(U.dts/90),F.push(U)},this.flush=function(){var U,te,Y,q=new I;if(F.length===0){this.trigger("done","AudioSegmentStream");return}for(Y=-1/0;F.length;)U=F.shift(),L.length&&U.pts>=L[0]&&(Y=L.shift(),this.writeMetaDataTags(q,Y)),(_.extraData!==R||U.pts-Y>=1e3)&&(this.writeMetaDataTags(q,U.pts),R=_.extraData,Y=U.pts),(te=new g(g.AUDIO_TAG)).pts=U.pts,te.dts=U.dts,te.writeBytes(U.data),q.push(te.finalize());L.length=0,R=null,this.trigger("data",{track:_,tags:q.list}),this.trigger("done","AudioSegmentStream")},this.writeMetaDataTags=function(U,te){var Y;(Y=new g(g.METADATA_TAG)).pts=te,Y.dts=te,Y.writeMetaDataDouble("audiocodecid",10),Y.writeMetaDataBoolean("stereo",_.channelcount===2),Y.writeMetaDataDouble("audiosamplerate",_.samplerate),Y.writeMetaDataDouble("audiosamplesize",16),U.push(Y.finalize()),(Y=new g(g.AUDIO_TAG,!0)).pts=te,Y.dts=te,Y.view.setUint16(Y.position,_.extraData),Y.position+=2,Y.length=Math.max(Y.length,Y.position),U.push(Y.finalize())},this.onVideoKeyFrame=function(U){L.push(U)}}).prototype=new o,(x=function(_){var R,F,L=[];x.prototype.init.call(this),this.finishFrame=function(U,te){if(te){if(R&&_&&_.newMetadata&&(te.keyFrame||U.length===0)){var Y=S(R,te.dts).finalize(),q=d(_,te.dts).finalize();Y.metaDataTag=q.metaDataTag=!0,U.push(Y),U.push(q),_.newMetadata=!1,this.trigger("keyframe",te.dts)}te.endNalUnit(),U.push(te.finalize()),F=null}},this.push=function(U){E(_,U),U.pts=Math.round(U.pts/90),U.dts=Math.round(U.dts/90),L.push(U)},this.flush=function(){for(var U,te=new I;L.length&&L[0].nalUnitType!=="access_unit_delimiter_rbsp";)L.shift();if(L.length===0){this.trigger("done","VideoSegmentStream");return}for(;L.length;)(U=L.shift()).nalUnitType==="seq_parameter_set_rbsp"?(_.newMetadata=!0,R=U.config,_.width=R.width,_.height=R.height,_.sps=[U.data],_.profileIdc=R.profileIdc,_.levelIdc=R.levelIdc,_.profileCompatibility=R.profileCompatibility,F.endNalUnit()):U.nalUnitType==="pic_parameter_set_rbsp"?(_.newMetadata=!0,_.pps=[U.data],F.endNalUnit()):U.nalUnitType==="access_unit_delimiter_rbsp"?(F&&this.finishFrame(te,F),(F=new g(g.VIDEO_TAG)).pts=U.pts,F.dts=U.dts):(U.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(F.keyFrame=!0),F.endNalUnit()),F.startNalUnit(),F.writeBytes(U.data);F&&this.finishFrame(te,F),this.trigger("data",{track:_,tags:te.list}),this.trigger("done","VideoSegmentStream")}}).prototype=new o,(s=function(_){var R,F,L,U,te,Y,q,se,J,j,M,b,N=this;s.prototype.init.call(this),_=_||{},this.metadataStream=new c.MetadataStream,_.metadataStream=this.metadataStream,R=new c.TransportPacketStream,F=new c.TransportParseStream,L=new c.ElementaryStream,U=new c.TimestampRolloverStream("video"),te=new c.TimestampRolloverStream("audio"),Y=new c.TimestampRolloverStream("timed-metadata"),q=new f,se=new m,b=new C(_),R.pipe(F).pipe(L),L.pipe(U).pipe(se),L.pipe(te).pipe(q),L.pipe(Y).pipe(this.metadataStream).pipe(b),M=new c.CaptionStream,se.pipe(M).pipe(b),L.on("data",function($){var X,ae,K;if($.type==="metadata"){for(X=$.tracks.length;X--;)$.tracks[X].type==="video"?ae=$.tracks[X]:$.tracks[X].type==="audio"&&(K=$.tracks[X]);ae&&!J&&(b.numberOfTracks++,J=new x(ae),se.pipe(J).pipe(b)),K&&!j&&(b.numberOfTracks++,j=new k(K),q.pipe(j).pipe(b),J&&J.on("keyframe",j.onVideoKeyFrame))}}),this.push=function($){R.push($)},this.flush=function(){R.flush()},this.resetCaptions=function(){M.reset()},b.on("data",function($){N.trigger("data",$)}),b.on("done",function(){N.trigger("done")})}).prototype=new o,ce.exports=s},we.__chunk_87960=ce=>{"use strict";ce.exports=function(){var O=this;this.list=[],this.push=function(u){this.list.push({bytes:u.bytes,dts:u.dts,pts:u.pts,keyFrame:u.keyFrame,metaDataTag:u.metaDataTag})},Object.defineProperty(this,"length",{get:function(){return O.list.length}})}},we.__chunk_69368=(ce,O,u)=>{ce.exports={tag:u(83198),Transmuxer:u(7493),getFlvHeader:u(68593)}},we.__chunk_83198=ce=>{"use strict";var O;(O=function(u,s){var x,k=0,E=16384,S=function(c,f){var m,C=c.position+f;C<c.bytes.byteLength||((m=new Uint8Array(2*C)).set(c.bytes.subarray(0,c.position),0),c.bytes=m,c.view=new DataView(c.bytes.buffer))},d=O.widthBytes||new Uint8Array(5),o=O.heightBytes||new Uint8Array(6),g=O.videocodecidBytes||new Uint8Array(12);if(!O.widthBytes){for(x=0;x<5;x++)d[x]="width".charCodeAt(x);for(x=0;x<6;x++)o[x]="height".charCodeAt(x);for(x=0;x<12;x++)g[x]="videocodecid".charCodeAt(x);O.widthBytes=d,O.heightBytes=o,O.videocodecidBytes=g}switch(this.keyFrame=!1,u){case O.VIDEO_TAG:this.length=16,E*=6;break;case O.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case O.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw Error("Unknown FLV tag type")}this.bytes=new Uint8Array(E),this.view=new DataView(this.bytes.buffer),this.bytes[0]=u,this.position=this.length,this.keyFrame=s,this.pts=0,this.dts=0,this.writeBytes=function(c,f,m){var C,I=f||0;C=I+(m=m||c.byteLength),S(this,m),this.bytes.set(c.subarray(I,C),this.position),this.position+=m,this.length=Math.max(this.length,this.position)},this.writeByte=function(c){S(this,1),this.bytes[this.position]=c,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(c){S(this,2),this.view.setUint16(this.position,c),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(c){return this.bytes[this.length-c]},this.nalUnitSize=function(){return k===0?0:this.length-(k+4)},this.startNalUnit=function(){if(k>0)throw Error("Attempted to create new NAL wihout closing the old one");k=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(c){var f,m;this.length===k+4?this.length-=4:k>0&&(f=k+4,m=this.length-f,this.position=k,this.view.setUint32(this.position,m),this.position=this.length,c&&c.push(this.bytes.subarray(f,f+m))),k=0},this.writeMetaDataDouble=function(c,f){var m;if(S(this,2+c.length+9),this.view.setUint16(this.position,c.length),this.position+=2,c==="width")this.bytes.set(d,this.position),this.position+=5;else if(c==="height")this.bytes.set(o,this.position),this.position+=6;else if(c==="videocodecid")this.bytes.set(g,this.position),this.position+=12;else for(m=0;m<c.length;m++)this.bytes[this.position]=c.charCodeAt(m),this.position++;this.position++,this.view.setFloat64(this.position,f),this.position+=8,this.length=Math.max(this.length,this.position),++k},this.writeMetaDataBoolean=function(c,f){var m;for(S(this,2),this.view.setUint16(this.position,c.length),this.position+=2,m=0;m<c.length;m++)S(this,1),this.bytes[this.position]=c.charCodeAt(m),this.position++;S(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,f?1:0),this.position++,this.length=Math.max(this.length,this.position),++k},this.finalize=function(){var c,f;switch(this.bytes[0]){case O.VIDEO_TAG:this.bytes[11]=(this.keyFrame||s?16:32)|7,this.bytes[12]=s?0:1,c=this.pts-this.dts,this.bytes[13]=(16711680&c)>>>16,this.bytes[14]=(65280&c)>>>8,this.bytes[15]=(255&c)>>>0;break;case O.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=s?0:1;break;case O.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,k),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return f=this.length-11,this.bytes[1]=(16711680&f)>>>16,this.bytes[2]=(65280&f)>>>8,this.bytes[3]=(255&f)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,S(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=O.frameTime(this.bytes),this}}).AUDIO_TAG=8,O.VIDEO_TAG=9,O.METADATA_TAG=18,O.isAudioFrame=function(u){return O.AUDIO_TAG===u[0]},O.isVideoFrame=function(u){return O.VIDEO_TAG===u[0]},O.isMetaData=function(u){return O.METADATA_TAG===u[0]},O.isKeyFrame=function(u){return O.isVideoFrame(u)?u[11]===23:!!(O.isAudioFrame(u)||O.isMetaData(u))},O.frameTime=function(u){var s=u[4]<<16;return s|=u[5]<<8,s|=u[6]<<0,s|=u[7]<<24},ce.exports=O},we.__chunk_68593=(ce,O,u)=>{"use strict";var s=u(83198);ce.exports=function(x,k,E){var S,d,o,g=new Uint8Array(9),c=new DataView(g.buffer);return x=x||0,k=k===void 0||k,E=E===void 0||E,c.setUint8(0,70),c.setUint8(1,76),c.setUint8(2,86),c.setUint8(3,1),c.setUint8(4,(k?4:0)|(E?1:0)),c.setUint32(5,g.byteLength),x<=0?((d=new Uint8Array(g.byteLength+4)).set(g),d.set([0,0,0,0],g.byteLength)):((S=new s(s.METADATA_TAG)).pts=S.dts=0,S.writeMetaDataDouble("duration",x),o=S.finalize().length,(d=new Uint8Array(g.byteLength+o)).set(g),d.set(c.byteLength,o)),d}},we.__chunk_4993=(ce,O,u)=>{"use strict";var s=u(17581),x=function(k){this.numberOfTracks=0,this.metadataStream=k.metadataStream,this.videoTags=[],this.audioTags=[],this.videoTrack=null,this.audioTrack=null,this.pendingCaptions=[],this.pendingMetadata=[],this.pendingTracks=0,this.processedTracks=0,x.prototype.init.call(this),this.push=function(E){return E.text?this.pendingCaptions.push(E):E.frames?this.pendingMetadata.push(E):(E.track.type==="video"&&(this.videoTrack=E.track,this.videoTags=E.tags,this.pendingTracks++),void(E.track.type==="audio"&&(this.audioTrack=E.track,this.audioTags=E.tags,this.pendingTracks++)))}};x.prototype=new s,x.prototype.flush=function(k){var E,S,d,o,g={tags:{},captions:[],captionStreams:{},metadata:[]};if((!(this.pendingTracks<this.numberOfTracks)||(k==="VideoSegmentStream"||k==="AudioSegmentStream")&&(this.pendingTracks!==0||(this.processedTracks++,!(this.processedTracks<this.numberOfTracks))))&&(this.processedTracks+=this.pendingTracks,this.pendingTracks=0,!(this.processedTracks<this.numberOfTracks))){for(this.videoTrack?o=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(o=this.audioTrack.timelineStartInfo.pts),g.tags.videoTags=this.videoTags,g.tags.audioTags=this.audioTags,d=0;d<this.pendingCaptions.length;d++)(S=this.pendingCaptions[d]).startTime=S.startPts-o,S.startTime/=9e4,S.endTime=S.endPts-o,S.endTime/=9e4,g.captionStreams[S.stream]=!0,g.captions.push(S);for(d=0;d<this.pendingMetadata.length;d++)(E=this.pendingMetadata[d]).cueTime=E.pts-o,E.cueTime/=9e4,g.metadata.push(E);g.metadata.dispatchType=this.metadataStream.dispatchType,this.videoTrack=null,this.audioTrack=null,this.videoTags=[],this.audioTags=[],this.pendingCaptions.length=0,this.pendingMetadata.length=0,this.pendingTracks=0,this.processedTracks=0,this.trigger("data",g),this.trigger("done")}},ce.exports=x},we.__chunk_65474=ce=>{var O,u=[33,16,5,32,164,27],s=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],x=function(k){for(var E=[];k--;)E.push(0);return E};ce.exports=function(){if(!O){var k;O=Object.keys(k={96e3:[u,[227,64],x(154),[56]],88200:[u,[231],x(170),[56]],64e3:[u,[248,192],x(240),[56]],48e3:[u,[255,192],x(268),[55,148,128],x(54),[112]],44100:[u,[255,192],x(268),[55,163,128],x(84),[112]],32e3:[u,[255,192],x(268),[55,234],x(226),[112]],24e3:[u,[255,192],x(268),[55,255,128],x(268),[111,112],x(126),[224]],16e3:[u,[255,192],x(268),[55,255,128],x(268),[111,255],x(269),[223,108],x(195),[1,192]],12e3:[s,x(268),[3,127,248],x(268),[6,255,240],x(268),[13,255,224],x(268),[27,253,128],x(259),[56]],11025:[s,x(268),[3,127,248],x(268),[6,255,240],x(268),[13,255,224],x(268),[27,255,192],x(268),[55,175,128],x(108),[112]],8e3:[s,x(268),[3,121,16],x(47),[7]]}).reduce(function(E,S){return E[S]=new Uint8Array(k[S].reduce(function(d,o){return d.concat(o)},[])),E},{})}return O}},we.__chunk_23166=ce=>{ce.exports=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"]},we.__chunk_91565=ce=>{ce.exports=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"]},we.__chunk_55707=(ce,O,u)=>{ce.exports={Adts:u(56659),h264:u(44596)}},we.__chunk_44596=(ce,O,u)=>{"use strict";var s,x,k,E=u(17581),S=u(98096);(x=function(){var d,o,g=0;x.prototype.init.call(this),this.push=function(c){o?((f=new Uint8Array(o.byteLength+c.data.byteLength)).set(o),f.set(c.data,o.byteLength),o=f):o=c.data;for(var f,m=o.byteLength;g<m-3;g++)if(o[g+2]===1){d=g+5;break}for(;d<m;)switch(o[d]){case 0:if(o[d-1]!==0){d+=2;break}if(o[d-2]!==0){d++;break}g+3!==d-2&&this.trigger("data",o.subarray(g+3,d-2));do d++;while(o[d]!==1&&d<m);g=d-2,d+=3;break;case 1:if(o[d-1]!==0||o[d-2]!==0){d+=3;break}this.trigger("data",o.subarray(g+3,d-2)),g=d-2,d+=3;break;default:d+=3}o=o.subarray(g),d-=g,g=0},this.reset=function(){o=null,g=0,this.trigger("reset")},this.flush=function(){o&&o.byteLength>3&&this.trigger("data",o.subarray(g+3)),o=null,g=0,this.trigger("done")},this.endTimeline=function(){this.flush(),this.trigger("endedtimeline")}}).prototype=new E,k={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0},(s=function(){var d,o,g,c,f,m,C,I=new x;s.prototype.init.call(this),d=this,this.push=function(_){_.type==="video"&&(o=_.trackId,g=_.pts,c=_.dts,I.push(_))},I.on("data",function(_){var R={trackId:o,pts:g,dts:c,data:_};switch(31&_[0]){case 5:R.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:R.nalUnitType="sei_rbsp",R.escapedRBSP=f(_.subarray(1));break;case 7:R.nalUnitType="seq_parameter_set_rbsp",R.escapedRBSP=f(_.subarray(1)),R.config=m(R.escapedRBSP);break;case 8:R.nalUnitType="pic_parameter_set_rbsp";break;case 9:R.nalUnitType="access_unit_delimiter_rbsp"}d.trigger("data",R)}),I.on("done",function(){d.trigger("done")}),I.on("partialdone",function(){d.trigger("partialdone")}),I.on("reset",function(){d.trigger("reset")}),I.on("endedtimeline",function(){d.trigger("endedtimeline")}),this.flush=function(){I.flush()},this.partialFlush=function(){I.partialFlush()},this.reset=function(){I.reset()},this.endTimeline=function(){I.endTimeline()},C=function(_,R){var F,L=8,U=8;for(F=0;F<_;F++)U!==0&&(U=(L+R.readExpGolomb()+256)%256),L=U===0?L:U},f=function(_){for(var R,F,L=_.byteLength,U=[],te=1;te<L-2;)_[te]===0&&_[te+1]===0&&_[te+2]===3?(U.push(te+2),te+=2):te++;if(U.length===0)return _;F=new Uint8Array(R=L-U.length);var Y=0;for(te=0;te<R;Y++,te++)Y===U[0]&&(Y++,U.shift()),F[te]=_[Y];return F},m=function(_){var R,F,L,U,te,Y,q,se,J,j,M,b,N,$=0,X=0,ae=0,K=0,ve=1;if(F=(R=new S(_)).readUnsignedByte(),U=R.readUnsignedByte(),L=R.readUnsignedByte(),R.skipUnsignedExpGolomb(),k[F]&&((te=R.readUnsignedExpGolomb())===3&&R.skipBits(1),R.skipUnsignedExpGolomb(),R.skipUnsignedExpGolomb(),R.skipBits(1),R.readBoolean()))for(N=0,M=te!==3?8:12;N<M;N++)R.readBoolean()&&(N<6?C(16,R):C(64,R));if(R.skipUnsignedExpGolomb(),(Y=R.readUnsignedExpGolomb())===0)R.readUnsignedExpGolomb();else if(Y===1)for(R.skipBits(1),R.skipExpGolomb(),R.skipExpGolomb(),q=R.readUnsignedExpGolomb(),N=0;N<q;N++)R.skipExpGolomb();if(R.skipUnsignedExpGolomb(),R.skipBits(1),se=R.readUnsignedExpGolomb(),J=R.readUnsignedExpGolomb(),(j=R.readBits(1))===0&&R.skipBits(1),R.skipBits(1),R.readBoolean()&&($=R.readUnsignedExpGolomb(),X=R.readUnsignedExpGolomb(),ae=R.readUnsignedExpGolomb(),K=R.readUnsignedExpGolomb()),R.readBoolean()&&R.readBoolean()){switch(R.readUnsignedByte()){case 1:b=[1,1];break;case 2:b=[12,11];break;case 3:b=[10,11];break;case 4:b=[16,11];break;case 5:b=[40,33];break;case 6:b=[24,11];break;case 7:b=[20,11];break;case 8:b=[32,11];break;case 9:b=[80,33];break;case 10:b=[18,11];break;case 11:b=[15,11];break;case 12:b=[64,33];break;case 13:b=[160,99];break;case 14:b=[4,3];break;case 15:b=[3,2];break;case 16:b=[2,1];break;case 255:b=[R.readUnsignedByte()<<8|R.readUnsignedByte(),R.readUnsignedByte()<<8|R.readUnsignedByte()]}b&&(ve=b[0]/b[1])}return{profileIdc:F,levelIdc:L,profileCompatibility:U,width:Math.ceil(((se+1)*16-2*$-2*X)*ve),height:(2-j)*(J+1)*16-2*ae-2*K,sarRatio:b}}}).prototype=new E,ce.exports={H264Stream:s,NalByteStream:x}},we.__chunk_56659=(ce,O,u)=>{"use strict";var s,x=u(17581),k=u(6056).ONE_SECOND_IN_TS,E=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];(s=function(S){var d,o=0;s.prototype.init.call(this),this.push=function(g){var c,f,m,C,I,_,R=0;if(S||(o=0),g.type==="audio")for(d?((d=new Uint8Array((C=d).byteLength+g.data.byteLength)).set(C),d.set(g.data,C.byteLength)):d=g.data;R+5<d.length;){if(d[R]!==255||(246&d[R+1])!=240){R++;continue}if(f=(1&~d[R+1])*2,c=(3&d[R+3])<<11|d[R+4]<<3|(224&d[R+5])>>5,_=(I=((3&d[R+6])+1)*1024)*k/E[(60&d[R+2])>>>2],m=R+c,d.byteLength<m)return;if(this.trigger("data",{pts:g.pts+o*_,dts:g.dts+o*_,sampleCount:I,audioobjecttype:(d[R+2]>>>6&3)+1,channelcount:(1&d[R+2])<<2|(192&d[R+3])>>>6,samplerate:E[(60&d[R+2])>>>2],samplingfrequencyindex:(60&d[R+2])>>>2,samplesize:16,data:d.subarray(R+7+f,m)}),o++,d.byteLength===m){d=void 0;return}d=d.subarray(m)}},this.flush=function(){o=0,this.trigger("done")},this.reset=function(){d=void 0,this.trigger("reset")},this.endTimeline=function(){d=void 0,this.trigger("endedtimeline")}}).prototype=new x,ce.exports=s},we.__chunk_17323=ce=>{"use strict";var O=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],u=function(E,S){var d=E[S+6]<<21|E[S+7]<<14|E[S+8]<<7|E[S+9];return d=d>=0?d:0,(16&E[S+5])>>4?d+20:d+10},s=function(E,S){return E.length-S<10||E[S]!==73||E[S+1]!==68||E[S+2]!==51?S:(S+=u(E,S),s(E,S))},x=function(E){return E[0]<<21|E[1]<<14|E[2]<<7|E[3]},k=function(E,S,d){var o,g="";for(o=S;o<d;o++)g+="%"+("00"+E[o].toString(16)).slice(-2);return g};ce.exports={isLikelyAacData:function(E){var S=s(E,0);return E.length>=S+2&&(255&E[S])==255&&(240&E[S+1])==240&&(22&E[S+1])==16},parseId3TagSize:u,parseAdtsSize:function(E,S){var d=(224&E[S+5])>>5,o=E[S+4]<<3;return 6144&E[S+3]|o|d},parseType:function(E,S){return E[S]===73&&E[S+1]===68&&E[S+2]===51?"timed-metadata":!0&E[S]&&(240&E[S+1])==240?"audio":null},parseSampleRate:function(E){for(var S=0;S+5<E.length;){if(E[S]!==255||(246&E[S+1])!=240){S++;continue}return O[(60&E[S+2])>>>2]}return null},parseAacTimestamp:function(E){var S,d,o;S=10,64&E[5]&&(S+=4+x(E.subarray(10,14)));do{if((d=x(E.subarray(S+4,S+8)))<1)break;if(String.fromCharCode(E[S],E[S+1],E[S+2],E[S+3])==="PRIV"){o=E.subarray(S+10,S+d+10);for(var g=0;g<o.byteLength;g++)if(o[g]===0){if(unescape(k(o,0,g))==="com.apple.streaming.transportStreamTimestamp"){var c=o.subarray(g+1),f=(1&c[3])<<30|c[4]<<22|c[5]<<14|c[6]<<6|c[7]>>>2;return f*=4,f+=3&c[7]}break}}S+=10+d}while(S<E.byteLength);return null}}},we.__chunk_72646=(ce,O,u)=>{"use strict";var s,x=u(17581),k=u(17323);(s=function(){var E=new Uint8Array,S=0;s.prototype.init.call(this),this.setTimestamp=function(d){S=d},this.push=function(d){var o,g,c,f=0,m=0;for(E.length?(c=E.length,(E=new Uint8Array(d.byteLength+c)).set(E.subarray(0,c)),E.set(d,c)):E=d;E.length-m>=3;){if(E[m]===73&&E[m+1]===68&&E[m+2]===51){if(E.length-m<10||(f=k.parseId3TagSize(E,m),m+f>E.length))break;o={type:"timed-metadata",data:E.subarray(m,m+f)},this.trigger("data",o),m+=f;continue}if((255&E[m])==255&&(240&E[m+1])==240){if(E.length-m<7||(f=k.parseAdtsSize(E,m),m+f>E.length))break;g={type:"audio",data:E.subarray(m,m+f),pts:S,dts:S},this.trigger("data",g),m+=f;continue}m++}E=E.length-m>0?E.subarray(m):new Uint8Array},this.reset=function(){E=new Uint8Array,this.trigger("reset")},this.endTimeline=function(){E=new Uint8Array,this.trigger("endedtimeline")}}).prototype=new x,ce.exports=s},we.__chunk_73464=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},we.__chunk_4676=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},we.__chunk_92845=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Tv",[["rect",{width:"20",height:"15",x:"2",y:"7",rx:"2",ry:"2",key:"10ag99"}],["polyline",{points:"17 2 12 7 7 2",key:"11pgbg"}]])},we.__chunk_89985=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},we.__chunk_73069=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]])},we.__chunk_2826=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},we.__chunk_38834=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},we.__chunk_32083=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},we.__chunk_68163=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},we.__chunk_3482=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},we.__chunk_14509=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},we.__chunk_9075=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},we.__chunk_97798=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]])},we.__chunk_28505=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]])},we.__chunk_51062=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]])},we.__chunk_80185=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]])},we.__chunk_22319=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},we.__chunk_18392=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]])},we.__chunk_31611=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]])},we.__chunk_34422=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},we.__chunk_62239=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},we.__chunk_68054=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]])},we.__chunk_94570=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},we.__chunk_90556=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},we.__chunk_43903=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Clover",[["path",{d:"M16.17 7.83 2 22",key:"t58vo8"}],["path",{d:"M4.02 12a2.827 2.827 0 1 1 3.81-4.17A2.827 2.827 0 1 1 12 4.02a2.827 2.827 0 1 1 4.17 3.81A2.827 2.827 0 1 1 19.98 12a2.827 2.827 0 1 1-3.81 4.17A2.827 2.827 0 1 1 12 19.98a2.827 2.827 0 1 1-4.17-3.81A1 1 0 1 1 4 12",key:"17k36q"}],["path",{d:"m7.83 7.83 8.34 8.34",key:"1d7sxk"}]])},we.__chunk_60609=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},we.__chunk_42860=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]])},we.__chunk_68630=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},we.__chunk_55297=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]])},we.__chunk_27715=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Cat",[["path",{d:"M12 5c.67 0 1.35.09 2 .26 1.78-2 5.03-2.84 6.42-2.26 1.4.58-.42 7-.42 7 .57 1.07 1 2.24 1 3.44C21 17.9 16.97 21 12 21s-9-3-9-7.56c0-1.25.5-2.4 1-3.44 0 0-1.89-6.42-.5-7 1.39-.58 4.72.23 6.5 2.23A9.04 9.04 0 0 1 12 5Z",key:"x6xyqk"}],["path",{d:"M8 14v.5",key:"1nzgdb"}],["path",{d:"M16 14v.5",key:"1lajdz"}],["path",{d:"M11.25 16.25h1.5L12 17l-.75-.75Z",key:"12kq1m"}]])},we.__chunk_17145=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]])},we.__chunk_35068=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>s});let s=(0,u(49263).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},we.__chunk_49263=(ce,O,u)=>{"use strict";u.d(O,{Z:()=>d});var s=u(24528);let x=o=>o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),k=(...o)=>o.filter((g,c,f)=>!!g&&f.indexOf(g)===c).join(" ");var E={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let S=(0,s.forwardRef)(({color:o="currentColor",size:g=24,strokeWidth:c=2,absoluteStrokeWidth:f,className:m="",children:C,iconNode:I,..._},R)=>(0,s.createElement)("svg",{ref:R,...E,width:g,height:g,stroke:o,strokeWidth:f?24*Number(c)/Number(g):c,className:k("lucide",m),..._},[...I.map(([F,L])=>(0,s.createElement)(F,L)),...Array.isArray(C)?C:[C]])),d=(o,g)=>{let c=(0,s.forwardRef)(({className:f,...m},C)=>(0,s.createElement)(S,{ref:C,iconNode:g,className:k(`lucide-${x(o)}`,f),...m}));return c.displayName=`${o}`,c}},we.__chunk_96951=ce=>{ce.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}},we);export{nl as __getNamedExports};
